<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applied Data Analysis - 21&nbsp; Multiple Regression and ANCOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./22-module.html" rel="next">
<link href="./20-module.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./21-module.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression and ANCOVA</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-logistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Logistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course-schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-typography-and-formatting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Typography and Formatting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-programming-style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming Style Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>RStudio</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extending the Functionality of <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamentals of the <strong><em>R</em></strong> Language</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basics of Version Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Additional Data Structures in <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting Data into <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Functions and Flow Control</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part II - Statistics and Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Descriptive Statisics and Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Using Permutation Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Elements of Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-module.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression and ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Model Selection in Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Mixed Effects or Multilevel Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Part III - Miscellany</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-maximum_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Maximum Likelihood Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-python-from-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using <strong><em>Python</em></strong> from <strong><em>R</em></strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-r-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building Custom <strong><em>R</em></strong> Packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building Interactive Web Apps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-using-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working with and Managing Packages</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 07</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 08</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-08-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 08 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 09</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-09-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 09 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-10-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 10 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 11</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-11-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 11 Solution</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-analysis-replication-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis Replication</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./collaborative-data-science-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Collaborative Data Science Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./creative-dataviz-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creative Data Visualization</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Packages Used</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives"><span class="header-section-number">21.1</span> Objectives</a></li>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link" data-scroll-target="#preliminaries"><span class="header-section-number">21.2</span> Preliminaries</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><span class="header-section-number">21.3</span> Overview</a></li>
  <li><a href="#multiple-regression" id="toc-multiple-regression" class="nav-link" data-scroll-target="#multiple-regression"><span class="header-section-number">21.4</span> Multiple Regression</a>
  <ul class="collapse">
  <li><a href="#challenge" id="toc-challenge" class="nav-link" data-scroll-target="#challenge">CHALLENGE</a></li>
  <li><a href="#plotting-effects" id="toc-plotting-effects" class="nav-link" data-scroll-target="#plotting-effects"><span class="header-section-number">21.4.1</span> Plotting Effects</a></li>
  <li><a href="#challenge-1" id="toc-challenge-1" class="nav-link" data-scroll-target="#challenge-1">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#ancova" id="toc-ancova" class="nav-link" data-scroll-target="#ancova"><span class="header-section-number">21.5</span> ANCOVA</a></li>
  <li><a href="#multicollinearity-and-vifs" id="toc-multicollinearity-and-vifs" class="nav-link" data-scroll-target="#multicollinearity-and-vifs"><span class="header-section-number">21.6</span> Multicollinearity and VIFs</a></li>
  <li><a href="#confidence-and-prediction-intervals" id="toc-confidence-and-prediction-intervals" class="nav-link" data-scroll-target="#confidence-and-prediction-intervals"><span class="header-section-number">21.7</span> Confidence and Prediction Intervals</a>
  <ul class="collapse">
  <li><a href="#challenge-2" id="toc-challenge-2" class="nav-link" data-scroll-target="#challenge-2">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#interactions-between-predictors" id="toc-interactions-between-predictors" class="nav-link" data-scroll-target="#interactions-between-predictors"><span class="header-section-number">21.8</span> Interactions Between Predictors</a>
  <ul class="collapse">
  <li><a href="#challenge-3" id="toc-challenge-3" class="nav-link" data-scroll-target="#challenge-3">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#visualizing-model-results" id="toc-visualizing-model-results" class="nav-link" data-scroll-target="#visualizing-model-results"><span class="header-section-number">21.9</span> Visualizing Model Results</a></li>
  <li><a href="#concept-review" id="toc-concept-review" class="nav-link" data-scroll-target="#concept-review">Concept Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./21-module.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression and ANCOVA</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="module-21" class="quarto-section-identifier"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression and ANCOVA</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="objectives" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="objectives"><span class="header-section-number">21.1</span> Objectives</h2>
<blockquote class="blockquote">
<p>In this module, we extend our simple linear regression and ANOVA models to cases where we have more than one predictor variable. The same approach can be used with combinations of continuous and categorical variables. If all of our predictors variables are continuous, we typically describe this as “multiple linear regression”. If our predictors are combinations of continuous and categorical variables, we typically describe this as “analysis of covariance”, or ANCOVA.</p>
</blockquote>
</section>
<section id="preliminaries" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="preliminaries"><span class="header-section-number">21.2</span> Preliminaries</h2>
<ul>
<li>Install these packages in <strong><em>R</em></strong>: <a href="https://cran.r-project.org/web/packages/jtools/jtools.pdf">{jtools}</a> <a href="https://cran.r-project.org/web/packages/ggeffects/ggeffects.pdf">{ggeffects}</a></li>
<li>Install and load this package in <strong><em>R</em></strong>: <a href="https://cran.r-project.org/web/packages/effects/effects.pdf">{effects}</a></li>
<li>Load {tidyverse}, {broom}, {car}, and {gridExtra}</li>
</ul>
</section>
<section id="overview" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="overview"><span class="header-section-number">21.3</span> Overview</h2>
<p>Multiple linear regression and ANCOVA are pretty straightforward generalizations of the simple linear regression and ANOVA approach that we have considered previously (i.e., Model I regressions, with our parameters estimated using the criterion of OLS). In multiple linear regression and ANCOVA, we are looking to model a response variable in terms of more than one predictor variable so that we can evaluate the effects of several different explanatory variables. When we do multiple linear regression, we are, essentially, looking at the relationship between each of two or more continuous predictor variables and a continuous response variable <strong>while holding the effect of all other predictor variables constant</strong>. When we do ANCOVA, we are effectively looking at the relationship between one or more continuous predictor variables and a continuous response variable within each of one or more categorical groups.</p>
<p>To characterize this using formulas analogous to those we have used before…</p>
<p>Simple Bivariate Linear Model:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1x + \epsilon\]</span></p>
<p>Multivariate Linear Model:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1x_1 + \beta_2x_2 + ... + \beta_kx_k + \epsilon\]</span></p>
<p>We thus now need to estimate <strong>several</strong> <span class="math inline">\(\beta\)</span> coefficients for our regression model - one for the intercept plus one for each predictor variable in our model, and, instead of a “line”” of best fit, we are determining a multidimensional “surface” of best fit. The criteria we typically use for estimating best fit is analogous to that we’ve used before, i.e., <strong>ordinary least squares</strong>, where we want to minimize the multidimensional squared deviation between our observed and predicted values:</p>
<p><span class="math display">\[\sum\limits_{i=1}^{k}[y_i - (\beta_0 + \beta_1x_{1_i} + \beta_2x_{2_i} + ... + \beta_kx_{k_i})]^2\]</span></p>
<p>Estimating our set of coefficients for multiple regression is actually done using matrix algebra, which we do not need to explore thoroughly (but see the “digression” below). The <code>lm()</code> function will implement this process for us directly.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Besides the least squares approach to parameter estimation, we might also use other approaches, including <strong>maximum likelihood</strong> and <strong>Bayesian approaches.</strong> These are mostly beyond the scope of what we will discuss in this class, but the objective is the same… to use a particular criterion to estimate parameter values for describing the relationship between our predictor and response variables, as well as for estimating the amount of uncertainty in those parameter values. It is worth noting that for many common population parameters (such as the mean), as well as for regression slopes and/or factor effects in certain linear models, OLS and ML estimators turn out to be exactly the same when the assumptions behind OLS are met (i.e., normally distributed variables and normally distributed error terms). When response variables or residuals are not normally distributed (e.g., where we have binary or categorical response variables), we use ML or Bayesian approaches, rather than OLS, for parameter estimation.</p>
</blockquote>
<p>Let’s work some examples!</p>
</section>
<section id="multiple-regression" class="level2" data-number="21.4">
<h2 data-number="21.4" class="anchored" data-anchor-id="multiple-regression"><span class="header-section-number">21.4</span> Multiple Regression</h2>
<section id="continous-response-variable-with-more-than-one-continuous-predictor" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="continous-response-variable-with-more-than-one-continuous-predictor">Continous Response Variable with More than One Continuous Predictor</h4>
<p>We will start by taking a digression to construct a dataset ourselves of some correlated random normal continuous variables. The following bit of code will let us do that. <a href="https://www.r-bloggers.com/simulating-random-multivariate-correlated-data-categorical-variables/">See also this post</a> for more information on generating toy data with a particular correlation structure. First, we define a matrix of correlations, <strong>R</strong>, among our variables (you can play with the values in this matrix, but it must be symmetric):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">cbind</span>(<span class="dv">1</span>, <span class="fl">0.8</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="dv">1</span>, <span class="fl">0.6</span>, <span class="dv">0</span>, <span class="fl">0.3</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.6</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.8 -0.5  0.0
## [2,]  0.8  1.0 -0.3  0.3
## [3,] -0.5 -0.3  1.0  0.6
## [4,]  0.0  0.3  0.6  1.0</code></pre>
</div>
</div>
<p>Second, we generate a dataset of random normal variables where each has a defined mean and standard deviation and then bundle these into a dataframe (“original”):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>original <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">40</span>, <span class="dv">5</span>, <span class="dv">23</span>)  <span class="co"># vector of variable means</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">4</span>, <span class="dv">15</span>)  <span class="co"># vector of variable SDs</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu[i], s[i])</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    original <span class="ot">&lt;-</span> <span class="fu">cbind</span>(original, v)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>original <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(original)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(original) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Y"</span>, <span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(original)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##          Y        X1         X2       X3
## 1 19.34724 78.994664  4.1644128 45.68779
## 2 19.15778 40.383009  4.4683729 30.10515
## 3 17.03678 26.330431  4.0073506 38.63092
## 4 22.82651  5.275346 -0.3145123 19.17930
## 5 22.06695 47.510989 -0.7758299 17.04949
## 6 20.97067 56.813979  6.1127408 21.75409</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(original)  <span class="co"># variables are uncorrelated</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##              Y          X1         X2          X3
## Y  1.000000000 0.007116743 0.03502810 0.055042430
## X1 0.007116743 1.000000000 0.02290142 0.004024335
## X2 0.035028098 0.022901421 1.00000000 0.047154776
## X3 0.055042430 0.004024335 0.04715478 1.000000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make quick bivariate plots for each pair of variables</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(original)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using `pairs(original)` would do the same</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s normalize and standardize our variables by subtracting the relevant means and dividing by the standard deviation. This converts them to <span class="math inline">\(Z\)</span> scores from a standard normal distribution.</p>
<p>Now run the following… note how we use the <code>apply()</code> and <code>sweep()</code> functions here. Cool, eh?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">apply</span>(original, <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"mean"</span>)  <span class="co"># returns a vector of means, where we are taking this across dimension 2 of the array 'orig'</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##         Y        X1        X2        X3 
## 15.024457 40.722288  4.856639 23.001342</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">summarize</span>(original, <span class="at">ymean =</span> <span class="fu">mean</span>(Y), <span class="at">x1mean =</span> <span class="fu">mean</span>(X1), <span class="at">x2mean =</span> <span class="fu">mean</span>(X2),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x3mean =</span> <span class="fu">mean</span>(X3)))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>ms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## function (..., quiet = FALSE, roll = FALSE) 
## {
##     out &lt;- .parse_hms(..., order = "MS", quiet = quiet)
##     if (roll) {
##         hms &lt;- .roll_hms(min = out["M", ], sec = out["S", ])
##         period(hour = hms$hour, minute = hms$min, second = hms$sec)
##     }
##     else {
##         period(minute = out["M", ], second = out["S", ])
##     }
## }
## &lt;bytecode: 0x13a428f58&gt;
## &lt;environment: namespace:lubridate&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>stdevs <span class="ot">&lt;-</span> <span class="fu">apply</span>(original, <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"sd"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>stdevs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##         Y        X1        X2        X3 
##  5.080689 20.245347  3.977061 15.578279</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>stdevs <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">summarize</span>(original, <span class="at">ySD =</span> <span class="fu">sd</span>(Y), <span class="at">x1SD =</span> <span class="fu">sd</span>(X1), <span class="at">x2SD =</span> <span class="fu">sd</span>(X2), <span class="at">x3SD =</span> <span class="fu">sd</span>(X3)))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>stdevs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##       ySD      x1SD      x2SD      x3SD 
##  5.080689 20.245347  3.977061 15.578279</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>normalized <span class="ot">&lt;-</span> <span class="fu">sweep</span>(original, <span class="dv">2</span>, <span class="at">STATS =</span> means, <span class="at">FUN =</span> <span class="st">"-"</span>)  <span class="co"># 2nd dimension is columns, removing array of means, function = subtract</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>normalized <span class="ot">&lt;-</span> <span class="fu">sweep</span>(normalized, <span class="dv">2</span>, <span class="at">STATS =</span> stdevs, <span class="at">FUN =</span> <span class="st">"/"</span>)  <span class="co"># 2nd dimension is columns, scaling by array of sds, function = divide</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(normalized)  <span class="co"># now a dataframe of Z scores</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##           Y          X1          X2          X3
## 1 0.8508262  1.89042822 -0.17405477  1.45628705
## 2 0.8135353 -0.01675842 -0.09762645  0.45600726
## 3 0.3960719 -0.71087235 -0.21354680  1.00329313
## 4 1.5356291 -1.75086861 -1.30024444 -0.24534453
## 5 1.3861295  0.33532149 -1.41623905 -0.38206068
## 6 1.1703553  0.79483402  0.31583664 -0.08006376</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(normalized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(normalized)  <span class="co"># define M as our matrix of normalized variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With <code>apply()</code>, we apply a function to a specified margin of an array or matrix (<code>1</code> = row, <code>2</code> = column), and with <code>sweep()</code> we then perform whatever function is specified by <code>FUN=</code> on all of the elements in an array specified by the given margin.</p>
<p>Next, we take what is called the Cholesky decomposition of our correlation matrix, <strong>R</strong>, and then multiply our normalized data matrix by the decomposition matrix to yield a transformed dataset with the specified correlation among variables. The Cholesky decomposition breaks certain symmetric matrices into two such that:</p>
<p><span class="math inline">\(R = U \cdot U^T\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>U <span class="ot">=</span> <span class="fu">chol</span>(R)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>newM <span class="ot">=</span> M <span class="sc">%*%</span> U</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>new <span class="ot">=</span> <span class="fu">as.data.frame</span>(newM)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Y"</span>, <span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(new)  <span class="co"># note that is correlation matrix is what we are aiming for!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##             Y         X1         X2        X3
## Y   1.0000000  0.8015366 -0.4748912 0.0573363
## X1  0.8015366  1.0000000 -0.2680911 0.3468081
## X2 -0.4748912 -0.2680911  1.0000000 0.6000199
## X3  0.0573363  0.3468081  0.6000199 1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(original)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new)  <span class="co"># note the axis scales; using `pairs(new)` would plot the same</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Finally, we can scale these back out to the mean and distribution of our original random variables.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">sweep</span>(new, <span class="dv">2</span>, <span class="at">STATS =</span> stdevs, <span class="at">FUN =</span> <span class="st">"*"</span>)  <span class="co"># scale back out to original mean...</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">sweep</span>(d, <span class="dv">2</span>, <span class="at">STATS =</span> means, <span class="at">FUN =</span> <span class="st">"+"</span>)  <span class="co"># and standard deviation</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##          Y       X1        X2        X3
## 1 19.34724 77.46593  3.829524 50.069623
## 2 19.15778 53.69496  2.897828 26.327488
## 3 17.03678 38.50206  2.876084 25.081357
## 4 22.82651 44.32560 -3.752192 -5.308254
## 5 22.06695 67.24565 -2.464134  8.529227
## 6 20.97067 69.33270  4.123684 31.414445</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##             Y         X1         X2        X3
## Y   1.0000000  0.8015366 -0.4748912 0.0573363
## X1  0.8015366  1.0000000 -0.2680911 0.3468081
## X2 -0.4748912 -0.2680911  1.0000000 0.6000199
## X3  0.0573363  0.3468081  0.6000199 1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d)  <span class="co"># note the change to the axis scales</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using `pairs(d)` would produce the same plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now have our own dataframe, <strong>d</strong>, comprising correlated random variables in original units!</p>
<p>Let’s explore this dataset, first with single and then with multivariate regression.</p>
</section>
<section id="challenge" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge">CHALLENGE</h3>
<p>Start off by making three bivariate scatterplots in {ggplot2} using the dataframe of three predictor variables (<strong>X1</strong>, <strong>X2</strong>, and <strong>X3</strong>) and one response variable (<strong>Y</strong>) that we generated above (or download it from “https://raw.githubusercontent.com/difiore/ada-datasets/main/multiple_regression.csv”)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/multiple_regression.csv"</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## Rows: 1000 Columns: 4
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## dbl (4): Y, X1, X2, X3
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> X3, <span class="at">y =</span> Y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g1, g2, g3, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Then, using simple linear regression as implemented with <code>lm()</code>, how does the response variable (<strong>Y</strong>) vary with each predictor variable (<strong>X1</strong>, <strong>X2</strong>, <strong>X3</strong>)? Are the <span class="math inline">\(\beta_1\)</span> coefficients for each bivariate significant? How much of the variation in <strong>Y</strong> does each predictor explain in a simple bivariate linear model?</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="at">formula =</span> Y <span class="sc">~</span> X1)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
## Call:
## lm(formula = Y ~ X1, data = d)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.9848  -2.1238   0.0731   2.1175  10.7924 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 7.132691   0.213888   33.35   &lt;2e-16 ***
## X1          0.198846   0.004785   41.55   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.012 on 998 degrees of freedom
## Multiple R-squared:  0.6337, Adjusted R-squared:  0.6334 
## F-statistic:  1727 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="at">formula =</span> Y <span class="sc">~</span> X2)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
## Call:
## lm(formula = Y ~ X2, data = d)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -16.1071  -3.0301   0.1099   2.9888  15.3328 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 17.91187    0.22465   79.73   &lt;2e-16 ***
## X2          -0.57531    0.03579  -16.07   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.435 on 998 degrees of freedom
## Multiple R-squared:  0.2057, Adjusted R-squared:  0.2049 
## F-statistic: 258.4 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="at">formula =</span> Y <span class="sc">~</span> X3)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
## Call:
## lm(formula = Y ~ X3, data = d)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -17.2471  -3.2823   0.0706   3.2325  13.9029 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 14.906854   0.288255  51.714   &lt;2e-16 ***
## X3           0.008163   0.010715   0.762    0.446    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.975 on 998 degrees of freedom
## Multiple R-squared:  0.0005812,  Adjusted R-squared:  -0.0004202 
## F-statistic: 0.5804 on 1 and 998 DF,  p-value: 0.4463</code></pre>
</details>
</div>
</div>
<p>In simple linear regression, <strong>Y</strong> has a significant, positive relationship with <strong>X1</strong>, a signficant negative relationship with <strong>X2</strong>, and no significant bivariate relationship with <strong>X3</strong>.</p>
<p>Now let’s move on to doing actual multiple regression. To review, with multiple regression, we are looking to model a response variable in terms of two or more predictor variables so we can evaluate the effect of each of several explanatory variables while holding the others constant.</p>
<p>Using <code>lm()</code> and formula notation, we can fit a model with all three predictor variables. The <code>+</code> sign is used to add additional predictors to our model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="at">formula =</span> Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## (Intercept)          X1          X2          X3 
##  9.14885797  0.20049618 -0.19794402 -0.04931104</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = Y ~ X1 + X2 + X3, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.3943 -1.7442 -0.1112  1.8602 10.6242 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  9.148858   0.254643  35.928  &lt; 2e-16 ***
## X1           0.200496   0.005680  35.297  &lt; 2e-16 ***
## X2          -0.197944   0.033890  -5.841 7.03e-09 ***
## X3          -0.049311   0.009235  -5.339 1.15e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.7 on 996 degrees of freedom
## Multiple R-squared:  0.7062, Adjusted R-squared:  0.7053 
## F-statistic: 798.1 on 3 and 996 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Next, let’s check if our residuals are random normal…</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(m), <span class="fu">residuals</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What does this output tell us? First off, the results of the omnibus F test tells us that the overall model is significant; using these three variables, we explain signficantly more of the variation in the response variable, <strong>Y</strong>, than we would using a model with just an intercept, i.e., just that <span class="math inline">\(Y\)</span> = mean(<span class="math inline">\(Y\)</span>).</p>
<p>For a multiple regression model, we calculate the F statistic as follows:</p>
<p><span class="math display">\[F = \frac{R^2(n-p-1)}{(1-R^2)p}\]</span></p>
<p>where…</p>
<ul>
<li><span class="math inline">\(R^2\)</span> = multiple R squared value</li>
<li><span class="math inline">\(n\)</span> = number of data points</li>
<li><span class="math inline">\(p\)</span> = number of parameters estimated from the data (i.e., the number of <span class="math inline">\(\beta\)</span> coefficients, not including the intercept)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> (<span class="fu">summary</span>(m)<span class="sc">$</span>r.squared <span class="sc">*</span> (<span class="fu">nrow</span>(df) <span class="sc">-</span> (<span class="fu">ncol</span>(df) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">/</span>((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>r.squared) <span class="sc">*</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">ncol</span>(df) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## numeric(0)</code></pre>
</div>
</div>
<p>Is this F ratio significant?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(<span class="at">q =</span> f, <span class="at">df1 =</span> <span class="fu">nrow</span>(df) <span class="sc">-</span> (<span class="fu">ncol</span>(df) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">df2 =</span> <span class="fu">ncol</span>(df) <span class="sc">-</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## numeric(0)</code></pre>
</div>
</div>
<p>Second, looking at <code>summary()</code> we see that the <span class="math inline">\(\beta\)</span> coefficient for each of our predictor variables (including <strong>X3</strong>) is significant. That is, each predictor is significant even when the effects of the other predictor variables are held constant. Recall that in the simple linear regression, the <span class="math inline">\(\beta\)</span> coefficient for <strong>X3</strong> was not significant.</p>
<p>Third, we can interpret our <span class="math inline">\(\beta\)</span> coefficients as we did in simple linear regression… for each change of one unit in a particular predictor variable (holding the other predictors constant), our predicted value of the response variable changes <span class="math inline">\(\beta\)</span> units.</p>
</section>
<section id="plotting-effects" class="level3" data-number="21.4.1">
<h3 data-number="21.4.1" class="anchored" data-anchor-id="plotting-effects"><span class="header-section-number">21.4.1</span> Plotting Effects</h3>
<p>We can use the versatile {effects} package to visualize the results of a variety of model objects, include general and generalized linear models and mixed effects models. The function <code>predictorEffects()</code> with no arguments will display the linear relationship between the response variable and each predictor.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also specify particular predictors we wish to look at by adding the “predictors = ~” argument…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">predictors =</span> <span class="sc">~</span>X1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Specifying the argument “partial.residuals = TRUE” returns the same plots as above, plus the values of the residuals after subtracting off the contribution from all other explanatory variables as well as a loess smoothed line of best fit through the residuals. Such plots are useful for detecting, for example, nonlinear relationships or interactions between predictors that are not obvious from looking at the original data.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The {ggeffects} package allows us to similarly predict and plot marginal effects from a model object. The <code>predict_response()</code> function takes a <em>model</em> object and one or more focal <em>terms</em> and returns the predicted values for the response variable across values of the focal term, along a specified margin (“mean_reference” by default) for the nonfocal terms. These can then be plotted with the <code>plot()</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict_response</span>(m, <span class="st">"X1 [all]"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="at">show_data =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> <span class="fl">0.1</span>)  <span class="co"># superimpose original data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="at">show_residuals =</span> <span class="cn">TRUE</span>, <span class="at">show_residuals_line =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> <span class="fl">0.1</span>)  <span class="co"># superimpose residuals and loess smoothed line of best fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>ggeffects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="challenge-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-1">CHALLENGE</h3>
<p>Load up the “zombies.csv” dataset with the characteristics of zombie apocalypse survivors again and run a linear model of height as a function of both weight and age. Is the overall model significant? Are both predictor variables significant when the other is controlled for? Make effects plots for each variable, plotting the partial residuals and the loess smoothed relationship between the residuals and each predictor.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>## Rows: 1000 Columns: 10
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (4): first_name, last_name, gender, major
## dbl (6): id, height, weight, zombies_killed, years_of_education, age
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## # A tibble: 6 × 10
##      id first_name last_name gender height weight zombies_killed
##   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;
## 1     1 Sarah      Little    Female   62.9   132.              2
## 2     2 Mark       Duncan    Male     67.8   146.              5
## 3     3 Brandon    Perez     Male     72.1   153.              1
## 4     4 Roger      Coleman   Male     66.8   130.              5
## 5     5 Tammy      Powell    Female   64.7   132.              4
## 6     6 Anthony    Green     Male     71.2   153.              1
## # ℹ 3 more variables: years_of_education &lt;dbl&gt;, major &lt;chr&gt;, age &lt;dbl&gt;</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight <span class="sc">+</span> age)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
## Call:
## lm(formula = height ~ weight + age, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.2278 -1.1782 -0.0574  1.1566  5.4117 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 31.763388   0.470797   67.47   &lt;2e-16 ***
## weight       0.163107   0.002976   54.80   &lt;2e-16 ***
## age          0.618270   0.018471   33.47   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.64 on 997 degrees of freedom
## Multiple R-squared:  0.8555, Adjusted R-squared:  0.8553 
## F-statistic:  2952 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ancova" class="level2" data-number="21.5">
<h2 data-number="21.5" class="anchored" data-anchor-id="ancova"><span class="header-section-number">21.5</span> ANCOVA</h2>
<section id="continous-response-variable-with-both-continuous-and-categorical-predictors" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="continous-response-variable-with-both-continuous-and-categorical-predictors">Continous Response Variable with both Continuous and Categorical Predictors</h4>
<p>We can use the same linear modeling approach to do <strong>analysis of covariance</strong>, or ANCOVA, where we have a continuous response variable and a combination of continuous and categorical predictor variables. Let’s return to the “zombies.csv” dataset and now include one continuous and one categorical variable in our model… we want to predict height as a function of <strong>age</strong> (a continuous variable) and <strong>gender</strong> (a categorical variable), and we want to use Type II regression (because we have an unbalanced design). What is our model formula?</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>gender)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="at">formula =</span> height <span class="sc">~</span> gender <span class="sc">+</span> age)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
## Call:
## lm(formula = height ~ gender + age, data = d)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.1909  -1.7173   0.1217   1.7670   7.6746 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 46.74251    0.56869   82.19   &lt;2e-16 ***
## genderMale   4.00224    0.16461   24.31   &lt;2e-16 ***
## age          0.94091    0.02777   33.88   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.603 on 997 degrees of freedom
## Multiple R-squared:  0.6361, Adjusted R-squared:  0.6354 
## F-statistic: 871.5 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>m.aov <span class="ot">&lt;-</span> <span class="fu">Anova</span>(m, <span class="at">type =</span> <span class="st">"II"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>m.aov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## Anova Table (Type II tests)
## 
## Response: height
##           Sum Sq  Df F value    Pr(&gt;F)    
## gender    4003.9   1  591.15 &lt; 2.2e-16 ***
## age       7775.6   1 1148.01 &lt; 2.2e-16 ***
## Residuals 6752.7 997                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(m), <span class="fu">residuals</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>How do we interpret these results?</p>
<ul>
<li>The omnibus F test is significant</li>
<li>Both predictors are significant</li>
<li>Height is related to age when sex is controlled for</li>
<li>Controlling for age, being <strong>male</strong> adds ~4 inches to predicted height when compared to being female.</li>
</ul>
</section>
<section id="visualizing-a-parallel-slopes-model" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="visualizing-a-parallel-slopes-model">Visualizing a Parallel Slopes Model</h4>
<p>We can now write two equations for the relationship between height, on the one hand, and age and gender on the other:</p>
<p>For females…</p>
<p><span class="math display">\[height = 46.7251 + 0.94091 \times age\]</span></p>
<blockquote class="blockquote">
<p>In this case, females are the first level of our “gender” factor and thus do not have additional regression coefficients associated with them.</p>
</blockquote>
<p>For males…</p>
<p><span class="math display">\[height = 46.7251 + 4.00224 + 0.94091 \times age\]</span></p>
<blockquote class="blockquote">
<p>Here, the additional 4.00224 added to the intercept term is the coefficient associated with <strong>genderMale</strong></p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(gender))) <span class="sc">+</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> m<span class="sc">$</span>coefficients[<span class="dv">3</span>], <span class="at">intercept =</span> m<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">"darkred"</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> m<span class="sc">$</span>coefficients[<span class="dv">3</span>], <span class="at">intercept =</span> m<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> m<span class="sc">$</span>coefficients[<span class="dv">2</span>],</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note that this model is based on all of the data collectively… we are not doing separate linear models for males and females, which <em>could</em> result in different intercepts and slopes for each sex… rather, we are modeling both sexes as having the same slope but different intercepts. This is what is known as a “parallel slopes” model. Below, we will explore a model where we posit an <strong>interaction</strong> between age and sex, which would require estimation of four separate parameters (i.e., both a slope <em>and</em> an intercept for males <em>and</em> females rather than, as above, only different intercepts for males and females but the same slope for each sex).</p>
<p>Using the <code>confint()</code> function on our ANCOVA model results reveals the confidence intervals for each of the coefficients in our multiple regression, just as it did for simple regression.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##                  2.5 %     97.5 %
## (Intercept) 45.6265330 47.8584809
## genderMale   3.6792172  4.3252593
## age          0.8864191  0.9954081</code></pre>
</div>
</div>
<p>We can also generate effects plots for this ANCOVA model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="multicollinearity-and-vifs" class="level2" data-number="21.6">
<h2 data-number="21.6" class="anchored" data-anchor-id="multicollinearity-and-vifs"><span class="header-section-number">21.6</span> Multicollinearity and VIFs</h2>
<p>When we have more than one explanatory variable in a regression model, we need to be concerned about possible high inter-correlations those variables. One way to characterize the amount of multicollinearity is by examining the variance inflation factor, or <strong>VIF</strong>, for each variable. Mathematically, the VIF for a predictor variable <em>i</em> is calculated as:</p>
<p><span class="math display">\[\frac{1}{1-R_i^2}\]</span> where <span class="math inline">\(R_i^2\)</span> is the R-squared value for the regression of variable <em>i</em> on all other predictors. A high VIF indicates that the predictor is highly collinear with other predictors in the model. As a rule of thumb, a VIF value that exceeds ~5 indicates a problematic amount of multicollinearity. The function <code>vif()</code> from the {car} package provides one way to calculate VIFs.</p>
<p>Below, we set up a new model with three predictors, <strong>weight</strong>, <strong>age</strong>, and <strong>gender</strong>, and calculate VIFs:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> weight <span class="sc">+</span> age <span class="sc">+</span> gender, <span class="at">data =</span> d)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ weight + age + gender, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.6235 -1.0082  0.0141  0.9845  4.6444 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 33.309791   0.437855   76.08   &lt;2e-16 ***
## weight       0.140542   0.003083   45.59   &lt;2e-16 ***
## age          0.662485   0.016953   39.08   &lt;2e-16 ***
## genderMale   1.609671   0.107436   14.98   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.482 on 996 degrees of freedom
## Multiple R-squared:  0.8821, Adjusted R-squared:  0.8818 
## F-statistic:  2484 on 3 and 996 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##   weight      age   gender 
## 1.463629 1.149158 1.313461</code></pre>
</div>
</div>
<p>We can also calculate VIFs manually, by running models that regress each individual predictor on all of the others…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> gender <span class="sc">+</span> age, <span class="at">data =</span> d)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>rsq_w <span class="ot">&lt;-</span> <span class="fu">summary</span>(w)<span class="sc">$</span>r.square</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>(vif_w <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> rsq_w))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.463629</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lm</span>(age <span class="sc">~</span> gender <span class="sc">+</span> weight, <span class="at">data =</span> d)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>rsq_a <span class="ot">&lt;-</span> <span class="fu">summary</span>(a)<span class="sc">$</span>r.square</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>(vif_a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> rsq_a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.149158</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for a categorical predictor variable, we can coerce it to numeric to use it</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># as a response variable</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.numeric</span>(gender) <span class="sc">~</span> age <span class="sc">+</span> weight, <span class="at">data =</span> d)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>rsq_g <span class="ot">&lt;-</span> <span class="fu">summary</span>(g)<span class="sc">$</span>r.square</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>(vif_g <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> rsq_g))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.313461</code></pre>
</div>
</div>
</section>
<section id="confidence-and-prediction-intervals" class="level2" data-number="21.7">
<h2 data-number="21.7" class="anchored" data-anchor-id="confidence-and-prediction-intervals"><span class="header-section-number">21.7</span> Confidence and Prediction Intervals</h2>
<p>One common reason for fitting a regression model is to then use that model to predict the value of the response variable under particular combinations of values of predictor variables, i.e., to predict the values of new observations. We can think of the <strong>Y</strong> value predicted by the regression model (<span class="math inline">\(\hat{y}\)</span>) as a point estimate of the response variable given particular value(s) of the predictor variable(s). This point estimate is associated with some uncertainty, which we can characterize in terms of either <strong>confidence intervals</strong> or <strong>prediction intervals</strong> around each the estimate. CIs represent uncertainty about the <strong>mean value</strong> of the response variable for a given (combination of) predictor value(s), while PIs represent our uncertainty about <strong>actual new predicted values</strong> of the response variable at those predictor value(s).</p>
<p>The <code>predict()</code> allows us to determine these intervals for individual responses for a given combination of predictor variables. <code>predict()</code> takes as arguments a model object, new values for the predictor(s) to be plugged into the model, an interval type (“confidence” or “prediction”), and a confidence level (e.g., “0.95”).</p>
<section id="challenge-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-2">CHALLENGE</h3>
<p>Let’s return to our model of height as a function of age and gender:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> age <span class="sc">+</span> gender, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>What is the predicted mean height, in inches, for 29-year old males who have survived the zombie apocalypse? What is the 95% confidence interval around this predicted mean height?</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">29</span>, <span class="at">gender =</span> <span class="st">"Male"</span>), <span class="at">interval =</span> <span class="st">"confidence"</span>,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>ci</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>##        fit      lwr      upr
## 1 78.03124 77.49345 78.56903</code></pre>
</details>
</div>
</div>
<ul>
<li>What is the 95% prediction interval for the <em>individual</em> heights of 29-year old male zombie apocalypse survivors?</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">29</span>, <span class="at">gender =</span> <span class="st">"Male"</span>), <span class="at">interval =</span> <span class="st">"prediction"</span>,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>pi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>##        fit      lwr      upr
## 1 78.03124 72.89597 83.16651</code></pre>
</details>
</div>
</div>
<p>In general, the width of a confidence interval for <span class="math inline">\(\hat{y}\)</span> increases as the value of our predictor variables moves away from the center of their distribution. Also, although both are intervals are centered at <span class="math inline">\(\hat{y}\)</span>, the predicted mean value of the response variable for the given (combination of) predictor(s), the prediction interval is invariably wider than the confidence interval. This makes intuitive sense, since the prediction interval encapsulates the possibility for individual values of <strong>Y</strong> to fluctuate away from the predicted mean value, while the confidence interval describes uncertainty in estimates of the predicted mean value. That is, the estimate of the mean of a variable is expected to be less uncertain than estimates of individual variable values, because the mean is already a statistic that summarizes a set of values.</p>
<p>We can see this by generating CIs and PIs for a range of data using the <code>predict()</code> function. Below, we pass <code>predict()</code> a new set of 1000 values ranging from the minimum to the maximum male age in our original data set…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>males <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"Male"</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>new_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(males<span class="sc">$</span>age), <span class="at">to =</span> <span class="fu">max</span>(males<span class="sc">$</span>age), <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> new_x, <span class="at">gender =</span> <span class="st">"Male"</span>), <span class="at">interval =</span> <span class="st">"confidence"</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> new_x, <span class="fu">as_tibble</span>(ci))</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> new_x, <span class="at">gender =</span> <span class="st">"Male"</span>), <span class="at">interval =</span> <span class="st">"prediction"</span>,</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(pi)</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> new_x, <span class="fu">as_tibble</span>(pi))</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d <span class="sc">|&gt;</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"Male"</span>), <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> ci,</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> fit), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> ci, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> lwr),</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> ci, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> upr), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> pi, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> lwr), <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> pi,</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> upr), <span class="at">color =</span> <span class="st">"green"</span>)</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>An easier, alternative way to generate CIs and PIs for across a range of predictor values iswith the <code>augment()</code> function from {broom}, as it returns a “tibble” with fitted values and interval limits appended to the original data frame.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">augment</span>(m, <span class="at">data =</span> d, <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">"confidence"</span>))</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">augment</span>(m, <span class="at">data =</span> d, <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">"prediction"</span>))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ci <span class="sc">|&gt;</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"Male"</span>), <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> age,</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper),</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="at">data =</span> pi <span class="sc">|&gt;</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"Male"</span>), <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper), <span class="at">alpha =</span> <span class="fl">0.1</span>)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="interactions-between-predictors" class="level2" data-number="21.8">
<h2 data-number="21.8" class="anchored" data-anchor-id="interactions-between-predictors"><span class="header-section-number">21.8</span> Interactions Between Predictors</h2>
<p>So far, we have only considered the joint <strong>main effects</strong> of multiple predictors on a response variable, but often there are <strong>interactive effects</strong> between our predictors. An interactive effect is an additional change in the response that occurs because of particular combinations of predictors or because the relationship of one continuous variable to a response is contingent on a particular level of a categorical variable. We explored the former case a bit when we looked at ANOVAs involving two discrete predictors. Now, we’ll consider the latter case… is there an interactive effect of sex <strong>AND</strong> age on height in our population of zombie apocalypse survivors?</p>
<p>Using formula notation, it is easy for us to consider interactions between predictors. The colon (<code>:</code>) operator allows us to specify particular interactions we want to consider. We can also use the asterisk (<code>*</code>) operator to specify a full model, i.e., <em>all</em> single terms factors and <em>all</em> their interactions.</p>
<p>What are the formula and results for a linear model of height as a function of age and sex plus the interaction of age and sex?</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age <span class="sc">+</span> gender <span class="sc">+</span> age<span class="sc">:</span>gender)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
## Call:
## lm(formula = height ~ age + gender + age:gender, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.7985 -1.6973  0.1189  1.7662  7.9473 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    48.18107    0.79839  60.348   &lt;2e-16 ***
## age             0.86913    0.03941  22.053   &lt;2e-16 ***
## genderMale      1.15975    1.12247   1.033   0.3018    
## age:genderMale  0.14179    0.05539   2.560   0.0106 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.595 on 996 degrees of freedom
## Multiple R-squared:  0.6385, Adjusted R-squared:  0.6374 
## F-statistic: 586.4 on 3 and 996 DF,  p-value: &lt; 2.2e-16</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age <span class="sc">*</span> gender)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
## Call:
## lm(formula = height ~ age * gender, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.7985 -1.6973  0.1189  1.7662  7.9473 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    48.18107    0.79839  60.348   &lt;2e-16 ***
## age             0.86913    0.03941  22.053   &lt;2e-16 ***
## genderMale      1.15975    1.12247   1.033   0.3018    
## age:genderMale  0.14179    0.05539   2.560   0.0106 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.595 on 996 degrees of freedom
## Multiple R-squared:  0.6385, Adjusted R-squared:  0.6374 
## F-statistic: 586.4 on 3 and 996 DF,  p-value: &lt; 2.2e-16</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>##    (Intercept)            age     genderMale age:genderMale 
##     48.1810741      0.8691284      1.1597481      0.1417928</code></pre>
</details>
</div>
</div>
<p>Here, when we allow an interaction, there is no main effect of gender, but there is an interaction effect of gender and age.</p>
<p>If we want to visualize this…</p>
<p><span class="math display">\[ female\ height = 48.1817041 + 0.8891281 \times age\]</span> <span class="math display">\[ male\ height = 48.1817041 + + 1.1597481 + 0.1417928 \times age\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(gender))) <span class="sc">+</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> m<span class="sc">$</span>coefficients[<span class="dv">2</span>], <span class="at">intercept =</span> m<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkred"</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> m<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> m<span class="sc">$</span>coefficients[<span class="dv">4</span>], <span class="at">intercept =</span> m<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    m<span class="sc">$</span>coefficients[<span class="dv">3</span>], <span class="at">color =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or, using `geom_smooth()`...</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(gender))) <span class="sc">+</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(gender)))</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <code>predictorEffects()</code> function from {effects} provides and alternative way to visualize interactions…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">predictors =</span> <span class="sc">~</span>age))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">predictors =</span> <span class="sc">~</span>gender))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the case of <strong>gender</strong>, the function plots the difference in predicted <strong>height</strong> of females and males as a set of levels specified by the argument “xlevels=”. The argument can be set to a particular number of levels (which is 5 by default, as in the example above) or it can be passed a list with elements named for the predictors, with either the number of level or a vector of level values added.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">predictors =</span> <span class="sc">~</span>gender, <span class="at">xlevels =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="dv">6</span>)))  <span class="co"># 6 ages, spanning the range of ages in the dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">predictors =</span> <span class="sc">~</span>gender, <span class="at">xlevels =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>))))  <span class="co"># 3 ages, specified by the user</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="challenge-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-3">CHALLENGE</h3>
<ul>
<li>Load in the “KamilarAndCooper.csv”” dataset we have used previously</li>
<li>Reduce the dataset to the following variables: <strong>Family</strong>, <strong>Brain_Size_Female_Mean</strong>, <strong>Body_mass_female_mean</strong>, <strong>MeanGroupSize</strong>, <strong>DayLength_km</strong>, <strong>HomeRange_km2</strong>, and <strong>Move</strong> and assign <strong>Family</strong> to be a factor. Also, rename the brain size, body mass, group size, day length, and home range variables as <strong>BrainSize</strong>, <strong>BodyMass</strong>, <strong>GroupSize</strong>, <strong>DayLength</strong>, <strong>HomeRange</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/KamilarAndCooperData.csv"</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>## Rows: 213 Columns: 45
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (17): Scientific_Name, Superfamily, Family, Genus, Species, Brain_size_R...
## dbl (28): Brain_Size_Species_Mean, Brain_Size_Female_Mean, Body_mass_male_me...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>Family <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>Family)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## # A tibble: 6 × 45
##   Scientific_Name        Superfamily Family Genus Species Brain_Size_Species_M…¹
##   &lt;chr&gt;                  &lt;chr&gt;       &lt;fct&gt;  &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
## 1 Allenopithecus_nigrov… Cercopithe… Cerco… Alle… nigrov…                   58.0
## 2 Allocebus_trichotis    Cercopithe… Cerco… Allo… tricho…                   NA  
## 3 Alouatta_belzebul      Ceboidea    Ateli… Alou… belzeb…                   52.8
## 4 Alouatta_caraya        Ceboidea    Ateli… Alou… caraya                    52.6
## 5 Alouatta_guariba       Ceboidea    Ateli… Alou… guariba                   51.7
## 6 Alouatta_palliata      Ceboidea    Ateli… Alou… pallia…                   49.9
## # ℹ abbreviated name: ¹​Brain_Size_Species_Mean
## # ℹ 39 more variables: Brain_Size_Female_Mean &lt;dbl&gt;, Brain_size_Ref &lt;chr&gt;,
## #   Body_mass_male_mean &lt;dbl&gt;, Body_mass_female_mean &lt;dbl&gt;,
## #   Mass_Dimorphism &lt;dbl&gt;, Mass_Ref &lt;chr&gt;, MeanGroupSize &lt;dbl&gt;,
## #   AdultMales &lt;dbl&gt;, AdultFemale &lt;dbl&gt;, AdultSexRatio &lt;dbl&gt;,
## #   Social_Organization_Ref &lt;chr&gt;, InterbirthInterval_d &lt;dbl&gt;, Gestation &lt;dbl&gt;,
## #   WeaningAge_d &lt;dbl&gt;, MaxLongevity_m &lt;dbl&gt;, LitterSz &lt;dbl&gt;, …</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Brain_Size_Female_Mean, Family, Body_mass_female_mean, MeanGroupSize,</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>        DayLength_km, HomeRange_km2, Move) <span class="sc">|&gt;</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">BrainSize =</span> Brain_Size_Female_Mean, <span class="at">BodyMass =</span> Body_mass_female_mean,</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">GroupSize =</span> MeanGroupSize, <span class="at">DayLength =</span> DayLength_km, <span class="at">HomeRange =</span> HomeRange_km2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Fit a <strong>Model I</strong> least squares multiple linear regression model using log(<strong>HomeRange</strong>) as the response variable and log(<strong>BodyMass</strong>), log(<strong>BrainSize</strong>), <strong>GroupSize</strong>, and <strong>Move</strong> as predictor variables, and view a model summary.</li>
<li>Look at and interpret the estimated regression coefficients for the fitted model and interpret. Are any of them statistically significant? What can you infer about the relationship between the response and predictors?</li>
<li>Report and interpret the coefficient of determination and the outcome of the omnibus F test.</li>
<li>Examine the residuals… are they normally distributed?</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="fu">log</span>(HomeRange) <span class="sc">~</span> <span class="fu">log</span>(BodyMass) <span class="sc">+</span> <span class="fu">log</span>(BrainSize) <span class="sc">+</span> GroupSize <span class="sc">+</span> Move)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
## Call:
## lm(formula = log(HomeRange) ~ log(BodyMass) + log(BrainSize) + 
##     GroupSize + Move, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7978 -0.6473 -0.0038  0.8807  2.1598 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -6.955853   1.957472  -3.553 0.000865 ***
## log(BodyMass)   0.315276   0.468439   0.673 0.504153    
## log(BrainSize)  0.614460   0.591100   1.040 0.303771    
## GroupSize       0.034026   0.009793   3.475 0.001095 ** 
## Move            0.025916   0.019559   1.325 0.191441    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.127 on 48 degrees of freedom
##   (160 observations deleted due to missingness)
## Multiple R-squared:  0.6359, Adjusted R-squared:  0.6055 
## F-statistic: 20.95 on 4 and 48 DF,  p-value: 4.806e-10</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(m<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(m<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
##  Shapiro-Wilk normality test
## 
## data:  m$residuals
## W = 0.96517, p-value = 0.1242</code></pre>
</details>
</div>
</div>
<p>When we plot effects for this model, note that the predictor effect plot uses untransformed predictor values on the horizontal axis, not the log-transformed variables that we used in the regression model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can use the “axes=” argument and the “x=” sub-argument to transform the horizontal axis, for example to replace <strong>BodyMass</strong> by <strong>log(BodyMass)</strong>. The code below specifies a lot of tweaks to the x axis…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="sc">~</span>BodyMass, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>), <span class="at">axes =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">list</span>(<span class="at">rotate =</span> <span class="dv">90</span>,</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">BodyMass =</span> <span class="fu">list</span>(<span class="at">transform =</span> <span class="fu">list</span>(<span class="at">trans =</span> log, <span class="at">inverse =</span> exp), <span class="at">lab =</span> <span class="st">"log(Body Mass)"</span>,</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ticks =</span> <span class="fu">list</span>(<span class="at">at =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>, <span class="fl">1e+05</span>)), <span class="at">lim =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="fl">1e+05</span>)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>What happens if we remove the <span class="math inline">\(Move\)</span> term from the model?</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="fu">log</span>(HomeRange) <span class="sc">~</span> <span class="fu">log</span>(BodyMass) <span class="sc">+</span> <span class="fu">log</span>(BrainSize) <span class="sc">+</span> GroupSize)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
## Call:
## lm(formula = log(HomeRange) ~ log(BodyMass) + log(BrainSize) + 
##     GroupSize, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7982 -0.7310 -0.0140  0.8386  3.1926 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -5.354845   1.176046  -4.553 1.45e-05 ***
## log(BodyMass)  -0.181627   0.311382  -0.583 0.560972    
## log(BrainSize)  1.390536   0.398840   3.486 0.000721 ***
## GroupSize       0.030433   0.008427   3.611 0.000473 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.228 on 103 degrees of freedom
##   (106 observations deleted due to missingness)
## Multiple R-squared:  0.6766, Adjusted R-squared:  0.6672 
## F-statistic: 71.85 on 3 and 103 DF,  p-value: &lt; 2.2e-16</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(m<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(m<span class="sc">$</span>residuals)  <span class="co"># no significant deviation from normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
##  Shapiro-Wilk normality test
## 
## data:  m$residuals
## W = 0.99366, p-value = 0.9058</code></pre>
</details>
</div>
</div>
</section>
</section>
<section id="visualizing-model-results" class="level2" data-number="21.9">
<h2 data-number="21.9" class="anchored" data-anchor-id="visualizing-model-results"><span class="header-section-number">21.9</span> Visualizing Model Results</h2>
<p>We have already seen lots of ways to view linear modeling results, e.g., by using the <code>summary()</code>, <code>glance()</code>, and <code>tidy()</code> functions with model objects as arguments. The {jtools} package provides some interesting additional functions for summarizing and visualizing regression models results.</p>
<ul>
<li>The <code>summ()</code> function is an alternative to <code>summary()</code> that provides a concise table of a model and its results. It can be used with standard <code>lm()</code> simple linear regression results (as we work with in this module) as well as with <code>glm()</code> and <code>lmer()</code> results (for generalized linear modeling and mixed effects modeling, respectively), as we cover in <a href="23-module.html"><strong>Module 23</strong></a> and <a href="24-module.html"><strong>Module 24</strong></a>.</li>
<li>The <code>effect_plot()</code> function can be used to plot the relationship between (one of) the predictor variables and the response variable while holding the others constant. The function contains lots of possible arguments for customizing the plot, e.g., for specifying whether and what types of interval can be plotted.</li>
<li>The <code>plot_summs()</code> function can be used to nicely visualize coefficient estimates and CI values around those terms, including visualizing multiple models on the same plot.</li>
</ul>
<p>Let’s return to working with the zombie apocaluypse survivors dataset…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> gender <span class="sc">+</span> zombies_killed)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(m1, <span class="at">confint =</span> <span class="cn">TRUE</span>, <span class="at">ci.width =</span> <span class="fl">0.95</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Observations</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Dependent variable</td>
<td style="text-align: right;">height</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Type</td>
<td style="text-align: right;">OLS linear regression</td>
</tr>
</tbody>
</table>
</div>
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">F(4,995)</td>
<td style="text-align: right;">1863.277</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">R²</td>
<td style="text-align: right;">0.882</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Adj. R²</td>
<td style="text-align: right;">0.882</td>
</tr>
</tbody>
</table>
</div>
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Est.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5%</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5%</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t val.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">(Intercept)</td>
<td style="text-align: right;">33.219</td>
<td style="text-align: right;">32.340</td>
<td style="text-align: right;">34.098</td>
<td style="text-align: right;">74.185</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">age</td>
<td style="text-align: right;">0.662</td>
<td style="text-align: right;">0.629</td>
<td style="text-align: right;">0.696</td>
<td style="text-align: right;">39.060</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">weight</td>
<td style="text-align: right;">0.141</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">45.586</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">genderMale</td>
<td style="text-align: right;">1.609</td>
<td style="text-align: right;">1.398</td>
<td style="text-align: right;">1.820</td>
<td style="text-align: right;">14.974</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">zombies_killed</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">-0.027</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">0.970</td>
<td style="text-align: right;">0.332</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> Standard errors: OLS</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effect_plot</span>(m1, <span class="at">pred =</span> age, <span class="at">interval =</span> <span class="cn">TRUE</span>, <span class="at">int.type =</span> <span class="st">"confidence"</span>, <span class="at">int.width =</span> <span class="fl">0.95</span>,</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> gender)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age <span class="sc">+</span> gender)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight <span class="sc">+</span> gender)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> gender)</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with unstandardized beta coefficients</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with standardized beta coefficients (i.e., mean centers the variables</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and sets SD to 1)</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-39-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with 95% CIs and distributions</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1, <span class="at">plot.distributions =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-39-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with 95% CIs and distributions scaled to same height</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1, <span class="at">plot.distributions =</span> <span class="cn">TRUE</span>, <span class="at">rescale.distributions =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-39-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot multiple models</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1, m2, m3, m4, m5, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-39-6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot multiple models</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1, m2, m3, m4, m5, <span class="at">plot.distributions =</span> <span class="cn">TRUE</span>, <span class="at">rescale.distributions =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21-module_files/figure-html/unnamed-chunk-39-7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>jtools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="concept-review" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="concept-review">Concept Review</h2>
<ul>
<li>Multiple regression and ANCOVA are further extensions of simple linear regression/ANOVA to cases where we have more than one predictor variable</li>
<li>“Multiple regression” refers to where we have 2 or more continuous predictor variables</li>
<li>“ANCOVA” refers to cases where we have one or more continuous predictor variables and one or more categorical predictor variables</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./20-module.html" class="pagination-link  aria-label=" &lt;span="" data="" analysis&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./22-module.html" class="pagination-link" aria-label="<span class='chapter-number'>22</span>&nbsp; <span class='chapter-title'>Model Selection in Regression</span>">
        <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Model Selection in Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb135" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multiple Regression and ANCOVA {#module-21}</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objectives</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In this module, we extend our simple linear regression and ANOVA models to cases where we have more than one predictor variable. The same approach can be used with combinations of continuous and categorical variables. If all of our predictors variables are continuous, we typically describe this as "multiple linear regression". If our predictors are combinations of continuous and categorical variables, we typically describe this as "analysis of covariance", or ANCOVA.</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminaries</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Install these packages in ***R***: <span class="co">[</span><span class="ot">{jtools}</span><span class="co">](https://cran.r-project.org/web/packages/jtools/jtools.pdf)</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">{ggeffects}</span><span class="co">](https://cran.r-project.org/web/packages/ggeffects/ggeffects.pdf)</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Install and load this package in ***R***:</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">{effects}</span><span class="co">](https://cran.r-project.org/web/packages/effects/effects.pdf)</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load {tidyverse}, {broom}, {car}, and {gridExtra}</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a>Multiple linear regression and ANCOVA are pretty straightforward generalizations of the simple linear regression and ANOVA approach that we have considered previously (i.e., Model I regressions, with our parameters estimated using the criterion of OLS). In multiple linear regression and ANCOVA, we are looking to model a response variable in terms of more than one predictor variable so that we can evaluate the effects of several different explanatory variables. When we do multiple linear regression, we are, essentially, looking at the relationship between each of two or more continuous predictor variables and a continuous response variable **while holding the effect of all other predictor variables constant**. When we do ANCOVA, we are effectively looking at the relationship between one or more continuous predictor variables and a continuous response variable within each of one or more categorical groups.</span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a>To characterize this using formulas analogous to those we have used before...</span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-33"><a href="#cb135-33" aria-hidden="true" tabindex="-1"></a>Simple Bivariate Linear Model:</span>
<span id="cb135-34"><a href="#cb135-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-35"><a href="#cb135-35" aria-hidden="true" tabindex="-1"></a>$$Y = \beta_0 + \beta_1x + \epsilon$$</span>
<span id="cb135-36"><a href="#cb135-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-37"><a href="#cb135-37" aria-hidden="true" tabindex="-1"></a>Multivariate Linear Model:</span>
<span id="cb135-38"><a href="#cb135-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-39"><a href="#cb135-39" aria-hidden="true" tabindex="-1"></a>$$Y = \beta_0 + \beta_1x_1 + \beta_2x_2 + ... + \beta_kx_k + \epsilon$$</span>
<span id="cb135-40"><a href="#cb135-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-41"><a href="#cb135-41" aria-hidden="true" tabindex="-1"></a>We thus now need to estimate **several** $\beta$ coefficients for our regression model - one for the intercept plus one for each predictor variable in our model, and, instead of a "line"" of best fit, we are determining a multidimensional "surface" of best fit. The criteria we typically use for estimating best fit is analogous to that we've used before, i.e., **ordinary least squares**, where we want to minimize the multidimensional squared deviation between our observed and predicted values:</span>
<span id="cb135-42"><a href="#cb135-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-43"><a href="#cb135-43" aria-hidden="true" tabindex="-1"></a>$$\sum\limits_{i=1}^{k}<span class="co">[</span><span class="ot">y_i - (\beta_0 + \beta_1x_{1_i} + \beta_2x_{2_i} + ... + \beta_kx_{k_i})</span><span class="co">]</span>^2$$</span>
<span id="cb135-44"><a href="#cb135-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-45"><a href="#cb135-45" aria-hidden="true" tabindex="-1"></a>Estimating our set of coefficients for multiple regression is actually done using matrix algebra, which we do not need to explore thoroughly (but see the "digression" below). The <span class="in">`lm()`</span> function will implement this process for us directly.</span>
<span id="cb135-46"><a href="#cb135-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-47"><a href="#cb135-47" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Besides the least squares approach to parameter estimation, we might also use other approaches, including **maximum likelihood** and **Bayesian approaches.** These are mostly beyond the scope of what we will discuss in this class, but the objective is the same... to use a particular criterion to estimate parameter values for describing the relationship between our predictor and response variables, as well as for estimating the amount of uncertainty in those parameter values. It is worth noting that for many common population parameters (such as the mean), as well as for regression slopes and/or factor effects in certain linear models, OLS and ML estimators turn out to be exactly the same when the assumptions behind OLS are met (i.e., normally distributed variables and normally distributed error terms). When response variables or residuals are not normally distributed (e.g., where we have binary or categorical response variables), we use ML or Bayesian approaches, rather than OLS, for parameter estimation.</span></span>
<span id="cb135-48"><a href="#cb135-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-49"><a href="#cb135-49" aria-hidden="true" tabindex="-1"></a>Let's work some examples!</span>
<span id="cb135-50"><a href="#cb135-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-51"><a href="#cb135-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple Regression</span></span>
<span id="cb135-52"><a href="#cb135-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-53"><a href="#cb135-53" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Continous Response Variable with More than One Continuous Predictor {.unnumbered}</span></span>
<span id="cb135-54"><a href="#cb135-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-55"><a href="#cb135-55" aria-hidden="true" tabindex="-1"></a>We will start by taking a digression to construct a dataset ourselves of some correlated random normal continuous variables. The following bit of code will let us do that. <span class="co">[</span><span class="ot">See also this post</span><span class="co">](https://www.r-bloggers.com/simulating-random-multivariate-correlated-data-categorical-variables/)</span> for more information on generating toy data with a particular correlation structure. First, we define a matrix of correlations, **R**, among our variables (you can play with the values in this matrix, but it must be symmetric):</span>
<span id="cb135-56"><a href="#cb135-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-59"><a href="#cb135-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-60"><a href="#cb135-60" aria-hidden="true" tabindex="-1"></a>R <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">cbind</span>(<span class="dv">1</span>,<span class="fl">0.80</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.00</span>,</span>
<span id="cb135-61"><a href="#cb135-61" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.80</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.3</span>,</span>
<span id="cb135-62"><a href="#cb135-62" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.3</span>,<span class="dv">1</span>, <span class="fl">0.6</span>,</span>
<span id="cb135-63"><a href="#cb135-63" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.00</span>,<span class="fl">0.3</span>,<span class="fl">0.6</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">4</span>)</span>
<span id="cb135-64"><a href="#cb135-64" aria-hidden="true" tabindex="-1"></a>R</span>
<span id="cb135-65"><a href="#cb135-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-66"><a href="#cb135-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-67"><a href="#cb135-67" aria-hidden="true" tabindex="-1"></a>Second, we generate a dataset of random normal variables where each has a defined mean and standard deviation and then bundle these into a dataframe ("original"):</span>
<span id="cb135-68"><a href="#cb135-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-71"><a href="#cb135-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-72"><a href="#cb135-72" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb135-73"><a href="#cb135-73" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb135-74"><a href="#cb135-74" aria-hidden="true" tabindex="-1"></a>original <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb135-75"><a href="#cb135-75" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb135-76"><a href="#cb135-76" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">40</span>,<span class="dv">5</span>,<span class="dv">23</span>) <span class="co"># vector of variable means</span></span>
<span id="cb135-77"><a href="#cb135-77" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>,<span class="dv">4</span>,<span class="dv">15</span>) <span class="co"># vector of variable SDs</span></span>
<span id="cb135-78"><a href="#cb135-78" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb135-79"><a href="#cb135-79" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,mu[i],s[i])</span>
<span id="cb135-80"><a href="#cb135-80" aria-hidden="true" tabindex="-1"></a>  original <span class="ot">&lt;-</span> <span class="fu">cbind</span>(original,v)</span>
<span id="cb135-81"><a href="#cb135-81" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-82"><a href="#cb135-82" aria-hidden="true" tabindex="-1"></a>original <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(original)</span>
<span id="cb135-83"><a href="#cb135-83" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(original) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Y"</span>,<span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3"</span>)</span>
<span id="cb135-84"><a href="#cb135-84" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(original)</span>
<span id="cb135-85"><a href="#cb135-85" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(original) <span class="co"># variables are uncorrelated</span></span>
<span id="cb135-86"><a href="#cb135-86" aria-hidden="true" tabindex="-1"></a><span class="co"># make quick bivariate plots for each pair of variables</span></span>
<span id="cb135-87"><a href="#cb135-87" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(original)</span>
<span id="cb135-88"><a href="#cb135-88" aria-hidden="true" tabindex="-1"></a><span class="co"># using `pairs(original)` would do the same</span></span>
<span id="cb135-89"><a href="#cb135-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-90"><a href="#cb135-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-91"><a href="#cb135-91" aria-hidden="true" tabindex="-1"></a>Now, let's normalize and standardize our variables by subtracting the relevant means and dividing by the standard deviation. This converts them to $Z$ scores from a standard normal distribution.</span>
<span id="cb135-92"><a href="#cb135-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-93"><a href="#cb135-93" aria-hidden="true" tabindex="-1"></a>Now run the following... note how we use the <span class="in">`apply()`</span> and <span class="in">`sweep()`</span> functions here. Cool, eh?</span>
<span id="cb135-94"><a href="#cb135-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-97"><a href="#cb135-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-98"><a href="#cb135-98" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">apply</span>(original, <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"mean"</span>) <span class="co"># returns a vector of means, where we are taking this across dimension 2 of the array "orig"</span></span>
<span id="cb135-99"><a href="#cb135-99" aria-hidden="true" tabindex="-1"></a>means</span>
<span id="cb135-100"><a href="#cb135-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-101"><a href="#cb135-101" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb135-102"><a href="#cb135-102" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">summarize</span>(original, <span class="at">ymean =</span> <span class="fu">mean</span>(Y), <span class="at">x1mean=</span><span class="fu">mean</span>(X1),<span class="at">x2mean=</span><span class="fu">mean</span>(X2),<span class="at">x3mean=</span><span class="fu">mean</span>(X3)))</span>
<span id="cb135-103"><a href="#cb135-103" aria-hidden="true" tabindex="-1"></a>ms</span>
<span id="cb135-104"><a href="#cb135-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-105"><a href="#cb135-105" aria-hidden="true" tabindex="-1"></a>stdevs <span class="ot">&lt;-</span> <span class="fu">apply</span>(original, <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"sd"</span>)</span>
<span id="cb135-106"><a href="#cb135-106" aria-hidden="true" tabindex="-1"></a>stdevs</span>
<span id="cb135-107"><a href="#cb135-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-108"><a href="#cb135-108" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb135-109"><a href="#cb135-109" aria-hidden="true" tabindex="-1"></a>stdevs <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">summarize</span>(original, <span class="at">ySD =</span> <span class="fu">sd</span>(Y), <span class="at">x1SD=</span><span class="fu">sd</span>(X1),<span class="at">x2SD=</span><span class="fu">sd</span>(X2),<span class="at">x3SD=</span><span class="fu">sd</span>(X3)))</span>
<span id="cb135-110"><a href="#cb135-110" aria-hidden="true" tabindex="-1"></a>stdevs</span>
<span id="cb135-111"><a href="#cb135-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-112"><a href="#cb135-112" aria-hidden="true" tabindex="-1"></a>normalized <span class="ot">&lt;-</span> <span class="fu">sweep</span>(original,<span class="dv">2</span>,<span class="at">STATS=</span>means,<span class="at">FUN=</span><span class="st">"-"</span>) <span class="co"># 2nd dimension is columns, removing array of means, function = subtract</span></span>
<span id="cb135-113"><a href="#cb135-113" aria-hidden="true" tabindex="-1"></a>normalized <span class="ot">&lt;-</span> <span class="fu">sweep</span>(normalized,<span class="dv">2</span>,<span class="at">STATS=</span>stdevs,<span class="at">FUN=</span><span class="st">"/"</span>) <span class="co"># 2nd dimension is columns, scaling by array of sds, function = divide</span></span>
<span id="cb135-114"><a href="#cb135-114" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(normalized) <span class="co"># now a dataframe of Z scores</span></span>
<span id="cb135-115"><a href="#cb135-115" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(normalized)</span>
<span id="cb135-116"><a href="#cb135-116" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(normalized) <span class="co"># define M as our matrix of normalized variables</span></span>
<span id="cb135-117"><a href="#cb135-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-118"><a href="#cb135-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-119"><a href="#cb135-119" aria-hidden="true" tabindex="-1"></a>With <span class="in">`apply()`</span>, we apply a function to a specified margin of an array or matrix (<span class="in">`1`</span> = row, <span class="in">`2`</span> = column), and with <span class="in">`sweep()`</span> we then perform whatever function is specified by <span class="in">`FUN=`</span> on all of the elements in an array specified by the given margin.</span>
<span id="cb135-120"><a href="#cb135-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-121"><a href="#cb135-121" aria-hidden="true" tabindex="-1"></a>Next, we take what is called the Cholesky decomposition of our correlation matrix, **R**, and then multiply our normalized data matrix by the decomposition matrix to yield a transformed dataset with the specified correlation among variables. The Cholesky decomposition breaks certain symmetric matrices into two such that:</span>
<span id="cb135-122"><a href="#cb135-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-123"><a href="#cb135-123" aria-hidden="true" tabindex="-1"></a>$R = U \cdot U^T$</span>
<span id="cb135-124"><a href="#cb135-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-127"><a href="#cb135-127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-128"><a href="#cb135-128" aria-hidden="true" tabindex="-1"></a>U <span class="ot">=</span> <span class="fu">chol</span>(R)</span>
<span id="cb135-129"><a href="#cb135-129" aria-hidden="true" tabindex="-1"></a>newM <span class="ot">=</span> M <span class="sc">%*%</span> U</span>
<span id="cb135-130"><a href="#cb135-130" aria-hidden="true" tabindex="-1"></a>new <span class="ot">=</span> <span class="fu">as.data.frame</span>(newM)</span>
<span id="cb135-131"><a href="#cb135-131" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Y"</span>,<span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3"</span>)</span>
<span id="cb135-132"><a href="#cb135-132" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(new) <span class="co"># note that is correlation matrix is what we are aiming for!</span></span>
<span id="cb135-133"><a href="#cb135-133" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(original)</span>
<span id="cb135-134"><a href="#cb135-134" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new) <span class="co"># note the axis scales; using `pairs(new)` would plot the same</span></span>
<span id="cb135-135"><a href="#cb135-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-136"><a href="#cb135-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-137"><a href="#cb135-137" aria-hidden="true" tabindex="-1"></a>Finally, we can scale these back out to the mean and distribution of our original random variables.</span>
<span id="cb135-138"><a href="#cb135-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-141"><a href="#cb135-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-142"><a href="#cb135-142" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">sweep</span>(new,<span class="dv">2</span>,<span class="at">STATS=</span>stdevs, <span class="at">FUN=</span><span class="st">"*"</span>) <span class="co"># scale back out to original mean...</span></span>
<span id="cb135-143"><a href="#cb135-143" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">sweep</span>(d,<span class="dv">2</span>,<span class="at">STATS=</span>means, <span class="at">FUN=</span><span class="st">"+"</span>) <span class="co"># and standard deviation</span></span>
<span id="cb135-144"><a href="#cb135-144" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb135-145"><a href="#cb135-145" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(d)</span>
<span id="cb135-146"><a href="#cb135-146" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d) <span class="co"># note the change to the axis scales</span></span>
<span id="cb135-147"><a href="#cb135-147" aria-hidden="true" tabindex="-1"></a><span class="co"># using `pairs(d)` would produce the same plot</span></span>
<span id="cb135-148"><a href="#cb135-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-149"><a href="#cb135-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-150"><a href="#cb135-150" aria-hidden="true" tabindex="-1"></a>We now have our own dataframe, **d**, comprising correlated random variables in original units!</span>
<span id="cb135-151"><a href="#cb135-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-152"><a href="#cb135-152" aria-hidden="true" tabindex="-1"></a>Let's explore this dataset, first with single and then with multivariate regression.</span>
<span id="cb135-153"><a href="#cb135-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-154"><a href="#cb135-154" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb135-155"><a href="#cb135-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-156"><a href="#cb135-156" aria-hidden="true" tabindex="-1"></a>Start off by making three bivariate scatterplots in {ggplot2} using the dataframe of three predictor variables (**X1**, **X2**, and **X3**) and one response variable (**Y**) that we generated above (or download it from "https://raw.githubusercontent.com/difiore/ada-datasets/main/multiple_regression.csv")</span>
<span id="cb135-157"><a href="#cb135-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-160"><a href="#cb135-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-161"><a href="#cb135-161" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/multiple_regression.csv"</span></span>
<span id="cb135-162"><a href="#cb135-162" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-163"><a href="#cb135-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-164"><a href="#cb135-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-167"><a href="#cb135-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-168"><a href="#cb135-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb135-169"><a href="#cb135-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb135-170"><a href="#cb135-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb135-171"><a href="#cb135-171" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>d, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb135-172"><a href="#cb135-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">formula=</span>y<span class="sc">~</span>x)</span>
<span id="cb135-173"><a href="#cb135-173" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>d, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb135-174"><a href="#cb135-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">formula=</span>y<span class="sc">~</span>x)</span>
<span id="cb135-175"><a href="#cb135-175" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>d, <span class="fu">aes</span>(<span class="at">x =</span> X3, <span class="at">y =</span> Y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb135-176"><a href="#cb135-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">formula=</span>y<span class="sc">~</span>x)</span>
<span id="cb135-177"><a href="#cb135-177" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g1, g2, g3, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb135-178"><a href="#cb135-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-179"><a href="#cb135-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-180"><a href="#cb135-180" aria-hidden="true" tabindex="-1"></a>Then, using simple linear regression as implemented with <span class="in">`lm()`</span>, how does the response variable (**Y**) vary with each predictor variable (**X1**, **X2**, **X3**)? Are the $\beta_1$ coefficients for each bivariate significant? How much of the variation in **Y** does each predictor explain in a simple bivariate linear model?</span>
<span id="cb135-181"><a href="#cb135-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-184"><a href="#cb135-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-185"><a href="#cb135-185" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb135-186"><a href="#cb135-186" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb135-187"><a href="#cb135-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb135-188"><a href="#cb135-188" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="at">formula =</span> Y <span class="sc">~</span> X1)</span>
<span id="cb135-189"><a href="#cb135-189" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb135-190"><a href="#cb135-190" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="at">formula =</span> Y <span class="sc">~</span> X2)</span>
<span id="cb135-191"><a href="#cb135-191" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span>
<span id="cb135-192"><a href="#cb135-192" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="at">formula =</span> Y <span class="sc">~</span> X3)</span>
<span id="cb135-193"><a href="#cb135-193" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span>
<span id="cb135-194"><a href="#cb135-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-195"><a href="#cb135-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-196"><a href="#cb135-196" aria-hidden="true" tabindex="-1"></a>In simple linear regression, **Y** has a significant, positive relationship with **X1**, a signficant negative relationship with **X2**, and no significant bivariate relationship with **X3**.</span>
<span id="cb135-197"><a href="#cb135-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-198"><a href="#cb135-198" aria-hidden="true" tabindex="-1"></a>Now let's move on to doing actual multiple regression. To review, with multiple regression, we are looking to model a response variable in terms of two or more predictor variables so we can evaluate the effect of each of several explanatory variables while holding the others constant.</span>
<span id="cb135-199"><a href="#cb135-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-200"><a href="#cb135-200" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`lm()`</span> and formula notation, we can fit a model with all three predictor variables. The <span class="in">`+`</span> sign is used to add additional predictors to our model.</span>
<span id="cb135-201"><a href="#cb135-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-204"><a href="#cb135-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-205"><a href="#cb135-205" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="at">formula =</span> Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3)</span>
<span id="cb135-206"><a href="#cb135-206" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m)</span>
<span id="cb135-207"><a href="#cb135-207" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb135-208"><a href="#cb135-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-209"><a href="#cb135-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-210"><a href="#cb135-210" aria-hidden="true" tabindex="-1"></a>Next, let's check if our residuals are random normal...</span>
<span id="cb135-211"><a href="#cb135-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-214"><a href="#cb135-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-215"><a href="#cb135-215" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb135-216"><a href="#cb135-216" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb135-217"><a href="#cb135-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb135-218"><a href="#cb135-218" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(m), <span class="fu">residuals</span>(m))</span>
<span id="cb135-219"><a href="#cb135-219" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb135-220"><a href="#cb135-220" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb135-221"><a href="#cb135-221" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb135-222"><a href="#cb135-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-223"><a href="#cb135-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-224"><a href="#cb135-224" aria-hidden="true" tabindex="-1"></a>What does this output tell us? First off, the results of the omnibus F test tells us that the overall model is significant; using these three variables, we explain signficantly more of the variation in the response variable, **Y**, than we would using a model with just an intercept, i.e., just that $Y$ = mean($Y$).</span>
<span id="cb135-225"><a href="#cb135-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-226"><a href="#cb135-226" aria-hidden="true" tabindex="-1"></a>For a multiple regression model, we calculate the F statistic as follows:</span>
<span id="cb135-227"><a href="#cb135-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-228"><a href="#cb135-228" aria-hidden="true" tabindex="-1"></a>$$F = \frac{R^2(n-p-1)}{(1-R^2)p}$$</span>
<span id="cb135-229"><a href="#cb135-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-230"><a href="#cb135-230" aria-hidden="true" tabindex="-1"></a>where...</span>
<span id="cb135-231"><a href="#cb135-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-232"><a href="#cb135-232" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$R^2$ = multiple R squared value</span>
<span id="cb135-233"><a href="#cb135-233" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$n$ = number of data points</span>
<span id="cb135-234"><a href="#cb135-234" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$p$ = number of parameters estimated from the data (i.e., the number of $\beta$ coefficients, not including the intercept)</span>
<span id="cb135-235"><a href="#cb135-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-238"><a href="#cb135-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-239"><a href="#cb135-239" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> (<span class="fu">summary</span>(m)<span class="sc">$</span>r.squared <span class="sc">*</span></span>
<span id="cb135-240"><a href="#cb135-240" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">nrow</span>(df) <span class="sc">-</span> (<span class="fu">ncol</span>(df) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>r.squared) <span class="sc">*</span></span>
<span id="cb135-241"><a href="#cb135-241" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">ncol</span>(df) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb135-242"><a href="#cb135-242" aria-hidden="true" tabindex="-1"></a>f</span>
<span id="cb135-243"><a href="#cb135-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-244"><a href="#cb135-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-245"><a href="#cb135-245" aria-hidden="true" tabindex="-1"></a>Is this F ratio significant?</span>
<span id="cb135-246"><a href="#cb135-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-249"><a href="#cb135-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-250"><a href="#cb135-250" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(<span class="at">q =</span> f, <span class="at">df1 =</span> <span class="fu">nrow</span>(df) <span class="sc">-</span> (<span class="fu">ncol</span>(df) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">df2 =</span> <span class="fu">ncol</span>(df) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb135-251"><a href="#cb135-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-252"><a href="#cb135-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-253"><a href="#cb135-253" aria-hidden="true" tabindex="-1"></a>Second, looking at <span class="in">`summary()`</span> we see that the $\beta$ coefficient for each of our predictor variables (including **X3**) is significant. That is, each predictor is significant even when the effects of the other predictor variables are held constant. Recall that in the simple linear regression, the $\beta$ coefficient for **X3** was not significant.</span>
<span id="cb135-254"><a href="#cb135-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-255"><a href="#cb135-255" aria-hidden="true" tabindex="-1"></a>Third, we can interpret our $\beta$ coefficients as we did in simple linear regression... for each change of one unit in a particular predictor variable (holding the other predictors constant), our predicted value of the response variable changes $\beta$ units.</span>
<span id="cb135-256"><a href="#cb135-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-257"><a href="#cb135-257" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plotting Effects</span></span>
<span id="cb135-258"><a href="#cb135-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-259"><a href="#cb135-259" aria-hidden="true" tabindex="-1"></a>We can use the versatile {effects} package to visualize the results of a variety of model objects, include general and generalized linear models and mixed effects models. The function <span class="in">`predictorEffects()`</span> with no arguments will display the linear relationship between the response variable and each predictor.</span>
<span id="cb135-260"><a href="#cb135-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-263"><a href="#cb135-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-264"><a href="#cb135-264" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m))</span>
<span id="cb135-265"><a href="#cb135-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-266"><a href="#cb135-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-267"><a href="#cb135-267" aria-hidden="true" tabindex="-1"></a>We can also specify particular predictors we wish to look at by adding the "predictors = ~" argument...</span>
<span id="cb135-268"><a href="#cb135-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-271"><a href="#cb135-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-272"><a href="#cb135-272" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">predictors =</span> <span class="sc">~</span> X1))</span>
<span id="cb135-273"><a href="#cb135-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-274"><a href="#cb135-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-275"><a href="#cb135-275" aria-hidden="true" tabindex="-1"></a>Specifying the argument "partial.residuals = TRUE" returns the same plots as above, plus the values of the residuals after subtracting off the contribution from all other explanatory variables as well as a loess smoothed line of best fit through the residuals. Such plots are useful for detecting, for example, nonlinear relationships or interactions between predictors that are not obvious from looking at the original data.</span>
<span id="cb135-276"><a href="#cb135-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-279"><a href="#cb135-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-280"><a href="#cb135-280" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>))</span>
<span id="cb135-281"><a href="#cb135-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-282"><a href="#cb135-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-283"><a href="#cb135-283" aria-hidden="true" tabindex="-1"></a>The {ggeffects} package allows us to similarly predict and plot marginal effects from a model object. The <span class="in">`predict_response()`</span> function takes a *model* object and one or more focal *terms* and returns the predicted values for the response variable across values of the focal term, along a specified margin ("mean_reference" by default) for the nonfocal terms. These can then be plotted with the <span class="in">`plot()`</span> function.</span>
<span id="cb135-284"><a href="#cb135-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-287"><a href="#cb135-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-288"><a href="#cb135-288" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb135-289"><a href="#cb135-289" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict_response</span>(m, <span class="st">"X1 [all]"</span>)</span>
<span id="cb135-290"><a href="#cb135-290" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p)</span>
<span id="cb135-291"><a href="#cb135-291" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="at">show_data =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> <span class="fl">0.1</span>) <span class="co"># superimpose original data</span></span>
<span id="cb135-292"><a href="#cb135-292" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="at">show_residuals =</span> <span class="cn">TRUE</span>, <span class="at">show_residuals_line =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> <span class="fl">0.1</span>) <span class="co"># superimpose residuals and loess smoothed line of best fit</span></span>
<span id="cb135-293"><a href="#cb135-293" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>ggeffects)</span>
<span id="cb135-294"><a href="#cb135-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-295"><a href="#cb135-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-296"><a href="#cb135-296" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb135-297"><a href="#cb135-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-298"><a href="#cb135-298" aria-hidden="true" tabindex="-1"></a>Load up the "zombies.csv" dataset with the characteristics of zombie apocalypse survivors again and run a linear model of height as a function of both weight and age. Is the overall model significant? Are both predictor variables significant when the other is controlled for? Make effects plots for each variable, plotting the partial residuals and the loess smoothed relationship between the residuals and each predictor.</span>
<span id="cb135-299"><a href="#cb135-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-302"><a href="#cb135-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-303"><a href="#cb135-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb135-304"><a href="#cb135-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb135-305"><a href="#cb135-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb135-306"><a href="#cb135-306" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb135-307"><a href="#cb135-307" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-308"><a href="#cb135-308" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb135-309"><a href="#cb135-309" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight <span class="sc">+</span> age)</span>
<span id="cb135-310"><a href="#cb135-310" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb135-311"><a href="#cb135-311" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>))</span>
<span id="cb135-312"><a href="#cb135-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-313"><a href="#cb135-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-314"><a href="#cb135-314" aria-hidden="true" tabindex="-1"></a><span class="fu">## ANCOVA</span></span>
<span id="cb135-315"><a href="#cb135-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-316"><a href="#cb135-316" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Continous Response Variable with both Continuous and Categorical Predictors {.unnumbered}</span></span>
<span id="cb135-317"><a href="#cb135-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-318"><a href="#cb135-318" aria-hidden="true" tabindex="-1"></a>We can use the same linear modeling approach to do **analysis of covariance**, or ANCOVA, where we have a continuous response variable and a combination of continuous and categorical predictor variables. Let's return to the "zombies.csv" dataset and now include one continuous and one categorical variable in our model... we want to predict height as a function of **age** (a continuous variable) and **gender** (a categorical variable), and we want to use Type II regression (because we have an unbalanced design). What is our model formula?</span>
<span id="cb135-319"><a href="#cb135-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-322"><a href="#cb135-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-323"><a href="#cb135-323" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb135-324"><a href="#cb135-324" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb135-325"><a href="#cb135-325" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb135-326"><a href="#cb135-326" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>gender)</span>
<span id="cb135-327"><a href="#cb135-327" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="at">formula =</span> height <span class="sc">~</span> gender <span class="sc">+</span> age)</span>
<span id="cb135-328"><a href="#cb135-328" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb135-329"><a href="#cb135-329" aria-hidden="true" tabindex="-1"></a>m.aov <span class="ot">&lt;-</span> <span class="fu">Anova</span>(m, <span class="at">type =</span> <span class="st">"II"</span>)</span>
<span id="cb135-330"><a href="#cb135-330" aria-hidden="true" tabindex="-1"></a>m.aov</span>
<span id="cb135-331"><a href="#cb135-331" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(m), <span class="fu">residuals</span>(m))</span>
<span id="cb135-332"><a href="#cb135-332" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb135-333"><a href="#cb135-333" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb135-334"><a href="#cb135-334" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb135-335"><a href="#cb135-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-336"><a href="#cb135-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-337"><a href="#cb135-337" aria-hidden="true" tabindex="-1"></a>How do we interpret these results?</span>
<span id="cb135-338"><a href="#cb135-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-339"><a href="#cb135-339" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The omnibus F test is significant</span>
<span id="cb135-340"><a href="#cb135-340" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Both predictors are significant</span>
<span id="cb135-341"><a href="#cb135-341" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Height is related to age when sex is controlled for</span>
<span id="cb135-342"><a href="#cb135-342" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Controlling for age, being **male** adds ~4 inches to predicted height when compared to being female.</span>
<span id="cb135-343"><a href="#cb135-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-344"><a href="#cb135-344" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualizing a Parallel Slopes Model {.unnumbered}</span></span>
<span id="cb135-345"><a href="#cb135-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-346"><a href="#cb135-346" aria-hidden="true" tabindex="-1"></a>We can now write two equations for the relationship between height, on the one hand, and age and gender on the other:</span>
<span id="cb135-347"><a href="#cb135-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-348"><a href="#cb135-348" aria-hidden="true" tabindex="-1"></a>For females...</span>
<span id="cb135-349"><a href="#cb135-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-350"><a href="#cb135-350" aria-hidden="true" tabindex="-1"></a>$$height = 46.7251 + 0.94091 \times age$$</span>
<span id="cb135-351"><a href="#cb135-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-352"><a href="#cb135-352" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In this case, females are the first level of our "gender" factor and thus do not have additional regression coefficients associated with them.</span></span>
<span id="cb135-353"><a href="#cb135-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-354"><a href="#cb135-354" aria-hidden="true" tabindex="-1"></a>For males...</span>
<span id="cb135-355"><a href="#cb135-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-356"><a href="#cb135-356" aria-hidden="true" tabindex="-1"></a>$$height = 46.7251 + 4.00224 + 0.94091 \times age$$</span>
<span id="cb135-357"><a href="#cb135-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-358"><a href="#cb135-358" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Here, the additional 4.00224 added to the intercept term is the coefficient associated with **genderMale**</span></span>
<span id="cb135-359"><a href="#cb135-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-362"><a href="#cb135-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-363"><a href="#cb135-363" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb135-364"><a href="#cb135-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(gender))) <span class="sc">+</span></span>
<span id="cb135-365"><a href="#cb135-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))</span>
<span id="cb135-366"><a href="#cb135-366" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_abline</span>(</span>
<span id="cb135-367"><a href="#cb135-367" aria-hidden="true" tabindex="-1"></a>  <span class="at">slope =</span> m<span class="sc">$</span>coefficients[<span class="dv">3</span>],</span>
<span id="cb135-368"><a href="#cb135-368" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> m<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb135-369"><a href="#cb135-369" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"darkred"</span></span>
<span id="cb135-370"><a href="#cb135-370" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-371"><a href="#cb135-371" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_abline</span>(</span>
<span id="cb135-372"><a href="#cb135-372" aria-hidden="true" tabindex="-1"></a>  <span class="at">slope =</span> m<span class="sc">$</span>coefficients[<span class="dv">3</span>],</span>
<span id="cb135-373"><a href="#cb135-373" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> m<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> m<span class="sc">$</span>coefficients[<span class="dv">2</span>],</span>
<span id="cb135-374"><a href="#cb135-374" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"darkblue"</span></span>
<span id="cb135-375"><a href="#cb135-375" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-376"><a href="#cb135-376" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb135-377"><a href="#cb135-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-378"><a href="#cb135-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-379"><a href="#cb135-379" aria-hidden="true" tabindex="-1"></a>Note that this model is based on all of the data collectively... we are not doing separate linear models for males and females, which *could* result in different intercepts and slopes for each sex... rather, we are modeling both sexes as having the same slope but different intercepts. This is what is known as a "parallel slopes" model. Below, we will explore a model where we posit an **interaction** between age and sex, which would require estimation of four separate parameters (i.e., both a slope *and* an intercept for males *and* females rather than, as above, only different intercepts for males and females but the same slope for each sex).</span>
<span id="cb135-380"><a href="#cb135-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-381"><a href="#cb135-381" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`confint()`</span> function on our ANCOVA model results reveals the confidence intervals for each of the coefficients in our multiple regression, just as it did for simple regression.</span>
<span id="cb135-382"><a href="#cb135-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-385"><a href="#cb135-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-386"><a href="#cb135-386" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb135-387"><a href="#cb135-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-388"><a href="#cb135-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-389"><a href="#cb135-389" aria-hidden="true" tabindex="-1"></a>We can also generate effects plots for this ANCOVA model:</span>
<span id="cb135-390"><a href="#cb135-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-393"><a href="#cb135-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-394"><a href="#cb135-394" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>))</span>
<span id="cb135-395"><a href="#cb135-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-396"><a href="#cb135-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-397"><a href="#cb135-397" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multicollinearity and VIFs</span></span>
<span id="cb135-398"><a href="#cb135-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-399"><a href="#cb135-399" aria-hidden="true" tabindex="-1"></a>When we have more than one explanatory variable in a regression model, we need to be concerned about possible high inter-correlations those variables. One way to characterize the amount of multicollinearity is by examining the variance inflation factor, or **VIF**, for each variable. Mathematically, the VIF for a predictor variable *i* is calculated as:</span>
<span id="cb135-400"><a href="#cb135-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-401"><a href="#cb135-401" aria-hidden="true" tabindex="-1"></a>$$\frac{1}{1-R_i^2}$$</span>
<span id="cb135-402"><a href="#cb135-402" aria-hidden="true" tabindex="-1"></a>where $R_i^2$ is the R-squared value for the regression of variable *i* on all other predictors. A high VIF indicates that the predictor is highly collinear with other predictors in the model. As a rule of thumb, a VIF value that exceeds ~5 indicates a problematic amount of multicollinearity. The function <span class="in">`vif()`</span> from the {car} package provides one way to calculate VIFs.</span>
<span id="cb135-403"><a href="#cb135-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-404"><a href="#cb135-404" aria-hidden="true" tabindex="-1"></a>Below, we set up a new model with three predictors, **weight**, **age**, and **gender**, and calculate VIFs:</span>
<span id="cb135-405"><a href="#cb135-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-408"><a href="#cb135-408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-409"><a href="#cb135-409" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> weight <span class="sc">+</span> age <span class="sc">+</span> gender, <span class="at">data =</span> d)</span>
<span id="cb135-410"><a href="#cb135-410" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb135-411"><a href="#cb135-411" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m)</span>
<span id="cb135-412"><a href="#cb135-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-413"><a href="#cb135-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-414"><a href="#cb135-414" aria-hidden="true" tabindex="-1"></a>We can also calculate VIFs manually, by running models that regress each individual predictor on all of the others...</span>
<span id="cb135-415"><a href="#cb135-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-418"><a href="#cb135-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-419"><a href="#cb135-419" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> gender <span class="sc">+</span> age, <span class="at">data =</span> d)</span>
<span id="cb135-420"><a href="#cb135-420" aria-hidden="true" tabindex="-1"></a>rsq_w <span class="ot">&lt;-</span> <span class="fu">summary</span>(w)<span class="sc">$</span>r.square</span>
<span id="cb135-421"><a href="#cb135-421" aria-hidden="true" tabindex="-1"></a>(vif_w <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>rsq_w))</span>
<span id="cb135-422"><a href="#cb135-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-423"><a href="#cb135-423" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lm</span>(age <span class="sc">~</span> gender <span class="sc">+</span> weight, <span class="at">data =</span> d)</span>
<span id="cb135-424"><a href="#cb135-424" aria-hidden="true" tabindex="-1"></a>rsq_a <span class="ot">&lt;-</span> <span class="fu">summary</span>(a)<span class="sc">$</span>r.square</span>
<span id="cb135-425"><a href="#cb135-425" aria-hidden="true" tabindex="-1"></a>(vif_a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>rsq_a))</span>
<span id="cb135-426"><a href="#cb135-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-427"><a href="#cb135-427" aria-hidden="true" tabindex="-1"></a><span class="co"># for a categorical predictor variable, we can coerce it to numeric to use it as a response variable</span></span>
<span id="cb135-428"><a href="#cb135-428" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.numeric</span>(gender) <span class="sc">~</span> age <span class="sc">+</span> weight, <span class="at">data =</span> d)</span>
<span id="cb135-429"><a href="#cb135-429" aria-hidden="true" tabindex="-1"></a>rsq_g <span class="ot">&lt;-</span> <span class="fu">summary</span>(g)<span class="sc">$</span>r.square</span>
<span id="cb135-430"><a href="#cb135-430" aria-hidden="true" tabindex="-1"></a>(vif_g <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>rsq_g))</span>
<span id="cb135-431"><a href="#cb135-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-432"><a href="#cb135-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-433"><a href="#cb135-433" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confidence and Prediction Intervals</span></span>
<span id="cb135-434"><a href="#cb135-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-435"><a href="#cb135-435" aria-hidden="true" tabindex="-1"></a>One common reason for fitting a regression model is to then use that model to predict the value of the response variable under particular combinations of values of predictor variables, i.e., to predict the values of new observations. We can think of the **Y** value predicted by the regression model ($\hat{y}$) as a point estimate of the response variable given particular value(s) of the predictor variable(s). This point estimate is associated with some uncertainty, which we can characterize in terms of either **confidence intervals** or **prediction intervals** around each the estimate. CIs represent uncertainty about the **mean value** of the response variable for a given (combination of) predictor value(s), while PIs represent our uncertainty about **actual new predicted values** of the response variable at those predictor value(s).</span>
<span id="cb135-436"><a href="#cb135-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-437"><a href="#cb135-437" aria-hidden="true" tabindex="-1"></a>The <span class="in">`predict()`</span> allows us to determine these intervals for individual responses for a given combination of predictor variables. <span class="in">`predict()`</span> takes as arguments a model object, new values for the predictor(s) to be plugged into the model, an interval type ("confidence" or "prediction"), and a confidence level (e.g., "0.95").</span>
<span id="cb135-438"><a href="#cb135-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-439"><a href="#cb135-439" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb135-440"><a href="#cb135-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-441"><a href="#cb135-441" aria-hidden="true" tabindex="-1"></a>Let's return to our model of height as a function of age and gender:</span>
<span id="cb135-442"><a href="#cb135-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-445"><a href="#cb135-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-446"><a href="#cb135-446" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> age <span class="sc">+</span> gender, <span class="at">data =</span> d)</span>
<span id="cb135-447"><a href="#cb135-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-448"><a href="#cb135-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-449"><a href="#cb135-449" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the predicted mean height, in inches, for 29-year old males who have survived the zombie apocalypse? What is the 95% confidence interval around this predicted mean height?</span>
<span id="cb135-450"><a href="#cb135-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-453"><a href="#cb135-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-454"><a href="#cb135-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb135-455"><a href="#cb135-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb135-456"><a href="#cb135-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb135-457"><a href="#cb135-457" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">29</span>, <span class="at">gender =</span> <span class="st">"Male"</span>),</span>
<span id="cb135-458"><a href="#cb135-458" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb135-459"><a href="#cb135-459" aria-hidden="true" tabindex="-1"></a>ci</span>
<span id="cb135-460"><a href="#cb135-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-461"><a href="#cb135-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-462"><a href="#cb135-462" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the 95% prediction interval for the *individual* heights of 29-year old male zombie apocalypse survivors?</span>
<span id="cb135-463"><a href="#cb135-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-466"><a href="#cb135-466" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-467"><a href="#cb135-467" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb135-468"><a href="#cb135-468" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb135-469"><a href="#cb135-469" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb135-470"><a href="#cb135-470" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">29</span>, <span class="at">gender =</span> <span class="st">"Male"</span>),</span>
<span id="cb135-471"><a href="#cb135-471" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval=</span><span class="st">"prediction"</span>,<span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb135-472"><a href="#cb135-472" aria-hidden="true" tabindex="-1"></a>pi</span>
<span id="cb135-473"><a href="#cb135-473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-474"><a href="#cb135-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-475"><a href="#cb135-475" aria-hidden="true" tabindex="-1"></a>In general, the width of a confidence interval for $\hat{y}$ increases as the value of our predictor variables moves away from the center of their distribution. Also, although both are intervals are centered at $\hat{y}$, the predicted mean value of the response variable for the given (combination of) predictor(s), the prediction interval is invariably wider than the confidence interval. This makes intuitive sense, since the prediction interval encapsulates the possibility for individual values of **Y** to fluctuate away from the predicted mean value, while the confidence interval describes uncertainty in estimates of the predicted mean value. That is, the estimate of the mean of a variable is expected to be less uncertain than estimates of individual variable values, because the mean is already a statistic that summarizes a set of values.</span>
<span id="cb135-476"><a href="#cb135-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-477"><a href="#cb135-477" aria-hidden="true" tabindex="-1"></a>We can see this by generating CIs and PIs for a range of data using the <span class="in">`predict()`</span> function. Below, we pass <span class="in">`predict()`</span> a new set of 1000 values ranging from the minimum to the maximum male age in our original data set...</span>
<span id="cb135-478"><a href="#cb135-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-481"><a href="#cb135-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-482"><a href="#cb135-482" aria-hidden="true" tabindex="-1"></a>males <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span> <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"Male"</span>)</span>
<span id="cb135-483"><a href="#cb135-483" aria-hidden="true" tabindex="-1"></a>new_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(males<span class="sc">$</span>age), <span class="at">to =</span> <span class="fu">max</span>(males<span class="sc">$</span>age), <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb135-484"><a href="#cb135-484" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb135-485"><a href="#cb135-485" aria-hidden="true" tabindex="-1"></a>  m,</span>
<span id="cb135-486"><a href="#cb135-486" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> new_x, <span class="at">gender =</span> <span class="st">"Male"</span>),</span>
<span id="cb135-487"><a href="#cb135-487" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb135-488"><a href="#cb135-488" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb135-489"><a href="#cb135-489" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> new_x, <span class="fu">as_tibble</span>(ci))</span>
<span id="cb135-490"><a href="#cb135-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-491"><a href="#cb135-491" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb135-492"><a href="#cb135-492" aria-hidden="true" tabindex="-1"></a>  m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> new_x, <span class="at">gender =</span> <span class="st">"Male"</span>),</span>
<span id="cb135-493"><a href="#cb135-493" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">"prediction"</span>,</span>
<span id="cb135-494"><a href="#cb135-494" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb135-495"><a href="#cb135-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-496"><a href="#cb135-496" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(pi)</span>
<span id="cb135-497"><a href="#cb135-497" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb135-498"><a href="#cb135-498" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> new_x, <span class="fu">as_tibble</span>(pi))</span>
<span id="cb135-499"><a href="#cb135-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-500"><a href="#cb135-500" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d <span class="sc">|&gt;</span> <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"Male"</span>),</span>
<span id="cb135-501"><a href="#cb135-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb135-502"><a href="#cb135-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb135-503"><a href="#cb135-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> ci, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> fit), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb135-504"><a href="#cb135-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> ci, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y=</span> lwr), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb135-505"><a href="#cb135-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> ci, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y=</span> upr), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb135-506"><a href="#cb135-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pi, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y=</span> lwr), <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb135-507"><a href="#cb135-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pi, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y=</span> upr), <span class="at">color =</span> <span class="st">"green"</span>)</span>
<span id="cb135-508"><a href="#cb135-508" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb135-509"><a href="#cb135-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-510"><a href="#cb135-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-511"><a href="#cb135-511" aria-hidden="true" tabindex="-1"></a>An easier, alternative way to generate CIs and PIs for across a range of predictor values iswith the <span class="in">`augment()`</span> function from {broom}, as it returns a "tibble" with fitted values and interval limits appended to the original data frame.</span>
<span id="cb135-512"><a href="#cb135-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-515"><a href="#cb135-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-516"><a href="#cb135-516" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">augment</span>(</span>
<span id="cb135-517"><a href="#cb135-517" aria-hidden="true" tabindex="-1"></a>  m,</span>
<span id="cb135-518"><a href="#cb135-518" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d,</span>
<span id="cb135-519"><a href="#cb135-519" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">"confidence"</span>)</span>
<span id="cb135-520"><a href="#cb135-520" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-521"><a href="#cb135-521" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">augment</span>(</span>
<span id="cb135-522"><a href="#cb135-522" aria-hidden="true" tabindex="-1"></a>  m,</span>
<span id="cb135-523"><a href="#cb135-523" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d,</span>
<span id="cb135-524"><a href="#cb135-524" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">"prediction"</span>)</span>
<span id="cb135-525"><a href="#cb135-525" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-526"><a href="#cb135-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-527"><a href="#cb135-527" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ci <span class="sc">|&gt;</span> <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"Male"</span>), <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb135-528"><a href="#cb135-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb135-529"><a href="#cb135-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">ymin =</span> .lower, <span class="at">ymax=</span>.upper), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb135-530"><a href="#cb135-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> pi <span class="sc">|&gt;</span> <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"Male"</span>), <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">ymin =</span> .lower, <span class="at">ymax=</span>.upper), <span class="at">alpha =</span> <span class="fl">0.1</span>)</span>
<span id="cb135-531"><a href="#cb135-531" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb135-532"><a href="#cb135-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-533"><a href="#cb135-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-534"><a href="#cb135-534" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interactions Between Predictors</span></span>
<span id="cb135-535"><a href="#cb135-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-536"><a href="#cb135-536" aria-hidden="true" tabindex="-1"></a>So far, we have only considered the joint **main effects** of multiple predictors on a response variable, but often there are **interactive effects** between our predictors. An interactive effect is an additional change in the response that occurs because of particular combinations of predictors or because the relationship of one continuous variable to a response is contingent on a particular level of a categorical variable. We explored the former case a bit when we looked at ANOVAs involving two discrete predictors. Now, we'll consider the latter case... is there an interactive effect of sex **AND** age on height in our population of zombie apocalypse survivors?</span>
<span id="cb135-537"><a href="#cb135-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-538"><a href="#cb135-538" aria-hidden="true" tabindex="-1"></a>Using formula notation, it is easy for us to consider interactions between predictors. The colon (<span class="in">`:`</span>) operator allows us to specify particular interactions we want to consider. We can also use the asterisk (<span class="in">`*`</span>) operator to specify a full model, i.e., *all* single terms factors and *all* their interactions.</span>
<span id="cb135-539"><a href="#cb135-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-540"><a href="#cb135-540" aria-hidden="true" tabindex="-1"></a>What are the formula and results for a linear model of height as a function of age and sex plus the interaction of age and sex?</span>
<span id="cb135-541"><a href="#cb135-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-544"><a href="#cb135-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-545"><a href="#cb135-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb135-546"><a href="#cb135-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb135-547"><a href="#cb135-547" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb135-548"><a href="#cb135-548" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age <span class="sc">+</span> gender <span class="sc">+</span> age<span class="sc">:</span>gender)</span>
<span id="cb135-549"><a href="#cb135-549" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb135-550"><a href="#cb135-550" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb135-551"><a href="#cb135-551" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age <span class="sc">*</span> gender)</span>
<span id="cb135-552"><a href="#cb135-552" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb135-553"><a href="#cb135-553" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(m)</span>
<span id="cb135-554"><a href="#cb135-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-555"><a href="#cb135-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-556"><a href="#cb135-556" aria-hidden="true" tabindex="-1"></a>Here, when we allow an interaction, there is no main effect of gender, but there is an interaction effect of gender and age.</span>
<span id="cb135-557"><a href="#cb135-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-558"><a href="#cb135-558" aria-hidden="true" tabindex="-1"></a>If we want to visualize this...</span>
<span id="cb135-559"><a href="#cb135-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-560"><a href="#cb135-560" aria-hidden="true" tabindex="-1"></a>$$ female\ height = 48.1817041 + 0.8891281 \times age$$ $$ male\ height = 48.1817041 + + 1.1597481 + 0.1417928 \times age$$</span>
<span id="cb135-561"><a href="#cb135-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-564"><a href="#cb135-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-565"><a href="#cb135-565" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d,<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb135-566"><a href="#cb135-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(gender))) <span class="sc">+</span></span>
<span id="cb135-567"><a href="#cb135-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>))</span>
<span id="cb135-568"><a href="#cb135-568" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> m<span class="sc">$</span>coefficients[<span class="dv">2</span>],</span>
<span id="cb135-569"><a href="#cb135-569" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> m<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">"darkred"</span>)</span>
<span id="cb135-570"><a href="#cb135-570" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> m<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> m<span class="sc">$</span>coefficients[<span class="dv">4</span>],</span>
<span id="cb135-571"><a href="#cb135-571" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> m<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> m<span class="sc">$</span>coefficients[<span class="dv">3</span>], <span class="at">color=</span><span class="st">"darkblue"</span>)</span>
<span id="cb135-572"><a href="#cb135-572" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb135-573"><a href="#cb135-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-574"><a href="#cb135-574" aria-hidden="true" tabindex="-1"></a><span class="co"># or, using `geom_smooth()`...</span></span>
<span id="cb135-575"><a href="#cb135-575" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d,<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb135-576"><a href="#cb135-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(gender))) <span class="sc">+</span></span>
<span id="cb135-577"><a href="#cb135-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb135-578"><a href="#cb135-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(gender)))</span>
<span id="cb135-579"><a href="#cb135-579" aria-hidden="true" tabindex="-1"></a>p2</span>
<span id="cb135-580"><a href="#cb135-580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-581"><a href="#cb135-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-582"><a href="#cb135-582" aria-hidden="true" tabindex="-1"></a>The <span class="in">`predictorEffects()`</span> function from {effects} provides and alternative way to visualize interactions...</span>
<span id="cb135-583"><a href="#cb135-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-586"><a href="#cb135-586" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-587"><a href="#cb135-587" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">predictors =</span> <span class="sc">~</span> age))</span>
<span id="cb135-588"><a href="#cb135-588" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">predictors =</span> <span class="sc">~</span> gender))</span>
<span id="cb135-589"><a href="#cb135-589" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-590"><a href="#cb135-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-591"><a href="#cb135-591" aria-hidden="true" tabindex="-1"></a>In the case of **gender**, the function plots the difference in predicted **height** of females and males as a set of levels specified by the argument "xlevels=". The argument can be set to a particular number of levels (which is 5 by default, as in the example above) or it can be passed a list with elements named for the predictors, with either the number of level or a vector of level values added.</span>
<span id="cb135-592"><a href="#cb135-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-595"><a href="#cb135-595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-596"><a href="#cb135-596" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">predictors =</span> <span class="sc">~</span> gender, <span class="at">xlevels =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="dv">6</span>))) <span class="co"># 6 ages, spanning the range of ages in the dataset</span></span>
<span id="cb135-597"><a href="#cb135-597" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">predictors =</span> <span class="sc">~</span> gender, <span class="at">xlevels =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>)))) <span class="co"># 3 ages, specified by the user</span></span>
<span id="cb135-598"><a href="#cb135-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-599"><a href="#cb135-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-600"><a href="#cb135-600" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb135-601"><a href="#cb135-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-602"><a href="#cb135-602" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load in the "KamilarAndCooper.csv"" dataset we have used previously</span>
<span id="cb135-603"><a href="#cb135-603" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Reduce the dataset to the following variables: **Family**, **Brain_Size_Female_Mean**, **Body_mass_female_mean**, **MeanGroupSize**, **DayLength_km**, **HomeRange_km2**, and **Move** and assign **Family** to be a factor. Also, rename the brain size, body mass, group size, day length, and home range variables as **BrainSize**, **BodyMass**, **GroupSize**, **DayLength**, **HomeRange**</span>
<span id="cb135-604"><a href="#cb135-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-607"><a href="#cb135-607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-608"><a href="#cb135-608" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb135-609"><a href="#cb135-609" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb135-610"><a href="#cb135-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb135-611"><a href="#cb135-611" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/KamilarAndCooperData.csv"</span></span>
<span id="cb135-612"><a href="#cb135-612" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-613"><a href="#cb135-613" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>Family <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>Family)</span>
<span id="cb135-614"><a href="#cb135-614" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb135-615"><a href="#cb135-615" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb135-616"><a href="#cb135-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Brain_Size_Female_Mean, Family, Body_mass_female_mean, MeanGroupSize, DayLength_km, HomeRange_km2, Move) <span class="sc">|&gt;</span></span>
<span id="cb135-617"><a href="#cb135-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">BrainSize =</span> Brain_Size_Female_Mean,</span>
<span id="cb135-618"><a href="#cb135-618" aria-hidden="true" tabindex="-1"></a>         <span class="at">BodyMass =</span> Body_mass_female_mean,</span>
<span id="cb135-619"><a href="#cb135-619" aria-hidden="true" tabindex="-1"></a>         <span class="at">GroupSize =</span> MeanGroupSize,</span>
<span id="cb135-620"><a href="#cb135-620" aria-hidden="true" tabindex="-1"></a>         <span class="at">DayLength =</span> DayLength_km,</span>
<span id="cb135-621"><a href="#cb135-621" aria-hidden="true" tabindex="-1"></a>         <span class="at">HomeRange =</span> HomeRange_km2)</span>
<span id="cb135-622"><a href="#cb135-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-623"><a href="#cb135-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-624"><a href="#cb135-624" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fit a **Model I** least squares multiple linear regression model using log(**HomeRange**) as the response variable and log(**BodyMass**), log(**BrainSize**), **GroupSize**, and **Move** as predictor variables, and view a model summary.</span>
<span id="cb135-625"><a href="#cb135-625" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Look at and interpret the estimated regression coefficients for the fitted model and interpret. Are any of them statistically significant? What can you infer about the relationship between the response and predictors?</span>
<span id="cb135-626"><a href="#cb135-626" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report and interpret the coefficient of determination and the outcome of the omnibus F test.</span>
<span id="cb135-627"><a href="#cb135-627" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Examine the residuals... are they normally distributed?</span>
<span id="cb135-628"><a href="#cb135-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-631"><a href="#cb135-631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-632"><a href="#cb135-632" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb135-633"><a href="#cb135-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb135-634"><a href="#cb135-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb135-635"><a href="#cb135-635" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="fu">log</span>(HomeRange) <span class="sc">~</span> <span class="fu">log</span>(BodyMass) <span class="sc">+</span></span>
<span id="cb135-636"><a href="#cb135-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(BrainSize) <span class="sc">+</span> GroupSize <span class="sc">+</span> Move)</span>
<span id="cb135-637"><a href="#cb135-637" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb135-638"><a href="#cb135-638" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m<span class="sc">$</span>residuals)</span>
<span id="cb135-639"><a href="#cb135-639" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(m<span class="sc">$</span>residuals)</span>
<span id="cb135-640"><a href="#cb135-640" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(m<span class="sc">$</span>residuals)</span>
<span id="cb135-641"><a href="#cb135-641" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-642"><a href="#cb135-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-643"><a href="#cb135-643" aria-hidden="true" tabindex="-1"></a>When we plot effects for this model, note that the predictor effect plot uses untransformed predictor values on the horizontal axis, not the log-transformed variables that we used in the regression model.</span>
<span id="cb135-644"><a href="#cb135-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-647"><a href="#cb135-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-648"><a href="#cb135-648" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>))</span>
<span id="cb135-649"><a href="#cb135-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-650"><a href="#cb135-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-651"><a href="#cb135-651" aria-hidden="true" tabindex="-1"></a>We can use the "axes=" argument and the "x=" sub-argument to transform the horizontal axis, for example to replace **BodyMass** by **log(BodyMass)**. The code below specifies a lot of tweaks to the x axis...</span>
<span id="cb135-652"><a href="#cb135-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-655"><a href="#cb135-655" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-656"><a href="#cb135-656" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(m, <span class="sc">~</span> BodyMass, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>),</span>
<span id="cb135-657"><a href="#cb135-657" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes =</span> <span class="fu">list</span>(</span>
<span id="cb135-658"><a href="#cb135-658" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">list</span>(</span>
<span id="cb135-659"><a href="#cb135-659" aria-hidden="true" tabindex="-1"></a>      <span class="at">rotate =</span> <span class="dv">90</span>,</span>
<span id="cb135-660"><a href="#cb135-660" aria-hidden="true" tabindex="-1"></a>      <span class="at">BodyMass =</span> <span class="fu">list</span>(</span>
<span id="cb135-661"><a href="#cb135-661" aria-hidden="true" tabindex="-1"></a>        <span class="at">transform =</span> <span class="fu">list</span>(<span class="at">trans =</span> log, <span class="at">inverse =</span> exp),</span>
<span id="cb135-662"><a href="#cb135-662" aria-hidden="true" tabindex="-1"></a>        <span class="at">lab =</span> <span class="st">"log(Body Mass)"</span>,</span>
<span id="cb135-663"><a href="#cb135-663" aria-hidden="true" tabindex="-1"></a>        <span class="at">ticks=</span><span class="fu">list</span>(<span class="at">at =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>, <span class="dv">100000</span>)),</span>
<span id="cb135-664"><a href="#cb135-664" aria-hidden="true" tabindex="-1"></a>        <span class="at">lim =</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">100000</span>)</span>
<span id="cb135-665"><a href="#cb135-665" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb135-666"><a href="#cb135-666" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb135-667"><a href="#cb135-667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-668"><a href="#cb135-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-669"><a href="#cb135-669" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What happens if we remove the $Move$ term from the model?</span>
<span id="cb135-670"><a href="#cb135-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-673"><a href="#cb135-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-674"><a href="#cb135-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb135-675"><a href="#cb135-675" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb135-676"><a href="#cb135-676" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb135-677"><a href="#cb135-677" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, <span class="fu">log</span>(HomeRange) <span class="sc">~</span> <span class="fu">log</span>(BodyMass) <span class="sc">+</span></span>
<span id="cb135-678"><a href="#cb135-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(BrainSize)<span class="sc">+</span> GroupSize)</span>
<span id="cb135-679"><a href="#cb135-679" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb135-680"><a href="#cb135-680" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m<span class="sc">$</span>residuals)</span>
<span id="cb135-681"><a href="#cb135-681" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(m<span class="sc">$</span>residuals)</span>
<span id="cb135-682"><a href="#cb135-682" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(m<span class="sc">$</span>residuals) <span class="co"># no significant deviation from normal</span></span>
<span id="cb135-683"><a href="#cb135-683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-684"><a href="#cb135-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-685"><a href="#cb135-685" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualizing Model Results</span></span>
<span id="cb135-686"><a href="#cb135-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-687"><a href="#cb135-687" aria-hidden="true" tabindex="-1"></a>We have already seen lots of ways to view linear modeling results, e.g., by using the <span class="in">`summary()`</span>, <span class="in">`glance()`</span>, and <span class="in">`tidy()`</span> functions with model objects as arguments. The {jtools} package provides some interesting additional functions for summarizing and visualizing regression models results.</span>
<span id="cb135-688"><a href="#cb135-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-689"><a href="#cb135-689" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The <span class="in">`summ()`</span> function is an alternative to <span class="in">`summary()`</span> that provides a concise table of a model and its results. It can be used with standard <span class="in">`lm()`</span> simple linear regression results (as we work with in this module) as well as with <span class="in">`glm()`</span> and <span class="in">`lmer()`</span> results (for generalized linear modeling and mixed effects modeling, respectively), as we cover in <span class="co">[</span><span class="ot">**Module 23**</span><span class="co">](#module-23)</span> and <span class="co">[</span><span class="ot">**Module 24**</span><span class="co">](#module-24)</span>.</span>
<span id="cb135-690"><a href="#cb135-690" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The <span class="in">`effect_plot()`</span> function can be used to plot the relationship between (one of) the predictor variables and the response variable while holding the others constant. The function contains lots of possible arguments for customizing the plot, e.g., for specifying whether and what types of interval can be plotted.</span>
<span id="cb135-691"><a href="#cb135-691" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The <span class="in">`plot_summs()`</span> function can be used to nicely visualize coefficient estimates and CI values around those terms, including visualizing multiple models on the same plot.</span>
<span id="cb135-692"><a href="#cb135-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-693"><a href="#cb135-693" aria-hidden="true" tabindex="-1"></a>Let's return to working with the zombie apocaluypse survivors dataset...</span>
<span id="cb135-694"><a href="#cb135-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-697"><a href="#cb135-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-698"><a href="#cb135-698" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb135-699"><a href="#cb135-699" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb135-700"><a href="#cb135-700" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb135-701"><a href="#cb135-701" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-702"><a href="#cb135-702" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools)</span>
<span id="cb135-703"><a href="#cb135-703" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d,</span>
<span id="cb135-704"><a href="#cb135-704" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> gender <span class="sc">+</span> zombies_killed)</span>
<span id="cb135-705"><a href="#cb135-705" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(m1, <span class="at">confint =</span> <span class="cn">TRUE</span>, <span class="at">ci.width =</span> <span class="fl">0.95</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb135-706"><a href="#cb135-706" aria-hidden="true" tabindex="-1"></a><span class="fu">effect_plot</span>(m1, <span class="at">pred =</span> age, <span class="at">interval =</span> <span class="cn">TRUE</span>, <span class="at">int.type =</span> <span class="st">"confidence"</span>,</span>
<span id="cb135-707"><a href="#cb135-707" aria-hidden="true" tabindex="-1"></a>  <span class="at">int.width =</span> <span class="fl">0.95</span>, <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-708"><a href="#cb135-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-709"><a href="#cb135-709" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d,</span>
<span id="cb135-710"><a href="#cb135-710" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> gender)</span>
<span id="cb135-711"><a href="#cb135-711" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d,</span>
<span id="cb135-712"><a href="#cb135-712" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> age <span class="sc">+</span> gender)</span>
<span id="cb135-713"><a href="#cb135-713" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d,</span>
<span id="cb135-714"><a href="#cb135-714" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> weight <span class="sc">+</span> gender)</span>
<span id="cb135-715"><a href="#cb135-715" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> gender)</span>
<span id="cb135-716"><a href="#cb135-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-717"><a href="#cb135-717" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with unstandardized beta coefficients</span></span>
<span id="cb135-718"><a href="#cb135-718" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1)</span>
<span id="cb135-719"><a href="#cb135-719" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with standardized beta coefficients</span></span>
<span id="cb135-720"><a href="#cb135-720" aria-hidden="true" tabindex="-1"></a><span class="co"># (i.e., mean centers the variables and sets SD to 1)</span></span>
<span id="cb135-721"><a href="#cb135-721" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1, <span class="at">scale =</span> <span class="cn">TRUE</span>) </span>
<span id="cb135-722"><a href="#cb135-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-723"><a href="#cb135-723" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with 95% CIs and distributions</span></span>
<span id="cb135-724"><a href="#cb135-724" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1, <span class="at">plot.distributions =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-725"><a href="#cb135-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-726"><a href="#cb135-726" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with 95% CIs and distributions scaled to same height</span></span>
<span id="cb135-727"><a href="#cb135-727" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1, <span class="at">plot.distributions =</span> <span class="cn">TRUE</span>, <span class="at">rescale.distributions =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-728"><a href="#cb135-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-729"><a href="#cb135-729" aria-hidden="true" tabindex="-1"></a><span class="co"># plot multiple models</span></span>
<span id="cb135-730"><a href="#cb135-730" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1, m2, m3, m4, m5, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-731"><a href="#cb135-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-732"><a href="#cb135-732" aria-hidden="true" tabindex="-1"></a><span class="co"># plot multiple models</span></span>
<span id="cb135-733"><a href="#cb135-733" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(m1, m2, m3, m4, m5, <span class="at">plot.distributions =</span> <span class="cn">TRUE</span>, <span class="at">rescale.distributions =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-734"><a href="#cb135-734" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>jtools)</span>
<span id="cb135-735"><a href="#cb135-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-736"><a href="#cb135-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-739"><a href="#cb135-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-740"><a href="#cb135-740" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb135-741"><a href="#cb135-741" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>effects)</span>
<span id="cb135-742"><a href="#cb135-742" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>gridExtra)</span>
<span id="cb135-743"><a href="#cb135-743" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>car)</span>
<span id="cb135-744"><a href="#cb135-744" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>broom)</span>
<span id="cb135-745"><a href="#cb135-745" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>tidyverse)</span>
<span id="cb135-746"><a href="#cb135-746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-747"><a href="#cb135-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-748"><a href="#cb135-748" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb135-749"><a href="#cb135-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-750"><a href="#cb135-750" aria-hidden="true" tabindex="-1"></a><span class="fu">## Concept Review {.unnumbered}</span></span>
<span id="cb135-751"><a href="#cb135-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-752"><a href="#cb135-752" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multiple regression and ANCOVA are further extensions of simple linear regression/ANOVA to cases where we have more than one predictor variable</span>
<span id="cb135-753"><a href="#cb135-753" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>"Multiple regression" refers to where we have 2 or more continuous predictor variables</span>
<span id="cb135-754"><a href="#cb135-754" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>"ANCOVA" refers to cases where we have one or more continuous predictor variables and one or more categorical predictor variables</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>