<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>14&nbsp; Confidence Intervals – Applied Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./15-module.html" rel="next">
<link href="./13-module.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./14-module.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-logistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Logistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course-schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-typography-and-formatting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Typography and Formatting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-programming-style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming Style Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>RStudio</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extending the Functionality of <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamentals of the <strong><em>R</em></strong> Language</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basics of Version Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Additional Data Structures in <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting Data into <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Functions and Flow Control</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II - Statistics and Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Descriptive Statisics and Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-module.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Using Permutation Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Elements of Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression and ANCOVA</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 07</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 08</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-analysis-replication-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis Replication</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Packages Used</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives"><span class="header-section-number">14.1</span> Objectives</a></li>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link" data-scroll-target="#preliminaries"><span class="header-section-number">14.2</span> Preliminaries</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">14.3</span> Confidence Intervals</a>
  <ul class="collapse">
  <li><a href="#calculating-theoretical-cis" id="toc-calculating-theoretical-cis" class="nav-link" data-scroll-target="#calculating-theoretical-cis">Calculating Theoretical CIs</a></li>
  <li><a href="#interpretation-of-cis" id="toc-interpretation-of-cis" class="nav-link" data-scroll-target="#interpretation-of-cis">Interpretation of CIs</a></li>
  </ul></li>
  <li><a href="#the-central-limit-theorem" id="toc-the-central-limit-theorem" class="nav-link" data-scroll-target="#the-central-limit-theorem"><span class="header-section-number">14.4</span> The Central Limit Theorem</a></li>
  <li><a href="#cis-for-sample-proportions" id="toc-cis-for-sample-proportions" class="nav-link" data-scroll-target="#cis-for-sample-proportions"><span class="header-section-number">14.5</span> CIs for Sample Proportions</a>
  <ul class="collapse">
  <li><a href="#challenge" id="toc-challenge" class="nav-link" data-scroll-target="#challenge">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#small-sample-cis" id="toc-small-sample-cis" class="nav-link" data-scroll-target="#small-sample-cis"><span class="header-section-number">14.6</span> Small Sample CIs</a></li>
  <li><a href="#calculating-cis-by-bootstrapping" id="toc-calculating-cis-by-bootstrapping" class="nav-link" data-scroll-target="#calculating-cis-by-bootstrapping"><span class="header-section-number">14.7</span> Calculating CIs by Bootstrapping</a>
  <ul class="collapse">
  <li><a href="#writing-our-own-bootstrap" id="toc-writing-our-own-bootstrap" class="nav-link" data-scroll-target="#writing-our-own-bootstrap">Writing our Own Bootstrap</a></li>
  <li><a href="#other-bootstrapping-options" id="toc-other-bootstrapping-options" class="nav-link" data-scroll-target="#other-bootstrapping-options">Other Bootstrapping Options</a></li>
  <li><a href="#challenge-1" id="toc-challenge-1" class="nav-link" data-scroll-target="#challenge-1">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#concept-review" id="toc-concept-review" class="nav-link" data-scroll-target="#concept-review">Concept Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./14-module.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="module-14" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="objectives" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="objectives"><span class="header-section-number">14.1</span> Objectives</h2>
<blockquote class="blockquote">
<p>The objective of this module is to provide an introduction to <em>statistical inference</em> and <em>hypothesis testing</em> by introducing the idea of <strong>confidence intervals</strong> around statistics.</p>
</blockquote>
</section>
<section id="preliminaries" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="preliminaries"><span class="header-section-number">14.2</span> Preliminaries</h2>
<ul>
<li>Install and load this package in <strong><em>R</em></strong>: <a href="https://cran.r-project.org/web/packages/manipulate/boot.pdf">{boot}</a></li>
<li>Load {tidyverse}, {manipulate}, and {mosaic}</li>
</ul>
</section>
<section id="confidence-intervals" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="confidence-intervals"><span class="header-section-number">14.3</span> Confidence Intervals</h2>
<p>The standard error for a statistic that we calculate given its sampling distribution or that we estimate based on a particular sample can be used to derive another measure of uncertainty in the statistic value - the <strong>confidence interval</strong>, or <strong>CI</strong>. The CI is another way of describing a statistic’s sampling distribution, and it plays a central role in basic inferential statistics.</p>
<p>Conceptually, the confidence interval is an interval around our estimate of mean of the sampling distribution for a particular statistic (typically a mean), and it gives us a range of values into which subsequent estimates of a statistic would be expected to fall some critical proportion of the time, if the sampling exercise were to be repeated. We can talk thus about different confidence intervals (e.g., 50%, 95%, 99%), where, intuitively, higher confidence is associated with a wider interval. The “95% CI” around a statistic, for example, describes the range of values into which a new estimate of the statistic, derived from a subsequent sample, would be expected to fall 95% of the time. The “99% CI” around the initial statistic would be slightly wider, while the “50% CI” would be narrower.</p>
<section id="calculating-theoretical-cis" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="calculating-theoretical-cis">Calculating Theoretical CIs</h3>
<p>Theoretical confidence intervals typically represent the range of values corresponding to the central X% of a given sampling distribution with a mean of <span class="math inline">\(m\)</span> and a standard deviation of <span class="math inline">\(se\)</span>. We can calculate theoretical CIs in several ways.</p>
<p>The typical way to calculate a confidence interval is as the <strong>value of the statistic</strong> being considered <span class="math inline">\(±\)</span> some <strong>critical value</strong> <span class="math inline">\(\times\)</span> the <strong>standard error</strong> of the statistic, where the <strong>critical value</strong> is determined with respect to the quantiles bracketing the central proportion of interest for a particular zero-centered, standardized <em>theoretical</em> distribution (e.g., the <em>standard normal</em> or the <em>Student’s</em> <span class="math inline">\(t\)</span>). The lower and upper limits of this CI thus should bracket the central proportion of interest of the sampling distribution of the statistic.</p>
<p>Alternatively, we can calculate the lower and upper limits directly from the appropriate quantile values of the relevant non-standardized version of the particular <em>theoretical</em> distribution (e.g., the normal, with mean <span class="math inline">\(m\)</span> and standard deviation <span class="math inline">\(se\)</span>).</p>
<p>For large sample sizes (<span class="math inline">\(n\)</span> ≥ ~30), the theoretical distribution used to define the critical values and the relevant quantiles is typically the <em>normal distribution</em>, while for smaller sample sizes (<span class="math inline">\(n\)</span> &lt; ~30), a <em>Student’s t distribution</em> is used. This is because, according to the <strong>Central Limit Theorem</strong> (see below), the sampling distribution for many summary statistics (such as the mean) tends to be normal when sample size is reasonably large.</p>
<p>As an example CI calculation, we will generate a vector, <strong>v</strong>, of 10,000 random numbers selected from a normal distribution with a mean of 25 and standard deviation of 10. We then will estimate the mean, standard deviation, and standard error based on a sample of 40 observations drawn from that vector and then use these to calculate the theoretical 95% CI.</p>
<p>First, we generate our vector of random numbers and calculate the relevant summary statistics…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sample</span>(v, <span class="at">size =</span> <span class="dv">40</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(s))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 24.50788</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(s)))  <span class="co"># if population standard deviation is known</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.581139</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(s))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 10.35182</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sd</span>(s)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(s)))  <span class="co"># if population standard deviation is unknown</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.636766</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively, we could use `sciplot::se(s)`</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> sciplot<span class="sc">::</span><span class="fu">se</span>(s))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.636766</code></pre>
</div>
</div>
<p>Now, to calculate the 95% CI around our estimate of the mean, we need to calculate the critical values that delimit the central 95% of the standard normal distribution and then use these to define the upper and lower bounds of the 95% CI around our sample mean. The central 95% of a distribution is that falling between the 2.5% and 97.5% quantiles (i.e., all but 2.5% of the distribution in the lower and upper tails). If we define <span class="math inline">\(\alpha\)</span> as <span class="math inline">\(1-CI/100\)</span>, then what we want to find is the <span class="math inline">\(\alpha/2\)</span> and <span class="math inline">\(1 - (\alpha/2)\)</span> quantiles, i.e., the <span class="math inline">\(0.025\)</span> and <span class="math inline">\(0.975\)</span> quantiles. [As we will see below, mathematically, this is equivalent to ± the <span class="math inline">\(0.975\)</span> quantile.]</p>
<p>We use the “quantile” function for the standard normal function (<code>qnorm()</code> with <code>mean=0</code> and <code>sd=1</code>, which are the default argument values) to generate these critical values.</p>
<p>Recall that when we give the <code>qnorm()</code> function a particular percentile value as an argument, it returns a number, <span class="math inline">\(X\)</span>, below which that proportion of the cumulative probability distribution falls, and when we are considering a standard normal distribution, <span class="math inline">\(X\)</span> is in units of standard deviations. Thus, <code>qnorm(0.025, mean=0, sd=1)</code> tells us the number of standard deviations (roughly -1.96) away from a mean (of 0) that corresponds to up to 2.5% of the cumulative probability distribution for a standard normal curve. Similarly, <code>qnorm(0.975, mean=0, sd=1)</code> tells us the number of standard deviations (roughly +1.96) away from the mean up to which 97.5% of the standard normal distribution falls. 95% of the standard normal distribution falls between these two values. Thus, to calculate the CI for our sampling distribution, we can do the following:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>percent_ci <span class="ot">&lt;-</span> <span class="dv">95</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> percent_ci<span class="sc">/</span><span class="dv">100</span>  <span class="co"># alpha = 0.05</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> se</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># where qnorm(alpha /2) is the 2.5% quantile of the standard normal</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> se</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># where qnorm(1 - alpha / 2) is the 97.5% quantile of the standard normal</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> <span class="fu">c</span>(lower, upper))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 21.29988 27.71589</code></pre>
</div>
</div>
<p>An easier way to do this is simply as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 21.29988 27.71589</code></pre>
</div>
</div>
<p>because these ways of calculating the lower CI bound are equivalent:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(lower <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> <span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 21.29988</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(lower <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 21.29988</code></pre>
</div>
</div>
<p>We could also do this…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the value associated with the alpha / 2 lower tail</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>(lower <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 21.29988</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the value associated with the alpha / 2 upper tail</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>(upper <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 27.71589</code></pre>
</div>
</div>
<p>And we can also make our own generic <code>CI()</code> function based on assuming that our the sampling distribution for our estimate of the mean is normal:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">level =</span> <span class="fl">0.95</span>) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> level</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    ci <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> (alpha<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(ci)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">CI</span>(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 21.29988 27.71589</code></pre>
</div>
</div>
<p>Finally, we could also characterize the central CI% of the sampling distribution directly by calling the <code>qnorm()</code> function on a non-standardized normal distribution. This is less common, though, because it is less easily applied to distributions other than the normal family (e.g., to the <span class="math inline">\(t\)</span> distribution).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(lower <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>, m, se))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 21.29988</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(upper <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, m, se))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 27.71589</code></pre>
</div>
</div>
<p>The following code will let us interactively visualize CIs around an estimate of a mean with a normal sampling distribution.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(<span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(sampling_dist_mean <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sampling_dist_sd,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    sampling_dist_mean <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sampling_dist_sd)), <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> sampling_dist_mean, <span class="at">sd =</span> sampling_dist_sd), <span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Sampling Distribution Mean"</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Exploring Confidence Intervals"</span>, <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Sampling Distribution SD (= SE): "</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    sampling_dist_sd, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">round</span>(percent_CI, <span class="dv">2</span>), <span class="st">"% CI: "</span>, <span class="fu">round</span>(sampling_dist_mean <span class="sc">-</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> percent_CI<span class="sc">/</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sampling_dist_sd, <span class="dv">2</span>), <span class="st">" to "</span>, <span class="fu">round</span>(sampling_dist_mean <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> percent_CI<span class="sc">/</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sampling_dist_sd, <span class="dv">2</span>))) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sampling_dist_mean <span class="sc">-</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> percent_CI<span class="sc">/</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sampling_dist_sd, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sampling_dist_mean <span class="sc">+</span> <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> percent_CI<span class="sc">/</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>        sampling_dist_sd, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sampling_dist_mean,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">xlim =</span> <span class="fu">c</span>(sampling_dist_mean <span class="sc">-</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> percent_CI<span class="sc">/</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sampling_dist_sd, sampling_dist_mean <span class="sc">+</span> <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    percent_CI<span class="sc">/</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sampling_dist_sd), <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> sampling_dist_mean,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> sampling_dist_sd), <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span>),</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sampling_dist_mean =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>, <span class="at">initial =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="dv">10</span>), <span class="at">sampling_dist_sd =</span> <span class="fu">slider</span>(<span class="dv">0</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        <span class="dv">100</span>, <span class="at">initial =</span> <span class="dv">1</span>, <span class="at">step =</span> <span class="dv">1</span>), <span class="at">percent_CI =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">99</span>, <span class="at">initial =</span> <span class="dv">95</span>, <span class="at">step =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpretation-of-cis" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="interpretation-of-cis">Interpretation of CIs</h3>
<p>There are two ways that CIs are generally interpreted:</p>
<ul>
<li>Based on the given data (with a particular mean, variance, and sample size), we are <span class="math inline">\(X\)</span>% confident that the true mean of the population lies between the lower and upper bounds.</li>
<li>The mean of a repeated sample of the same size drawn from this same underlying distribution is expected to fall into the given interval <span class="math inline">\(X\)</span>% of the time.</li>
</ul>
</section>
</section>
<section id="the-central-limit-theorem" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="the-central-limit-theorem"><span class="header-section-number">14.4</span> The Central Limit Theorem</h2>
<p>Our construction of CIs thus far has implicitly taken advantage of one of the most important theorems in statistics, the <strong>Central Limit Theorem (CLT)</strong>. The key importance of the CLT for us is that it states that the sampling distribution of averages (or sums or other summary statistics…) of “independent and identically distributed” (or <span class="math inline">\(iid\)</span>) random variables approaches a normal distribution as the sample size increases. It is this fact that allows us to have a good sense of the mean and distribution of average events in a population even though we only observe one or a small number of samples of those events and even though we do not know what the actual population distribution is! In fact, the CLT says nothing about the probability distribution for events in the original population, and that is exactly where its usefulness lies… that original probability distribution can be normal, skewed, exponential, or even all kinds of odd!</p>
<blockquote class="blockquote">
<p><strong>TL/DR:</strong> The CLT means can we typically assume normality for the sampling distribution, i.e., for the distribution of the <strong>sample mean</strong> (or of the sample sum or the sample mode, etc…) no matter what kind of probability distribution characterizes the initial population, <strong>as long as our sample size is large enough and our samples are independent and identically distributed</strong>. It is thus the CLT that allows us to make inferences about a population based on a sample.</p>
</blockquote>
<p>Just to explore this a bit, let’s do some simulations. We are going to take lots of averages of samples from a particular <em>non-normal</em> distribution and then look at the distribution of those averages.</p>
<p>Imagine we have some event that occurs in a population according to some probability mass function like the Poisson where we know <span class="math inline">\(\lambda=14\)</span>. Recall that the expectations of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> for the Poisson distribution are both equal to <span class="math inline">\(\lambda\)</span>.</p>
<p>Now let’s imagine taking a bunch of random samples of size 10 from this population. We will take 1000 random samples of this size, calculate the average of each sample, and plot a histogram of those averages… it will be close to normal, and the standard deviation of those averages - i.e., the SD of the sampling distribution - should be roughly equal to the estimated standard error, i.e., the square root of (expected variance / sample size). Recall that for a Poisson distribution that <span class="math inline">\(\lambda\)</span> is the expected variance, so the estimated standard error is simply the <span class="math inline">\(\sqrt{\lambda/n}\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(lambda<span class="sc">/</span>n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.183216</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated SE, here, based on an estimate of the population variance if</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># available</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rpois</span>(<span class="dv">10000</span>, <span class="at">lambda =</span> lambda), <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">main =</span> <span class="st">"Original Distribution"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="dv">1000</span>)  <span class="co"># dummy variable to hold sample means</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    x[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rpois</span>(<span class="at">n =</span> n, <span class="at">lambda =</span> lambda))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(x), <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">20</span>), <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"Mean x"</span>, <span class="at">main =</span> <span class="st">"Sampling Distribution"</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sd</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.160762</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated SE, here based on the standard deviation of the actual sampling</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(x)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s now do the same for samples of size 1000. We see that the mean of the sampling distribution stays essentially the same, the distribution is still normal, but the standard deviation - the spread - of the sampling distribution is lower.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(lambda<span class="sc">/</span>n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.1183216</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated SE, here, based on an estimate of the population variance if</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># available</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rpois</span>(<span class="dv">10000</span>, <span class="at">lambda =</span> lambda), <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">main =</span> <span class="st">"Original Distribution"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    x[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rpois</span>(<span class="at">n =</span> n, <span class="at">lambda =</span> lambda))</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(x), <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">20</span>), <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"Mean X"</span>, <span class="at">main =</span> <span class="st">"Sampling Distribution"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sd</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.1179025</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated SE, here based on the standard deviation of the actual sampling</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(x)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note that the sampling distribution gets narrower as the sample size increases.</p>
<p>We can convert the sampling distribution to a standard normal by subtracting off the mean of the distribution and dividing by the standard deviation and then plotting a histogram of those values along with a normal curve.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">floor</span>(<span class="fu">min</span>(x)), <span class="at">to =</span> <span class="fu">ceiling</span>(<span class="fu">max</span>(x)), <span class="at">length.out =</span> <span class="dv">20</span>),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x)  <span class="co"># converts the vector of means to z scores</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(z), <span class="at">to =</span> <span class="fu">max</span>(z), <span class="at">length.out =</span> <span class="dv">20</span>), <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))  <span class="co"># plots the histogram of z scores</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), <span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">xlab =</span> <span class="st">"Z"</span>, <span class="at">ylab =</span> <span class="st">"Density"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)  <span class="co"># plots a standard normal curve</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pretty normal looking, right?</p>
<p>Here’s an example of the CLT in action using the <code>sum()</code> of our random variables instead of the <code>mean()</code> as the statistic of interest …</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rpois</span>(<span class="dv">10000</span>, <span class="at">lambda =</span> lambda), <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">main =</span> <span class="st">"Original Distribution"</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    x[[i]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">rpois</span>(<span class="at">n =</span> n, <span class="at">lambda =</span> lambda))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(x), <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">20</span>), <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"Sum X"</span>, <span class="at">main =</span> <span class="st">"Sampling Distribution"</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the sampling distribution to standard normal</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">20</span>), <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plots a standard normal curve</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), <span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">xlab =</span> <span class="st">"Z"</span>, <span class="at">ylab =</span> <span class="st">"Density"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again, pretty normal looking!</p>
<p>Trying this for an intial beta rather than Poisson distribution…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">1.1</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">2.9</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rbeta</span>(<span class="dv">10000</span>, <span class="at">shape1 =</span> alpha, <span class="at">shape2 =</span> beta), <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">xlab =</span> <span class="st">"X"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Original Distribution"</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    x[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rbeta</span>(<span class="at">n =</span> n, <span class="at">shape1 =</span> alpha, <span class="at">shape2 =</span> beta))</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">20</span>), <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">xlab =</span> <span class="st">"Mean X"</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Sampling Distribution"</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the sampling distribution to standard normal</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">20</span>), <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plots a standard normal curve</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), <span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">xlab =</span> <span class="st">"Z"</span>, <span class="at">ylab =</span> <span class="st">"Density"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Once again, the sampling distribution is normal, even though the original distribution is far from it!</p>
<p><strong>Take Home Points:</strong></p>
<p>[1] The CLT states that, regardless of the underlying probability distribution of a population of <strong>independent, identically distributed</strong> (<span class="math inline">\(iid\)</span>) random variables, the distribution of a statistic (e.g., means, or sums or standard deviations, etc…) for samples drawn from that underlying distribution:</p>
<ul>
<li>will be approximately normal,</li>
<li>will be centered at the population mean for the statistic, and - will have a standard deviation roughly equal to the standard error of the mean for the statistic.</li>
</ul>
<p>Additionally, it suggests that variables that are expected to be the sum of multiple independent processes (e.g., measurement errors) will also have distributions that are nearly normal.</p>
<p>[2] Calculating a <em>statistic</em> based on this distribution (e.g., the mean) and adding/subtracting the relevant <em>standard quantile</em> <span class="math inline">\(\times\)</span> the <em>standard error</em> yields a confidence interval for the relevant statistic, which gets wider as the coverage increases and gets narrower with less variability or larger sample sizes.</p>
<p>[3] As sample size increases, the standard error of the statistic decreases and the sampling distribution becomes more and more normal (i.e., has less skew and kurtosis, which are higher order moments of the distribution).</p>
<p>For a nice interactive simulation demonstrating the Central Limit Theorem, check out <a href="http://onlinestatbook.com/stat_sim/sampling_dist/index.html">this cool website</a>.</p>
</section>
<section id="cis-for-sample-proportions" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="cis-for-sample-proportions"><span class="header-section-number">14.5</span> CIs for Sample Proportions</h2>
<p>So far, we’ve talked about CIs for sample means of a continuous random variable, but what about for other statistics, e.g., sample proportions for discrete binary variables. For example, if you have a sample of <strong>n</strong> trials where you record the success or failure of a binary event, you can obtain an estimate of the proportion of successes, <span class="math inline">\(x/n\)</span>. If you perform another <strong>n</strong> trials, the new estimate will vary from sample to sample in the same way that averages of a continuous random variable (e.g., zombie age) will vary.</p>
<p>Taking a similar approach as we did above for normally distributed continuous random variables, we can generate confidence intervals for the proportion of successes across trials, i.e., for a discrete binary variable, by taking the expectation and adding/subtracting a critical value <span class="math inline">\(\times\)</span> a standard error.</p>
<p>Recall from our discussion of discrete random binary variables that the expectation for proportion of successes, which we will denote as <span class="math inline">\(\pi\)</span> (where <span class="math inline">\(\pi\)</span>, for “proportion”, is analogous to <span class="math inline">\(\mu\)</span>, for “mean”) is simply the average number of successes across multiple trials, and the expectation for the variance in this proportion is <span class="math inline">\(\pi \times (1-\pi)\)</span>.</p>
<p>As for the mean of a continuous random variable, the expected sampling distribution for the proportion of successes across many trials of sample size <span class="math inline">\(n\)</span> is approximately normal and centered at <span class="math inline">\(\pi\)</span>, and its standard deviation is estimated by <span class="math inline">\(\sqrt{\pi(1-\pi)/n}\)</span>, which is, essentially, the standard error of the mean: it is the square root of (the expected variance / sample size). As above for <span class="math inline">\(\mu\)</span>, if we do not already have a population estimate for <span class="math inline">\(\pi\)</span>, we can estimate this from a sample as <span class="math inline">\(\hat{p}=x/n\)</span></p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> The approximation of normality for the sampling distribution of proportion of successes holds true only if both <span class="math inline">\(n\times\pi\)</span> and <span class="math inline">\(n\times(1-\pi)\)</span> are greater than roughly 5, so we should always check this when working with proportion data!</p>
</blockquote>
<section id="challenge" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge">CHALLENGE</h3>
<p>Suppose a polling group in the United States is interested in the proportion of voting-age citizens in their state that already know they will vote for Bernie Sanders in the upcoming presidential election. The group obtains a “yes”” or “no” answer from 1000 randomly selected individuals. Of these individuals, 856 say they know they’ll vote for Sanders How would we characterize the mean and variability associated with this proportion?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">856</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> x<span class="sc">/</span>n  <span class="co"># our estimate of pi</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>p_hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.856</code></pre>
</div>
</div>
<p>Are <span class="math inline">\(n\times\pi\)</span> and <span class="math inline">\(n\times(1-\pi)\)</span> both &gt; 5? Yes!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>n <span class="sc">*</span> p_hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 856</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>n <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 144</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((p_hat) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat)<span class="sc">/</span>n)  <span class="co"># estimated SE for proportion data</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>se</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.01110243</code></pre>
</div>
</div>
<p>So, what is the 95% CI around our estimate of the proportion of people who already know how they will vote?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> p_hat, <span class="at">sd =</span> se), p_hat <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> se, p_hat <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> se, <span class="at">xlab =</span> <span class="st">""</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Density"</span>, <span class="at">main =</span> <span class="st">"95% Confidence Interval around</span><span class="sc">\n</span><span class="st">Expected Proportion of Decided Voters "</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> p_hat <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> p_hat <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> <span class="fu">c</span>(lower, upper))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.8342396 0.8777604</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> p_hat <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.8342396 0.8777604</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(ci[<span class="dv">1</span>], <span class="fu">seq</span>(<span class="at">from =</span> ci[<span class="dv">1</span>], <span class="at">to =</span> ci[<span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">1000</span>), ci[<span class="dv">2</span>]),</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> ci[<span class="dv">1</span>], <span class="at">to =</span> ci[<span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">1000</span>), <span class="at">mean =</span> p_hat, <span class="at">sd =</span> se),</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> p_hat)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="small-sample-cis" class="level2" data-number="14.6">
<h2 data-number="14.6" class="anchored" data-anchor-id="small-sample-cis"><span class="header-section-number">14.6</span> Small Sample CIs</h2>
<p>Thus far, we have discussed creating confidence intervals for sample statistics based on the CLT and the <strong>normal</strong> distribution, and our intervals took the form:</p>
<p><em>mean</em> <span class="math inline">\(±\)</span> <span class="math inline">\(Z\)</span> (the critical value, based on a quantile from the standard normal curve) <span class="math inline">\(\times\)</span> <em>standard error</em></p>
<p>But, when the size of our sample is small (<span class="math inline">\(n\)</span> &lt; 30), instead of using the normal distribution to calculate our CIs, statisticians typically use a different distribution to generate the relevant quantiles to multiply the standard error by… the <strong>t distribution</strong> (a.k.a., <strong>Gosset’s</strong> <span class="math inline">\(t\)</span> or <strong>Student’s</strong> <span class="math inline">\(t\)</span> distribution).</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> This is a <strong>typical</strong> case that we will encounter, as we often do not have information about the population that a sample is drawn from!</p>
</blockquote>
<p>The <span class="math inline">\(t\)</span> distribution is a continuous probability distribution very similar in shape to the normal, and is generally used when dealing with <em>statistics</em> (such as means and standard deviations) that are estimated from a sample rather than being known <em>parameters</em> about a population. Any particular <span class="math inline">\(t\)</span> distribution looks a lot like a normal distribution in that it is bell-shaped, symmetric, unimodal, and (if standardized) zero-centered.</p>
<p>The choice of the appropriate <span class="math inline">\(t\)</span> distribution to use in any particular statistical test is based on the number of <strong>degrees of freedom (df)</strong>, i.e., the number of individual components in the calculation of a given statistic (such as the mean or standard deviation) that are “free to change”.</p>
<p>We can thus think of the <span class="math inline">\(t\)</span> distribution as representing a <em>family of curves</em> that, as the number of degrees of freedom increases, approaches the normal curve. At low numbers of degrees of freedom, the tails of the distribution get fatter and the peak of the distribution gets lower.</p>
<p>Confidence intervals based on the <span class="math inline">\(t\)</span> distribution are of the form:</p>
<p><em>mean</em> <span class="math inline">\(±\)</span> <span class="math inline">\(T\)</span> (the critical value, based on a quantile from the <span class="math inline">\(t\)</span> distribution) <span class="math inline">\(\times\)</span> <em>standard error</em></p>
<p>The only change from CIs based on the normal distribution is that we have replaced the <span class="math inline">\(Z\)</span> quantile of the standard normal with a <span class="math inline">\(T\)</span> quantile.</p>
<p>Let’s explore this a bit…</p>
<p>Recall that a standard normal distribution is generated by normalizing a set of data (subtracting the mean from each observation and then dividing all of these differences by the standard deviation of the distribution)…</p>
<p><span class="math display">\[(\bar{x}-\mu)/\sigma\]</span></p>
<p>For a sample, if we subtract the population mean from each observation and then divide each difference, instead, by the standard error of the mean, i.e., <span class="math inline">\((\bar{x}-\mu)/SE\)</span>, the result is not a normal distribution, but rather a <span class="math inline">\(t\)</span> distribution! We are taking into account sample size by dividing by the standard error of the mean rather than by the population standard deviation.</p>
<p>The code below plots a standard normal distribution in red and then superimposes several <span class="math inline">\(t\)</span> distributions with varying degrees of freedom, specified using the <code>df=</code> argument.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, mu, <span class="dv">1</span>), mu <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma, mu <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma, <span class="at">main =</span> <span class="st">"Normal Distribution (red) and</span><span class="sc">\n</span><span class="st">Student's t Distributions (blue)"</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"f(x)"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">100</span>)) {</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df =</span> i), mu <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma, mu <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma, <span class="at">main =</span> <span class="st">"T Curve"</span>, <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"f(x)"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">5</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As for other distributions, <strong><em>R</em></strong> implements <code>d</code> (density), <code>p</code> (cumulative probability), <code>q</code> (quantile), and <code>r</code> (random draw) functions for the t distribution.</p>
<p>The fatter tails of the <span class="math inline">\(t\)</span> distibution at small sample sizes lead naturally to more extreme quantile values given a specific probability than we would see for the normal distribution. If we define a CI based on quantiles of the <span class="math inline">\(t\)</span> distribution, then, they will be correspondingly slightly <strong>wider</strong> than those based on the normal distribution for small values of <span class="math inline">\(df\)</span>.</p>
<p>We can see this in an example, where we draw samples from a population of values defined by a normal distribution with a particular mean and standard deviation. Recall that above we estimated the 95% CI for such a sample drawn from a normal distribution as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e+05</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)  <span class="co"># x is our large population</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> sample_size, <span class="at">replace =</span> <span class="cn">FALSE</span>)  <span class="co"># s is a sample from that population</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(s))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 2.921573</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(s))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 4.198638</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sd</span>(s)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(s)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.7665629</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>ci_normal <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> se</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (1-alpha)/2 each in the upper and lower tails of the distribution</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>ci_normal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.419138 4.424009</code></pre>
</div>
</div>
<p>Now, let’s look at the CIs calculated based using the <span class="math inline">\(t\)</span> distribution for the same sample size. For sample size 30, the difference in the CIs is negligible.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>ci_t <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> sample_size <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (1-alpha)/2 each in the upper and lower tails of the distribution</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>ci_t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.353776 4.489371</code></pre>
</div>
</div>
<p>However, if we use a sample size of 5, the equivalent CI based on the <span class="math inline">\(t\)</span> distribution is much wider.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>small_s <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> sample_size, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(small_s))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.307108</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>(sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(small_s))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 2.599329</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sd</span>(small_s)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(small_s)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.162455</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>ci_normal <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> se</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (1-alpha)/2 each in the upper and lower tails of the distribution</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>ci_normal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 3.028738 7.585479</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>ci_t <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> sample_size <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (1-alpha)/2 each in the upper and lower tails of the distribution</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>ci_t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 2.079615 8.534602</code></pre>
</div>
</div>
</section>
<section id="calculating-cis-by-bootstrapping" class="level2" data-number="14.7">
<h2 data-number="14.7" class="anchored" data-anchor-id="calculating-cis-by-bootstrapping"><span class="header-section-number">14.7</span> Calculating CIs by Bootstrapping</h2>
<p>An alternative (and arguably <strong>better</strong>) way to calculate a confidence interval for a given statistic is by “bootstrapping” from the data in a single sample using a Monte Carlo simulation process. Bootstrapping allows us to approximate a sampling distribution even without access to the population from which samples are drawn and without making any assumptions about the theoretical shape of the sampling distribution. The distribution we generate is sometimes referred to as a <em>bootstrap distribution</em>.</p>
<section id="writing-our-own-bootstrap" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="writing-our-own-bootstrap">Writing our Own Bootstrap</h3>
<p>Below, we use the <code>sample()</code> function to sample, <strong>with replacement</strong>, bootstrap replicates of equivalent sample size from our original vector of sample data, <strong>s</strong>, a total of 10000 times. This is just one approach to how we might perform bootstrapping, using {base} <strong><em>R</em></strong> functions.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> If we wanted to sample rows from a data frame instead of items from a vector, we could use the {dplyr} functions <code>sample_n()</code> or <code>slice_sample()</code>.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>n_boot <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> n_boot)  <span class="co"># set up a dummy variable to hold our simulations</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(s)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the size of each bootstrap sample should equivalent to the size our original</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sample</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_boot) {</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    boot[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(s, n, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following code visualizes the bootstrap sampling distribution we have just generated and also compares the various methods we have explored for calculating CIs.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot, <span class="at">breaks =</span> <span class="dv">25</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1600</span>), <span class="at">xlab =</span> <span class="st">"Mean"</span>, <span class="at">main =</span> <span class="st">"Bootstrap Sampling Distribution"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(boot), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">3</span>)  <span class="co"># mean of our simulated samples</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">mean</span>(boot) <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"mean of bootstrap distribution "</span>, <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(s), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># mean of our original vector of samples, s</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">mean</span>(s) <span class="sc">-</span> <span class="fl">0.125</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"mean of original sample"</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">srt =</span> <span class="dv">90</span>,</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">quantile</span>(boot, <span class="fl">0.025</span>), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="co"># lower ci bound inferred by bootstrapping</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">quantile</span>(boot, <span class="fl">0.975</span>), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="co"># upper ci bound inferred by bootstrapping</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">quantile</span>(boot, <span class="fl">0.025</span>) <span class="sc">+</span> <span class="fl">0.25</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"lower CI - bootstrap"</span>, <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">quantile</span>(boot, <span class="fl">0.975</span>) <span class="sc">-</span> <span class="fl">0.125</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"upper CI - bootstrap"</span>, <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>ci_normal <span class="ot">&lt;-</span> <span class="fu">mean</span>(s) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sciplot<span class="sc">::</span><span class="fu">se</span>(s)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>ci_t <span class="ot">&lt;-</span> <span class="fu">mean</span>(s) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="fu">length</span>(s) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sciplot<span class="sc">::</span><span class="fu">se</span>(s)</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci_normal[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a><span class="co"># calculated lower ci bound based on the se of our vector and assuming that our</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="co"># observations are drawn from a normal distribution</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci_normal[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="co"># calculated upper ci bound based on the se of our vector and assuming that our</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a><span class="co"># observations are drawn from a normal distribution</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> ci_normal[<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.12</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"lower CI - normal"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">srt =</span> <span class="dv">90</span>,</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> ci_normal[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.245</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"upper CI - normal"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">srt =</span> <span class="dv">90</span>,</span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci_t[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a><span class="co"># calculated lower ci bound based on the se of our vector and assuming that our</span></span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a><span class="co"># observations are drawn from a t distribution</span></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci_t[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a><span class="co"># calculated upper ci bound based on the se of our vector and assuming that our</span></span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a><span class="co"># observations are drawn from a t distribution</span></span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> ci_t[<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.15</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"lower CI - t"</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> ci_t[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.275</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"upper CI - t"</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, we used the <code>quantile()</code> function to return the observations satisfying the <span class="math inline">\(n^{th}\)</span> quantile of our particular distribution of bootstrapped sample means. We use this function to define the lower and upper bounds for the bootstrap confidence interval around the mean of our variable, <strong>x</strong>.</p>
<p>Note that this compares very favorably to the CIs estimated by assuming that the sampling distribution follows either a normal or <span class="math inline">\(t\)</span> distribution</p>
</section>
<section id="other-bootstrapping-options" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="other-bootstrapping-options">Other Bootstrapping Options</h3>
<p>As is typically the case with <strong><em>R</em></strong>, we have many choices for perform we might perform boostrapping! All of the options below are alternatives to the process we used above and generate similar bootstrap sampling distributions and corresponding CIs.</p>
<section id="using-the-mosaic-package" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="using-the-mosaic-package">Using the {mosaic} Package</h4>
<p>We are already familiar with the <code>do(reps) *</code> formulation from the {mosaic} package…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="fu">do</span>(n_boot) <span class="sc">*</span> <span class="fu">mean</span>(<span class="sc">~</span><span class="fu">sample</span>(s, <span class="fu">length</span>(s), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot<span class="sc">$</span>mean, <span class="at">breaks =</span> <span class="dv">25</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1600</span>), <span class="at">xlab =</span> <span class="st">"Mean"</span>, <span class="at">main =</span> <span class="st">"Bootstrap Sampling Distribution</span><span class="sc">\n</span><span class="st">from do(reps) *"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="using-the-infer-package" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="using-the-infer-package">Using the {infer} Package</h4>
<p>Alternatively, can use the <code>rep_sample_n()</code> function from the {infer} package to perform boostrapping. This function takes a data frame as an argument and randomly samples from that data frame a specified number of times (defined by the “size=” argument) to produce a large data object consisting of samples for each replicate and a column data that indicates which replicate each sample datum comes from. To use <code>rep_sample_n()</code>, we need to first convert our original sample vector <strong>s</strong> into a data frame. We can then use <code>group_by()</code> and <code>summarize()</code> from {dplyr} to generate a bootstrap sampling distribution, as we did above.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(s) <span class="sc">|&gt;</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep_sample_n</span>(<span class="at">size =</span> <span class="fu">length</span>(s), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">reps =</span> n_boot) <span class="sc">|&gt;</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(replicate) <span class="sc">|&gt;</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(s))</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot<span class="sc">$</span>mean, <span class="at">breaks =</span> <span class="dv">25</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>), <span class="at">xlab =</span> <span class="st">"Mean"</span>, <span class="at">main =</span> <span class="st">"Bootstrap Sampling Distribution</span><span class="sc">\n</span><span class="st">from rep_sample_n()"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="using-the-boot-package" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="using-the-boot-package">Using the {boot} Package</h4>
<p>We can also use the fast and versatile {boot} package to do bootstrapping for any statistic.</p>
<p>For this approach, we define a custom function that we will use to generate the statistic we are interested in that we will then calculate for each bootstrapped sample:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># here, the `stat()` function we define calculates the mean value of a</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap sample taken with replacement from a vector of interest passed into</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># `data` the function we write for `statistic=` has two arguments, a data set</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># and a set of indices, generated at random by the `boot()` function, to sample</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co"># from the dataset this corresponds to the default argument `stype='i'` in the</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co"># `boot()` call</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(data[indices]))</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we run the <code>boot()</code> function passing in the data to be resampled from (“data=”), the statistic we want to calculate (“statistic=”), and the number of bootstrap replicates (or “resamples”) we want using the argument “R=”.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> s, <span class="at">statistic =</span> stat, <span class="at">R =</span> n_boot)  <span class="co"># stype='i' by default</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the object returned includes a table, `t`, of `stat`s results from each</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Again, it is interesting to plot the bootstrap sampling distibution and compare methods for calculating CIs.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the results and comparing methods for calculating CIs</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot<span class="sc">$</span>t, <span class="at">breaks =</span> <span class="dv">25</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>), <span class="at">xlab =</span> <span class="st">"Mean"</span>, <span class="at">main =</span> <span class="st">"Bootstrap Sampling Distribution</span><span class="sc">\n</span><span class="st">from boot()"</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(boot<span class="sc">$</span>t), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">3</span>)  <span class="co"># mean of our simulated samples</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">mean</span>(boot<span class="sc">$</span>t) <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"mean of bootstrap distribution "</span>, <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(s), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mean of our original vector of samples, s</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">mean</span>(s) <span class="sc">-</span> <span class="fl">0.125</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"mean of original sample"</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">srt =</span> <span class="dv">90</span>,</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate and plot bootstrap CIs</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>lower_boot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot<span class="sc">$</span>t, <span class="fl">0.025</span>)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> lower_boot, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>upper_boot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot<span class="sc">$</span>t, <span class="fl">0.975</span>)</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> upper_boot, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> lower_boot <span class="sc">+</span> <span class="fl">0.25</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"lower CI - bootstrap"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">srt =</span> <span class="dv">90</span>,</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> upper_boot <span class="sc">-</span> <span class="fl">0.125</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"upper CI - bootstrap"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">srt =</span> <span class="dv">90</span>,</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also use the <code>boot.ci()</code> function from the {boot} package to calculate CIs for using various methods, although the available methods do not include exactly the one we most want, i.e., the quantile method. Instead, all the options for <code>boot.ci()</code> generate equi-tailed CIs based on presumed theoretical shapes for the sampling distribution. The “basic” and “percent” intervals are the closest to the empirical quantile method.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot<span class="sc">$</span>t, <span class="at">breaks =</span> <span class="dv">25</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>), <span class="at">xlab =</span> <span class="st">"Mean"</span>, <span class="at">main =</span> <span class="st">"Bootstrap Sampling Distribution</span><span class="sc">\n</span><span class="st">from boot()"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>basic[<span class="dv">4</span>], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>basic[<span class="dv">5</span>], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>percent[<span class="dv">4</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>percent[<span class="dv">5</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>bca[<span class="dv">4</span>], <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>bca[<span class="dv">5</span>], <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>normal[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>normal[<span class="dv">3</span>], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14-module_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These alternative CIs are all very close to one another and are close to what we calculated using the <code>quantile()</code> approach!</p>
</section>
</section>
<section id="challenge-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-1">CHALLENGE</h3>
<ul>
<li>How does the CI calculated by bootstrap simulation compare to that calculated based on assuming a normal or <span class="math inline">\(t\)</span> distribution?</li>
<li>How does the width of the CI change with decreasing or increasing <span class="math inline">\(n\)</span> (the number of observations drawn from your sample with replacement)? For example, if we set <span class="math inline">\(n\)</span> at 5? At 50? At 500?</li>
</ul>
<hr>
</section>
</section>
<section id="concept-review" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="concept-review">Concept Review</h2>
<ul>
<li><p>We can generate confidence intervals around a statistic (e.g., a mean) estimated from a sample as:</p>
<ul>
<li><em>mean</em> <span class="math inline">\(±\)</span> <em>critical value</em> (i.e., the relevant quantile for the standardized version of a particular theoretical sampling distribution such as the normal or Student’s <span class="math inline">\(t\)</span>) <span class="math inline">\(\times\)</span> <em>standard error</em> in the statistic, which is typically estimated as the standard deviation of a sample divided by the square root of the sample size, or <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span></li>
</ul></li>
<li><p>Bootstrapping allows us to estimate confidence intervals by simulation from a sample, without assuming a particular shape for the sampling distribution</p></li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./13-module.html" class="pagination-link" aria-label="Probability and Distributions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./15-module.html" class="pagination-link" aria-label="Classical Hypothesis Testing">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb86" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Confidence Intervals {#module-14}</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objectives</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The objective of this module is to provide an introduction to *statistical inference* and *hypothesis testing* by introducing the idea of **confidence intervals** around statistics.</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminaries</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Install and load this package in ***R***: <span class="co">[</span><span class="ot">{boot}</span><span class="co">](https://cran.r-project.org/web/packages/manipulate/boot.pdf)</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load {tidyverse}, {manipulate}, and {mosaic}</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manipulate)</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confidence Intervals</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>The standard error for a statistic that we calculate given its sampling distribution or that we estimate based on a particular sample can be used to derive another measure of uncertainty in the statistic value - the **confidence interval**, or **CI**. The CI is another way of describing a statistic's sampling distribution, and it plays a central role in basic inferential statistics.</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>Conceptually, the confidence interval is an interval around our estimate of mean of the sampling distribution for a particular statistic (typically a mean), and it gives us a range of values into which subsequent estimates of a statistic would be expected to fall some critical proportion of the time, if the sampling exercise were to be repeated. We can talk thus about different confidence intervals (e.g., 50%, 95%, 99%), where, intuitively, higher confidence is associated with a wider interval. The "95% CI" around a statistic, for example, describes the range of values into which a new estimate of the statistic, derived from a subsequent sample, would be expected to fall 95% of the time. The "99% CI" around the initial statistic would be slightly wider, while the "50% CI" would be narrower.</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculating Theoretical CIs {.unnumbered}</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>Theoretical confidence intervals typically represent the range of values corresponding to the central X% of a given sampling distribution with a mean of $m$ and a standard deviation of $se$. We can calculate theoretical CIs in several ways.</span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>The typical way to calculate a confidence interval is as the **value of the statistic** being considered $±$ some **critical value** $\times$ the **standard error** of the statistic, where the **critical value** is determined with respect to the quantiles bracketing the central proportion of interest for a particular zero-centered, standardized *theoretical* distribution (e.g., the *standard normal* or the *Student's* $t$). The lower and upper limits of this CI thus should bracket the central proportion of interest of the sampling distribution of the statistic.</span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>Alternatively, we can calculate the lower and upper limits directly from the appropriate quantile values of the relevant non-standardized version of the particular *theoretical* distribution (e.g., the normal, with mean $m$ and standard deviation $se$).</span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>For large sample sizes ($n$ ≥ \~30), the theoretical distribution used to define the critical values and the relevant quantiles is typically the *normal distribution*, while for smaller sample sizes ($n$ \&lt; \~30), a *Student's t distribution* is used. This is because, according to the **Central Limit Theorem** (see below), the sampling distribution for many summary statistics (such as the mean) tends to be normal when sample size is reasonably large.</span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>As an example CI calculation, we will generate a vector, **v**, of 10,000 random numbers selected from a normal distribution with a mean of 25 and standard deviation of 10. We then will estimate the mean, standard deviation, and standard error based on a sample of 40 observations drawn from that vector and then use these to calculate the theoretical 95% CI.</span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>First, we generate our vector of random numbers and calculate the relevant summary statistics...</span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb86-50"><a href="#cb86-50" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb86-51"><a href="#cb86-51" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sample</span>(v, <span class="at">size =</span> <span class="dv">40</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb86-52"><a href="#cb86-52" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(s))</span>
<span id="cb86-53"><a href="#cb86-53" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(s))) <span class="co"># if population standard deviation is known</span></span>
<span id="cb86-54"><a href="#cb86-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-55"><a href="#cb86-55" aria-hidden="true" tabindex="-1"></a>(sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(s))</span>
<span id="cb86-56"><a href="#cb86-56" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sd</span>(s)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(s))) <span class="co"># if population standard deviation is unknown</span></span>
<span id="cb86-57"><a href="#cb86-57" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively, we could use `sciplot::se(s)`</span></span>
<span id="cb86-58"><a href="#cb86-58" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> sciplot<span class="sc">::</span><span class="fu">se</span>(s))</span>
<span id="cb86-59"><a href="#cb86-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-60"><a href="#cb86-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-61"><a href="#cb86-61" aria-hidden="true" tabindex="-1"></a>Now, to calculate the 95% CI around our estimate of the mean, we need to calculate the critical values that delimit the central 95% of the standard normal distribution and then use these to define the upper and lower bounds of the 95% CI around our sample mean. The central 95% of a distribution is that falling between the 2.5% and 97.5% quantiles (i.e., all but 2.5% of the distribution in the lower and upper tails). If we define $\alpha$ as $1-CI/100$, then what we want to find is the $\alpha/2$ and $1 - (\alpha/2)$ quantiles, i.e., the $0.025$ and $0.975$ quantiles. <span class="co">[</span><span class="ot">As we will see below, mathematically, this is equivalent to ± the $0.975$ quantile.</span><span class="co">]</span></span>
<span id="cb86-62"><a href="#cb86-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-63"><a href="#cb86-63" aria-hidden="true" tabindex="-1"></a>We use the "quantile" function for the standard normal function (<span class="in">`qnorm()`</span> with <span class="in">`mean=0`</span> and <span class="in">`sd=1`</span>, which are the default argument values) to generate these critical values.</span>
<span id="cb86-64"><a href="#cb86-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-65"><a href="#cb86-65" aria-hidden="true" tabindex="-1"></a>Recall that when we give the <span class="in">`qnorm()`</span> function a particular percentile value as an argument, it returns a number, $X$, below which that proportion of the cumulative probability distribution falls, and when we are considering a standard normal distribution, $X$ is in units of standard deviations. Thus, <span class="in">`qnorm(0.025, mean=0, sd=1)`</span> tells us the number of standard deviations (roughly -1.96) away from a mean (of 0) that corresponds to up to 2.5% of the cumulative probability distribution for a standard normal curve. Similarly, <span class="in">`qnorm(0.975, mean=0, sd=1)`</span> tells us the number of standard deviations (roughly +1.96) away from the mean up to which 97.5% of the standard normal distribution falls. 95% of the standard normal distribution falls between these two values. Thus, to calculate the CI for our sampling distribution, we can do the following:</span>
<span id="cb86-66"><a href="#cb86-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-69"><a href="#cb86-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-70"><a href="#cb86-70" aria-hidden="true" tabindex="-1"></a>percent_ci <span class="ot">&lt;-</span> <span class="dv">95</span></span>
<span id="cb86-71"><a href="#cb86-71" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> percent_ci<span class="sc">/</span><span class="dv">100</span> <span class="co"># alpha = 0.05</span></span>
<span id="cb86-72"><a href="#cb86-72" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">qnorm</span>(alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> se</span>
<span id="cb86-73"><a href="#cb86-73" aria-hidden="true" tabindex="-1"></a><span class="co"># where qnorm(alpha /2) is the 2.5% quantile of the standard normal distribution</span></span>
<span id="cb86-74"><a href="#cb86-74" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> se</span>
<span id="cb86-75"><a href="#cb86-75" aria-hidden="true" tabindex="-1"></a><span class="co"># where qnorm(1 - alpha / 2) is the 97.5% quantile of the standard normal distribution</span></span>
<span id="cb86-76"><a href="#cb86-76" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> <span class="fu">c</span>(lower, upper))</span>
<span id="cb86-77"><a href="#cb86-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-78"><a href="#cb86-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-79"><a href="#cb86-79" aria-hidden="true" tabindex="-1"></a>An easier way to do this is simply as follows:</span>
<span id="cb86-80"><a href="#cb86-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-83"><a href="#cb86-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-84"><a href="#cb86-84" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> se)</span>
<span id="cb86-85"><a href="#cb86-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-86"><a href="#cb86-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-87"><a href="#cb86-87" aria-hidden="true" tabindex="-1"></a>because these ways of calculating the lower CI bound are equivalent:</span>
<span id="cb86-88"><a href="#cb86-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-91"><a href="#cb86-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-92"><a href="#cb86-92" aria-hidden="true" tabindex="-1"></a>(lower <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> <span class="fu">qnorm</span>(alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> se)</span>
<span id="cb86-93"><a href="#cb86-93" aria-hidden="true" tabindex="-1"></a>(lower <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> se)</span>
<span id="cb86-94"><a href="#cb86-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-95"><a href="#cb86-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-96"><a href="#cb86-96" aria-hidden="true" tabindex="-1"></a>We could also do this...</span>
<span id="cb86-97"><a href="#cb86-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-100"><a href="#cb86-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-101"><a href="#cb86-101" aria-hidden="true" tabindex="-1"></a><span class="co"># get the value associated with the alpha / 2 lower tail</span></span>
<span id="cb86-102"><a href="#cb86-102" aria-hidden="true" tabindex="-1"></a>(lower <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">qnorm</span>(alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> se)</span>
<span id="cb86-103"><a href="#cb86-103" aria-hidden="true" tabindex="-1"></a><span class="co"># get the value associated with the alpha / 2 upper tail</span></span>
<span id="cb86-104"><a href="#cb86-104" aria-hidden="true" tabindex="-1"></a>(upper <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">qnorm</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> se)</span>
<span id="cb86-105"><a href="#cb86-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-106"><a href="#cb86-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-107"><a href="#cb86-107" aria-hidden="true" tabindex="-1"></a>And we can also make our own generic <span class="in">`CI()`</span> function based on assuming that our the sampling distribution for our estimate of the mean is normal:</span>
<span id="cb86-108"><a href="#cb86-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-111"><a href="#cb86-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-112"><a href="#cb86-112" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">level =</span> <span class="fl">0.95</span>) {</span>
<span id="cb86-113"><a href="#cb86-113" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> level</span>
<span id="cb86-114"><a href="#cb86-114" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> (alpha <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">length</span>(x))</span>
<span id="cb86-115"><a href="#cb86-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ci)</span>
<span id="cb86-116"><a href="#cb86-116" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-117"><a href="#cb86-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-118"><a href="#cb86-118" aria-hidden="true" tabindex="-1"></a><span class="fu">CI</span>(s)</span>
<span id="cb86-119"><a href="#cb86-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-120"><a href="#cb86-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-121"><a href="#cb86-121" aria-hidden="true" tabindex="-1"></a>Finally, we could also characterize the central CI% of the sampling distribution directly by calling the <span class="in">`qnorm()`</span> function on a non-standardized normal distribution. This is less common, though, because it is less easily applied to distributions other than the normal family (e.g., to the $t$ distribution).</span>
<span id="cb86-122"><a href="#cb86-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-125"><a href="#cb86-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-126"><a href="#cb86-126" aria-hidden="true" tabindex="-1"></a>(lower <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, m, se))</span>
<span id="cb86-127"><a href="#cb86-127" aria-hidden="true" tabindex="-1"></a>(upper <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, m, se))</span>
<span id="cb86-128"><a href="#cb86-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-129"><a href="#cb86-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-130"><a href="#cb86-130" aria-hidden="true" tabindex="-1"></a>The following code will let us interactively visualize CIs around an estimate of a mean with a normal sampling distribution.</span>
<span id="cb86-131"><a href="#cb86-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-134"><a href="#cb86-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-135"><a href="#cb86-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-136"><a href="#cb86-136" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(</span>
<span id="cb86-137"><a href="#cb86-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb86-138"><a href="#cb86-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(sampling_dist_mean <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sampling_dist_sd,</span>
<span id="cb86-139"><a href="#cb86-139" aria-hidden="true" tabindex="-1"></a>      sampling_dist_mean <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sampling_dist_sd)),</span>
<span id="cb86-140"><a href="#cb86-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb86-141"><a href="#cb86-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb86-142"><a href="#cb86-142" aria-hidden="true" tabindex="-1"></a>      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> sampling_dist_mean, <span class="at">sd =</span> sampling_dist_sd),</span>
<span id="cb86-143"><a href="#cb86-143" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">+</span></span>
<span id="cb86-144"><a href="#cb86-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Sampling Distribution Mean"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb86-145"><a href="#cb86-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb86-146"><a href="#cb86-146" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Exploring Confidence Intervals"</span>,</span>
<span id="cb86-147"><a href="#cb86-147" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Sampling Distribution SD (= SE): "</span>,</span>
<span id="cb86-148"><a href="#cb86-148" aria-hidden="true" tabindex="-1"></a>        sampling_dist_sd, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">round</span>(percent_CI, <span class="dv">2</span>), <span class="st">"% CI: "</span>,</span>
<span id="cb86-149"><a href="#cb86-149" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(sampling_dist_mean <span class="sc">-</span></span>
<span id="cb86-150"><a href="#cb86-150" aria-hidden="true" tabindex="-1"></a>          <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> percent_CI <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sampling_dist_sd, <span class="dv">2</span>),</span>
<span id="cb86-151"><a href="#cb86-151" aria-hidden="true" tabindex="-1"></a>        <span class="st">" to "</span>,</span>
<span id="cb86-152"><a href="#cb86-152" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(sampling_dist_mean <span class="sc">+</span></span>
<span id="cb86-153"><a href="#cb86-153" aria-hidden="true" tabindex="-1"></a>          <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> percent_CI <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sampling_dist_sd, <span class="dv">2</span>)</span>
<span id="cb86-154"><a href="#cb86-154" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb86-155"><a href="#cb86-155" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb86-156"><a href="#cb86-156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sampling_dist_mean <span class="sc">-</span></span>
<span id="cb86-157"><a href="#cb86-157" aria-hidden="true" tabindex="-1"></a>      <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> percent_CI <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sampling_dist_sd,</span>
<span id="cb86-158"><a href="#cb86-158" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb86-159"><a href="#cb86-159" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb86-160"><a href="#cb86-160" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sampling_dist_mean <span class="sc">+</span></span>
<span id="cb86-161"><a href="#cb86-161" aria-hidden="true" tabindex="-1"></a>      <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> percent_CI <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sampling_dist_sd,</span>
<span id="cb86-162"><a href="#cb86-162" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb86-163"><a href="#cb86-163" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb86-164"><a href="#cb86-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sampling_dist_mean,</span>
<span id="cb86-165"><a href="#cb86-165" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span></span>
<span id="cb86-166"><a href="#cb86-166" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb86-167"><a href="#cb86-167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb86-168"><a href="#cb86-168" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(</span>
<span id="cb86-169"><a href="#cb86-169" aria-hidden="true" tabindex="-1"></a>        sampling_dist_mean <span class="sc">-</span> <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> percent_CI <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sampling_dist_sd,</span>
<span id="cb86-170"><a href="#cb86-170" aria-hidden="true" tabindex="-1"></a>        sampling_dist_mean <span class="sc">+</span> <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> percent_CI <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sampling_dist_sd</span>
<span id="cb86-171"><a href="#cb86-171" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb86-172"><a href="#cb86-172" aria-hidden="true" tabindex="-1"></a>      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> sampling_dist_mean, <span class="at">sd =</span> sampling_dist_sd),</span>
<span id="cb86-173"><a href="#cb86-173" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb86-174"><a href="#cb86-174" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-175"><a href="#cb86-175" aria-hidden="true" tabindex="-1"></a>  <span class="at">sampling_dist_mean =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>, <span class="at">initial =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="dv">10</span>),</span>
<span id="cb86-176"><a href="#cb86-176" aria-hidden="true" tabindex="-1"></a>  <span class="at">sampling_dist_sd =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">initial =</span> <span class="dv">1</span>, <span class="at">step =</span> <span class="dv">1</span>),</span>
<span id="cb86-177"><a href="#cb86-177" aria-hidden="true" tabindex="-1"></a>  <span class="at">percent_CI =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">99</span>, <span class="at">initial =</span> <span class="dv">95</span>, <span class="at">step =</span> <span class="dv">1</span>)</span>
<span id="cb86-178"><a href="#cb86-178" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-179"><a href="#cb86-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-180"><a href="#cb86-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-181"><a href="#cb86-181" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation of CIs {.unnumbered}</span></span>
<span id="cb86-182"><a href="#cb86-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-183"><a href="#cb86-183" aria-hidden="true" tabindex="-1"></a>There are two ways that CIs are generally interpreted:</span>
<span id="cb86-184"><a href="#cb86-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-185"><a href="#cb86-185" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Based on the given data (with a particular mean, variance, and sample size), we are $X$% confident that the true mean of the population lies between the lower and upper bounds.</span>
<span id="cb86-186"><a href="#cb86-186" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The mean of a repeated sample of the same size drawn from this same underlying distribution is expected to fall into the given interval $X$% of the time.</span>
<span id="cb86-187"><a href="#cb86-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-188"><a href="#cb86-188" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Central Limit Theorem</span></span>
<span id="cb86-189"><a href="#cb86-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-190"><a href="#cb86-190" aria-hidden="true" tabindex="-1"></a>Our construction of CIs thus far has implicitly taken advantage of one of the most important theorems in statistics, the **Central Limit Theorem (CLT)**. The key importance of the CLT for us is that it states that the sampling distribution of averages (or sums or other summary statistics...) of "independent and identically distributed" (or $iid$) random variables approaches a normal distribution as the sample size increases. It is this fact that allows us to have a good sense of the mean and distribution of average events in a population even though we only observe one or a small number of samples of those events and even though we do not know what the actual population distribution is! In fact, the CLT says nothing about the probability distribution for events in the original population, and that is exactly where its usefulness lies... that original probability distribution can be normal, skewed, exponential, or even all kinds of odd!</span>
<span id="cb86-191"><a href="#cb86-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-192"><a href="#cb86-192" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **TL/DR:** The CLT means can we typically assume normality for the sampling distribution, i.e., for the distribution of the **sample mean** (or of the sample sum or the sample mode, etc...) no matter what kind of probability distribution characterizes the initial population, **as long as our sample size is large enough and our samples are independent and identically distributed**. It is thus the CLT that allows us to make inferences about a population based on a sample.</span></span>
<span id="cb86-193"><a href="#cb86-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-194"><a href="#cb86-194" aria-hidden="true" tabindex="-1"></a>Just to explore this a bit, let's do some simulations. We are going to take lots of averages of samples from a particular *non-normal* distribution and then look at the distribution of those averages.</span>
<span id="cb86-195"><a href="#cb86-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-196"><a href="#cb86-196" aria-hidden="true" tabindex="-1"></a>Imagine we have some event that occurs in a population according to some probability mass function like the Poisson where we know $\lambda=14$. Recall that the expectations of $\mu$ and $\sigma^2$ for the Poisson distribution are both equal to $\lambda$.</span>
<span id="cb86-197"><a href="#cb86-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-198"><a href="#cb86-198" aria-hidden="true" tabindex="-1"></a>Now let's imagine taking a bunch of random samples of size 10 from this population. We will take 1000 random samples of this size, calculate the average of each sample, and plot a histogram of those averages... it will be close to normal, and the standard deviation of those averages - i.e., the SD of the sampling distribution - should be roughly equal to the estimated standard error, i.e., the square root of (expected variance / sample size). Recall that for a Poisson distribution that $\lambda$ is the expected variance, so the estimated standard error is simply the $\sqrt{\lambda/n}$</span>
<span id="cb86-199"><a href="#cb86-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-202"><a href="#cb86-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-203"><a href="#cb86-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb86-204"><a href="#cb86-204" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb86-205"><a href="#cb86-205" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb86-206"><a href="#cb86-206" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(lambda<span class="sc">/</span>n))</span>
<span id="cb86-207"><a href="#cb86-207" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated SE, here, based on an estimate of the population variance</span></span>
<span id="cb86-208"><a href="#cb86-208" aria-hidden="true" tabindex="-1"></a><span class="co"># if available</span></span>
<span id="cb86-209"><a href="#cb86-209" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb86-210"><a href="#cb86-210" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb86-211"><a href="#cb86-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpois</span>(<span class="dv">10000</span>, <span class="at">lambda =</span> lambda),</span>
<span id="cb86-212"><a href="#cb86-212" aria-hidden="true" tabindex="-1"></a>  <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-213"><a href="#cb86-213" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"X"</span>,</span>
<span id="cb86-214"><a href="#cb86-214" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Original Distribution"</span></span>
<span id="cb86-215"><a href="#cb86-215" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-216"><a href="#cb86-216" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span><span class="dv">1000</span>) <span class="co"># dummy variable to hold sample means</span></span>
<span id="cb86-217"><a href="#cb86-217" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb86-218"><a href="#cb86-218" aria-hidden="true" tabindex="-1"></a>  x[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rpois</span>(<span class="at">n=</span>n, <span class="at">lambda=</span>lambda))</span>
<span id="cb86-219"><a href="#cb86-219" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-220"><a href="#cb86-220" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb86-221"><a href="#cb86-221" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb86-222"><a href="#cb86-222" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(</span>
<span id="cb86-223"><a href="#cb86-223" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb86-224"><a href="#cb86-224" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb86-225"><a href="#cb86-225" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="dv">20</span></span>
<span id="cb86-226"><a href="#cb86-226" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb86-227"><a href="#cb86-227" aria-hidden="true" tabindex="-1"></a>  <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-228"><a href="#cb86-228" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Mean x"</span>,</span>
<span id="cb86-229"><a href="#cb86-229" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Sampling Distribution"</span></span>
<span id="cb86-230"><a href="#cb86-230" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-231"><a href="#cb86-231" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sd</span>(x))</span>
<span id="cb86-232"><a href="#cb86-232" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated SE, here based on the standard deviation of the actual sampling distribution</span></span>
<span id="cb86-233"><a href="#cb86-233" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(x)</span>
<span id="cb86-234"><a href="#cb86-234" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(x)</span>
<span id="cb86-235"><a href="#cb86-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-236"><a href="#cb86-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-237"><a href="#cb86-237" aria-hidden="true" tabindex="-1"></a>Let's now do the same for samples of size 1000. We see that the mean of the sampling distribution stays essentially the same, the distribution is still normal, but the standard deviation - the spread - of the sampling distribution is lower.</span>
<span id="cb86-238"><a href="#cb86-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-241"><a href="#cb86-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-242"><a href="#cb86-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb86-243"><a href="#cb86-243" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb86-244"><a href="#cb86-244" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb86-245"><a href="#cb86-245" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(lambda<span class="sc">/</span>n))</span>
<span id="cb86-246"><a href="#cb86-246" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated SE, here, based on an estimate of the population variance if available</span></span>
<span id="cb86-247"><a href="#cb86-247" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb86-248"><a href="#cb86-248" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb86-249"><a href="#cb86-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpois</span>(<span class="dv">10000</span>, <span class="at">lambda =</span> lambda),</span>
<span id="cb86-250"><a href="#cb86-250" aria-hidden="true" tabindex="-1"></a>  <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-251"><a href="#cb86-251" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb86-252"><a href="#cb86-252" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Original Distribution"</span></span>
<span id="cb86-253"><a href="#cb86-253" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-254"><a href="#cb86-254" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb86-255"><a href="#cb86-255" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb86-256"><a href="#cb86-256" aria-hidden="true" tabindex="-1"></a>    x[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rpois</span>(<span class="at">n =</span> n, <span class="at">lambda =</span> lambda))</span>
<span id="cb86-257"><a href="#cb86-257" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-258"><a href="#cb86-258" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb86-259"><a href="#cb86-259" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb86-260"><a href="#cb86-260" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(</span>
<span id="cb86-261"><a href="#cb86-261" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb86-262"><a href="#cb86-262" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb86-263"><a href="#cb86-263" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="dv">20</span></span>
<span id="cb86-264"><a href="#cb86-264" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb86-265"><a href="#cb86-265" aria-hidden="true" tabindex="-1"></a>  <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-266"><a href="#cb86-266" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Mean X"</span>,</span>
<span id="cb86-267"><a href="#cb86-267" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Sampling Distribution"</span></span>
<span id="cb86-268"><a href="#cb86-268" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-269"><a href="#cb86-269" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sd</span>(x))</span>
<span id="cb86-270"><a href="#cb86-270" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated SE, here based on the standard deviation of the actual sampling distribution</span></span>
<span id="cb86-271"><a href="#cb86-271" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(x)</span>
<span id="cb86-272"><a href="#cb86-272" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(x)</span>
<span id="cb86-273"><a href="#cb86-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-274"><a href="#cb86-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-275"><a href="#cb86-275" aria-hidden="true" tabindex="-1"></a>Note that the sampling distribution gets narrower as the sample size increases.</span>
<span id="cb86-276"><a href="#cb86-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-277"><a href="#cb86-277" aria-hidden="true" tabindex="-1"></a>We can convert the sampling distribution to a standard normal by subtracting off the mean of the distribution and dividing by the standard deviation and then plotting a histogram of those values along with a normal curve.</span>
<span id="cb86-278"><a href="#cb86-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-281"><a href="#cb86-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-282"><a href="#cb86-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb86-283"><a href="#cb86-283" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb86-284"><a href="#cb86-284" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb86-285"><a href="#cb86-285" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb86-286"><a href="#cb86-286" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(</span>
<span id="cb86-287"><a href="#cb86-287" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">floor</span>(<span class="fu">min</span>(x)),</span>
<span id="cb86-288"><a href="#cb86-288" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">ceiling</span>(<span class="fu">max</span>(x)),</span>
<span id="cb86-289"><a href="#cb86-289" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="dv">20</span></span>
<span id="cb86-290"><a href="#cb86-290" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb86-291"><a href="#cb86-291" aria-hidden="true" tabindex="-1"></a>  <span class="at">probability =</span> <span class="cn">TRUE</span></span>
<span id="cb86-292"><a href="#cb86-292" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-293"><a href="#cb86-293" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x) <span class="co"># converts the vector of means to z scores</span></span>
<span id="cb86-294"><a href="#cb86-294" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span> <span class="fu">min</span>(z), <span class="at">to=</span><span class="fu">max</span>(z), <span class="at">length.out=</span><span class="dv">20</span>), <span class="at">probability=</span><span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)) <span class="co"># plots the histogram of z scores</span></span>
<span id="cb86-295"><a href="#cb86-295" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">1</span>),<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>), <span class="at">xlab=</span><span class="st">"Z"</span>, <span class="at">ylab=</span><span class="st">"Density"</span>, <span class="at">add=</span><span class="cn">TRUE</span>) <span class="co"># plots a standard normal curve</span></span>
<span id="cb86-296"><a href="#cb86-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-297"><a href="#cb86-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-298"><a href="#cb86-298" aria-hidden="true" tabindex="-1"></a>Pretty normal looking, right?</span>
<span id="cb86-299"><a href="#cb86-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-300"><a href="#cb86-300" aria-hidden="true" tabindex="-1"></a>Here's an example of the CLT in action using the <span class="in">`sum()`</span> of our random variables instead of the <span class="in">`mean()`</span> as the statistic of interest ...</span>
<span id="cb86-301"><a href="#cb86-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-304"><a href="#cb86-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-305"><a href="#cb86-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb86-306"><a href="#cb86-306" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb86-307"><a href="#cb86-307" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb86-308"><a href="#cb86-308" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb86-309"><a href="#cb86-309" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb86-310"><a href="#cb86-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpois</span>(<span class="dv">10000</span>, <span class="at">lambda =</span> lambda),</span>
<span id="cb86-311"><a href="#cb86-311" aria-hidden="true" tabindex="-1"></a>  <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-312"><a href="#cb86-312" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"X"</span>,</span>
<span id="cb86-313"><a href="#cb86-313" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Original Distribution"</span></span>
<span id="cb86-314"><a href="#cb86-314" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-315"><a href="#cb86-315" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb86-316"><a href="#cb86-316" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb86-317"><a href="#cb86-317" aria-hidden="true" tabindex="-1"></a>    x[[i]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">rpois</span>(<span class="at">n=</span>n, <span class="at">lambda=</span>lambda))</span>
<span id="cb86-318"><a href="#cb86-318" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-319"><a href="#cb86-319" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb86-320"><a href="#cb86-320" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb86-321"><a href="#cb86-321" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(</span>
<span id="cb86-322"><a href="#cb86-322" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb86-323"><a href="#cb86-323" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb86-324"><a href="#cb86-324" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="dv">20</span></span>
<span id="cb86-325"><a href="#cb86-325" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb86-326"><a href="#cb86-326" aria-hidden="true" tabindex="-1"></a>  <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-327"><a href="#cb86-327" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Sum X"</span>,</span>
<span id="cb86-328"><a href="#cb86-328" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Sampling Distribution"</span></span>
<span id="cb86-329"><a href="#cb86-329" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-330"><a href="#cb86-330" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the sampling distribution to standard normal</span></span>
<span id="cb86-331"><a href="#cb86-331" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb86-332"><a href="#cb86-332" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">length.out=</span><span class="dv">20</span>), <span class="at">probability=</span><span class="cn">TRUE</span>)</span>
<span id="cb86-333"><a href="#cb86-333" aria-hidden="true" tabindex="-1"></a><span class="co"># plots a standard normal curve</span></span>
<span id="cb86-334"><a href="#cb86-334" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">1</span>),<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">xlab=</span><span class="st">"Z"</span>, <span class="at">ylab=</span><span class="st">"Density"</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb86-335"><a href="#cb86-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-336"><a href="#cb86-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-337"><a href="#cb86-337" aria-hidden="true" tabindex="-1"></a>Again, pretty normal looking!</span>
<span id="cb86-338"><a href="#cb86-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-339"><a href="#cb86-339" aria-hidden="true" tabindex="-1"></a>Trying this for an intial beta rather than Poisson distribution...</span>
<span id="cb86-340"><a href="#cb86-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-343"><a href="#cb86-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-344"><a href="#cb86-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb86-345"><a href="#cb86-345" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">1.1</span></span>
<span id="cb86-346"><a href="#cb86-346" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">2.9</span></span>
<span id="cb86-347"><a href="#cb86-347" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb86-348"><a href="#cb86-348" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb86-349"><a href="#cb86-349" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb86-350"><a href="#cb86-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbeta</span>(<span class="dv">10000</span>, <span class="at">shape1 =</span> alpha, <span class="at">shape2 =</span> beta),</span>
<span id="cb86-351"><a href="#cb86-351" aria-hidden="true" tabindex="-1"></a>  <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-352"><a href="#cb86-352" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"X"</span>,</span>
<span id="cb86-353"><a href="#cb86-353" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Original Distribution"</span></span>
<span id="cb86-354"><a href="#cb86-354" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-355"><a href="#cb86-355" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb86-356"><a href="#cb86-356" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb86-357"><a href="#cb86-357" aria-hidden="true" tabindex="-1"></a>    x[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rbeta</span>(<span class="at">n=</span>n, <span class="at">shape1 =</span> alpha, <span class="at">shape2 =</span> beta))</span>
<span id="cb86-358"><a href="#cb86-358" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-359"><a href="#cb86-359" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb86-360"><a href="#cb86-360" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb86-361"><a href="#cb86-361" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">20</span>),</span>
<span id="cb86-362"><a href="#cb86-362" aria-hidden="true" tabindex="-1"></a>  <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-363"><a href="#cb86-363" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Mean X"</span>,</span>
<span id="cb86-364"><a href="#cb86-364" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Sampling Distribution"</span></span>
<span id="cb86-365"><a href="#cb86-365" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-366"><a href="#cb86-366" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the sampling distribution to standard normal</span></span>
<span id="cb86-367"><a href="#cb86-367" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb86-368"><a href="#cb86-368" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">length.out=</span><span class="dv">20</span>), <span class="at">probability=</span><span class="cn">TRUE</span>)</span>
<span id="cb86-369"><a href="#cb86-369" aria-hidden="true" tabindex="-1"></a><span class="co"># plots a standard normal curve</span></span>
<span id="cb86-370"><a href="#cb86-370" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">1</span>),<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">xlab=</span><span class="st">"Z"</span>, <span class="at">ylab=</span><span class="st">"Density"</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb86-371"><a href="#cb86-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-372"><a href="#cb86-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-373"><a href="#cb86-373" aria-hidden="true" tabindex="-1"></a>Once again, the sampling distribution is normal, even though the original distribution is far from it!</span>
<span id="cb86-374"><a href="#cb86-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-375"><a href="#cb86-375" aria-hidden="true" tabindex="-1"></a>**Take Home Points:**</span>
<span id="cb86-376"><a href="#cb86-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-377"><a href="#cb86-377" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">1</span><span class="co">]</span> The CLT states that, regardless of the underlying probability distribution of a population of **independent, identically distributed** ($iid$) random variables, the distribution of a statistic (e.g., means, or sums or standard deviations, etc...) for samples drawn from that underlying distribution:</span>
<span id="cb86-378"><a href="#cb86-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-379"><a href="#cb86-379" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>will be approximately normal,</span>
<span id="cb86-380"><a href="#cb86-380" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>will be centered at the population mean for the statistic, and - will have a standard deviation roughly equal to the standard error of the mean for the statistic.</span>
<span id="cb86-381"><a href="#cb86-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-382"><a href="#cb86-382" aria-hidden="true" tabindex="-1"></a>Additionally, it suggests that variables that are expected to be the sum of multiple independent processes (e.g., measurement errors) will also have distributions that are nearly normal.</span>
<span id="cb86-383"><a href="#cb86-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-384"><a href="#cb86-384" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">2</span><span class="co">]</span> Calculating a *statistic* based on this distribution (e.g., the mean) and adding/subtracting the relevant *standard quantile* $\times$ the *standard error* yields a confidence interval for the relevant statistic, which gets wider as the coverage increases and gets narrower with less variability or larger sample sizes.</span>
<span id="cb86-385"><a href="#cb86-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-386"><a href="#cb86-386" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">3</span><span class="co">]</span> As sample size increases, the standard error of the statistic decreases and the sampling distribution becomes more and more normal (i.e., has less skew and kurtosis, which are higher order moments of the distribution).</span>
<span id="cb86-387"><a href="#cb86-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-388"><a href="#cb86-388" aria-hidden="true" tabindex="-1"></a>For a nice interactive simulation demonstrating the Central Limit Theorem, check out <span class="co">[</span><span class="ot">this cool website</span><span class="co">](http://onlinestatbook.com/stat_sim/sampling_dist/index.html)</span>.</span>
<span id="cb86-389"><a href="#cb86-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-390"><a href="#cb86-390" aria-hidden="true" tabindex="-1"></a><span class="fu">## CIs for Sample Proportions</span></span>
<span id="cb86-391"><a href="#cb86-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-392"><a href="#cb86-392" aria-hidden="true" tabindex="-1"></a>So far, we've talked about CIs for sample means of a continuous random variable, but what about for other statistics, e.g., sample proportions for discrete binary variables. For example, if you have a sample of **n** trials where you record the success or failure of a binary event, you can obtain an estimate of the proportion of successes, $x/n$. If you perform another **n** trials, the new estimate will vary from sample to sample in the same way that averages of a continuous random variable (e.g., zombie age) will vary.</span>
<span id="cb86-393"><a href="#cb86-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-394"><a href="#cb86-394" aria-hidden="true" tabindex="-1"></a>Taking a similar approach as we did above for normally distributed continuous random variables, we can generate confidence intervals for the proportion of successes across trials, i.e., for a discrete binary variable, by taking the expectation and adding/subtracting a critical value $\times$ a standard error.</span>
<span id="cb86-395"><a href="#cb86-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-396"><a href="#cb86-396" aria-hidden="true" tabindex="-1"></a>Recall from our discussion of discrete random binary variables that the expectation for proportion of successes, which we will denote as $\pi$ (where $\pi$, for "proportion", is analogous to $\mu$, for "mean") is simply the average number of successes across multiple trials, and the expectation for the variance in this proportion is $\pi \times (1-\pi)$.</span>
<span id="cb86-397"><a href="#cb86-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-398"><a href="#cb86-398" aria-hidden="true" tabindex="-1"></a>As for the mean of a continuous random variable, the expected sampling distribution for the proportion of successes across many trials of sample size $n$ is approximately normal and centered at $\pi$, and its standard deviation is estimated by $\sqrt{\pi(1-\pi)/n}$, which is, essentially, the standard error of the mean: it is the square root of (the expected variance / sample size). As above for $\mu$, if we do not already have a population estimate for $\pi$, we can estimate this from a sample as $\hat{p}=x/n$</span>
<span id="cb86-399"><a href="#cb86-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-400"><a href="#cb86-400" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** The approximation of normality for the sampling distribution of proportion of successes holds true only if both $n\times\pi$ and $n\times(1-\pi)$ are greater than roughly 5, so we should always check this when working with proportion data!</span></span>
<span id="cb86-401"><a href="#cb86-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-402"><a href="#cb86-402" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb86-403"><a href="#cb86-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-404"><a href="#cb86-404" aria-hidden="true" tabindex="-1"></a>Suppose a polling group in the United States is interested in the proportion of voting-age citizens in their state that already know they will vote for Bernie Sanders in the upcoming presidential election. The group obtains a "yes"" or "no" answer from 1000 randomly selected individuals. Of these individuals, 856 say they know they'll vote for Sanders How would we characterize the mean and variability associated with this proportion?</span>
<span id="cb86-405"><a href="#cb86-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-408"><a href="#cb86-408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-409"><a href="#cb86-409" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb86-410"><a href="#cb86-410" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">856</span></span>
<span id="cb86-411"><a href="#cb86-411" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> x<span class="sc">/</span>n <span class="co"># our estimate of pi</span></span>
<span id="cb86-412"><a href="#cb86-412" aria-hidden="true" tabindex="-1"></a>p_hat</span>
<span id="cb86-413"><a href="#cb86-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-414"><a href="#cb86-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-415"><a href="#cb86-415" aria-hidden="true" tabindex="-1"></a>Are $n\times\pi$ and $n\times(1-\pi)$ both <span class="sc">\&gt;</span> 5? Yes!</span>
<span id="cb86-416"><a href="#cb86-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-419"><a href="#cb86-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-420"><a href="#cb86-420" aria-hidden="true" tabindex="-1"></a>n <span class="sc">*</span> p_hat</span>
<span id="cb86-421"><a href="#cb86-421" aria-hidden="true" tabindex="-1"></a>n <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat)</span>
<span id="cb86-422"><a href="#cb86-422" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((p_hat)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_hat)<span class="sc">/</span>n) <span class="co"># estimated SE for proportion data</span></span>
<span id="cb86-423"><a href="#cb86-423" aria-hidden="true" tabindex="-1"></a>se</span>
<span id="cb86-424"><a href="#cb86-424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-425"><a href="#cb86-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-426"><a href="#cb86-426" aria-hidden="true" tabindex="-1"></a>So, what is the 95% CI around our estimate of the proportion of people who already know how they will vote?</span>
<span id="cb86-427"><a href="#cb86-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-430"><a href="#cb86-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-431"><a href="#cb86-431" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb86-432"><a href="#cb86-432" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb86-433"><a href="#cb86-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(x, <span class="at">mean =</span> p_hat, <span class="at">sd =</span> se),</span>
<span id="cb86-434"><a href="#cb86-434" aria-hidden="true" tabindex="-1"></a>  p_hat <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> se,</span>
<span id="cb86-435"><a href="#cb86-435" aria-hidden="true" tabindex="-1"></a>  p_hat <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> se,</span>
<span id="cb86-436"><a href="#cb86-436" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">""</span>,</span>
<span id="cb86-437"><a href="#cb86-437" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb86-438"><a href="#cb86-438" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"95% Confidence Interval around</span><span class="sc">\n</span><span class="st">Expected Proportion of Decided Voters "</span></span>
<span id="cb86-439"><a href="#cb86-439" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-440"><a href="#cb86-440" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> p_hat <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se</span>
<span id="cb86-441"><a href="#cb86-441" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> p_hat <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se</span>
<span id="cb86-442"><a href="#cb86-442" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> <span class="fu">c</span>(lower, upper))</span>
<span id="cb86-443"><a href="#cb86-443" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb86-444"><a href="#cb86-444" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span>p_hat <span class="sc">+</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span>
<span id="cb86-445"><a href="#cb86-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-446"><a href="#cb86-446" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(</span>
<span id="cb86-447"><a href="#cb86-447" aria-hidden="true" tabindex="-1"></a>  ci[<span class="dv">1</span>], <span class="fu">seq</span>(</span>
<span id="cb86-448"><a href="#cb86-448" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> ci[<span class="dv">1</span>],</span>
<span id="cb86-449"><a href="#cb86-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> ci[<span class="dv">2</span>],</span>
<span id="cb86-450"><a href="#cb86-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="dv">1000</span></span>
<span id="cb86-451"><a href="#cb86-451" aria-hidden="true" tabindex="-1"></a>  ), ci[<span class="dv">2</span>]</span>
<span id="cb86-452"><a href="#cb86-452" aria-hidden="true" tabindex="-1"></a>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(</span>
<span id="cb86-453"><a href="#cb86-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seq</span>(</span>
<span id="cb86-454"><a href="#cb86-454" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> ci[<span class="dv">1</span>],</span>
<span id="cb86-455"><a href="#cb86-455" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> ci[<span class="dv">2</span>],</span>
<span id="cb86-456"><a href="#cb86-456" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="dv">1000</span></span>
<span id="cb86-457"><a href="#cb86-457" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb86-458"><a href="#cb86-458" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> p_hat,</span>
<span id="cb86-459"><a href="#cb86-459" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> se</span>
<span id="cb86-460"><a href="#cb86-460" aria-hidden="true" tabindex="-1"></a>), <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb86-461"><a href="#cb86-461" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>ci)</span>
<span id="cb86-462"><a href="#cb86-462" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>p_hat)</span>
<span id="cb86-463"><a href="#cb86-463" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb86-464"><a href="#cb86-464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-465"><a href="#cb86-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-466"><a href="#cb86-466" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small Sample CIs</span></span>
<span id="cb86-467"><a href="#cb86-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-468"><a href="#cb86-468" aria-hidden="true" tabindex="-1"></a>Thus far, we have discussed creating confidence intervals for sample statistics based on the CLT and the **normal** distribution, and our intervals took the form:</span>
<span id="cb86-469"><a href="#cb86-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-470"><a href="#cb86-470" aria-hidden="true" tabindex="-1"></a>*mean* $±$ $Z$ (the critical value, based on a quantile from the standard normal curve) $\times$ *standard error*</span>
<span id="cb86-471"><a href="#cb86-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-472"><a href="#cb86-472" aria-hidden="true" tabindex="-1"></a>But, when the size of our sample is small ($n$ <span class="sc">\&lt;</span> 30), instead of using the normal distribution to calculate our CIs, statisticians typically use a different distribution to generate the relevant quantiles to multiply the standard error by... the **t distribution** (a.k.a., **Gosset's** $t$ or **Student's** $t$ distribution).</span>
<span id="cb86-473"><a href="#cb86-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-474"><a href="#cb86-474" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** This is a **typical** case that we will encounter, as we often do not have information about the population that a sample is drawn from!</span></span>
<span id="cb86-475"><a href="#cb86-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-476"><a href="#cb86-476" aria-hidden="true" tabindex="-1"></a>The $t$ distribution is a continuous probability distribution very similar in shape to the normal, and is generally used when dealing with *statistics* (such as means and standard deviations) that are estimated from a sample rather than being known *parameters* about a population. Any particular $t$ distribution looks a lot like a normal distribution in that it is bell-shaped, symmetric, unimodal, and (if standardized) zero-centered.</span>
<span id="cb86-477"><a href="#cb86-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-478"><a href="#cb86-478" aria-hidden="true" tabindex="-1"></a>The choice of the appropriate $t$ distribution to use in any particular statistical test is based on the number of **degrees of freedom (df)**, i.e., the number of individual components in the calculation of a given statistic (such as the mean or standard deviation) that are "free to change".</span>
<span id="cb86-479"><a href="#cb86-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-480"><a href="#cb86-480" aria-hidden="true" tabindex="-1"></a>We can thus think of the $t$ distribution as representing a *family of curves* that, as the number of degrees of freedom increases, approaches the normal curve. At low numbers of degrees of freedom, the tails of the distribution get fatter and the peak of the distribution gets lower.</span>
<span id="cb86-481"><a href="#cb86-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-482"><a href="#cb86-482" aria-hidden="true" tabindex="-1"></a>Confidence intervals based on the $t$ distribution are of the form:</span>
<span id="cb86-483"><a href="#cb86-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-484"><a href="#cb86-484" aria-hidden="true" tabindex="-1"></a>*mean* $±$ $T$ (the critical value, based on a quantile from the $t$ distribution) $\times$ *standard error*</span>
<span id="cb86-485"><a href="#cb86-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-486"><a href="#cb86-486" aria-hidden="true" tabindex="-1"></a>The only change from CIs based on the normal distribution is that we have replaced the $Z$ quantile of the standard normal with a $T$ quantile.</span>
<span id="cb86-487"><a href="#cb86-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-488"><a href="#cb86-488" aria-hidden="true" tabindex="-1"></a>Let's explore this a bit...</span>
<span id="cb86-489"><a href="#cb86-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-490"><a href="#cb86-490" aria-hidden="true" tabindex="-1"></a>Recall that a standard normal distribution is generated by normalizing a set of data (subtracting the mean from each observation and then dividing all of these differences by the standard deviation of the distribution)...</span>
<span id="cb86-491"><a href="#cb86-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-492"><a href="#cb86-492" aria-hidden="true" tabindex="-1"></a>$$(\bar{x}-\mu)/\sigma$$</span>
<span id="cb86-493"><a href="#cb86-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-494"><a href="#cb86-494" aria-hidden="true" tabindex="-1"></a>For a sample, if we subtract the population mean from each observation and then divide each difference, instead, by the standard error of the mean, i.e., $(\bar{x}-\mu)/SE$, the result is not a normal distribution, but rather a $t$ distribution! We are taking into account sample size by dividing by the standard error of the mean rather than by the population standard deviation.</span>
<span id="cb86-495"><a href="#cb86-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-496"><a href="#cb86-496" aria-hidden="true" tabindex="-1"></a>The code below plots a standard normal distribution in red and then superimposes several $t$ distributions with varying degrees of freedom, specified using the <span class="in">`df=`</span> argument.</span>
<span id="cb86-497"><a href="#cb86-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-500"><a href="#cb86-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-501"><a href="#cb86-501" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb86-502"><a href="#cb86-502" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb86-503"><a href="#cb86-503" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb86-504"><a href="#cb86-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(x, mu, <span class="dv">1</span>),</span>
<span id="cb86-505"><a href="#cb86-505" aria-hidden="true" tabindex="-1"></a>  mu <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma,</span>
<span id="cb86-506"><a href="#cb86-506" aria-hidden="true" tabindex="-1"></a>  mu <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma,</span>
<span id="cb86-507"><a href="#cb86-507" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Normal Distribution (red)\ and</span><span class="sc">\n</span><span class="st">Student's t Distributions (blue)"</span>,</span>
<span id="cb86-508"><a href="#cb86-508" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb86-509"><a href="#cb86-509" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"f(x)"</span>,</span>
<span id="cb86-510"><a href="#cb86-510" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb86-511"><a href="#cb86-511" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">3</span></span>
<span id="cb86-512"><a href="#cb86-512" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-513"><a href="#cb86-513" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">100</span>)) {</span>
<span id="cb86-514"><a href="#cb86-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(</span>
<span id="cb86-515"><a href="#cb86-515" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dt</span>(x, <span class="at">df =</span> i),</span>
<span id="cb86-516"><a href="#cb86-516" aria-hidden="true" tabindex="-1"></a>    mu <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma,</span>
<span id="cb86-517"><a href="#cb86-517" aria-hidden="true" tabindex="-1"></a>    mu <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma,</span>
<span id="cb86-518"><a href="#cb86-518" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"T Curve"</span>,</span>
<span id="cb86-519"><a href="#cb86-519" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb86-520"><a href="#cb86-520" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"f(x)"</span>,</span>
<span id="cb86-521"><a href="#cb86-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-522"><a href="#cb86-522" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb86-523"><a href="#cb86-523" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">5</span></span>
<span id="cb86-524"><a href="#cb86-524" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-525"><a href="#cb86-525" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-526"><a href="#cb86-526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-527"><a href="#cb86-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-528"><a href="#cb86-528" aria-hidden="true" tabindex="-1"></a>As for other distributions, ***R*** implements <span class="in">`d`</span> (density), <span class="in">`p`</span> (cumulative probability), <span class="in">`q`</span> (quantile), and <span class="in">`r`</span> (random draw) functions for the t distribution.</span>
<span id="cb86-529"><a href="#cb86-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-530"><a href="#cb86-530" aria-hidden="true" tabindex="-1"></a>The fatter tails of the $t$ distibution at small sample sizes lead naturally to more extreme quantile values given a specific probability than we would see for the normal distribution. If we define a CI based on quantiles of the $t$ distribution, then, they will be correspondingly slightly **wider** than those based on the normal distribution for small values of $df$.</span>
<span id="cb86-531"><a href="#cb86-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-532"><a href="#cb86-532" aria-hidden="true" tabindex="-1"></a>We can see this in an example, where we draw samples from a population of values defined by a normal distribution with a particular mean and standard deviation. Recall that above we estimated the 95% CI for such a sample drawn from a normal distribution as follows:</span>
<span id="cb86-533"><a href="#cb86-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-536"><a href="#cb86-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-537"><a href="#cb86-537" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb86-538"><a href="#cb86-538" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb86-539"><a href="#cb86-539" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb86-540"><a href="#cb86-540" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb86-541"><a href="#cb86-541" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma) <span class="co"># x is our large population</span></span>
<span id="cb86-542"><a href="#cb86-542" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span>
<span id="cb86-543"><a href="#cb86-543" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb86-544"><a href="#cb86-544" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> sample_size, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="co"># s is a sample from that population</span></span>
<span id="cb86-545"><a href="#cb86-545" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(s))</span>
<span id="cb86-546"><a href="#cb86-546" aria-hidden="true" tabindex="-1"></a>(sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(s))</span>
<span id="cb86-547"><a href="#cb86-547" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sd</span>(s)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(s)))</span>
<span id="cb86-548"><a href="#cb86-548" aria-hidden="true" tabindex="-1"></a>ci_normal <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> se</span>
<span id="cb86-549"><a href="#cb86-549" aria-hidden="true" tabindex="-1"></a><span class="co"># (1-alpha)/2 each in the upper and lower tails of the distribution</span></span>
<span id="cb86-550"><a href="#cb86-550" aria-hidden="true" tabindex="-1"></a>ci_normal</span>
<span id="cb86-551"><a href="#cb86-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-552"><a href="#cb86-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-553"><a href="#cb86-553" aria-hidden="true" tabindex="-1"></a>Now, let's look at the CIs calculated based using the $t$ distribution for the same sample size. For sample size 30, the difference in the CIs is negligible.</span>
<span id="cb86-554"><a href="#cb86-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-557"><a href="#cb86-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-558"><a href="#cb86-558" aria-hidden="true" tabindex="-1"></a>ci_t <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> sample_size <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se</span>
<span id="cb86-559"><a href="#cb86-559" aria-hidden="true" tabindex="-1"></a><span class="co"># (1-alpha)/2 each in the upper and lower tails of the distribution</span></span>
<span id="cb86-560"><a href="#cb86-560" aria-hidden="true" tabindex="-1"></a>ci_t</span>
<span id="cb86-561"><a href="#cb86-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-562"><a href="#cb86-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-563"><a href="#cb86-563" aria-hidden="true" tabindex="-1"></a>However, if we use a sample size of 5, the equivalent CI based on the $t$ distribution is much wider.</span>
<span id="cb86-564"><a href="#cb86-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-567"><a href="#cb86-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-568"><a href="#cb86-568" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb86-569"><a href="#cb86-569" aria-hidden="true" tabindex="-1"></a>small_s <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> sample_size, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb86-570"><a href="#cb86-570" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(small_s))</span>
<span id="cb86-571"><a href="#cb86-571" aria-hidden="true" tabindex="-1"></a>(sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(small_s))</span>
<span id="cb86-572"><a href="#cb86-572" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">sd</span>(small_s)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(small_s)))</span>
<span id="cb86-573"><a href="#cb86-573" aria-hidden="true" tabindex="-1"></a>ci_normal <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> se</span>
<span id="cb86-574"><a href="#cb86-574" aria-hidden="true" tabindex="-1"></a><span class="co"># (1-alpha)/2 each in the upper and lower tails of the distribution</span></span>
<span id="cb86-575"><a href="#cb86-575" aria-hidden="true" tabindex="-1"></a>ci_normal</span>
<span id="cb86-576"><a href="#cb86-576" aria-hidden="true" tabindex="-1"></a>ci_t <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> sample_size <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se</span>
<span id="cb86-577"><a href="#cb86-577" aria-hidden="true" tabindex="-1"></a><span class="co"># (1-alpha)/2 each in the upper and lower tails of the distribution</span></span>
<span id="cb86-578"><a href="#cb86-578" aria-hidden="true" tabindex="-1"></a>ci_t</span>
<span id="cb86-579"><a href="#cb86-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-580"><a href="#cb86-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-581"><a href="#cb86-581" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculating CIs by Bootstrapping</span></span>
<span id="cb86-582"><a href="#cb86-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-583"><a href="#cb86-583" aria-hidden="true" tabindex="-1"></a>An alternative (and arguably **better**) way to calculate a confidence interval for a given statistic is by "bootstrapping" from the data in a single sample using a Monte Carlo simulation process. Bootstrapping allows us to approximate a sampling distribution even without access to the population from which samples are drawn and without making any assumptions about the theoretical shape of the sampling distribution. The distribution we generate is sometimes referred to as a *bootstrap distribution*.</span>
<span id="cb86-584"><a href="#cb86-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-585"><a href="#cb86-585" aria-hidden="true" tabindex="-1"></a><span class="fu">### Writing our Own Bootstrap {.unnumbered}</span></span>
<span id="cb86-586"><a href="#cb86-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-587"><a href="#cb86-587" aria-hidden="true" tabindex="-1"></a>Below, we use the <span class="in">`sample()`</span> function to sample, **with replacement**, bootstrap replicates of equivalent sample size from our original vector of sample data, **s**, a total of 10000 times. This is just one approach to how we might perform bootstrapping, using {base} ***R*** functions.</span>
<span id="cb86-588"><a href="#cb86-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-589"><a href="#cb86-589" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** If we wanted to sample rows from a data frame instead of items from a vector, we could use the {dplyr} functions </span><span class="in">`sample_n()`</span><span class="at"> or </span><span class="in">`slice_sample()`</span><span class="at">.</span></span>
<span id="cb86-590"><a href="#cb86-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-593"><a href="#cb86-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-594"><a href="#cb86-594" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: last</span></span>
<span id="cb86-595"><a href="#cb86-595" aria-hidden="true" tabindex="-1"></a>n_boot <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb86-596"><a href="#cb86-596" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span>n_boot) <span class="co"># set up a dummy variable to hold our simulations</span></span>
<span id="cb86-597"><a href="#cb86-597" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(s)</span>
<span id="cb86-598"><a href="#cb86-598" aria-hidden="true" tabindex="-1"></a><span class="co"># the size of each bootstrap sample should equivalent to the size our original sample</span></span>
<span id="cb86-599"><a href="#cb86-599" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_boot){</span>
<span id="cb86-600"><a href="#cb86-600" aria-hidden="true" tabindex="-1"></a>  boot[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(s, n, <span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb86-601"><a href="#cb86-601" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-602"><a href="#cb86-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-603"><a href="#cb86-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-604"><a href="#cb86-604" aria-hidden="true" tabindex="-1"></a>The following code visualizes the bootstrap sampling distribution we have just generated and also compares the various methods we have explored for calculating CIs.</span>
<span id="cb86-605"><a href="#cb86-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-608"><a href="#cb86-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-609"><a href="#cb86-609" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot, <span class="at">breaks =</span> <span class="dv">25</span>,</span>
<span id="cb86-610"><a href="#cb86-610" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1600</span>),</span>
<span id="cb86-611"><a href="#cb86-611" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Mean"</span>,</span>
<span id="cb86-612"><a href="#cb86-612" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Bootstrap Sampling Distribution"</span>)</span>
<span id="cb86-613"><a href="#cb86-613" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(boot), <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">3</span>) <span class="co"># mean of our simulated samples</span></span>
<span id="cb86-614"><a href="#cb86-614" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">mean</span>(boot) <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"mean of bootstrap distribution "</span>,</span>
<span id="cb86-615"><a href="#cb86-615" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-616"><a href="#cb86-616" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(s), <span class="at">col=</span><span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb86-617"><a href="#cb86-617" aria-hidden="true" tabindex="-1"></a><span class="co"># mean of our original vector of samples, s</span></span>
<span id="cb86-618"><a href="#cb86-618" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">mean</span>(s) <span class="sc">-</span> <span class="fl">0.125</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"mean of original sample"</span>,</span>
<span id="cb86-619"><a href="#cb86-619" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-620"><a href="#cb86-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-621"><a href="#cb86-621" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">quantile</span>(boot, <span class="fl">0.025</span>), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb86-622"><a href="#cb86-622" aria-hidden="true" tabindex="-1"></a><span class="co"># lower ci bound inferred by bootstrapping</span></span>
<span id="cb86-623"><a href="#cb86-623" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">quantile</span>(boot, <span class="fl">0.975</span>), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb86-624"><a href="#cb86-624" aria-hidden="true" tabindex="-1"></a><span class="co"># upper ci bound inferred by bootstrapping</span></span>
<span id="cb86-625"><a href="#cb86-625" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">quantile</span>(boot, <span class="fl">0.025</span>) <span class="sc">+</span> <span class="fl">0.25</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"lower CI - bootstrap"</span>,</span>
<span id="cb86-626"><a href="#cb86-626" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-627"><a href="#cb86-627" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">quantile</span>(boot, <span class="fl">0.975</span>) <span class="sc">-</span> <span class="fl">0.125</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"upper CI - bootstrap"</span>,</span>
<span id="cb86-628"><a href="#cb86-628" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-629"><a href="#cb86-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-630"><a href="#cb86-630" aria-hidden="true" tabindex="-1"></a>ci_normal <span class="ot">&lt;-</span> <span class="fu">mean</span>(s) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sciplot<span class="sc">::</span><span class="fu">se</span>(s)</span>
<span id="cb86-631"><a href="#cb86-631" aria-hidden="true" tabindex="-1"></a>ci_t <span class="ot">&lt;-</span> <span class="fu">mean</span>(s) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> <span class="fu">length</span>(s) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sciplot<span class="sc">::</span><span class="fu">se</span>(s)</span>
<span id="cb86-632"><a href="#cb86-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-633"><a href="#cb86-633" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci_normal[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb86-634"><a href="#cb86-634" aria-hidden="true" tabindex="-1"></a><span class="co"># calculated lower ci bound based on the se of our vector and</span></span>
<span id="cb86-635"><a href="#cb86-635" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming that our observations are drawn from a normal distribution</span></span>
<span id="cb86-636"><a href="#cb86-636" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci_normal[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb86-637"><a href="#cb86-637" aria-hidden="true" tabindex="-1"></a><span class="co"># calculated upper ci bound based on the se of our vector and</span></span>
<span id="cb86-638"><a href="#cb86-638" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming that our observations are drawn from a normal distribution</span></span>
<span id="cb86-639"><a href="#cb86-639" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> ci_normal[<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.12</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"lower CI - normal"</span>,</span>
<span id="cb86-640"><a href="#cb86-640" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-641"><a href="#cb86-641" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> ci_normal[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.245</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"upper CI - normal"</span>,</span>
<span id="cb86-642"><a href="#cb86-642" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-643"><a href="#cb86-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-644"><a href="#cb86-644" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci_t[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb86-645"><a href="#cb86-645" aria-hidden="true" tabindex="-1"></a><span class="co"># calculated lower ci bound based on the se of our vector and</span></span>
<span id="cb86-646"><a href="#cb86-646" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming that our observations are drawn from a t distribution</span></span>
<span id="cb86-647"><a href="#cb86-647" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci_t[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb86-648"><a href="#cb86-648" aria-hidden="true" tabindex="-1"></a><span class="co"># calculated upper ci bound based on the se of our vector and</span></span>
<span id="cb86-649"><a href="#cb86-649" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming that our observations are drawn from a t distribution</span></span>
<span id="cb86-650"><a href="#cb86-650" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> ci_t[<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.15</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"lower CI - t"</span>, <span class="at">col =</span> <span class="st">"green"</span>,</span>
<span id="cb86-651"><a href="#cb86-651" aria-hidden="true" tabindex="-1"></a>  <span class="at">srt =</span> <span class="dv">90</span> , <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-652"><a href="#cb86-652" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> ci_t[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.275</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"upper CI - t"</span>, <span class="at">col =</span> <span class="st">"green"</span>,</span>
<span id="cb86-653"><a href="#cb86-653" aria-hidden="true" tabindex="-1"></a>  <span class="at">srt =</span> <span class="dv">90</span> , <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-654"><a href="#cb86-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-655"><a href="#cb86-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-656"><a href="#cb86-656" aria-hidden="true" tabindex="-1"></a>In this example, we used the <span class="in">`quantile()`</span> function to return the observations satisfying the $n^{th}$ quantile of our particular distribution of bootstrapped sample means. We use this function to define the lower and upper bounds for the bootstrap confidence interval around the mean of our variable, **x**.</span>
<span id="cb86-657"><a href="#cb86-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-658"><a href="#cb86-658" aria-hidden="true" tabindex="-1"></a>Note that this compares very favorably to the CIs estimated by assuming that the sampling distribution follows either a normal or $t$ distribution</span>
<span id="cb86-659"><a href="#cb86-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-660"><a href="#cb86-660" aria-hidden="true" tabindex="-1"></a><span class="fu">### Other Bootstrapping Options {.unnumbered}</span></span>
<span id="cb86-661"><a href="#cb86-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-662"><a href="#cb86-662" aria-hidden="true" tabindex="-1"></a>As is typically the case with ***R***, we have many choices for perform we might perform boostrapping! All of the options below are alternatives to the process we used above and generate similar bootstrap sampling distributions and corresponding CIs.</span>
<span id="cb86-663"><a href="#cb86-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-664"><a href="#cb86-664" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Using the {mosaic} Package {.unnumbered}</span></span>
<span id="cb86-665"><a href="#cb86-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-666"><a href="#cb86-666" aria-hidden="true" tabindex="-1"></a>We are already familiar with the <span class="in">`do(reps) *`</span> formulation from the {mosaic} package...</span>
<span id="cb86-667"><a href="#cb86-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-670"><a href="#cb86-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-671"><a href="#cb86-671" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="fu">do</span>(n_boot) <span class="sc">*</span> <span class="fu">mean</span>(<span class="sc">~</span> <span class="fu">sample</span>(s, <span class="fu">length</span>(s), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb86-672"><a href="#cb86-672" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot<span class="sc">$</span>mean,</span>
<span id="cb86-673"><a href="#cb86-673" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="dv">25</span>,</span>
<span id="cb86-674"><a href="#cb86-674" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1600</span>),</span>
<span id="cb86-675"><a href="#cb86-675" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Mean"</span>,</span>
<span id="cb86-676"><a href="#cb86-676" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Bootstrap Sampling Distribution</span><span class="sc">\n</span><span class="st">from do(reps) *"</span>)</span>
<span id="cb86-677"><a href="#cb86-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-678"><a href="#cb86-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-679"><a href="#cb86-679" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Using the {infer} Package {.unnumbered}</span></span>
<span id="cb86-680"><a href="#cb86-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-681"><a href="#cb86-681" aria-hidden="true" tabindex="-1"></a>Alternatively, can use the <span class="in">`rep_sample_n()`</span> function from the {infer} package to perform boostrapping. This function takes a data frame as an argument and randomly samples from that data frame a specified number of times (defined by the "size=" argument) to produce a large data object consisting of samples for each replicate and a column data that indicates which replicate each sample datum comes from. To use <span class="in">`rep_sample_n()`</span>, we need to first convert our original sample vector **s** into a data frame. We can then use <span class="in">`group_by()`</span> and <span class="in">`summarize()`</span> from {dplyr} to generate a bootstrap sampling distribution, as we did above.</span>
<span id="cb86-682"><a href="#cb86-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-685"><a href="#cb86-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-686"><a href="#cb86-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb86-687"><a href="#cb86-687" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb86-688"><a href="#cb86-688" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(s) <span class="sc">|&gt;</span></span>
<span id="cb86-689"><a href="#cb86-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep_sample_n</span>(<span class="at">size =</span> <span class="fu">length</span>(s), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">reps =</span> n_boot) <span class="sc">|&gt;</span></span>
<span id="cb86-690"><a href="#cb86-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(replicate) <span class="sc">|&gt;</span></span>
<span id="cb86-691"><a href="#cb86-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(s))</span>
<span id="cb86-692"><a href="#cb86-692" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot<span class="sc">$</span>mean,</span>
<span id="cb86-693"><a href="#cb86-693" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="dv">25</span>,</span>
<span id="cb86-694"><a href="#cb86-694" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>),</span>
<span id="cb86-695"><a href="#cb86-695" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Mean"</span>,</span>
<span id="cb86-696"><a href="#cb86-696" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Bootstrap Sampling Distribution</span><span class="sc">\n</span><span class="st">from rep_sample_n()"</span>)</span>
<span id="cb86-697"><a href="#cb86-697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-698"><a href="#cb86-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-699"><a href="#cb86-699" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Using the {boot} Package {.unnumbered}</span></span>
<span id="cb86-700"><a href="#cb86-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-701"><a href="#cb86-701" aria-hidden="true" tabindex="-1"></a>We can also use the fast and versatile {boot} package to do bootstrapping for any statistic.</span>
<span id="cb86-702"><a href="#cb86-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-703"><a href="#cb86-703" aria-hidden="true" tabindex="-1"></a>For this approach, we define a custom function that we will use to generate the statistic we are interested in that we will then calculate for each bootstrapped sample:</span>
<span id="cb86-704"><a href="#cb86-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-707"><a href="#cb86-707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-708"><a href="#cb86-708" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb86-709"><a href="#cb86-709" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb86-710"><a href="#cb86-710" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb86-711"><a href="#cb86-711" aria-hidden="true" tabindex="-1"></a><span class="co"># here, the `stat()` function we define calculates the mean value of a bootstrap sample</span></span>
<span id="cb86-712"><a href="#cb86-712" aria-hidden="true" tabindex="-1"></a><span class="co">#   taken with replacement from a vector of interest passed into `data`</span></span>
<span id="cb86-713"><a href="#cb86-713" aria-hidden="true" tabindex="-1"></a><span class="co"># the function we write for `statistic=` has two arguments, a data set and a</span></span>
<span id="cb86-714"><a href="#cb86-714" aria-hidden="true" tabindex="-1"></a><span class="co">#   set of indices, generated at random by the `boot()` function, to sample</span></span>
<span id="cb86-715"><a href="#cb86-715" aria-hidden="true" tabindex="-1"></a><span class="co">#   from the dataset</span></span>
<span id="cb86-716"><a href="#cb86-716" aria-hidden="true" tabindex="-1"></a><span class="co"># this corresponds to the default argument `stype="i"` in the `boot()` call</span></span>
<span id="cb86-717"><a href="#cb86-717" aria-hidden="true" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb86-718"><a href="#cb86-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(data[indices])) </span>
<span id="cb86-719"><a href="#cb86-719" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-720"><a href="#cb86-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-721"><a href="#cb86-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-722"><a href="#cb86-722" aria-hidden="true" tabindex="-1"></a>Then, we run the <span class="in">`boot()`</span> function passing in the data to be resampled from ("data="), the statistic we want to calculate ("statistic="), and the number of bootstrap replicates (or "resamples") we want using the argument "R=".</span>
<span id="cb86-723"><a href="#cb86-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-726"><a href="#cb86-726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-727"><a href="#cb86-727" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: last</span></span>
<span id="cb86-728"><a href="#cb86-728" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> s, <span class="at">statistic =</span> stat, <span class="at">R =</span> n_boot) <span class="co"># stype="i" by default</span></span>
<span id="cb86-729"><a href="#cb86-729" aria-hidden="true" tabindex="-1"></a><span class="co"># the object returned includes a table, `t`, of `stat`s results from each</span></span>
<span id="cb86-730"><a href="#cb86-730" aria-hidden="true" tabindex="-1"></a><span class="co">#   bootstrap</span></span>
<span id="cb86-731"><a href="#cb86-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-732"><a href="#cb86-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-733"><a href="#cb86-733" aria-hidden="true" tabindex="-1"></a>Again, it is interesting to plot the bootstrap sampling distibution and compare methods for calculating CIs.</span>
<span id="cb86-734"><a href="#cb86-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-737"><a href="#cb86-737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-738"><a href="#cb86-738" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: last</span></span>
<span id="cb86-739"><a href="#cb86-739" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the results and comparing methods for calculating CIs</span></span>
<span id="cb86-740"><a href="#cb86-740" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb86-741"><a href="#cb86-741" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot<span class="sc">$</span>t, <span class="at">breaks =</span> <span class="dv">25</span>,</span>
<span id="cb86-742"><a href="#cb86-742" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>),</span>
<span id="cb86-743"><a href="#cb86-743" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Mean"</span>,</span>
<span id="cb86-744"><a href="#cb86-744" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Bootstrap Sampling Distribution</span><span class="sc">\n</span><span class="st">from boot()"</span>)</span>
<span id="cb86-745"><a href="#cb86-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-746"><a href="#cb86-746" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(boot<span class="sc">$</span>t), <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">3</span>) <span class="co"># mean of our simulated samples</span></span>
<span id="cb86-747"><a href="#cb86-747" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">mean</span>(boot<span class="sc">$</span>t) <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"mean of bootstrap distribution "</span>,</span>
<span id="cb86-748"><a href="#cb86-748" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-749"><a href="#cb86-749" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(s), <span class="at">col=</span><span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb86-750"><a href="#cb86-750" aria-hidden="true" tabindex="-1"></a><span class="co"># mean of our original vector of samples, s</span></span>
<span id="cb86-751"><a href="#cb86-751" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">mean</span>(s) <span class="sc">-</span> <span class="fl">0.125</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"mean of original sample"</span>,</span>
<span id="cb86-752"><a href="#cb86-752" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-753"><a href="#cb86-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-754"><a href="#cb86-754" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate and plot bootstrap CIs</span></span>
<span id="cb86-755"><a href="#cb86-755" aria-hidden="true" tabindex="-1"></a>lower_boot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot<span class="sc">$</span>t, <span class="fl">0.025</span>)</span>
<span id="cb86-756"><a href="#cb86-756" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> lower_boot, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb86-757"><a href="#cb86-757" aria-hidden="true" tabindex="-1"></a>upper_boot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot<span class="sc">$</span>t, <span class="fl">0.975</span>)</span>
<span id="cb86-758"><a href="#cb86-758" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> upper_boot, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb86-759"><a href="#cb86-759" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> lower_boot <span class="sc">+</span> <span class="fl">0.25</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"lower CI - bootstrap"</span>,</span>
<span id="cb86-760"><a href="#cb86-760" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-761"><a href="#cb86-761" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> upper_boot <span class="sc">-</span> <span class="fl">0.125</span>, <span class="at">y =</span> <span class="dv">700</span>, <span class="st">"upper CI - bootstrap"</span>,</span>
<span id="cb86-762"><a href="#cb86-762" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">srt =</span> <span class="dv">90</span>, <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb86-763"><a href="#cb86-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-764"><a href="#cb86-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-765"><a href="#cb86-765" aria-hidden="true" tabindex="-1"></a>We can also use the <span class="in">`boot.ci()`</span> function from the {boot} package to calculate CIs for using various methods, although the available methods do not include exactly the one we most want, i.e., the quantile method. Instead, all the options for <span class="in">`boot.ci()`</span> generate equi-tailed CIs based on presumed theoretical shapes for the sampling distribution. The "basic" and "percent" intervals are the closest to the empirical quantile method.</span>
<span id="cb86-766"><a href="#cb86-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-769"><a href="#cb86-769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-770"><a href="#cb86-770" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: last</span></span>
<span id="cb86-771"><a href="#cb86-771" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb86-772"><a href="#cb86-772" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot<span class="sc">$</span>t, <span class="at">breaks =</span> <span class="dv">25</span>,</span>
<span id="cb86-773"><a href="#cb86-773" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>),</span>
<span id="cb86-774"><a href="#cb86-774" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Mean"</span>,</span>
<span id="cb86-775"><a href="#cb86-775" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Bootstrap Sampling Distribution</span><span class="sc">\n</span><span class="st">from boot()"</span>)</span>
<span id="cb86-776"><a href="#cb86-776" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot)</span>
<span id="cb86-777"><a href="#cb86-777" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>basic[<span class="dv">4</span>], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb86-778"><a href="#cb86-778" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>basic[<span class="dv">5</span>], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb86-779"><a href="#cb86-779" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>percent[<span class="dv">4</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb86-780"><a href="#cb86-780" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>percent[<span class="dv">5</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb86-781"><a href="#cb86-781" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>bca[<span class="dv">4</span>], <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb86-782"><a href="#cb86-782" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>bca[<span class="dv">5</span>], <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb86-783"><a href="#cb86-783" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>normal[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb86-784"><a href="#cb86-784" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci<span class="sc">$</span>normal[<span class="dv">3</span>], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb86-785"><a href="#cb86-785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-786"><a href="#cb86-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-787"><a href="#cb86-787" aria-hidden="true" tabindex="-1"></a>These alternative CIs are all very close to one another and are close to what we calculated using the <span class="in">`quantile()`</span> approach!</span>
<span id="cb86-788"><a href="#cb86-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-789"><a href="#cb86-789" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb86-790"><a href="#cb86-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-791"><a href="#cb86-791" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How does the CI calculated by bootstrap simulation compare to that calculated based on assuming a normal or $t$ distribution?</span>
<span id="cb86-792"><a href="#cb86-792" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How does the width of the CI change with decreasing or increasing $n$ (the number of observations drawn from your sample with replacement)? For example, if we set $n$ at 5? At 50? At 500?</span>
<span id="cb86-793"><a href="#cb86-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-796"><a href="#cb86-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-797"><a href="#cb86-797" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb86-798"><a href="#cb86-798" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>infer)</span>
<span id="cb86-799"><a href="#cb86-799" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>boot)</span>
<span id="cb86-800"><a href="#cb86-800" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>manipulate)</span>
<span id="cb86-801"><a href="#cb86-801" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>mosaic)</span>
<span id="cb86-802"><a href="#cb86-802" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>tidyverse)</span>
<span id="cb86-803"><a href="#cb86-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-804"><a href="#cb86-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-805"><a href="#cb86-805" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb86-806"><a href="#cb86-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-807"><a href="#cb86-807" aria-hidden="true" tabindex="-1"></a><span class="fu">## Concept Review {.unnumbered}</span></span>
<span id="cb86-808"><a href="#cb86-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-809"><a href="#cb86-809" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We can generate confidence intervals around a statistic (e.g., a mean) estimated from a sample as:</span>
<span id="cb86-810"><a href="#cb86-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-811"><a href="#cb86-811" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>*mean* $±$ *critical value* (i.e., the relevant quantile for the standardized version of a particular theoretical sampling distribution such as the normal or Student's $t$) $\times$ *standard error* in the statistic, which is typically estimated as the standard deviation of a sample divided by the square root of the sample size, or $\frac{s}{\sqrt{n}}$</span>
<span id="cb86-812"><a href="#cb86-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-813"><a href="#cb86-813" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bootstrapping allows us to estimate confidence intervals by simulation from a sample, without assuming a particular shape for the sampling distribution</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>