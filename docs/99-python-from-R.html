<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applied Data Analysis - Using Python from R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./99-shiny.html" rel="next">
<link href="./99-r-packages.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>


<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./99-maximum_likelihood.html">Part III - Miscellany</a></li><li class="breadcrumb-item"><a href="./99-python-from-R.html">Using <strong><em>Python</em></strong> from <strong><em>R</em></strong></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-logistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Logistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course-schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-typography-and-formatting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Typography and Formatting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-programming-style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming Style Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>RStudio</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extending the Functionality of <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamentals of the <strong><em>R</em></strong> Language</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basics of Version Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Additional Data Structures in <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting Data into <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Functions and Flow Control</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part II - Statistics and Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Descriptive Statisics and Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Using Permutation Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Elements of Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression and ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Model Selection in Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Mixed Effects or Multilevel Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Part III - Miscellany</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-maximum_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Maximum Likelihood Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-geospatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Geospatial Data Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-r-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building Custom <strong><em>R</em></strong> Packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-python-from-R.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Using <strong><em>Python</em></strong> from <strong><em>R</em></strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building Interactive Web Apps</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 07</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 08</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-08-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 08 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 09</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 10</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-analysis-replication-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis Replication</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Packages Used</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link" data-scroll-target="#preliminaries">Preliminaries</a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a></li>
  <li><a href="#getting-started-with-reticulate" id="toc-getting-started-with-reticulate" class="nav-link" data-scroll-target="#getting-started-with-reticulate">Getting Started with {reticulate}</a>
  <ul class="collapse">
  <li><a href="#configuring-python" id="toc-configuring-python" class="nav-link" data-scroll-target="#configuring-python">Configuring <strong><em>Python</em></strong></a></li>
  <li><a href="#working-with-environments" id="toc-working-with-environments" class="nav-link" data-scroll-target="#working-with-environments">Working with Environments</a></li>
  <li><a href="#specifying-an-environment" id="toc-specifying-an-environment" class="nav-link" data-scroll-target="#specifying-an-environment">Specifying an Environment</a></li>
  <li><a href="#adding-modules" id="toc-adding-modules" class="nav-link" data-scroll-target="#adding-modules">Adding <strong><em>Python</em></strong> Modules</a></li>
  </ul></li>
  <li><a href="#python-code" id="toc-python-code" class="nav-link" data-scroll-target="#python-code">Using <strong><em>Python</em></strong> Code in <strong><em>R</em></strong></a>
  <ul class="collapse">
  <li><a href="#python-code-chunks" id="toc-python-code-chunks" class="nav-link" data-scroll-target="#python-code-chunks"><strong><em>Python</em></strong> Code Chunks</a></li>
  <li><a href="#importing-and-using-modules" id="toc-importing-and-using-modules" class="nav-link" data-scroll-target="#importing-and-using-modules">Importing and Using Modules</a></li>
  <li><a href="#sourcing-a-python-script" id="toc-sourcing-a-python-script" class="nav-link" data-scroll-target="#sourcing-a-python-script">Sourcing a <strong><em>Python</em></strong> Script</a></li>
  <li><a href="#using-python-interactively" id="toc-using-python-interactively" class="nav-link" data-scroll-target="#using-python-interactively">Using <strong><em>Python</em></strong> Interactively</a></li>
  </ul></li>
  <li><a href="#converting-data-objects" id="toc-converting-data-objects" class="nav-link" data-scroll-target="#converting-data-objects">Converting Data Objects</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./99-maximum_likelihood.html">Part III - Miscellany</a></li><li class="breadcrumb-item"><a href="./99-python-from-R.html">Using <strong><em>Python</em></strong> from <strong><em>R</em></strong></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="using-python" class="quarto-section-identifier">Using <strong><em>Python</em></strong> from <strong><em>R</em></strong></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="objectives" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="objectives">Objectives</h2>
<blockquote class="blockquote">
<p>In this module, we look at how to integrate <strong><em>Python</em></strong> code and functions into <strong><em>R</em></strong>.</p>
</blockquote>
</section>
<section id="preliminaries" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="preliminaries">Preliminaries</h2>
<ul>
<li>Install and load this package in <strong><em>R</em></strong>: <a href="https://cran.r-project.org/web/packages/reticulate/reticulate.pdf">{reticulate}</a></li>
<li>Load {tidyverse} and {broom}</li>
<li>Make sure you have a working <strong><em>Python</em></strong> installation on your computer <em>and</em> a package manager for <strong><em>Python</em></strong></li>
</ul>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Recent versions of the MacOS, Windows, and Linux operating systems typically include a <strong><em>Python</em></strong> installation by default, but that may not be an up-to-date version and the included package manager may not be comprehensive. Thus, for most users, it is worthwhile to download and install an updated version of <strong><em>Python</em></strong> along with a software system for managing <strong><em>Python</em></strong> libraries and environments.</p>
</blockquote>
<p><a href="https://www.anaconda.com/download"><strong><em>Anaconda</em></strong></a> is one such such system; it is a comprehensive, open-source distribution for <strong><em>Python</em></strong> (as well as other scientific computing software, including <strong><em>R</em></strong>, and <strong><em>RStudio</em></strong>, and <strong><em>Jupyter</em></strong> notebooks), and it provides an easy way to get an up-to-date version of <strong><em>Python</em></strong> installed. Binary <strong><em>Anaconda</em></strong> installers are available for most computer operating systems, including MacOS, Windows, and Linux. Running the installer basically installs a command-line package manager, <strong><em>conda</em></strong>, for all of these different pieces of software, as well as a graphical version of that manager and software launcher, named <strong><em>Anaconda-Navigator</em></strong>. Unless you specify otherwise, the current distribution of <strong><em>Anaconda</em></strong> should install (on MacOS) to a directory called <code>~/anaconda3</code> at the root of your user folder.</p>
<p>Alternatively, you can download and install a pared-down version of <strong><em>Anaconda</em></strong> called [<strong><em>Miniconda</em></strong>]((https://www.anaconda.com/download), which consists of just the <strong><em>conda</em></strong> package manager, <strong><em>Python</em></strong>, and a limited set of additional packages. You can download and install <strong><em>Miniconda</em></strong> yourself from this URL, in which case it should install to this directory on MacOS: <code>~/opt/miniconda3</code>.</p>
<blockquote class="blockquote">
<p><strong>NOTE</strong>: There is no need to install both <strong><em>Anaconda</em></strong> and <strong><em>Miniconda</em></strong>… choose one or the other! Both will write a series of PATH configuration lines to your shell profile, and, if you do install both, the latter one to be installed will overwrite the PATH details of the former in your default shell profile.</p>
</blockquote>
<p>Finally, you can download and install <strong><em>Miniconda</em></strong> from within {reticulate}. In fact, when you first run a function from <code>library(reticulate)</code>, you may see a prompt asking if you want to install <strong><em>Miniconda</em></strong>…</p>
<pre><code>No non-system installation of Python could be found.
Would you like to download and install Miniconda?
Miniconda is an open source environment management system for Python.
See https://docs.conda.io/en/latest/miniconda.html for more details.</code></pre>
<p>If so, you can answer “Y” and let the installation run. In doing so, the installer will create a directory at the base of your user folder called <code>~/Library/r-miniconda</code> with a <strong>conda</strong> installation in it. If you are not prompted to install <strong><em>Miniconda</em></strong>, you can install it manually using the {reticulate} command <code>install_miniconda()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install_miniconda</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE</strong>: This process installs <strong><em>Miniconda</em></strong> to a different location <em>and</em> does not add PATH configuration lines to your shell script. Thus, if you choose this route for <strong><em>Miniconda</em></strong> installation, it will be less easy to use the terminal to run <strong>conda</strong> commands as you would then need to manually configure your PATH.</p>
</blockquote>
</section>
<section id="background" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="background">Background</h2>
<p>One of the wonderful things about <strong><em>R</em></strong> is that it offers interoperability with several other programming languages useful for statistical analysis, data science, and data visualization, including <strong><em>Python</em></strong>, <strong><em>Stan</em></strong>, <strong><em>Julia</em></strong>, <strong><em>JavaScript</em></strong>, and <strong><em>C++</em></strong>. Here, we explore the {reticulate} package, which essentially embeds a <strong><em>Python</em></strong> session within your <strong><em>R</em></strong> session, allowing you the opportunity to smoothly integrate <strong><em>Python</em></strong> code into <strong><em>R</em></strong> workflows and analyses through the <strong><em>RStudio</em></strong> IDE. For additional details, see the information on the {reticulate} package’s website <a href="https://rstudio.github.io/reticulate/">R Interface to <strong><em>Python</em></strong></a> website.</p>
<p>With {reticulate}, we can call <strong><em>Python</em></strong> code from <strong><em>R</em></strong> in several ways:</p>
<ul>
<li>By including <strong><em>Python</em></strong> code chunks within an <strong>R Markdown</strong> document</li>
<li>By importing <strong><em>Python</em></strong> modules into <strong><em>R</em></strong> and accessing their functions</li>
<li>By sourcing entire <strong><em>Python</em></strong> scripts (“.py” files)</li>
<li>By using <strong><em>Python</em></strong> interactively within an <strong><em>R</em></strong> session</li>
</ul>
<p>We can also use {reticulate} to convert between <strong><em>R</em></strong> and <strong><em>Python</em></strong> objects (e.g., between <strong><em>R</em></strong> and <strong><em>Python</em></strong> {pandas} data frames).</p>
</section>
<section id="getting-started-with-reticulate" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="getting-started-with-reticulate">Getting Started with {reticulate}</h2>
<section id="configuring-python" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="configuring-python">Configuring <strong><em>Python</em></strong></h3>
<p>Many computers may have several different iterations of <strong><em>Python</em></strong> installed in different places. Upon loading {reticulate} and first calling the <strong><em>Python</em></strong> function <code>import</code>, either directly or implicitly , <strong><em>R</em></strong> tries to find and “attach” to one of these versions. To control the process, it is recommended that you specify or build a desired <strong><em>Python</em></strong> version and then pass this suggested instance to {reticulate}. Restarting <strong><em>R</em></strong> will unbind an instance and allow you to specify a different one.</p>
<p>The <strong><em>R</em></strong> commands <code>Sys.which("python")</code> and <code>Sys.which("python3")</code> will return the path to the current version of <strong><em>Python</em></strong> (for pre-version 3 installations) and <strong><em>Python3</em></strong>, respectively that <strong><em>R</em></strong> has bound. Unless you specify a <strong><em>Python</em></strong> instance from a particular “environment” (see below), these will usually be “/usr/bin/python” and “/usr/bin/python3” or “/usr/local/bin/python” and “/usr/local/bin/python3”. [Sometimes, the path returned by these functions is actually a <em>symlink</em>, a kind of pointer, to the actual executable file.]</p>
<blockquote class="blockquote">
<p><strong>NOTE</strong>: If your computer does not have an older, pre-3.0 version of <strong><em>Python</em></strong> installed, <code>Sys.which("python")</code> may return a blank path or the path to a 3.0 version of <strong><em>Python</em></strong>.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">"python"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">"python3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After loading {reticulate}, if you run the function <code>py_config()</code>, it will return information on the version of and path to the <strong><em>Python</em></strong> binary (executable program) and associated libraries that {reticulate} is currently bound to, It also returns the version and location of {numpy}, an important <strong><em>Python</em></strong> library for maths, if it is installed.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## python:         /opt/anaconda3/bin/python3.11
## libpython:      /opt/anaconda3/lib/libpython3.11.dylib
## pythonhome:     /opt/anaconda3:/opt/anaconda3
## version:        3.11.7 (main, Dec 15 2023, 12:09:56) [Clang 14.0.6 ]
## numpy:          /opt/anaconda3/lib/python3.11/site-packages/numpy
## numpy_version:  1.26.4
## 
## NOTE: Python version was forced by RETICULATE_PYTHON_FALLBACK</code></pre>
</div>
</div>
<p>You can specify or change the instance of <strong><em>Python</em></strong> that {reticulate} uses via the <strong><em>RStudio</em></strong> IDE by going either the <em>Preferences</em> (MacOS) or <em>Global Options</em> (MacOS or PC) dialog box and selecting the <em>Python</em> section…</p>
<p>… and then choosing the desired <strong><em>Python</em></strong> interpreter from the dialog boxes. <strong><em>RStudio</em></strong> will try to highlight all available <strong><em>Python</em></strong> interpreters for you, either ones installed in the system (e.g., distributed with MacOS) or ones associated with different virtual or conda “environments” (see below) that you have created. You can also type the path to the version of the <strong><em>Python</em></strong> interpreter you wish to using directly into the dialog box. After you click, “Apply” you will be prompted to restart <strong><em>R</em></strong> to allow {reticulate} be able to rebind to a different interpreter.</p>
<p>After <strong><em>R</em></strong> restarts, reload {reticulate}, then call <code>py_config()</code> to verify that {reticulate} is connected to the desired <strong><em>Python</em></strong> executable.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> After changing the bound version of <strong><em>Python</em></strong> in this manner and running py_config(), the last line of the output should read as follows:</p>
<p>NOTE: Python version was forced by use_python() function</p>
</blockquote>
<p>Note that specification of the <strong><em>Python</em></strong> interpreter in this manner is “sticky”. That is, if an interpreter is specified in <em>Global Options</em>, then that takes precedence over assigning an interpreter with <code>use_python()</code> or by assigning an environment (see below). That is, if you specify a version of <strong><em>Python</em></strong> to use in <em>Global Options</em>, you will not be able change to a different interpreter or specify what environment to use via code.</p>
<p>If we do not use <em>Global Options</em> or <em>Preferences</em> to specify an interpreter, we can instead directly suggest what <strong><em>Python</em></strong> interpreter that {reticulate} should use from <strong><em>R</em></strong> by calling the <code>use_python()</code> function with the path to the interpreter as an argument. For example, as noted above, the current <strong><em>Anaconda</em></strong> distribution typically installs its own version of <strong><em>Python</em></strong> at “~/anaconda3/bin/python”, thus we could specify that we want {reticulate} to bind to that version as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">"~/anaconda3/bin/python"</span>, <span class="at">required =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>()  <span class="co"># confirm our selection</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similarly, as described above, the <strong><em>Miniconda</em></strong> version of the <strong>conda</strong> package manager installed from within {reticulate} places its version of <strong><em>Python</em></strong> inside a user’s <code>Library</code> directory, at “~/Library/r-miniconda/bin/python”. We can set {reticulate} to bind that version using the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">"~/Library/r-miniconda/bin/python"</span>, <span class="at">required =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>()  <span class="co"># confirm our selection</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, it is important to remember that if you want to modify the particular instance of <strong><em>Python</em></strong> that {reticulate} should to attach to, it is necessary to first RESTART <strong><em>R</em></strong>, which you can do either in <strong><em>RStudio</em></strong> (by choosing that option from the <strong>Session</strong> menu) or by using the function <code>.rs.restartR()</code> at a command prompt), then load {reticulate} again, and then run the <code>use_python()</code> function. After doing this, you can run <code>py_config()</code> again to confirm that the <strong><em>Python</em></strong> configuration has indeed changed as desired, and you can check with <code>Sys.which("python")</code> or <code>Sys.which("python3")</code> to confirm what instance of <strong><em>Python</em></strong> is attached. For example…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.rs.restartR</span>()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">"~/Library/r-miniconda/bin/python"</span>, <span class="at">required =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>()  <span class="co"># confirm our selection</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">"python3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> After changing the bound version of <strong><em>Python</em></strong> in this manner and running py_config(), the last line of the output should read as follows:</p>
<p>NOTE: Python version was forced by use_python function</p>
</blockquote>
<p>Note that changing the intepreter this way is <strong>not</strong> “sticky.” That is, if you were to restart <strong><em>R</em></strong> again, load {reticulate}, and run <code>py_config()</code> without specifying a configuration using <code>use_python()</code>, {reticulate} will scan along your PATH and other possible places where <strong><em>Python</em></strong> might be installed to find the first appropriate instance, giving preference to one where {numpy} is present as that library is very important for integrating <strong><em>Python</em></strong> and <strong><em>R</em></strong>. Importantly, this may find a version of <strong><em>Python</em></strong> not associated with any particular “environment” (see below).</p>
</section>
<section id="working-with-environments" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="working-with-environments">Working with Environments</h3>
<p>Whenever we work with <strong><em>Python</em></strong>, it is best to do so in the context of an “environment”. An <strong>environment</strong> (such as the “r-reticulate” environment created by default by installing <strong><em>Miniconda</em></strong>) is basically a folder that contains all the necessary executables and <strong><em>Python</em></strong> <strong>modules</strong> (which are akin to <strong><em>R</em></strong> packages) that a particular <strong><em>Python</em></strong> project needs. An environment is kind of analogous to a repository containing an <strong>R Project</strong>, except that in <strong><em>R Projects</em></strong>, the <strong><em>R</em></strong> executable and all of the packages used in a project are not physically replicated in each repository the way that a <strong><em>Python</em></strong> executable and referenced modules are (often) replicated within the environment. When we install any specific module that we want to are going to use in a script, we typically install it to a specific working environment.</p>
<p>Using environments is a way of isolating and keeping different versions of modules independent so as not to “break” our code when modules are updated. They also allow us to experiment with different <strong><em>Python</em></strong> setups.</p>
<p><strong><em>Python</em></strong> and {reticulate} support two different types of environments, <strong>conda</strong> environments, which are managed by <strong>conda</strong> and “virtual environments”. We will focus first on <strong>conda</strong> environments.</p>
<section id="conda-environments" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="conda-environments"><strong>conda</strong> Environments</h4>
<p>The {reticulate} function <code>conda_list()</code> can be used to list all of the different <strong>conda</strong> environments that are registered within <strong>conda</strong> installations on our computer, along with a path to the <strong><em>Python</em></strong> binary associated with the environment.</p>
<blockquote class="blockquote">
<p><strong>NOTE</strong>: Sometimes the path returned by <code>conda_list()</code> is a <em>symlink</em> to the actual executable file. That is, the <em>symlink</em> is located in the environment folder while the actual executable file resides in a different folder like <code>/usr/bin/</code> or <code>/usr/local/bin</code>.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conda_list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##           name                                      python
## 1         base                   /opt/anaconda3/bin/python
## 2   DEEPLABCUT   /opt/anaconda3/envs/DEEPLABCUT/bin/python
## 3 r-reticulate /opt/anaconda3/envs/r-reticulate/bin/python</code></pre>
</div>
</div>
<p>After running this command, you should see two or three environments listed, depending on whether you installed <strong><em>Anaconda</em></strong>, <strong><em>Miniconda</em></strong> through {reticulate}, or both. Installing <strong><em>Anaconda</em></strong> should have created an environment called “anaconda3” by default, while installing <strong><em>Miniconda</em></strong> through {reticulate} should have created two environments, one called “base” and one called “r-reticulate”.</p>
<p>You can set up other new environments by running the function <code>conda_create()</code> and specifying a different environment name as an argument.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> By default, if no environments have yet been defined, the <code>conda_create()</code> function creates one named “r-reticulate”. This is what the <strong><em>Miniconda</em></strong> installer ran behind the scenes to create the default “r-reticulate” environment. But we can also provide an alternative name within the particular active <strong>conda</strong> installation.</p>
</blockquote>
<p>When you create a new environment with <code>conda_create()</code>, it will be set up inside of the <code>envs/</code> directory in which our <strong>conda</strong> installation resides (again, if using <strong><em>Miniconda</em></strong>, this should be within the <code>~/Library/r-miniconda/</code> directory. Environments created with this function will include a default suite of <strong><em>Python</em></strong> packages that {reticulate} will have access to. They will also be associated with the particular instance of <strong><em>Python</em></strong> that is currently bound to {reticulate}, unless we specify otherwise using the “python_version=” argument.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new **conda** environment named 'my-environment'</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">conda_create</span>(<span class="st">"my-environment"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">conda_list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The {reticulate} function <code>conda_remove()</code> will delete a particular <strong>conda</strong> environment.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conda_remove</span>(<span class="st">"my-environment"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">conda_list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="specifying-an-environment" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="specifying-an-environment">Specifying an Environment</h3>
<p>If we have more than one <strong>conda</strong> environment set up on our machines, perhaps with different <strong><em>Python</em></strong> modules installed and/or using different versions of <strong><em>Python</em></strong>, we can use the functions <code>use_miniconda(condaenv=)</code> or <code>use_condaenv(condaenv=)</code> to “activate” a particular environment, i.e., to specify which one you want to bind to a particular <strong><em>R</em></strong> and {reticulate} session. [The “r-reticulate” environment set up by <strong><em>Miniconda</em></strong>, if present, is the one that will be used by default if no other environment is specified.] Given that each environment contains a <strong><em>Python</em></strong> executable (or path to an executable), this is an alternative to <code>use_python()</code> as a way of also specifying a <strong><em>Python</em></strong> version for a particular project. Specifying an environment to use is analogous to opening a particular <strong><em>R Project</em></strong> from a repository.</p>
<p>As for <code>use_python()</code>, the way to force use of a non-default environment is to restart <strong><em>R</em></strong>, load {reticulate}, and run the function <code>use_miniconda()</code> (or, equivalently, <code>use_condaenv()</code>) as below, after which running <code>py_config()</code> should confirm the configuration.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.rs.restartR</span>()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_miniconda</span>(<span class="at">condaenv =</span> <span class="st">"r-reticulate"</span>, <span class="at">required =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or use_condaenv(condaenv = 'r-reticulate', required = TRUE)</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">"python3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> It is a good idea to include the argument <code>required=TRUE</code>, which ensures that an error will be thrown if the specified environment is not found.</p>
</blockquote>
<p>It is possible to also run all of these <strong>conda</strong> functions at the command prompt in a terminal…</p>
<pre><code># to list your conda environments and show which one is active
$ conda info --envs

# OR
$ conda env list</code></pre>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Doing this from the command line shows an asterisk next to an environment called “base” that is a default environment that was created when we first installed <strong><em>Anaconda</em></strong> (as opposed to <strong><em>Miniconda</em></strong>) and is associated with your base <strong>conda</strong> installation. This is typically at the path: “~/anaconda3” in current <strong><em>Anaconda</em></strong> installations.</p>
</blockquote>
<pre><code># to create a conda environment
$ conda create --name my-environment

# to create a conda environment with a specific version of Python
# this will install an executable for the specified version
# of Python within the environment
$ conda create --name my-environment python=3.9

# to activate an environment
$ conda activate my-environment</code></pre>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Running <code>conda env list</code> after activating a different environment shows the asterisk next to the newly activated environment.</p>
</blockquote>
<pre><code># to list the packages in the active environment
$ conda list

# to deactivate an active environment and return to *base*
$ conda deactivate

# to remove an environment
$ conda remove --name my-environment --all</code></pre>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> An active environment needs to be deactivated before it can be removed.</p>
</blockquote>
<p>The <a href="https://docs.conda.io/projects/conda/en/latest/index.html"><strong>conda</strong> documentation</a> provides further details on how to use the <strong>conda</strong> package and environment management system that is central to the <strong><em>Anaconda</em></strong> and <strong><em>Miniconda</em></strong> distributions.</p>
<section id="virtual-environments" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="virtual-environments">“Virtual” Environments</h4>
<p>As noted above, {reticulate} actually supports using two different <strong><em>Python</em></strong> environment flavors: **conda*“** environments (as we set up above) and”virtual” environments. The former are stored inside of a directory called <code>envs/</code> that sits within a particular <strong>conda</strong> installation. The latter type of environments are typically stored in a hidden directory called <code>.virtualenvs/</code> at the root of your user folder.</p>
<p>To create and use “virtual” rather than <strong>conda</strong> environments with {reticulate}, the commands are very similar. Unless otherwise specified, the environment created will be bound to the <strong><em>Python</em></strong> interpreter associated with the current {reticulate} and <strong><em>R</em></strong> session.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">virtualenv_create</span>(<span class="at">envname =</span> <span class="st">"r-reticulate"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">virtualenv_create</span>(<span class="at">envname =</span> <span class="st">"my-environment"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">virtualenv_list</span>()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">virtualenv_remove</span>(<span class="at">envname =</span> <span class="st">"my-environment"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">use_virtualenv</span>(<span class="at">virtualenv =</span> <span class="st">"r-reticulate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once we have bound {reticulate} to a particular <strong>conda</strong> or “virtual” environment, we can check/confirm how our setup is configured by running <code>py_config()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="adding-modules" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="adding-modules">Adding <strong><em>Python</em></strong> Modules</h3>
<p>The {reticulate} package includes the simple function <code>py_install()</code> that can be used to install one or more <strong><em>Python</em></strong> modules into a specified environment (either a <strong>conda</strong> environment, as we created above, or a “virtual environment” if we are using that flavor of environment instead). With <code>py_install()</code>, new modules, by default, will be installed into the environment named “r-reticulate” (though this can be changed by specifying the “envname=” argument).</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Alternatively, the function <code>conda_install(envname, packages)</code> will install python modules into a particular, specified <strong>conda</strong> environment, and the function <code>virtualenv_install(envname, packages)</code> will install packages into into a particular virtual environment, but <code>py_install()</code> is sufficient for our purposes.</p>
</blockquote>
<p>Below, we install the python modules {scipy}, {numpy}, {pandas}, {matplotlib}, and {seaborn}, which are used in the subsequent <strong><em>Python</em></strong> coding examples, into the “r-reticulate” <strong><em>Miniconda</em></strong> environment.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> In the function below, the <code>envname=</code> argument does not need to specified, but I have included it anyway.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"numpy"</span>, <span class="st">"scipy"</span>, <span class="st">"pandas"</span>, <span class="st">"matplotlib"</span>, <span class="st">"seaborn"</span>, <span class="st">"statsmodels"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">py_install</span>(<span class="at">envname =</span> <span class="st">"r-reticulate"</span>, <span class="at">packages =</span> p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## + /opt/anaconda3/bin/conda install --yes --name r-reticulate -c conda-forge numpy scipy pandas matplotlib seaborn statsmodels</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or conda_install(envname = 'r-reticulate', packages = p) or</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># virtualenv_install(envname = 'r-reticulate', packages = p, required = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also use standard shell installation utilities at a terminal prompt (e.g., <code>conda</code> or <code>pip</code>) to activate an environment and to install <strong><em>Python</em></strong> modules.</p>
<pre><code># to activate an environment...
$ conda activate r-reticulate

# to install a module into an active conda environment...
$ conda install scipy

# or to install into a different, named environment, e.g., r-reticulate
$ conda install --name r-reticulate scipy

# to install a module into system level Python (i.e., globally, instead of in a specified environment)
$ sudo pip install scipy</code></pre>
</section>
</section>
<section id="python-code" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="python-code">Using <strong><em>Python</em></strong> Code in <strong><em>R</em></strong></h2>
<p>As mentioned in the introduction above, there are multiple ways to integrate <strong><em>Python</em></strong> code into your <strong><em>R</em></strong> projects and workflow. You can…</p>
<ul>
<li><p>Include <strong><em>Python</em></strong> code chunks in <strong>R Markdown</strong> documents</p>
<p><strong>R Markdown</strong> now includes a language engine that supports bi-directional communication between <strong><em>R</em></strong> and Python (<strong><em>R</em></strong> chunks can access Python objects and vice-versa).</p></li>
<li><p>Import <strong><em>Python</em></strong> modules to access their functions directly from <strong><em>R</em></strong></p>
<p>The <code>import()</code> function from {reticulate} enables you to import any Python module and call its functions directly from R.</p></li>
<li><p>Source a <strong><em>Python</em></strong> script from <strong><em>R</em></strong></p>
<p>The <code>source_python()</code> function from {reticulate} enables you to source a Python script the same way you would <code>source()</code> an <strong><em>R</em></strong> script. Python functions and objects defined within the script become directly available to the <strong><em>R</em></strong> session.</p></li>
<li><p>Use a <strong><em>Python</em></strong> REPL (“Read-Eval-Print Loop”)</p>
<p>The <code>repl_python()</code> function embeds an interactive Python console within <strong><em>R</em></strong> that you can use interactively, as you would the <strong><em>R</em></strong> console. Objects you create within Python are available to your <strong><em>R</em></strong> session, and vice-versa.</p></li>
</ul>
<p>More detail on each of these approaches, and examples, are given below.</p>
<section id="python-code-chunks" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="python-code-chunks"><strong><em>Python</em></strong> Code Chunks</h3>
<p>The following example <strong><em>Python</em></strong> code chunk, which can be included in an “.Rmd” document, imports the zombie apocalypse survivors datafile from <strong>GitHub</strong> and plots a linear model of height~age and a boxplot of height~gender. Note that the chunk type is <code>{python}</code> not <code>{r}</code>!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a Python code chunk</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> pandas.read_csv(f)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(z.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##    id first_name  ...                            major        age
## 0   1      Sarah  ...                 medicine/nursing  17.642745
## 1   2       Mark  ...  criminal justice administration  22.589513
## 2   3    Brandon  ...                        education  21.912760
## 3   4      Roger  ...                   energy studies  18.190582
## 4   5      Tammy  ...                        logistics  21.103986
## 
## [5 rows x 10 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> z[[<span class="st">'gender'</span>, <span class="st">'height'</span>, <span class="st">'weight'</span>, <span class="st">'age'</span>, <span class="st">'major'</span>]]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create a plot using the python seaborn module</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> seaborn.pairplot(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> z,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  hue <span class="op">=</span> <span class="st">'gender'</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  kind <span class="op">=</span> <span class="st">'scatter'</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  plot_kws <span class="op">=</span> <span class="bu">dict</span>(alpha <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## /opt/anaconda3/lib/python3.11/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
##   with pd.option_context('mode.use_inf_as_na', True):
## /opt/anaconda3/lib/python3.11/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
##   with pd.option_context('mode.use_inf_as_na', True):
## /opt/anaconda3/lib/python3.11/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
##   with pd.option_context('mode.use_inf_as_na', True):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the active plot object</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.show(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="99-python-from-R_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="816"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.clf()</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> seaborn.boxplot(x<span class="op">=</span><span class="st">"gender"</span>, y<span class="op">=</span><span class="st">"height"</span>, data<span class="op">=</span>z)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the active plot object</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.show(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="99-python-from-R_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># type `exit` at the Python prompt to exit the REPL</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>exit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Use exit() or Ctrl-D (i.e. EOF) to exit</code></pre>
</div>
</div>
</section>
<section id="importing-and-using-modules" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="importing-and-using-modules">Importing and Using Modules</h3>
<p>Running the <code>import()</code> command in <strong><em>R</em></strong> will load functions and other data from within <strong><em>Python</em></strong> modules and classes directly into <strong><em>R</em></strong>. The functions and data included in the <strong><em>Python</em></strong> module can then be accessed via the <code>$</code> operator, analogous to the way they would when we interact with an <strong><em>R</em></strong> object.</p>
<p>Imported <strong><em>Python</em></strong> modules also support code completion and inline help, again paralleling what we see with <strong><em>R</em></strong> packages.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pandas <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"pandas"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>seaborn <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"seaborn"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>matplotlib <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"matplotlib"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> pandas<span class="sc">$</span><span class="fu">read_csv</span>(f)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##   id first_name last_name gender   height   weight zombies_killed
## 1  1      Sarah    Little Female 62.88951 132.0872              2
## 2  2       Mark    Duncan   Male 67.80277 146.3753              5
## 3  3    Brandon     Perez   Male 72.12908 152.9370              1
## 4  4      Roger   Coleman   Male 66.78484 129.7418              5
## 5  5      Tammy    Powell Female 64.71832 132.4265              4
## 6  6    Anthony     Green   Male 71.24326 152.5246              1
##   years_of_education                           major      age
## 1                  1                medicine/nursing 17.64275
## 2                  3 criminal justice administration 22.58951
## 3                  1                       education 21.91276
## 4                  6                  energy studies 18.19058
## 5                  3                       logistics 21.10399
## 6                  4                  energy studies 21.48355</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a plot using the python seaborn module</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> seaborn<span class="sc">$</span><span class="fu">lmplot</span>(<span class="at">x =</span> <span class="st">"age"</span>, <span class="at">y =</span> <span class="st">"height"</span>, <span class="at">data =</span> z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Because there is sometimes some awkwardness with using the {matplotlib} <strong><em>Python</em></strong> module from within <strong><em>R</em></strong>, we can switch back to a {python} chunk to print out the figure created…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>r.p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="99-python-from-R_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="244"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the active plot object created with the R code above</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.show(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="99-python-from-R_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># type `exit` at the Python prompt to exit the REPL</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>exit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Use exit() or Ctrl-D (i.e. EOF) to exit</code></pre>
</div>
</div>
</section>
<section id="sourcing-a-python-script" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sourcing-a-python-script">Sourcing a <strong><em>Python</em></strong> Script</h3>
<p>We can use the <code>source_python()</code> function in <strong><em>R</em></strong> to source a <strong><em>Python</em></strong> script the same way we would source() an <strong><em>R</em></strong> script. We give the function the path to the file to load in and run as an argument. This process assumes the “.py” script is stored in a directory called <code>src/</code> located in the current working directory. The script loads in the zombie apocalypse survivors dataset from <strong>GitHub</strong> and then plots a boxplot of weight~gender.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"python_script.py"</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source_python</span>(<span class="fu">paste0</span>(<span class="fu">getwd</span>(), <span class="st">"/src/"</span>, f))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##    first_name last_name  ...                            major        age
## id                       ...                                            
## 1       Sarah    Little  ...                 medicine/nursing  17.642745
## 2        Mark    Duncan  ...  criminal justice administration  22.589513
## 3     Brandon     Perez  ...                        education  21.912760
## 4       Roger   Coleman  ...                   energy studies  18.190582
## 5       Tammy    Powell  ...                        logistics  21.103986
## 
## [5 rows x 9 columns]</code></pre>
</div>
</div>
<p>As above, we switch to a {python} chunk to print out the figures created…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>r.p</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the active plot object created with the sourced python code</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.show(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="99-python-from-R_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># type `exit` at the Python prompt to exit the REPL</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>exit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Use exit() or Ctrl-D (i.e. EOF) to exit</code></pre>
</div>
</div>
</section>
<section id="using-python-interactively" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="using-python-interactively">Using <strong><em>Python</em></strong> Interactively</h3>
<p>Finally, if you want to work with <strong><em>Python</em></strong> interactively, you can call the <code>repl_python()</code> function from <strong><em>R</em></strong>, which provides a <strong><em>Python</em></strong> REPL (“Read–Eval–Print Loop”) session embedded within your <strong><em>R</em></strong> session.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">repl_python</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To test this out, copy and paste each of the following lines singly at the <strong><em>Python</em></strong> console prompt (<code>&gt;&gt;&gt;</code>).</p>
<pre><code>import pandas
import seaborn
import matplotlib
f = "https://raw.githubusercontent.com/difiore/ADA-datasets/master/zombies.csv"
z = pandas.read_csv(f)
print(z.head())
seaborn.lmplot(x="weight", y="height", data=z)
matplotlib.pyplot.show()
exit</code></pre>
</section>
</section>
<section id="converting-data-objects" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="converting-data-objects">Converting Data Objects</h2>
<p>One of the great things about {reticulate} allows us to share variables and states of <strong><em>Python</em></strong> objects across <strong><em>Python</em></strong> code chunks within the same <strong>R Markdown</strong> document, the same way we can with <strong><em>R</em></strong> code chunks.</p>
<p>It also allows us to access objects created within <strong><em>Python</em></strong> code chunks from <strong><em>R</em></strong> using the <code>py</code> object (e.g., we can use <code>py$age</code> would access a variable, <strong>age</strong> created within <strong><em>Python</em></strong> from <strong><em>R</em></strong>).</p>
<p>Likewise, {reticulate} allows us to access objects created within <strong><em>R</em></strong> chunks from <strong><em>Python</em></strong> using the <code>r</code> object (e.g., we could use <code>r.sex</code> to access a variable named <strong>sex</strong> that was created within <strong><em>R</em></strong> from inside a <strong><em>Python</em></strong> code chunk).</p>
<p>{reticulate} supports built-in conversion between <strong><em>Python</em></strong> and <strong><em>R</em></strong> for many <strong><em>Python</em></strong> objects, including {numpy} arrays and {pandas} data frames.</p>
<p><strong>EXAMPLE:</strong></p>
<p>Here, we run a {python} chunk and load in a familiar data file from over the web…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/woollydata.csv"</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> pandas.read_csv(f)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(d.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##       name  success    age    rank
## 0    Aaron       15   9.80  medium
## 1     Adam       14  12.06  medium
## 2  Agustin       22  16.33    high
## 3     Alan        9   8.79     low
## 4   Andrew       12   6.81     low</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>exit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Use exit() or Ctrl-D (i.e. EOF) to exit</code></pre>
</div>
</div>
<p>… then we run an {r} chunk that accesses and uses the <strong><em>Python</em></strong> object created in the chunk above, after which we load a different data set from the web and run a linear model on it using <strong><em>R</em></strong>…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(py<span class="sc">$</span>d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##      name success   age   rank
## 1   Aaron      15  9.80 medium
## 2    Adam      14 12.06 medium
## 3 Agustin      22 16.33   high
## 4    Alan       9  8.79    low
## 5  Andrew      12  6.81    low
## 6 Anthony      11 14.84    low</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(py<span class="sc">$</span>d<span class="sc">$</span>success <span class="sc">~</span> py<span class="sc">$</span>d<span class="sc">$</span>rank, <span class="at">xlab =</span> <span class="st">"Rank"</span>, <span class="at">ylab =</span> <span class="st">"Success"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="99-python-from-R_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/master/zombies.csv"</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 10
##      id first_name last_name gender height weight zombies_killed
##   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;
## 1     1 Sarah      Little    Female   62.9   132.              2
## 2     2 Mark       Duncan    Male     67.8   146.              5
## 3     3 Brandon    Perez     Male     72.1   153.              1
## 4     4 Roger      Coleman   Male     66.8   130.              5
## 5     5 Tammy      Powell    Female   64.7   132.              4
## 6     6 Anthony    Green     Male     71.2   153.              1
## # ℹ 3 more variables: years_of_education &lt;dbl&gt;, major &lt;chr&gt;, age &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> weight)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 2 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)   39.6     0.596        66.4 0        
## 2 weight         0.195   0.00411      47.5 2.65e-258</code></pre>
</div>
</div>
<p>… then we again run a {python} chunk, now accessing the <strong><em>R</em></strong> data frame created in the {r} chunk above and using <strong><em>Python</em></strong> to run and print a summary of the same linear model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(r.z.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##     id first_name  ...                            major        age
## 0  1.0      Sarah  ...                 medicine/nursing  17.642745
## 1  2.0       Mark  ...  criminal justice administration  22.589513
## 2  3.0    Brandon  ...                        education  21.912760
## 3  4.0      Roger  ...                   energy studies  18.190582
## 4  5.0      Tammy  ...                        logistics  21.103986
## 
## [5 rows x 10 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># statsmodels package for OLS using formulas</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># regression of height ~ weight with intercept</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> smf.ols(formula <span class="op">=</span> <span class="st">'height ~ weight'</span>, data<span class="op">=</span>r.z)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(m.fit().summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##                             OLS Regression Results                            
## ==============================================================================
## Dep. Variable:                 height   R-squared:                       0.693
## Model:                            OLS   Adj. R-squared:                  0.693
## Method:                 Least Squares   F-statistic:                     2255.
## Date:                Wed, 26 Mar 2025   Prob (F-statistic):          2.65e-258
## Time:                        07:18:59   Log-Likelihood:                -2288.6
## No. Observations:                1000   AIC:                             4581.
## Df Residuals:                     998   BIC:                             4591.
## Df Model:                           1                                         
## Covariance Type:            nonrobust                                         
## ==============================================================================
##                  coef    std err          t      P&gt;|t|      [0.025      0.975]
## ------------------------------------------------------------------------------
## Intercept     39.5654      0.596     66.406      0.000      38.396      40.735
## weight         0.1950      0.004     47.486      0.000       0.187       0.203
## ==============================================================================
## Omnibus:                        8.716   Durbin-Watson:                   1.938
## Prob(Omnibus):                  0.013   Jarque-Bera (JB):                9.617
## Skew:                           0.159   Prob(JB):                      0.00816
## Kurtosis:                       3.360   Cond. No.                     1.14e+03
## ==============================================================================
## 
## Notes:
## [1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
## [2] The condition number is large, 1.14e+03. This might indicate that there are
## strong multicollinearity or other numerical problems.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># del [pandas, seaborn, matplotlib, ggplot, smf]</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># delete refs to imported modules</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>exit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Use exit() or Ctrl-D (i.e. EOF) to exit</code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./99-r-packages.html" class="pagination-link  aria-label=" building="" custom="" ***r***="" packages"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Building Custom <strong><em>R</em></strong> Packages</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./99-shiny.html" class="pagination-link" aria-label="Building Interactive Web Apps">
        <span class="nav-page-text">Building Interactive Web Apps</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb64" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Using ***Python*** from ***R*** {#using-python .unnumbered}</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objectives {.unnumbered}</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In this module, we look at how to integrate ***Python*** code and functions into ***R***.</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminaries {.unnumbered}</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Install and load this package in ***R***: <span class="co">[</span><span class="ot">{reticulate}</span><span class="co">](https://cran.r-project.org/web/packages/reticulate/reticulate.pdf)</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load {tidyverse} and {broom}</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Make sure you have a working ***Python*** installation on your computer *and* a package manager for ***Python***</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Recent versions of the MacOS, Windows, and Linux operating systems typically include a ***Python*** installation by default, but that may not be an up-to-date version and the included package manager may not be comprehensive. Thus, for most users, it is worthwhile to download and install an updated version of ***Python*** along with a software system for managing ***Python*** libraries and environments.</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">***Anaconda***</span><span class="co">](https://www.anaconda.com/download)</span> is one such such system; it is a comprehensive, open-source distribution for ***Python*** (as well as other scientific computing software, including ***R***, and ***RStudio***, and ***Jupyter*** notebooks), and it provides an easy way to get an up-to-date version of ***Python*** installed. Binary ***Anaconda*** installers are available for most computer operating systems, including MacOS, Windows, and Linux. Running the installer basically installs a command-line package manager, ***conda***, for all of these different pieces of software, as well as a graphical version of that manager and software launcher, named ***Anaconda-Navigator***. Unless you specify otherwise, the current distribution of ***Anaconda*** should install (on MacOS) to a directory called <span class="in">`~/anaconda3`</span> at the root of your user folder.</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>Alternatively, you can download and install a pared-down version of ***Anaconda*** called [***Miniconda***]((https://www.anaconda.com/download), which consists of just the ***conda*** package manager, ***Python***, and a limited set of additional packages. You can download and install ***Miniconda*** yourself from this URL, in which case it should install to this directory on MacOS: <span class="in">`~/opt/miniconda3`</span>.</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE**: There is no need to install both ***Anaconda*** and ***Miniconda***... choose one or the other! Both will write a series of PATH configuration lines to your shell profile, and, if you do install both, the latter one to be installed will overwrite the PATH details of the former in your default shell profile.</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>Finally, you can download and install ***Miniconda*** from within {reticulate}. In fact, when you first run a function from `library(reticulate)`, you may see a prompt asking if you want to install ***Miniconda***...</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="in">    No non-system installation of Python could be found.</span></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a><span class="in">    Would you like to download and install Miniconda?</span></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a><span class="in">    Miniconda is an open source environment management system for Python.</span></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a><span class="in">    See https://docs.conda.io/en/latest/miniconda.html for more details.</span></span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>If so, you can answer "Y" and let the installation run. In doing so, the installer will create a directory at the base of your user folder called <span class="in">`~/Library/r-miniconda`</span> with a **conda** installation in it. If you are not prompted to install ***Miniconda***, you can install it manually using the {reticulate} command <span class="in">`install_miniconda()`</span>.</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a><span class="fu">install_miniconda</span>()</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE**: This process installs ***Miniconda*** to a different location *and* does not add PATH configuration lines to your shell script. Thus, if you choose this route for ***Miniconda*** installation, it will be less easy to use the terminal to run **conda** commands as you would then need to manually configure your PATH.</span></span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background {.unnumbered}</span></span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a>One of the wonderful things about ***R*** is that it offers interoperability with several other programming languages useful for statistical analysis, data science, and data visualization, including ***Python***, ***Stan***, ***Julia***, ***JavaScript***, and ***C++***. Here, we explore the {reticulate} package, which essentially embeds a ***Python*** session within your ***R*** session, allowing you the opportunity to smoothly integrate ***Python*** code into ***R*** workflows and analyses through the ***RStudio*** IDE. For additional details, see the information on the {reticulate} package's website [R Interface to ***Python***](https://rstudio.github.io/reticulate/) website.</span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>With {reticulate}, we can call ***Python*** code from ***R*** in several ways:</span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>By including ***Python*** code chunks within an **R Markdown** document</span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>By importing ***Python*** modules into ***R*** and accessing their functions</span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>By sourcing entire ***Python*** scripts (".py" files)</span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>By using ***Python*** interactively within an ***R*** session</span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a>We can also use {reticulate} to convert between ***R*** and ***Python*** objects (e.g., between ***R*** and ***Python*** {pandas} data frames).</span>
<span id="cb64-59"><a href="#cb64-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a><span class="fu">## Getting Started with {reticulate} {.unnumbered}</span></span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a><span class="fu">### Configuring ***Python*** {.unnumbered}</span></span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a>Many computers may have several different iterations of ***Python*** installed in different places. Upon loading {reticulate} and first calling the ***Python*** function `import`, either directly or implicitly , ***R*** tries to find and "attach" to one of these versions. To control the process, it is recommended that you specify or build a desired ***Python*** version and then pass this suggested instance to {reticulate}. Restarting ***R*** will unbind an instance and allow you to specify a different one.</span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a>The ***R*** commands `Sys.which("python")` and `Sys.which("python3")` will return the path to the current version of ***Python*** (for pre-version 3 installations) and ***Python3***, respectively that ***R*** has bound. Unless you specify a ***Python*** instance from a particular "environment" (see below), these will usually be "/usr/bin/python" and "/usr/bin/python3" or "/usr/local/bin/python" and "/usr/local/bin/python3". <span class="co">[</span><span class="ot">Sometimes, the path returned by these functions is actually a *symlink*, a kind of pointer, to the actual executable file.</span><span class="co">]</span></span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-68"><a href="#cb64-68" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE**: If your computer does not have an older, pre-3.0 version of ***Python*** installed, `Sys.which("python")` may return a blank path or the path to a 3.0 version of ***Python***.</span></span>
<span id="cb64-69"><a href="#cb64-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-72"><a href="#cb64-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-73"><a href="#cb64-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-74"><a href="#cb64-74" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">"python"</span>)</span>
<span id="cb64-75"><a href="#cb64-75" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">"python3"</span>)</span>
<span id="cb64-76"><a href="#cb64-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-77"><a href="#cb64-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-78"><a href="#cb64-78" aria-hidden="true" tabindex="-1"></a>After loading {reticulate}, if you run the function <span class="in">`py_config()`</span>, it will return information on the version of and path to the ***Python*** binary (executable program) and associated libraries that {reticulate} is currently bound to, It also returns the version and location of {numpy}, an important ***Python*** library for maths, if it is installed.</span>
<span id="cb64-79"><a href="#cb64-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-82"><a href="#cb64-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-83"><a href="#cb64-83" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>()</span>
<span id="cb64-84"><a href="#cb64-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-85"><a href="#cb64-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-86"><a href="#cb64-86" aria-hidden="true" tabindex="-1"></a>You can specify or change the instance of ***Python*** that {reticulate} uses via the ***RStudio*** IDE by going either the *Preferences* (MacOS) or *Global Options* (MacOS or PC) dialog box and selecting the *Python* section...</span>
<span id="cb64-87"><a href="#cb64-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-90"><a href="#cb64-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-91"><a href="#cb64-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-92"><a href="#cb64-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb64-93"><a href="#cb64-93" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::include_graphics("img/python")</span></span>
<span id="cb64-94"><a href="#cb64-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-95"><a href="#cb64-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-98"><a href="#cb64-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-99"><a href="#cb64-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-100"><a href="#cb64-100" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb64-101"><a href="#cb64-101" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::include_graphics("img/python-details")</span></span>
<span id="cb64-102"><a href="#cb64-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-103"><a href="#cb64-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-104"><a href="#cb64-104" aria-hidden="true" tabindex="-1"></a>... and then choosing the desired ***Python*** interpreter from the dialog boxes. ***RStudio*** will try to highlight all available ***Python*** interpreters for you, either ones installed in the system (e.g., distributed with MacOS) or ones associated with different virtual or conda "environments" (see below) that you have created. You can also type the path to the version of the ***Python*** interpreter you wish to using directly into the dialog box. After you click, "Apply" you will be prompted to restart ***R*** to allow {reticulate} be able to rebind to a different interpreter.</span>
<span id="cb64-105"><a href="#cb64-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-108"><a href="#cb64-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-109"><a href="#cb64-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-110"><a href="#cb64-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb64-111"><a href="#cb64-111" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::include_graphics("img/interpreter")</span></span>
<span id="cb64-112"><a href="#cb64-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-113"><a href="#cb64-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-114"><a href="#cb64-114" aria-hidden="true" tabindex="-1"></a>After ***R*** restarts, reload {reticulate}, then call `py_config()` to verify that {reticulate} is connected to the desired ***Python*** executable.</span>
<span id="cb64-115"><a href="#cb64-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-116"><a href="#cb64-116" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** After changing the bound version of ***Python*** in this manner and running py_config(), the last line of the output should read as follows:</span></span>
<span id="cb64-117"><a href="#cb64-117" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb64-118"><a href="#cb64-118" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; NOTE: Python version was forced by use_python() function</span></span>
<span id="cb64-119"><a href="#cb64-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-120"><a href="#cb64-120" aria-hidden="true" tabindex="-1"></a>Note that specification of the ***Python*** interpreter in this manner is "sticky". That is, if an interpreter is specified in *Global Options*, then that takes precedence over assigning an interpreter with `use_python()` or by assigning an environment (see below). That is, if you specify a version of ***Python*** to use in *Global Options*, you will not be able change to a different interpreter or specify what environment to use via code.</span>
<span id="cb64-121"><a href="#cb64-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-122"><a href="#cb64-122" aria-hidden="true" tabindex="-1"></a>If we do not use *Global Options* or *Preferences* to specify an interpreter, we can instead directly suggest what ***Python*** interpreter that {reticulate} should use from ***R*** by calling the `use_python()` function with the path to the interpreter as an argument. For example, as noted above, the current ***Anaconda*** distribution typically installs its own version of ***Python*** at "~/anaconda3/bin/python", thus we could specify that we want {reticulate} to bind to that version as follows:</span>
<span id="cb64-123"><a href="#cb64-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-126"><a href="#cb64-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-127"><a href="#cb64-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-128"><a href="#cb64-128" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">"~/anaconda3/bin/python"</span>, <span class="at">required=</span><span class="cn">TRUE</span>)</span>
<span id="cb64-129"><a href="#cb64-129" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>() <span class="co"># confirm our selection</span></span>
<span id="cb64-130"><a href="#cb64-130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-131"><a href="#cb64-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-132"><a href="#cb64-132" aria-hidden="true" tabindex="-1"></a>Similarly, as described above, the ***Miniconda*** version of the **conda** package manager installed from within {reticulate} places its version of ***Python*** inside a user's <span class="in">`Library`</span> directory, at </span>
<span id="cb64-133"><a href="#cb64-133" aria-hidden="true" tabindex="-1"></a>"~/Library/r-miniconda/bin/python". We can set {reticulate} to bind that version using the following code:</span>
<span id="cb64-134"><a href="#cb64-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-137"><a href="#cb64-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-138"><a href="#cb64-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-139"><a href="#cb64-139" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">"~/Library/r-miniconda/bin/python"</span>, <span class="at">required=</span><span class="cn">TRUE</span>)</span>
<span id="cb64-140"><a href="#cb64-140" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>() <span class="co"># confirm our selection</span></span>
<span id="cb64-141"><a href="#cb64-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-142"><a href="#cb64-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-143"><a href="#cb64-143" aria-hidden="true" tabindex="-1"></a>However, it is important to remember that if you want to modify the particular instance of ***Python*** that {reticulate} should to attach to, it is necessary to first RESTART ***R***, which you can do either in ***RStudio*** (by choosing that option from the **Session** menu) or by using the function <span class="in">`.rs.restartR()`</span> at a command prompt), then load {reticulate} again, and then run the <span class="in">`use_python()`</span> function. After doing this, you can run <span class="in">`py_config()`</span> again to confirm that the ***Python*** configuration has indeed changed as desired, and you can check with `Sys.which("python")` or `Sys.which("python3")` to confirm what instance of ***Python*** is attached. For example...</span>
<span id="cb64-144"><a href="#cb64-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-147"><a href="#cb64-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-148"><a href="#cb64-148" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-149"><a href="#cb64-149" aria-hidden="true" tabindex="-1"></a><span class="fu">.rs.restartR</span>()</span>
<span id="cb64-150"><a href="#cb64-150" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb64-151"><a href="#cb64-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-152"><a href="#cb64-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-155"><a href="#cb64-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-156"><a href="#cb64-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-157"><a href="#cb64-157" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">"~/Library/r-miniconda/bin/python"</span>, <span class="at">required =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-158"><a href="#cb64-158" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>() <span class="co"># confirm our selection</span></span>
<span id="cb64-159"><a href="#cb64-159" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">"python3"</span>)</span>
<span id="cb64-160"><a href="#cb64-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-161"><a href="#cb64-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-162"><a href="#cb64-162" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** After changing the bound version of ***Python*** in this manner and running py_config(), the last line of the output should read as follows:</span></span>
<span id="cb64-163"><a href="#cb64-163" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb64-164"><a href="#cb64-164" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; NOTE: Python version was forced by use_python function</span></span>
<span id="cb64-165"><a href="#cb64-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-166"><a href="#cb64-166" aria-hidden="true" tabindex="-1"></a>Note that changing the intepreter this way is **not** "sticky." That is, if you were to restart ***R*** again, load {reticulate}, and run `py_config()` without specifying a configuration using `use_python()`, {reticulate} will scan along your PATH and other possible places where ***Python*** might be installed to find the first appropriate instance, giving preference to one where {numpy} is present as that library is very important for integrating ***Python*** and ***R***. Importantly, this may find a version of ***Python*** not associated with any particular "environment" (see below).</span>
<span id="cb64-167"><a href="#cb64-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-168"><a href="#cb64-168" aria-hidden="true" tabindex="-1"></a><span class="fu">### Working with Environments {.unnumbered}</span></span>
<span id="cb64-169"><a href="#cb64-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-170"><a href="#cb64-170" aria-hidden="true" tabindex="-1"></a>Whenever we work with ***Python***, it is best to do so in the context of an "environment". An **environment** (such as the "r-reticulate" environment created by default by installing ***Miniconda***) is basically a folder that contains all the necessary executables and ***Python*** **modules** (which are akin to ***R*** packages) that a particular ***Python*** project needs. An environment is kind of analogous to a repository containing an **R Project**, except that in ***R Projects***, the ***R*** executable and all of the packages used in a project are not physically replicated in each repository the way that a ***Python*** executable and referenced modules are (often) replicated within the environment. When we install any specific module that we want to are going to use in a script, we typically install it to a specific working environment.</span>
<span id="cb64-171"><a href="#cb64-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-172"><a href="#cb64-172" aria-hidden="true" tabindex="-1"></a>Using environments is a way of isolating and keeping different versions of modules independent so as not to "break" our code when modules are updated. They also allow us to experiment with different ***Python*** setups.</span>
<span id="cb64-173"><a href="#cb64-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-174"><a href="#cb64-174" aria-hidden="true" tabindex="-1"></a>***Python*** and {reticulate} support two different types of environments, **conda** environments, which are managed by **conda** and "virtual environments". We will focus first on **conda** environments.</span>
<span id="cb64-175"><a href="#cb64-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-176"><a href="#cb64-176" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **conda** Environments {.unnumbered}</span></span>
<span id="cb64-177"><a href="#cb64-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-178"><a href="#cb64-178" aria-hidden="true" tabindex="-1"></a>The {reticulate} function <span class="in">`conda_list()`</span> can be used to list all of the different **conda** environments that are registered within **conda** installations on our computer, along with a path to the ***Python*** binary associated with the environment.</span>
<span id="cb64-179"><a href="#cb64-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-180"><a href="#cb64-180" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE**: Sometimes the path returned by </span><span class="in">`conda_list()`</span><span class="at"> is a *symlink* to the actual executable file. That is, the *symlink* is located in the environment folder while the actual executable file resides in a different folder like </span><span class="in">`/usr/bin/`</span><span class="at"> or </span><span class="in">`/usr/local/bin`</span><span class="at">.</span></span>
<span id="cb64-181"><a href="#cb64-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-184"><a href="#cb64-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-185"><a href="#cb64-185" aria-hidden="true" tabindex="-1"></a><span class="fu">conda_list</span>()</span>
<span id="cb64-186"><a href="#cb64-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-187"><a href="#cb64-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-188"><a href="#cb64-188" aria-hidden="true" tabindex="-1"></a>After running this command, you should see two or three environments listed, depending on whether you installed ***Anaconda***, ***Miniconda*** through {reticulate}, or both. Installing ***Anaconda*** should have created an environment called "anaconda3" by default, while installing ***Miniconda*** through {reticulate} should have created two environments, one called "base" and one called "r-reticulate".</span>
<span id="cb64-189"><a href="#cb64-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-190"><a href="#cb64-190" aria-hidden="true" tabindex="-1"></a>You can set up other new environments by running the function <span class="in">`conda_create()`</span> and specifying a different environment name as an argument.</span>
<span id="cb64-191"><a href="#cb64-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-192"><a href="#cb64-192" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** By default, if no environments have yet been defined, the `conda_create()` function creates one named "r-reticulate". This is what the ***Miniconda*** installer ran behind the scenes to create the default "r-reticulate" environment. But we can also provide an alternative name within the particular active **conda** installation.</span></span>
<span id="cb64-193"><a href="#cb64-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-194"><a href="#cb64-194" aria-hidden="true" tabindex="-1"></a>When you create a new environment with <span class="in">`conda_create()`</span>, it will be set up inside of the <span class="in">`envs/`</span> directory in which our **conda** installation resides (again, if using ***Miniconda***, this should be within the `~/Library/r-miniconda/` directory. Environments created with this function will include a default suite of ***Python*** packages that {reticulate} will have access to. They will also be associated with the particular instance of ***Python*** that is currently bound to {reticulate}, unless we specify otherwise using the "python_version=" argument.</span>
<span id="cb64-195"><a href="#cb64-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-198"><a href="#cb64-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-199"><a href="#cb64-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-200"><a href="#cb64-200" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new **conda** environment named "my-environment"</span></span>
<span id="cb64-201"><a href="#cb64-201" aria-hidden="true" tabindex="-1"></a><span class="fu">conda_create</span>(<span class="st">"my-environment"</span>)</span>
<span id="cb64-202"><a href="#cb64-202" aria-hidden="true" tabindex="-1"></a><span class="fu">conda_list</span>()</span>
<span id="cb64-203"><a href="#cb64-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-204"><a href="#cb64-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-205"><a href="#cb64-205" aria-hidden="true" tabindex="-1"></a>The {reticulate} function <span class="in">`conda_remove()`</span> will delete a particular **conda** environment.</span>
<span id="cb64-206"><a href="#cb64-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-209"><a href="#cb64-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-210"><a href="#cb64-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-211"><a href="#cb64-211" aria-hidden="true" tabindex="-1"></a><span class="fu">conda_remove</span>(<span class="st">"my-environment"</span>)</span>
<span id="cb64-212"><a href="#cb64-212" aria-hidden="true" tabindex="-1"></a><span class="fu">conda_list</span>()</span>
<span id="cb64-213"><a href="#cb64-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-214"><a href="#cb64-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-215"><a href="#cb64-215" aria-hidden="true" tabindex="-1"></a><span class="fu">### Specifying an Environment {.unnumbered}</span></span>
<span id="cb64-216"><a href="#cb64-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-217"><a href="#cb64-217" aria-hidden="true" tabindex="-1"></a>If we have more than one **conda** environment set up on our machines, perhaps with different ***Python*** modules installed and/or using different versions of ***Python***, we can use the functions `use_miniconda(condaenv=)` or `use_condaenv(condaenv=)` to "activate" a particular environment, i.e., to specify which one you want to bind to a particular ***R*** and {reticulate} session. [The "r-reticulate" environment set up by ***Miniconda***, if present, is the one that will be used by default if no other environment is specified.] Given that each environment contains a ***Python*** executable (or path to an executable), this is an alternative to `use_python()` as a way of also specifying a ***Python*** version for a particular project. Specifying an environment to use is analogous to opening a particular ***R Project*** from a repository.</span>
<span id="cb64-218"><a href="#cb64-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-219"><a href="#cb64-219" aria-hidden="true" tabindex="-1"></a>As for <span class="in">`use_python()`</span>, the way to force use of a non-default environment is to restart ***R***, load {reticulate}, and run the function <span class="in">`use_miniconda()`</span> (or, equivalently, <span class="in">`use_condaenv()`</span>) as below, after which running <span class="in">`py_config()`</span> should confirm the configuration.</span>
<span id="cb64-220"><a href="#cb64-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-223"><a href="#cb64-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-224"><a href="#cb64-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-225"><a href="#cb64-225" aria-hidden="true" tabindex="-1"></a><span class="fu">.rs.restartR</span>()</span>
<span id="cb64-226"><a href="#cb64-226" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb64-227"><a href="#cb64-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-228"><a href="#cb64-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-231"><a href="#cb64-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-232"><a href="#cb64-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-233"><a href="#cb64-233" aria-hidden="true" tabindex="-1"></a><span class="fu">use_miniconda</span>(<span class="at">condaenv =</span> <span class="st">"r-reticulate"</span>, <span class="at">required =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-234"><a href="#cb64-234" aria-hidden="true" tabindex="-1"></a><span class="co"># or use_condaenv(condaenv = "r-reticulate", required = TRUE)</span></span>
<span id="cb64-235"><a href="#cb64-235" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>()</span>
<span id="cb64-236"><a href="#cb64-236" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">"python3"</span>)</span>
<span id="cb64-237"><a href="#cb64-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-238"><a href="#cb64-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-239"><a href="#cb64-239" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** It is a good idea to include the argument </span><span class="in">`required=TRUE`</span><span class="at">, which ensures that an error will be thrown if the specified environment is not found.</span></span>
<span id="cb64-240"><a href="#cb64-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-241"><a href="#cb64-241" aria-hidden="true" tabindex="-1"></a>It is possible to also run all of these **conda** functions at the command prompt in a terminal...</span>
<span id="cb64-242"><a href="#cb64-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-243"><a href="#cb64-243" aria-hidden="true" tabindex="-1"></a><span class="in">    # to list your conda environments and show which one is active</span></span>
<span id="cb64-244"><a href="#cb64-244" aria-hidden="true" tabindex="-1"></a><span class="in">    $ conda info --envs</span></span>
<span id="cb64-245"><a href="#cb64-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-246"><a href="#cb64-246" aria-hidden="true" tabindex="-1"></a><span class="in">    # OR</span></span>
<span id="cb64-247"><a href="#cb64-247" aria-hidden="true" tabindex="-1"></a><span class="in">    $ conda env list</span></span>
<span id="cb64-248"><a href="#cb64-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-249"><a href="#cb64-249" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Doing this from the command line shows an asterisk next to an environment called "base" that is a default environment that was created when we first installed ***Anaconda*** (as opposed to ***Miniconda***) and is associated with your base **conda** installation. This is typically at the path: "~/anaconda3" in current ***Anaconda*** installations.</span></span>
<span id="cb64-250"><a href="#cb64-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-251"><a href="#cb64-251" aria-hidden="true" tabindex="-1"></a>    # to create a conda environment</span>
<span id="cb64-252"><a href="#cb64-252" aria-hidden="true" tabindex="-1"></a>    $ conda create --name my-environment</span>
<span id="cb64-253"><a href="#cb64-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-254"><a href="#cb64-254" aria-hidden="true" tabindex="-1"></a><span class="in">    # to create a conda environment with a specific version of Python</span></span>
<span id="cb64-255"><a href="#cb64-255" aria-hidden="true" tabindex="-1"></a><span class="in">    # this will install an executable for the specified version</span></span>
<span id="cb64-256"><a href="#cb64-256" aria-hidden="true" tabindex="-1"></a><span class="in">    # of Python within the environment</span></span>
<span id="cb64-257"><a href="#cb64-257" aria-hidden="true" tabindex="-1"></a><span class="in">    $ conda create --name my-environment python=3.9</span></span>
<span id="cb64-258"><a href="#cb64-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-259"><a href="#cb64-259" aria-hidden="true" tabindex="-1"></a><span class="in">    # to activate an environment</span></span>
<span id="cb64-260"><a href="#cb64-260" aria-hidden="true" tabindex="-1"></a><span class="in">    $ conda activate my-environment</span></span>
<span id="cb64-261"><a href="#cb64-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-262"><a href="#cb64-262" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Running </span><span class="in">`conda env list`</span><span class="at"> after activating a different environment shows the asterisk next to the newly activated environment.</span></span>
<span id="cb64-263"><a href="#cb64-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-264"><a href="#cb64-264" aria-hidden="true" tabindex="-1"></a>    # to list the packages in the active environment</span>
<span id="cb64-265"><a href="#cb64-265" aria-hidden="true" tabindex="-1"></a>    $ conda list</span>
<span id="cb64-266"><a href="#cb64-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-267"><a href="#cb64-267" aria-hidden="true" tabindex="-1"></a><span class="in">    # to deactivate an active environment and return to *base*</span></span>
<span id="cb64-268"><a href="#cb64-268" aria-hidden="true" tabindex="-1"></a><span class="in">    $ conda deactivate</span></span>
<span id="cb64-269"><a href="#cb64-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-270"><a href="#cb64-270" aria-hidden="true" tabindex="-1"></a><span class="in">    # to remove an environment</span></span>
<span id="cb64-271"><a href="#cb64-271" aria-hidden="true" tabindex="-1"></a><span class="in">    $ conda remove --name my-environment --all</span></span>
<span id="cb64-272"><a href="#cb64-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-273"><a href="#cb64-273" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** An active environment needs to be deactivated before it can be removed.</span></span>
<span id="cb64-274"><a href="#cb64-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-275"><a href="#cb64-275" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">**conda** documentation</span><span class="co">](https://docs.conda.io/projects/conda/en/latest/index.html)</span> provides further details on how to use the **conda** package and environment management system that is central to the ***Anaconda*** and ***Miniconda*** distributions.</span>
<span id="cb64-276"><a href="#cb64-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-277"><a href="#cb64-277" aria-hidden="true" tabindex="-1"></a><span class="fu">#### "Virtual" Environments {.unnumbered}</span></span>
<span id="cb64-278"><a href="#cb64-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-279"><a href="#cb64-279" aria-hidden="true" tabindex="-1"></a>As noted above, {reticulate} actually supports using two different ***Python*** environment flavors: **conda*"** environments (as we set up above) and "virtual" environments. The former are stored inside of a directory called `envs/` that sits within a particular **conda** installation. The latter type of environments are typically stored in a hidden directory called <span class="in">`.virtualenvs/`</span> at the root of your user folder.</span>
<span id="cb64-280"><a href="#cb64-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-281"><a href="#cb64-281" aria-hidden="true" tabindex="-1"></a>To create and use "virtual" rather than **conda** environments with {reticulate}, the commands are very similar. Unless otherwise specified, the environment created will be bound to the ***Python*** interpreter associated with the current {reticulate} and ***R*** session.</span>
<span id="cb64-282"><a href="#cb64-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-285"><a href="#cb64-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-286"><a href="#cb64-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-287"><a href="#cb64-287" aria-hidden="true" tabindex="-1"></a><span class="fu">virtualenv_create</span>(<span class="at">envname =</span> <span class="st">"r-reticulate"</span>)</span>
<span id="cb64-288"><a href="#cb64-288" aria-hidden="true" tabindex="-1"></a><span class="fu">virtualenv_create</span>(<span class="at">envname =</span> <span class="st">"my-environment"</span>)</span>
<span id="cb64-289"><a href="#cb64-289" aria-hidden="true" tabindex="-1"></a><span class="fu">virtualenv_list</span>()</span>
<span id="cb64-290"><a href="#cb64-290" aria-hidden="true" tabindex="-1"></a><span class="fu">virtualenv_remove</span>(<span class="at">envname =</span> <span class="st">"my-environment"</span>)</span>
<span id="cb64-291"><a href="#cb64-291" aria-hidden="true" tabindex="-1"></a><span class="fu">use_virtualenv</span>(<span class="at">virtualenv =</span> <span class="st">"r-reticulate"</span>)</span>
<span id="cb64-292"><a href="#cb64-292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-293"><a href="#cb64-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-294"><a href="#cb64-294" aria-hidden="true" tabindex="-1"></a>Once we have bound {reticulate} to a particular **conda** or "virtual" environment, we can check/confirm how our setup is configured by running <span class="in">`py_config()`</span>.</span>
<span id="cb64-295"><a href="#cb64-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-298"><a href="#cb64-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-299"><a href="#cb64-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-300"><a href="#cb64-300" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>()</span>
<span id="cb64-301"><a href="#cb64-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-302"><a href="#cb64-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-303"><a href="#cb64-303" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding ***Python*** Modules {#adding-modules .unnumbered}</span></span>
<span id="cb64-304"><a href="#cb64-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-305"><a href="#cb64-305" aria-hidden="true" tabindex="-1"></a>The {reticulate} package includes the simple function <span class="in">`py_install()`</span> that can be used to install one or more ***Python*** modules into a specified environment (either a **conda** environment, as we created above, or a "virtual environment" if we are using that flavor of environment instead). With <span class="in">`py_install()`</span>, new modules, by default, will be installed into the environment named "r-reticulate" (though this can be changed by specifying the "envname=" argument).</span>
<span id="cb64-306"><a href="#cb64-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-307"><a href="#cb64-307" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Alternatively, the function `conda_install(envname, packages)` will install python modules into a particular, specified **conda** environment, and the function </span><span class="in">`virtualenv_install(envname, packages)`</span><span class="at"> will install packages into into a particular virtual environment, but </span><span class="in">`py_install()`</span><span class="at"> is sufficient for our purposes.</span></span>
<span id="cb64-308"><a href="#cb64-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-309"><a href="#cb64-309" aria-hidden="true" tabindex="-1"></a>Below, we install the python modules {scipy}, {numpy}, {pandas}, {matplotlib}, and {seaborn}, which are used in the subsequent ***Python*** coding examples, into the "r-reticulate" ***Miniconda*** environment.</span>
<span id="cb64-310"><a href="#cb64-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-311"><a href="#cb64-311" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** In the function below, the </span><span class="in">`envname=`</span><span class="at"> argument does not need to specified, but I have included it anyway.</span></span>
<span id="cb64-312"><a href="#cb64-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-315"><a href="#cb64-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-316"><a href="#cb64-316" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb64-317"><a href="#cb64-317" aria-hidden="true" tabindex="-1"></a>    <span class="st">"numpy"</span>,</span>
<span id="cb64-318"><a href="#cb64-318" aria-hidden="true" tabindex="-1"></a>    <span class="st">"scipy"</span>,</span>
<span id="cb64-319"><a href="#cb64-319" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pandas"</span>,</span>
<span id="cb64-320"><a href="#cb64-320" aria-hidden="true" tabindex="-1"></a>    <span class="st">"matplotlib"</span>,</span>
<span id="cb64-321"><a href="#cb64-321" aria-hidden="true" tabindex="-1"></a>    <span class="st">"seaborn"</span>,</span>
<span id="cb64-322"><a href="#cb64-322" aria-hidden="true" tabindex="-1"></a>    <span class="st">"statsmodels"</span></span>
<span id="cb64-323"><a href="#cb64-323" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-324"><a href="#cb64-324" aria-hidden="true" tabindex="-1"></a><span class="fu">py_install</span>(<span class="at">envname =</span> <span class="st">"r-reticulate"</span>, <span class="at">packages =</span> p)</span>
<span id="cb64-325"><a href="#cb64-325" aria-hidden="true" tabindex="-1"></a><span class="co"># or conda_install(envname = "r-reticulate",  packages = p)</span></span>
<span id="cb64-326"><a href="#cb64-326" aria-hidden="true" tabindex="-1"></a><span class="co"># or virtualenv_install(envname = "r-reticulate", packages = p, required = TRUE)</span></span>
<span id="cb64-327"><a href="#cb64-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-328"><a href="#cb64-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-329"><a href="#cb64-329" aria-hidden="true" tabindex="-1"></a>You can also use standard shell installation utilities at a terminal prompt (e.g., <span class="in">`conda`</span> or <span class="in">`pip`</span>) to activate an environment and to install ***Python*** modules.</span>
<span id="cb64-330"><a href="#cb64-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-331"><a href="#cb64-331" aria-hidden="true" tabindex="-1"></a><span class="in">    # to activate an environment...</span></span>
<span id="cb64-332"><a href="#cb64-332" aria-hidden="true" tabindex="-1"></a><span class="in">    $ conda activate r-reticulate</span></span>
<span id="cb64-333"><a href="#cb64-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-334"><a href="#cb64-334" aria-hidden="true" tabindex="-1"></a><span class="in">    # to install a module into an active conda environment...</span></span>
<span id="cb64-335"><a href="#cb64-335" aria-hidden="true" tabindex="-1"></a><span class="in">    $ conda install scipy</span></span>
<span id="cb64-336"><a href="#cb64-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-337"><a href="#cb64-337" aria-hidden="true" tabindex="-1"></a><span class="in">    # or to install into a different, named environment, e.g., r-reticulate</span></span>
<span id="cb64-338"><a href="#cb64-338" aria-hidden="true" tabindex="-1"></a><span class="in">    $ conda install --name r-reticulate scipy</span></span>
<span id="cb64-339"><a href="#cb64-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-340"><a href="#cb64-340" aria-hidden="true" tabindex="-1"></a><span class="in">    # to install a module into system level Python (i.e., globally, instead of in a specified environment)</span></span>
<span id="cb64-341"><a href="#cb64-341" aria-hidden="true" tabindex="-1"></a><span class="in">    $ sudo pip install scipy</span></span>
<span id="cb64-342"><a href="#cb64-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-343"><a href="#cb64-343" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using ***Python*** Code in ***R*** {#python-code .unnumbered}</span></span>
<span id="cb64-344"><a href="#cb64-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-345"><a href="#cb64-345" aria-hidden="true" tabindex="-1"></a>As mentioned in the introduction above, there are multiple ways to integrate ***Python*** code into your ***R*** projects and workflow. You can...</span>
<span id="cb64-346"><a href="#cb64-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-347"><a href="#cb64-347" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Include ***Python*** code chunks in **R Markdown** documents</span>
<span id="cb64-348"><a href="#cb64-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-349"><a href="#cb64-349" aria-hidden="true" tabindex="-1"></a>    **R Markdown** now includes a language engine that supports bi-directional communication between ***R*** and Python (***R*** chunks can access Python objects and vice-versa).</span>
<span id="cb64-350"><a href="#cb64-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-351"><a href="#cb64-351" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Import ***Python*** modules to access their functions directly from ***R***</span>
<span id="cb64-352"><a href="#cb64-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-353"><a href="#cb64-353" aria-hidden="true" tabindex="-1"></a>    The <span class="in">`import()`</span> function from {reticulate} enables you to import any Python module and call its functions directly from R.</span>
<span id="cb64-354"><a href="#cb64-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-355"><a href="#cb64-355" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Source a ***Python*** script from ***R***</span>
<span id="cb64-356"><a href="#cb64-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-357"><a href="#cb64-357" aria-hidden="true" tabindex="-1"></a>    The <span class="in">`source_python()`</span> function from {reticulate} enables you to source a Python script the same way you would <span class="in">`source()`</span> an ***R*** script. Python functions and objects defined within the script become directly available to the ***R*** session.</span>
<span id="cb64-358"><a href="#cb64-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-359"><a href="#cb64-359" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use a ***Python*** REPL ("Read-Eval-Print Loop")</span>
<span id="cb64-360"><a href="#cb64-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-361"><a href="#cb64-361" aria-hidden="true" tabindex="-1"></a>    The <span class="in">`repl_python()`</span> function embeds an interactive Python console within ***R*** that you can use interactively, as you would the ***R*** console. Objects you create within Python are available to your ***R*** session, and vice-versa.</span>
<span id="cb64-362"><a href="#cb64-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-363"><a href="#cb64-363" aria-hidden="true" tabindex="-1"></a>More detail on each of these approaches, and examples, are given below.</span>
<span id="cb64-364"><a href="#cb64-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-365"><a href="#cb64-365" aria-hidden="true" tabindex="-1"></a><span class="fu">### ***Python*** Code Chunks {.unnumbered}</span></span>
<span id="cb64-366"><a href="#cb64-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-367"><a href="#cb64-367" aria-hidden="true" tabindex="-1"></a>The following example ***Python*** code chunk, which can be included in an ".Rmd" document, imports the zombie apocalypse survivors datafile from **GitHub** and plots a linear model of height~age and a boxplot of height~gender. Note that the chunk type is <span class="in">`{python}`</span> not <span class="in">`{r}`</span>!</span>
<span id="cb64-368"><a href="#cb64-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-371"><a href="#cb64-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb64-372"><a href="#cb64-372" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a Python code chunk</span></span>
<span id="cb64-373"><a href="#cb64-373" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb64-374"><a href="#cb64-374" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn</span>
<span id="cb64-375"><a href="#cb64-375" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb64-376"><a href="#cb64-376" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb64-377"><a href="#cb64-377" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> pandas.read_csv(f)</span>
<span id="cb64-378"><a href="#cb64-378" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(z.head())</span>
<span id="cb64-379"><a href="#cb64-379" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> z[[<span class="st">'gender'</span>, <span class="st">'height'</span>, <span class="st">'weight'</span>, <span class="st">'age'</span>, <span class="st">'major'</span>]]</span>
<span id="cb64-380"><a href="#cb64-380" aria-hidden="true" tabindex="-1"></a><span class="co"># create a plot using the python seaborn module</span></span>
<span id="cb64-381"><a href="#cb64-381" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> seaborn.pairplot(</span>
<span id="cb64-382"><a href="#cb64-382" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> z,</span>
<span id="cb64-383"><a href="#cb64-383" aria-hidden="true" tabindex="-1"></a>  hue <span class="op">=</span> <span class="st">'gender'</span>,</span>
<span id="cb64-384"><a href="#cb64-384" aria-hidden="true" tabindex="-1"></a>  kind <span class="op">=</span> <span class="st">'scatter'</span>,</span>
<span id="cb64-385"><a href="#cb64-385" aria-hidden="true" tabindex="-1"></a>  plot_kws <span class="op">=</span> <span class="bu">dict</span>(alpha <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb64-386"><a href="#cb64-386" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-387"><a href="#cb64-387" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the active plot object</span></span>
<span id="cb64-388"><a href="#cb64-388" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.show(p)</span>
<span id="cb64-389"><a href="#cb64-389" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.clf()</span>
<span id="cb64-390"><a href="#cb64-390" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> seaborn.boxplot(x<span class="op">=</span><span class="st">"gender"</span>, y<span class="op">=</span><span class="st">"height"</span>, data<span class="op">=</span>z)</span>
<span id="cb64-391"><a href="#cb64-391" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the active plot object</span></span>
<span id="cb64-392"><a href="#cb64-392" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.show(p)</span>
<span id="cb64-393"><a href="#cb64-393" aria-hidden="true" tabindex="-1"></a><span class="co"># type `exit` at the Python prompt to exit the REPL</span></span>
<span id="cb64-394"><a href="#cb64-394" aria-hidden="true" tabindex="-1"></a>exit</span>
<span id="cb64-395"><a href="#cb64-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-396"><a href="#cb64-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-397"><a href="#cb64-397" aria-hidden="true" tabindex="-1"></a><span class="fu">### Importing and Using Modules {.unnumbered}</span></span>
<span id="cb64-398"><a href="#cb64-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-399"><a href="#cb64-399" aria-hidden="true" tabindex="-1"></a>Running the <span class="in">`import()`</span> command in ***R*** will load functions and other data from within ***Python*** modules and classes directly into ***R***. The functions and data included in the ***Python*** module can then be accessed via the `$` operator, analogous to the way they would when we interact with an ***R*** object.</span>
<span id="cb64-400"><a href="#cb64-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-401"><a href="#cb64-401" aria-hidden="true" tabindex="-1"></a>Imported ***Python*** modules also support code completion and inline help, again paralleling what we see with ***R*** packages.</span>
<span id="cb64-402"><a href="#cb64-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-405"><a href="#cb64-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-406"><a href="#cb64-406" aria-hidden="true" tabindex="-1"></a>pandas <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"pandas"</span>)</span>
<span id="cb64-407"><a href="#cb64-407" aria-hidden="true" tabindex="-1"></a>seaborn <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"seaborn"</span>)</span>
<span id="cb64-408"><a href="#cb64-408" aria-hidden="true" tabindex="-1"></a>matplotlib <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"matplotlib"</span>)</span>
<span id="cb64-409"><a href="#cb64-409" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb64-410"><a href="#cb64-410" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> pandas<span class="sc">$</span><span class="fu">read_csv</span>(f)</span>
<span id="cb64-411"><a href="#cb64-411" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(z)</span>
<span id="cb64-412"><a href="#cb64-412" aria-hidden="true" tabindex="-1"></a><span class="co"># create a plot using the python seaborn module</span></span>
<span id="cb64-413"><a href="#cb64-413" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> seaborn<span class="sc">$</span><span class="fu">lmplot</span>(<span class="at">x =</span> <span class="st">'age'</span>, <span class="at">y =</span> <span class="st">'height'</span>, <span class="at">data =</span> z)</span>
<span id="cb64-414"><a href="#cb64-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-415"><a href="#cb64-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-416"><a href="#cb64-416" aria-hidden="true" tabindex="-1"></a>Because there is sometimes some awkwardness with using the {matplotlib} ***Python*** module from within ***R***, we can switch back to a {python} chunk to print out the figure created...</span>
<span id="cb64-417"><a href="#cb64-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-420"><a href="#cb64-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb64-421"><a href="#cb64-421" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb64-422"><a href="#cb64-422" aria-hidden="true" tabindex="-1"></a>r.p</span>
<span id="cb64-423"><a href="#cb64-423" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the active plot object created with the R code above</span></span>
<span id="cb64-424"><a href="#cb64-424" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.show(p)</span>
<span id="cb64-425"><a href="#cb64-425" aria-hidden="true" tabindex="-1"></a><span class="co"># type `exit` at the Python prompt to exit the REPL</span></span>
<span id="cb64-426"><a href="#cb64-426" aria-hidden="true" tabindex="-1"></a>exit</span>
<span id="cb64-427"><a href="#cb64-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-428"><a href="#cb64-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-429"><a href="#cb64-429" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sourcing a ***Python*** Script {.unnumbered}</span></span>
<span id="cb64-430"><a href="#cb64-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-431"><a href="#cb64-431" aria-hidden="true" tabindex="-1"></a>We can use the <span class="in">`source_python()`</span> function in ***R*** to source a ***Python*** script the same way we would source() an ***R*** script. We give the function the path to the file to load in and run as an argument. This process assumes the ".py" script is stored in a directory called `src/` located in the current working directory. The script loads in the zombie apocalypse survivors dataset from **GitHub** and then plots a boxplot of weight~gender.</span>
<span id="cb64-432"><a href="#cb64-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-435"><a href="#cb64-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-436"><a href="#cb64-436" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"python_script.py"</span></span>
<span id="cb64-437"><a href="#cb64-437" aria-hidden="true" tabindex="-1"></a><span class="fu">source_python</span>(<span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/src/"</span>,f))</span>
<span id="cb64-438"><a href="#cb64-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-439"><a href="#cb64-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-440"><a href="#cb64-440" aria-hidden="true" tabindex="-1"></a>As above, we switch to a {python} chunk to print out the figures created...</span>
<span id="cb64-441"><a href="#cb64-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-444"><a href="#cb64-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb64-445"><a href="#cb64-445" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb64-446"><a href="#cb64-446" aria-hidden="true" tabindex="-1"></a>r.p</span>
<span id="cb64-447"><a href="#cb64-447" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the active plot object created with the sourced python code</span></span>
<span id="cb64-448"><a href="#cb64-448" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.show(p)</span>
<span id="cb64-449"><a href="#cb64-449" aria-hidden="true" tabindex="-1"></a><span class="co"># type `exit` at the Python prompt to exit the REPL</span></span>
<span id="cb64-450"><a href="#cb64-450" aria-hidden="true" tabindex="-1"></a>exit</span>
<span id="cb64-451"><a href="#cb64-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-452"><a href="#cb64-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-453"><a href="#cb64-453" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using ***Python*** Interactively {.unnumbered}</span></span>
<span id="cb64-454"><a href="#cb64-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-455"><a href="#cb64-455" aria-hidden="true" tabindex="-1"></a>Finally, if you want to work with ***Python*** interactively, you can call the `repl_python()` function from ***R***, which provides a ***Python*** REPL ("Read--Eval--Print Loop") session embedded within your ***R*** session.</span>
<span id="cb64-456"><a href="#cb64-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-459"><a href="#cb64-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-460"><a href="#cb64-460" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-461"><a href="#cb64-461" aria-hidden="true" tabindex="-1"></a><span class="fu">repl_python</span>()</span>
<span id="cb64-462"><a href="#cb64-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-463"><a href="#cb64-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-464"><a href="#cb64-464" aria-hidden="true" tabindex="-1"></a>To test this out, copy and paste each of the following lines singly at the ***Python*** console prompt (<span class="in">`&gt;&gt;&gt;`</span>).</span>
<span id="cb64-465"><a href="#cb64-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-466"><a href="#cb64-466" aria-hidden="true" tabindex="-1"></a><span class="in">    import pandas</span></span>
<span id="cb64-467"><a href="#cb64-467" aria-hidden="true" tabindex="-1"></a><span class="in">    import seaborn</span></span>
<span id="cb64-468"><a href="#cb64-468" aria-hidden="true" tabindex="-1"></a><span class="in">    import matplotlib</span></span>
<span id="cb64-469"><a href="#cb64-469" aria-hidden="true" tabindex="-1"></a><span class="in">    f = "https://raw.githubusercontent.com/difiore/ADA-datasets/master/zombies.csv"</span></span>
<span id="cb64-470"><a href="#cb64-470" aria-hidden="true" tabindex="-1"></a><span class="in">    z = pandas.read_csv(f)</span></span>
<span id="cb64-471"><a href="#cb64-471" aria-hidden="true" tabindex="-1"></a><span class="in">    print(z.head())</span></span>
<span id="cb64-472"><a href="#cb64-472" aria-hidden="true" tabindex="-1"></a><span class="in">    seaborn.lmplot(x="weight", y="height", data=z)</span></span>
<span id="cb64-473"><a href="#cb64-473" aria-hidden="true" tabindex="-1"></a><span class="in">    matplotlib.pyplot.show()</span></span>
<span id="cb64-474"><a href="#cb64-474" aria-hidden="true" tabindex="-1"></a><span class="in">    exit</span></span>
<span id="cb64-475"><a href="#cb64-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-476"><a href="#cb64-476" aria-hidden="true" tabindex="-1"></a><span class="fu">## Converting Data Objects {.unnumbered}</span></span>
<span id="cb64-477"><a href="#cb64-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-478"><a href="#cb64-478" aria-hidden="true" tabindex="-1"></a>One of the great things about {reticulate} allows us to share variables and states of ***Python*** objects across ***Python*** code chunks within the same **R Markdown** document, the same way we can with ***R*** code chunks.</span>
<span id="cb64-479"><a href="#cb64-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-480"><a href="#cb64-480" aria-hidden="true" tabindex="-1"></a>It also allows us to access objects created within ***Python*** code chunks from ***R*** using the `py` object (e.g., we can use `py$age` would access a variable, **age** created within ***Python*** from ***R***).</span>
<span id="cb64-481"><a href="#cb64-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-482"><a href="#cb64-482" aria-hidden="true" tabindex="-1"></a>Likewise, {reticulate} allows us to access objects created within ***R*** chunks from ***Python*** using the `r` object (e.g., we could use `r.sex` to access a variable named **sex** that was created within ***R*** from inside a ***Python*** code chunk).</span>
<span id="cb64-483"><a href="#cb64-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-484"><a href="#cb64-484" aria-hidden="true" tabindex="-1"></a>{reticulate} supports built-in conversion between ***Python*** and ***R*** for many ***Python*** objects, including {numpy} arrays and {pandas} data frames.</span>
<span id="cb64-485"><a href="#cb64-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-486"><a href="#cb64-486" aria-hidden="true" tabindex="-1"></a>**EXAMPLE:**</span>
<span id="cb64-487"><a href="#cb64-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-488"><a href="#cb64-488" aria-hidden="true" tabindex="-1"></a>Here, we run a {python} chunk and load in a familiar data file from over the web...</span>
<span id="cb64-489"><a href="#cb64-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-492"><a href="#cb64-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb64-493"><a href="#cb64-493" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb64-494"><a href="#cb64-494" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/woollydata.csv"</span></span>
<span id="cb64-495"><a href="#cb64-495" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> pandas.read_csv(f)</span>
<span id="cb64-496"><a href="#cb64-496" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(d.head())</span>
<span id="cb64-497"><a href="#cb64-497" aria-hidden="true" tabindex="-1"></a>exit</span>
<span id="cb64-498"><a href="#cb64-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-499"><a href="#cb64-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-500"><a href="#cb64-500" aria-hidden="true" tabindex="-1"></a>... then we run an {r} chunk that accesses and uses the ***Python*** object created in the chunk above, after which we load a different data set from the web and run a linear model on it using ***R***...</span>
<span id="cb64-501"><a href="#cb64-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-504"><a href="#cb64-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-505"><a href="#cb64-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb64-506"><a href="#cb64-506" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-507"><a href="#cb64-507" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb64-508"><a href="#cb64-508" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(py<span class="sc">$</span>d)</span>
<span id="cb64-509"><a href="#cb64-509" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(py<span class="sc">$</span>d<span class="sc">$</span>success <span class="sc">~</span> py<span class="sc">$</span>d<span class="sc">$</span>rank, <span class="at">xlab =</span> <span class="st">"Rank"</span>, <span class="at">ylab =</span> <span class="st">"Success"</span>)</span>
<span id="cb64-510"><a href="#cb64-510" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/master/zombies.csv"</span></span>
<span id="cb64-511"><a href="#cb64-511" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-512"><a href="#cb64-512" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(z)</span>
<span id="cb64-513"><a href="#cb64-513" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>z, height<span class="sc">~</span>weight)</span>
<span id="cb64-514"><a href="#cb64-514" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m)</span>
<span id="cb64-515"><a href="#cb64-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-516"><a href="#cb64-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-517"><a href="#cb64-517" aria-hidden="true" tabindex="-1"></a>... then we again run a {python} chunk, now accessing the ***R*** data frame created in the {r} chunk above and using ***Python*** to run and print a summary of the same linear model.</span>
<span id="cb64-518"><a href="#cb64-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-521"><a href="#cb64-521" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb64-522"><a href="#cb64-522" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(r.z.head())</span>
<span id="cb64-523"><a href="#cb64-523" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb64-524"><a href="#cb64-524" aria-hidden="true" tabindex="-1"></a><span class="co"># statsmodels package for OLS using formulas</span></span>
<span id="cb64-525"><a href="#cb64-525" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb64-526"><a href="#cb64-526" aria-hidden="true" tabindex="-1"></a><span class="co"># regression of height ~ weight with intercept</span></span>
<span id="cb64-527"><a href="#cb64-527" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> smf.ols(formula <span class="op">=</span> <span class="st">'height ~ weight'</span>, data<span class="op">=</span>r.z)</span>
<span id="cb64-528"><a href="#cb64-528" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(m.fit().summary())</span>
<span id="cb64-529"><a href="#cb64-529" aria-hidden="true" tabindex="-1"></a><span class="co"># del [pandas, seaborn, matplotlib, ggplot, smf]</span></span>
<span id="cb64-530"><a href="#cb64-530" aria-hidden="true" tabindex="-1"></a><span class="co"># delete refs to imported modules</span></span>
<span id="cb64-531"><a href="#cb64-531" aria-hidden="true" tabindex="-1"></a>exit</span>
<span id="cb64-532"><a href="#cb64-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-533"><a href="#cb64-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-534"><a href="#cb64-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb64-535"><a href="#cb64-535" aria-hidden="true" tabindex="-1"></a><span class="in">detach(package:broom)</span></span>
<span id="cb64-536"><a href="#cb64-536" aria-hidden="true" tabindex="-1"></a><span class="in">detach(package:tidyverse)</span></span>
<span id="cb64-537"><a href="#cb64-537" aria-hidden="true" tabindex="-1"></a><span class="in">detach(package:reticulate)</span></span>
<span id="cb64-538"><a href="#cb64-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-539"><a href="#cb64-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-540"><a href="#cb64-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb64-541"><a href="#cb64-541" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::clean_cache(TRUE)</span></span>
<span id="cb64-542"><a href="#cb64-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>