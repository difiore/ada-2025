<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applied Data Analysis - 17&nbsp; Error, Power, and Effect Size</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./18-module.html" rel="next">
<link href="./16-module.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./17-module.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-logistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Logistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course-schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-typography-and-formatting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Typography and Formatting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-programming-style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming Style Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>RStudio</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extending the Functionality of <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamentals of the <strong><em>R</em></strong> Language</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basics of Version Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Additional Data Structures in <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting Data into <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Functions and Flow Control</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part II - Statistics and Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Descriptive Statisics and Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Using Permutation Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-module.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Elements of Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression and ANCOVA</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Part III - Miscellany</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maximum_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Maximum Likelihood Estimation Example</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 07</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 08</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-analysis-replication-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis Replication</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Packages Used</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives"><span class="header-section-number">17.1</span> Objectives</a></li>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link" data-scroll-target="#preliminaries"><span class="header-section-number">17.2</span> Preliminaries</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><span class="header-section-number">17.3</span> Overview</a></li>
  <li><a href="#type-i-error-and-multiple-testing" id="toc-type-i-error-and-multiple-testing" class="nav-link" data-scroll-target="#type-i-error-and-multiple-testing"><span class="header-section-number">17.4</span> Type I Error and Multiple Testing</a>
  <ul class="collapse">
  <li><a href="#challenge" id="toc-challenge" class="nav-link" data-scroll-target="#challenge">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#multiple-comparison-corrections" id="toc-multiple-comparison-corrections" class="nav-link" data-scroll-target="#multiple-comparison-corrections"><span class="header-section-number">17.5</span> Multiple Comparison Corrections</a></li>
  <li><a href="#type-ii-error" id="toc-type-ii-error" class="nav-link" data-scroll-target="#type-ii-error"><span class="header-section-number">17.6</span> Type II Error</a>
  <ul class="collapse">
  <li><a href="#challenge-1" id="toc-challenge-1" class="nav-link" data-scroll-target="#challenge-1">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#power-and-effect-size" id="toc-power-and-effect-size" class="nav-link" data-scroll-target="#power-and-effect-size"><span class="header-section-number">17.7</span> Power and Effect Size</a></li>
  <li><a href="#visualizing-power-and-effect-size" id="toc-visualizing-power-and-effect-size" class="nav-link" data-scroll-target="#visualizing-power-and-effect-size"><span class="header-section-number">17.8</span> Visualizing Power and Effect Size</a>
  <ul class="collapse">
  <li><a href="#challenge-2" id="toc-challenge-2" class="nav-link" data-scroll-target="#challenge-2">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#concept-review" id="toc-concept-review" class="nav-link" data-scroll-target="#concept-review">Concept Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./17-module.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="module-17" class="quarto-section-identifier"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="objectives" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="objectives"><span class="header-section-number">17.1</span> Objectives</h2>
<blockquote class="blockquote">
<p>The objective of this module is to discuss the concepts of Type I and Type II error, the multiple testing problem, statistical power, and effect size and outline how we can use <strong><em>R</em></strong> to investigate these via simulation and built-in functions.</p>
</blockquote>
</section>
<section id="preliminaries" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="preliminaries"><span class="header-section-number">17.2</span> Preliminaries</h2>
<ul>
<li>Load {tidyverse} and {manipulate}</li>
</ul>
</section>
<section id="overview" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="overview"><span class="header-section-number">17.3</span> Overview</h2>
<p>Let’s return to the concepts of <strong>error</strong> and <strong>power</strong>. Recall that Type I error occurs when you <strong>incorrectly reject a true</strong> <span class="math inline">\(H_0\)</span>. In any given hypothesis test, the probability of a Type I error is equivalent to the significance level, <span class="math inline">\(\alpha\)</span>, and it is this type of error we are often trying to minimize when we are doing classical statistical inference. Type II error occurs when you <strong>incorrectly fail to reject a false</strong> <span class="math inline">\(H_0\)</span> (in other words, fail to find evidence in support of a true <span class="math inline">\(H_A\)</span>). Since we do not know what the true <span class="math inline">\(H_A\)</span> actually is, the probability of committing such an error, labeled <span class="math inline">\(\beta\)</span>, is not usually known in practice.</p>
<table class="table">
<colgroup>
<col style="width: 19%">
<col style="width: 21%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th>What is True</th>
<th>What We Decide</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(H_0\)</span></td>
<td><span class="math inline">\(H_0\)</span></td>
<td>Correctly ‘accept’ the null</td>
</tr>
<tr class="even">
<td><span class="math inline">\(H_0\)</span></td>
<td><span class="math inline">\(H_A\)</span></td>
<td>Falsely reject the null (Type I error)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(H_A\)</span></td>
<td><span class="math inline">\(H_0\)</span></td>
<td>Falsely ‘accept’ the null (Type II error)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(H_A\)</span></td>
<td><span class="math inline">\(H_A\)</span></td>
<td>Correctly reject the null</td>
</tr>
</tbody>
</table>
</section>
<section id="type-i-error-and-multiple-testing" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="type-i-error-and-multiple-testing"><span class="header-section-number">17.4</span> Type I Error and Multiple Testing</h2>
<p>Because of how we define <span class="math inline">\(\alpha\)</span>, the chance probability of falsely rejecting <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is actually true, we would expect to find some “significant” results if we run enough independent hypothesis tests. For example, if we set <span class="math inline">\(\alpha\)</span> at 0.05, we would expect to find one “significant” result in roughly every 20 tests we run, just by chance. The relation of <span class="math inline">\(\alpha\)</span> to the distribution of a variable under a null hypothesis (<span class="math inline">\(\mu\)</span> = <span class="math inline">\(\mu_0\)</span>) versus an alternative hypothesis (e.g., <span class="math inline">\(\mu\)</span> &gt; <span class="math inline">\(\mu_0\)</span>) is shown in the figure below (this example is for an upper one-tailed test). It should be clear that we can reduce the chance of Type I error by decreasing <span class="math inline">\(\alpha\)</span> (shifting the critical value to the right in the <span class="math inline">\(H_0\)</span> distribution). Type I error will also be reduced as the means get further apart or as the standard deviation of the distributions shrinks.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/typeI.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Let’s explore this via simulation.</p>
<p>We will write some code to simulate a bunch of random datasets from a normal distribution where we set the expected population mean (<span class="math inline">\(\mu_0\)</span>) and standard deviation (<span class="math inline">\(\sigma\)</span>) and then calculate a <span class="math inline">\(Z\)</span> (or <span class="math inline">\(T\)</span>) statistic and p value for each one. We will then look at the “Type I” error rate… the proportion of times that, based on our sample, we would conclude that it was not drawn from the distribution we know to be true.</p>
<p>First, let’s set up a skeleton function we will call <code>typeI()</code> to evaluate the Type I error rate. It should take, as arguments, the parameters of the normal distribution for the null hypothesis we want to simulate from (<span class="math inline">\(\mu_0\)</span> and <span class="math inline">\(\sigma\)</span>), our sample size, our <span class="math inline">\(\alpha\)</span> level, what “alternative” type of <span class="math inline">\(Z\)</span> (or <span class="math inline">\(T\)</span>) test we want to do (“greater”, “less”, or “two.tailed”), and the number of simulated datasets we want to generate. Copy and paste in the code below (and note that we set default values for <span class="math inline">\(\alpha\)</span> and the number of simulations). Note that we can use the “t” family of functions instead of the “norm” family.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function skeleton</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>typeI <span class="ot">&lt;-</span> <span class="cf">function</span>(mu0, sigma, n, <span class="at">alternative =</span> <span class="st">"two.tailed"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">k =</span> <span class="dv">10000</span>) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we will add the body of the function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>typeI <span class="ot">&lt;-</span> <span class="cf">function</span>(mu0, sigma, n, <span class="at">alternative =</span> <span class="st">"two.tailed"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">k =</span> <span class="dv">10000</span>) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, k)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set a vector of k empty p values, one for each simulation</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sets up a loop to run k simulations</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># draws a sample of size n from our distribution</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)  <span class="co"># calculates the mean</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)  <span class="co"># calculates the standard deviation</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        z <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu0)<span class="sc">/</span>(s<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calculates the Z statistic for the sample drawn from the null</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># distribution relative to the null distribution alternatively use t &lt;-</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># (m-mu0)/(s/sqrt(n))</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"less"</span>) {</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>            p[[i]] <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># calculates the associated p value alternatively, use p[[i]] &lt;-</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># pt(t, df = n-1, lower.tail = TRUE)</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"greater"</span>) {</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>            p[[i]] <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># calculates the associated p value alternatively, use p[[i]] &lt;-</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># pt(t, df = n-1, lower.tail=FALSE)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"two.tailed"</span>) {</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                p[[i]] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># alternatively, use if (t &gt; 0) {p[[i]] &lt;- pt(t, df = n-1,</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># lower.tail = FALSE)}</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (z <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                p[[i]] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># alternatively, use if (t &lt; 0) {p[[i]] &lt;- pt(t, df = n-1,</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># lower.tail = TRUE)}</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">curve</span>(<span class="fu">dnorm</span>(x, mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Sampling Distribution Under Null Hypothesis</span><span class="sc">\n</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="st">      Type I error rate from simulation = "</span>,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>            <span class="fu">length</span>(p[p <span class="sc">&lt;</span> alpha])<span class="sc">/</span>k, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"Pr(x)"</span>, <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim =</span> <span class="fu">c</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(mu0,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>            mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))))</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"less"</span>) {</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>            <span class="at">to =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>), mu0 <span class="sc">-</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>            <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>            <span class="at">to =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">mean =</span> mu0,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        q <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">-</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pnorm</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"greater"</span>) {</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">+</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>            <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>            mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>            sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">mean =</span> mu0,</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>        q <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">-</span> <span class="fu">pnorm</span>(mu0 <span class="sc">+</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>            <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"two.tailed"</span>) {</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>        <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">to =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>), mu0 <span class="sc">-</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>            <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>            sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>        <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">+</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>            <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>            mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>            sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">mean =</span> mu0,</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>        q <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">-</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pnorm</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fu">pnorm</span>(mu0 <span class="sc">+</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">-</span> <span class="fu">pnorm</span>(mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>            alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(round(q,digits=3)) this prints area in the shaded portion(s) of the</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># curve</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">length</span>(p[p <span class="sc">&lt;</span> alpha])<span class="sc">/</span>k)</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># returns the proportion of simulations where p &lt; alpha or</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `return(mean(p&lt;alpha))`</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, <span class="math inline">\(\mu_0\)</span> is our sample mean and <span class="math inline">\(\sigma\)</span> is our sample standard deviation.</p>
<p>Can you explain what each step of this code is doing?</p>
<p>Now, run our Type I error test function with a couple of different values of <span class="math inline">\(\mu_0\)</span>, <span class="math inline">\(\sigma\)</span>, and <span class="math inline">\(\alpha\)</span>. What error rates are returned? They should be always be close to <span class="math inline">\(\alpha\)</span>!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>eI <span class="ot">&lt;-</span> <span class="fu">typeI</span>(<span class="at">mu0 =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">sigma =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="17-module_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>eI <span class="ot">&lt;-</span> <span class="fu">typeI</span>(<span class="at">mu0 =</span> <span class="dv">5</span>, <span class="at">sigma =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">alternative =</span> <span class="st">"less"</span>, <span class="at">alpha =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="17-module_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>eI <span class="ot">&lt;-</span> <span class="fu">typeI</span>(<span class="at">mu0 =</span> <span class="dv">10</span>, <span class="at">sigma =</span> <span class="dv">4</span>, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">alternative =</span> <span class="st">"two.tailed"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="17-module_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="challenge" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge">CHALLENGE</h3>
<p>How does the Type I error rate change with <span class="math inline">\(n\)</span>? With <span class="math inline">\(\sigma\)</span>? With <span class="math inline">\(\alpha\)</span>?</p>
<blockquote class="blockquote">
<p><strong>HINT:</strong> It shouldn’t change much… the Type I error rate is defined by <span class="math inline">\(\alpha\)</span>!</p>
</blockquote>
</section>
</section>
<section id="multiple-comparison-corrections" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="multiple-comparison-corrections"><span class="header-section-number">17.5</span> Multiple Comparison Corrections</h2>
<p>One way we can address the multiple testing problem mentioned above is by using what is called the <strong>Bonferroni</strong> correction, which suggests that when doing a total of <span class="math inline">\(k\)</span> independent hypothesis tests, each with a significance level of <span class="math inline">\(\alpha\)</span>, we should adjust the <span class="math inline">\(\alpha\)</span> level we use to interpret statistical significance as follow: <span class="math inline">\(\alpha_B = \alpha/k\)</span>. For example, if we run 10 independent hypothesis tests, then we should set our adjusted <span class="math inline">\(\alpha\)</span> level for each test as 0.05/10 = 0.005.</p>
<p>With the Bonferroni correction, we are essentially saying that we want to control the rate at which we have even one incorrect rejection of <span class="math inline">\(H_0\)</span> given the entire family of tests we do. This is also referred to as limiting the “family-wise error rate” to level <span class="math inline">\(\alpha\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example Bonferroni correction</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e-04</span>, <span class="fl">0.003</span>, <span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.04</span>, <span class="fl">0.045</span>, <span class="fl">0.11</span>, <span class="fl">0.18</span>, <span class="fl">0.23</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># vector of p values associated with a set of tests</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> pvals <span class="sc">&lt;=</span> alpha<span class="sc">/</span><span class="fu">length</span>(pvals)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># returns a boolean vector of pvals less than or equal to the adjusted alpha</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>sig  <span class="co"># first 3 values are less than the adjusted alpha</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
</div>
<p>Many statisticians consider the <strong>Bonferroni</strong> correction to be an overly conservative one, and there are other corrections we might use to account for multiple testing.</p>
<p>One common alternative is the <strong>Benjamini &amp; Hochberg</strong> correction, which is less conservative. It attempts to control for the “false discovery rate”, which is different than the “family-wise error rate”. Here, we aim to limit the number of false “discoveries” (i.e., incorrect rejections of the null hypothesis) out of a set of discoveries (i.e., out of the set of results where we would reject the null hypothesis) to <span class="math inline">\(\alpha\)</span>.</p>
<ul>
<li>Calculate <span class="math inline">\(p\)</span> values for all tests</li>
<li>Order <span class="math inline">\(p\)</span> values from smallest to largest (from <span class="math inline">\(p_1\)</span> to <span class="math inline">\(p_m\)</span>)</li>
<li>Call any <span class="math inline">\(p\)</span> value where <span class="math inline">\(p_i ≤ \alpha \times i/m\)</span> significant</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>psig <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e-04</span>, <span class="fl">0.003</span>, <span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.04</span>, <span class="fl">0.045</span>, <span class="fl">0.11</span>, <span class="fl">0.18</span>, <span class="fl">0.27</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pvals)) {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    psig[i] <span class="ot">&lt;-</span> alpha <span class="sc">*</span> i<span class="sc">/</span><span class="fu">length</span>(pvals)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">rank =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">pvals =</span> pvals, <span class="at">psig =</span> psig)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> rank, <span class="at">y =</span> pvals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> rank,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> psig))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="17-module_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> pvals <span class="sc">&lt;=</span> psig  <span class="co"># vector of significant pvalues</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sig  <span class="co"># first 5 values are less than the adjusted alpha, the remaining are not</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
</div>
<p>An alternative way of thinking about this is to adjust <strong>p values</strong> themselves rather than the <span class="math inline">\(\alpha\)</span> levels. We can do this with a built-in <strong><em>R</em></strong> function, <code>p.adjust()</code>, which makes the calculation easy. Using this function, we can specify the kind of correction method we want to apply.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pvals, <span class="at">method =</span> <span class="st">"bonferroni"</span>) <span class="sc">&lt;=</span> <span class="fl">0.05</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sig  <span class="co"># first 3 adjusted p values are less alpha</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pvals, <span class="at">method =</span> <span class="st">"BH"</span>) <span class="sc">&lt;=</span> <span class="fl">0.05</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sig  <span class="co"># first 5 adjusted p values are less alpha</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
</div>
</section>
<section id="type-ii-error" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="type-ii-error"><span class="header-section-number">17.6</span> Type II Error</h2>
<p>By reducing the <span class="math inline">\(\alpha\)</span> level we use as our criterion for statistical significance, we can reduce the chance of committing a Type I error (i.e., of incorrectly rejecting a true null hypothesis)… but doing so directly increases our chance of committing a Type II error (i.e., of incorrectly <strong><em>failing</em></strong> to reject a false null). The shaded area in the figure below, <span class="math inline">\(\beta\)</span>, is the probability of incorrectly failing to reject the null…</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/typeII.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>It should be clear from this figure that if the critical value (which, again, is defined by <span class="math inline">\(\alpha\)</span>) is shifted to the right (i.e., if we reduce <span class="math inline">\(\alpha\)</span>), or if <span class="math inline">\(\mu\)</span> under the alternative hypothesis shifts left, then <span class="math inline">\(\beta\)</span>, the area under the alternative hypothesis distribution curve to the left of the critical value, increases! Intuitively, this makes sense: the lower the difference between the true <span class="math inline">\(\mu_A\)</span> value and <span class="math inline">\(\mu_0\)</span> and/or the higher the <span class="math inline">\(\alpha\)</span> level, the harder it will be to reject the null hypothesis that <span class="math inline">\(\mu\)</span> = <span class="math inline">\(\mu_0\)</span>.</p>
<p>In practice, we cannot usually calculate <span class="math inline">\(\beta\)</span> because of the need to know where the true distribution is really centered (i.e., we need to know the value of <span class="math inline">\(\mu_A\)</span>, which is often unknown). However, we can explore via simulation what <span class="math inline">\(\beta\)</span> is expected to look like under different alternative hypotheses (e.g., under different <span class="math inline">\(\mu_A\)</span>) and under different sample sizes and <span class="math inline">\(\alpha\)</span> levels.</p>
<p>Let’s do this using the simulation approach we developed above. Again, we will write some code to simulate a bunch of random datasets, this time drawn from a normal distribution associated with a particular alternative hypothesis, <span class="math inline">\(H_A\)</span>, that we define… i.e., where we specify <span class="math inline">\(\mu_A\)</span> and <span class="math inline">\(\sigma\)</span>, i.e., a mean and a standard deviation. We then calculate a <span class="math inline">\(Z\)</span> (or <span class="math inline">\(T\)</span>) statistic based on each sample dataset relative to <span class="math inline">\(\mu_0\)</span>, the expected mean under <span class="math inline">\(H_0\)</span>, and determine the associated p value for each one. Based on this, we can calculate the Type II error rate… the proportion of times that, based on our sample, we would conclude that it was drawn from the <span class="math inline">\(H_0\)</span> distribution rather than the <span class="math inline">\(H_A\)</span> distribution that we set to be true. Note that, as above, we can use the “t” family of functions in lieu of the “norm” family.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>typeII <span class="ot">&lt;-</span> <span class="cf">function</span>(mu0, muA, sigma, n, <span class="at">alternative =</span> <span class="st">"two.tailed"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">10000</span>) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, k)  <span class="co"># sets up a vector of empty p values</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># draw a sample of size n from Ha</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        z <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu0)<span class="sc">/</span>(s<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calculates the Z statistic for the sample drawn from Ha relative to</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the null distribution or... t &lt;- (m-mu0)/(s/sqrt(n)) # calculates the</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># t statistic</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"greater"</span>) {</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>            p[[i]] <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>            <span class="co"># calculates the associated p value for the Z statistic or...</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># p[[i]] &lt;- pt(t,lower.tail=FALSE,df=n-1) calculates the associated</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># p value for the t statistic</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>            hyp <span class="ot">&lt;-</span> <span class="st">"muA &gt; mu0"</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"less"</span>) {</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>            p[[i]] <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># or... p[[i]] &lt;- pt(t, lower.tail = TRUE, df = n - 1)</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>            hyp <span class="ot">&lt;-</span> <span class="st">"muA &lt; mu0"</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"two.tailed"</span>) {</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>                p[[i]] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (z <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>                p[[i]] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if (t &gt; 0) {p[[i]] &lt;- 2 * pt(t, lower.tail = FALSE, df = n-1)} if</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (t &lt; 0) {p[[i]] &lt;- 2 * pt(t, lower.tail = TRUE, df = n-1)}</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>            hyp <span class="ot">&lt;-</span> <span class="st">"muA ≠ mu0"</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">curve</span>(<span class="fu">dnorm</span>(x, mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Sampling Distributions Under Null (red) and Alternative (blue) Hypotheses</span><span class="sc">\n</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="st">      Type II error rate from simulation = "</span>,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>            <span class="fu">length</span>(p[p <span class="sc">&gt;=</span> alpha])<span class="sc">/</span>k, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"Pr(x)"</span>, <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(<span class="fu">c</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))), <span class="fu">max</span>(<span class="fu">c</span>(mu0 <span class="sc">+</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)))), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">c</span>(<span class="fu">dnorm</span>(mu0,</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>            mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))), <span class="fu">dnorm</span>(muA, muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)))))</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">curve</span>(<span class="fu">dnorm</span>(x, muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"less"</span>) {</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>            muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>            sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">mean =</span> muA,</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="at">v =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"greater"</span>) {</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>        <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>), mu0 <span class="sc">+</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>            <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>            <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">mean =</span> muA,</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="at">v =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"two.tailed"</span>) {</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="at">v =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="at">v =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>            <span class="co"># greater</span></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>            <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>                <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>                mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span></span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>                <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>                <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>), <span class="at">border =</span> <span class="st">"black"</span>,</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (z <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>            <span class="co"># less</span></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>            <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span></span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>                <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>                <span class="at">length.out =</span> <span class="dv">100</span>), muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span></span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>                <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>                <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>), <span class="at">border =</span> <span class="st">"black"</span>,</span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">length</span>(p[p <span class="sc">&gt;=</span> alpha])<span class="sc">/</span>k)</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="challenge-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-1">CHALLENGE</h3>
<p>Explore this function using different values of <span class="math inline">\(\mu_0\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(n\)</span>, and different types of one- and two-tailed tests.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ha &lt; H0</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>eII <span class="ot">&lt;-</span> <span class="fu">typeII</span>(<span class="at">mu0 =</span> <span class="dv">5</span>, <span class="at">muA =</span> <span class="dv">2</span>, <span class="at">sigma =</span> <span class="dv">4</span>, <span class="at">n =</span> <span class="dv">18</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="17-module_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ha ≠ H0</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>eII <span class="ot">&lt;-</span> <span class="fu">typeII</span>(<span class="at">mu0 =</span> <span class="dv">5</span>, <span class="at">muA =</span> <span class="dv">7</span>, <span class="at">sigma =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">15</span>, <span class="at">alternative =</span> <span class="st">"two.tailed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="17-module_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ha &gt; H0</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>eII <span class="ot">&lt;-</span> <span class="fu">typeII</span>(<span class="at">mu0 =</span> <span class="dv">0</span>, <span class="at">muA =</span> <span class="fl">0.5</span>, <span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">n =</span> <span class="dv">30</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">alpha =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="17-module_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>What happens if you increase <span class="math inline">\(\sigma\)</span> keeping other values constant?</li>
<li>What happens if you reduce <span class="math inline">\(n\)</span> or increase <span class="math inline">\(n\)</span>?</li>
<li>What happens if you increase the difference between <span class="math inline">\(\mu_A\)</span> and <span class="math inline">\(\mu_0\)</span>?</li>
</ul>
</section>
</section>
<section id="power-and-effect-size" class="level2" data-number="17.7">
<h2 data-number="17.7" class="anchored" data-anchor-id="power-and-effect-size"><span class="header-section-number">17.7</span> Power and Effect Size</h2>
<p><strong>Power</strong> is the <em>probability of correctly rejecting a null hypothesis that is untrue</em>. For a test that has a Type II error rate of <span class="math inline">\(\beta\)</span>, the statistical power is defined, simply, as <span class="math inline">\(1-\beta\)</span>. Power values of 0.8 or greater are conventionally considered to be “high”. Power for any given test depends on the difference in means between groups or treatments, <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(n\)</span>, and <span class="math inline">\(\sigma\)</span>.</p>
<p>Generally speaking, <strong>effect size</strong> is a quantitative measure of the <em>strength of a phenomenon</em>. Here, we are interested in comparing two sample means, and the most common way to describe the effect size is as a <strong>standardized difference</strong> between the means of the groups being compared. In this case, we divide the absolute values of the difference between the means by the standard deviation: <span class="math inline">\(\frac{\vert(\mu_0 - \mu_A)\vert}{\sigma}\)</span>. This results in a scaleless measure. Conventionally, effect sizes of 0.2 or less are considered to be low and of 0.8 or greater are considered to be high.</p>
</section>
<section id="visualizing-power-and-effect-size" class="level2" data-number="17.8">
<h2 data-number="17.8" class="anchored" data-anchor-id="visualizing-power-and-effect-size"><span class="header-section-number">17.8</span> Visualizing Power and Effect Size</h2>
<p>The code below lets you explore power and effect size interactively. You can use the sliders to set <span class="math inline">\(\mu_0\)</span> and <span class="math inline">\(\mu_A\)</span> for a one-sample test (or, alternatively, think about these as <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> for a two-sample test), <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(\alpha\)</span>, and <span class="math inline">\(n\)</span>, and you can choose whether you are testing a one-sided hypothesis of <span class="math inline">\(\mu_A\)</span> being “greater” or “less” than <span class="math inline">\(\mu_0\)</span> or are testing the two-sided hypothesis that <span class="math inline">\(\mu_A\)</span> ≠ <span class="math inline">\(\mu_0\)</span> (“two.tailed”). The figure will output <strong>power</strong> and <strong>effect size</strong>. Note that <span class="math inline">\(n\)</span> is the number of observations (or differences) being considered and <span class="math inline">\(\sigma\)</span> is the standard deviation in the observation (or difference values).</p>
<p>First, we define a function that plots the relationship between these factors and power:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>power.plot <span class="ot">&lt;-</span> <span class="cf">function</span>(mu0, muA, n, sigma, alpha, <span class="at">alternative =</span> <span class="st">"two.tailed"</span>) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    pow <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> (muA <span class="sc">-</span> mu0)<span class="sc">/</span>(sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">mu =</span> <span class="fu">c</span>(<span class="fu">min</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">max</span>(mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)))), <span class="fu">aes</span>(<span class="at">x =</span> mu)) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Explore Power and Effect Size for Z Test</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="st">      for a sample of size "</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        n))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">dnorm</span>(mu0, mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.1</span>, <span class="fu">dnorm</span>(muA, muA,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.1</span>)))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> muA, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)),</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"greater"</span>) {</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>            xcrit <span class="ot">=</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>            g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="at">x =</span> xcrit, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> xcrit, <span class="at">yend =</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(mu0,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>                mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>, <span class="fu">dnorm</span>(muA, muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>),</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="dv">3</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>            g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">x =</span> <span class="fu">c</span>(xcrit, <span class="fu">seq</span>(<span class="at">from =</span> xcrit,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">1000</span>), muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)),</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> xcrit, <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>))), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"blue"</span>,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>            pow <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">-</span> <span class="fu">pnorm</span>(xcrit,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>                muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"less"</span>) {</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (z <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>            xcrit <span class="ot">=</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>            g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="at">x =</span> xcrit, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> xcrit, <span class="at">yend =</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(mu0,</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>                mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>, <span class="fu">dnorm</span>(muA, muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>),</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="dv">3</span>)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>            g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">x =</span> <span class="fu">c</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>                <span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> xcrit, <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>                xcrit), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> xcrit,</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">length.out =</span> <span class="dv">1000</span>), <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>))), <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>            pow <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(xcrit, muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">-</span> <span class="fu">pnorm</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>                muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"two.tailed"</span>) {</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>            xcrit <span class="ot">=</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>            g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="at">x =</span> xcrit, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> xcrit, <span class="at">yend =</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(mu0,</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>                mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>, <span class="fu">dnorm</span>(muA, muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>),</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="dv">3</span>)</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>            g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">x =</span> <span class="fu">c</span>(xcrit, <span class="fu">seq</span>(<span class="at">from =</span> xcrit,</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>                <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">1000</span>), muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)),</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> xcrit, <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>))), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"blue"</span>,</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>            pow <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">-</span> <span class="fu">pnorm</span>(xcrit,</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>                muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (z <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>            xcrit <span class="ot">=</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>            g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="at">x =</span> xcrit, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> xcrit, <span class="at">yend =</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(mu0,</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>                mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>, <span class="fu">dnorm</span>(muA, muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>),</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="dv">3</span>)</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>            g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">x =</span> <span class="fu">c</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>                <span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> xcrit, <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>                xcrit), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">to =</span> xcrit,</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>                <span class="at">length.out =</span> <span class="dv">1000</span>), <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>))), <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>            pow <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(xcrit, muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">-</span> <span class="fu">pnorm</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>                muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(mu0, muA) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">y =</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(mu0,</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>        mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.075</span>, <span class="fu">dnorm</span>(muA, muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.075</span>), <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Effect Size = "</span>,</span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(<span class="fu">abs</span>((muA <span class="sc">-</span> mu0))<span class="sc">/</span>sigma, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">Power = "</span>, <span class="fu">round</span>(pow, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">min</span>(mu0, muA) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">y =</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(mu0,</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>        mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.075</span>, <span class="fu">dnorm</span>(muA, muA, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.075</span>), <span class="at">label =</span> <span class="st">"Red = mu0</span><span class="sc">\n</span><span class="st">Blue = muA"</span>)</span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>    g</span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(<span class="fu">power.plot</span>(mu0, muA, n, sigma, alpha, alternative), <span class="at">mu0 =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">10</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>, <span class="at">step =</span> <span class="fl">0.1</span>, <span class="at">initial =</span> <span class="dv">0</span>), <span class="at">muA =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="at">step =</span> <span class="fl">0.1</span>, <span class="at">initial =</span> <span class="dv">2</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">slider</span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="at">step =</span> <span class="dv">1</span>, <span class="at">initial =</span> <span class="dv">15</span>), <span class="at">sigma =</span> <span class="fu">slider</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="at">step =</span> <span class="fl">0.1</span>, <span class="at">initial =</span> <span class="dv">2</span>),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fu">slider</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="at">step =</span> <span class="fl">0.01</span>, <span class="at">initial =</span> <span class="fl">0.05</span>), <span class="at">alternative =</span> <span class="fu">picker</span>(<span class="st">"two.tailed"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"greater"</span>, <span class="st">"less"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In most cases, since we are dealing with limited samples from a population, we will want to use the t rather than the normal distribution as the basis for making our power evaluations. The <code>power.t.test()</code> function lets us easily implement power calculations based on the t distribution, and the results of using it should be very similar to those we found above by simulation. The <code>power.t.test()</code> function takes as possible arguments the sample size, <code>n=</code> (<span class="math inline">\(n\)</span>), the difference, <code>delta=</code> (<span class="math inline">\(\delta\)</span>) between group means, the standard deviation of the differences between means (<code>sd=</code>, <span class="math inline">\(\sigma\)</span>), the significance level (<code>sig.level=</code>, <span class="math inline">\(\alpha\)</span>), the test <code>type=</code> (“two.sample”, “one.sample”, or “paired”), the <code>alternative=</code> test to run (“two.sided”, “one.sided”), and the <code>desired_power=</code> (<span class="math inline">\(1-\beta\)</span>). Power, <span class="math inline">\(n\)</span>, or the difference between means is left as null and the other arguments are specified. The function then calculates the missing argument.</p>
<section id="challenge-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-2">CHALLENGE</h3>
<p>Using the code below, which graphs the Type II error rate (<span class="math inline">\(\beta\)</span>) and power (<span class="math inline">\(1-\beta\)</span>) for T tests (using the <code>power.t.test()</code> function), explore the effects of changing <span class="math inline">\(\alpha\)</span>, within sample variability (<span class="math inline">\(\sigma\)</span>), and the difference between sample means (i.e., <span class="math inline">\(\mu_0\)</span> and <span class="math inline">\(\mu_A\)</span> for a one sample test (or, equivalently, <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> for a two sample test). The plot shows the effect size, given the difference between the means, (i.e., <span class="math inline">\(\vert(\mu_0 - \mu_A)\vert/\sigma\)</span>) and marks the sample size (<span class="math inline">\(n\)</span>) needed to achieve a power of 0.8.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>power.test <span class="ot">&lt;-</span> <span class="cf">function</span>(mu0, muA, sigma, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">desired_power =</span> <span class="fl">0.8</span>, type,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    alternative) {</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">200</span>) {</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">n =</span> i, <span class="at">delta =</span> <span class="fu">abs</span>(muA <span class="sc">-</span> mu0), <span class="at">sd =</span> sigma, <span class="at">sig.level =</span> alpha,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">power =</span> <span class="cn">NULL</span>, <span class="at">type =</span> type, <span class="at">alternative =</span> alternative)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> <span class="fu">c</span>(p, x<span class="sc">$</span>power)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, p, <span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    critn <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">199</span>) {</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (p[i] <span class="sc">&lt;</span> desired_power <span class="sc">&amp;&amp;</span> p[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">&gt;=</span> desired_power) {</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>            critn <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            critn <span class="ot">&lt;-</span> critn</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(d) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"n"</span>, <span class="st">"power"</span>, <span class="st">"beta"</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"sample size n"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Type II Error Rate, Beta  (Red)</span><span class="sc">\n</span><span class="st">and</span><span class="sc">\n</span><span class="st">Power, 1-Beta (Blue)"</span>) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="st">"Power Explorer for T Tests</span><span class="sc">\n</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="st">      (assuming equal n and variance across the two groups)"</span>) <span class="sc">+</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power), <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> desired_power), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> beta), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> beta), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">x =</span> critn, <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> desired_power), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">lwd =</span> <span class="fl">0.1</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Effect Size = "</span>, <span class="fu">round</span>(<span class="fu">abs</span>(mu0 <span class="sc">-</span> muA)<span class="sc">/</span>sigma,</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">Critical n = "</span>, critn, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(g)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(<span class="fu">power.test</span>(mu0, muA, sigma, alpha, desired_power, type, alternative),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu0 =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="at">initial =</span> <span class="dv">3</span>, <span class="at">step =</span> <span class="dv">1</span>), <span class="at">muA =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="at">initial =</span> <span class="dv">0</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">step =</span> <span class="dv">1</span>), <span class="at">sigma =</span> <span class="fu">slider</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">initial =</span> <span class="dv">3</span>, <span class="at">step =</span> <span class="dv">1</span>), <span class="at">alpha =</span> <span class="fu">slider</span>(<span class="fl">0.01</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.1</span>, <span class="at">initial =</span> <span class="fl">0.05</span>, <span class="at">step =</span> <span class="fl">0.01</span>), <span class="at">desired_power =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">initial =</span> <span class="fl">0.8</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">step =</span> <span class="fl">0.05</span>), <span class="at">alternative =</span> <span class="fu">picker</span>(<span class="st">"two.sided"</span>, <span class="st">"one.sided"</span>), <span class="at">type =</span> <span class="fu">picker</span>(<span class="st">"two.sample"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"one.sample"</span>, <span class="st">"paired"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="concept-review" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="concept-review">Concept Review</h2>
<ul>
<li>Classical null hypothesis significance testing tries to minimize the rate of type I error (<span class="math inline">\(\alpha\)</span>, i.e., the probability of incorrectly rejecting a null hypothesis when it’s correct)</li>
<li>When we try to reduce the rate of type I error (e.g., by decreasing <span class="math inline">\(\alpha\)</span>), all else being equal, we increase the rate of type II error (<span class="math inline">\(\beta\)</span>, i.e., the probability of incorrectly failing to reject the null hypothesis when it’s wrong)</li>
<li>The <strong>power</strong> of a statistical test, <span class="math inline">\(1-\beta\)</span>, is our ability to correctly reject the null hypothesis when it is false</li>
<li>Power depends on the difference between sample means, the standard deviation in the population the sample is drawn from, and the sample size</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./16-module.html" class="pagination-link  aria-label=" &lt;span="" permutation="" tests&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Using Permutation Tests</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./18-module.html" class="pagination-link" aria-label="<span class='chapter-number'>18</span>&nbsp; <span class='chapter-title'>Introduction to Linear Modeling</span>">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb23" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Error, Power, and Effect Size {#module-17}</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objectives</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The objective of this module is to discuss the concepts of Type I and Type II error, the multiple testing problem, statistical power, and effect size and outline how we can use ***R*** to investigate these via simulation and built-in functions.</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminaries</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load {tidyverse} and {manipulate}</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manipulate)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>Let's return to the concepts of **error** and **power**. Recall that Type I error occurs when you **incorrectly reject a true** $H_0$. In any given hypothesis test, the probability of a Type I error is equivalent to the significance level, $\alpha$, and it is this type of error we are often trying to minimize when we are doing classical statistical inference. Type II error occurs when you **incorrectly fail to reject a false** $H_0$ (in other words, fail to find evidence in support of a true $H_A$). Since we do not know what the true $H_A$ actually is, the probability of committing such an error, labeled $\beta$, is not usually known in practice.</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>| What is True | What We Decide | Result                                    |</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>|--------------|----------------|-------------------------------------------|</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>| $H_0$        | $H_0$          | Correctly 'accept' the null               |</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>| $H_0$        | $H_A$          | Falsely reject the null (Type I error)    |</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>| $H_A$        | $H_0$          | Falsely 'accept' the null (Type II error) |</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>| $H_A$        | $H_A$          | Correctly reject the null                 |</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## Type I Error and Multiple Testing</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>Because of how we define $\alpha$, the chance probability of falsely rejecting $H_0$ when $H_0$ is actually true, we would expect to find some "significant" results if we run enough independent hypothesis tests. For example, if we set $\alpha$ at 0.05, we would expect to find one "significant" result in roughly every 20 tests we run, just by chance. The relation of $\alpha$ to the distribution of a variable under a null hypothesis ($\mu$ = $\mu_0$) versus an alternative hypothesis (e.g., $\mu$ <span class="sc">\&gt;</span> $\mu_0$) is shown in the figure below (this example is for an upper one-tailed test). It should be clear that we can reduce the chance of Type I error by decreasing $\alpha$ (shifting the critical value to the right in the $H_0$ distribution). Type I error will also be reduced as the means get further apart or as the standard deviation of the distributions shrinks.</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/typeI.png"</span>)</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>Let's explore this via simulation.</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>We will write some code to simulate a bunch of random datasets from a normal distribution where we set the expected population mean ($\mu_0$) and standard deviation ($\sigma$) and then calculate a $Z$ (or $T$) statistic and p value for each one. We will then look at the "Type I" error rate... the proportion of times that, based on our sample, we would conclude that it was not drawn from the distribution we know to be true.</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>First, let's set up a skeleton function we will call <span class="in">`typeI()`</span> to evaluate the Type I error rate. It should take, as arguments, the parameters of the normal distribution for the null hypothesis we want to simulate from ($\mu_0$ and $\sigma$), our sample size, our $\alpha$ level, what "alternative" type of $Z$ (or $T$) test we want to do ("greater", "less", or "two.tailed"), and the number of simulated datasets we want to generate. Copy and paste in the code below (and note that we set default values for $\alpha$ and the number of simulations). Note that we can use the "t" family of functions instead of the "norm" family.</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a><span class="co"># function skeleton</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>typeI <span class="ot">&lt;-</span> <span class="cf">function</span>(mu0, sigma, n, <span class="at">alternative =</span> <span class="st">"two.tailed"</span>,</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">k =</span> <span class="dv">10000</span>){</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>Now, we will add the body of the function.</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>typeI <span class="ot">&lt;-</span> <span class="cf">function</span>(mu0, sigma, n, <span class="at">alternative =</span> <span class="st">"two.tailed"</span>,</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">k =</span> <span class="dv">10000</span>){</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, k)</span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set a vector of k empty p values, one for each simulation</span></span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sets up a loop to run k simulations</span></span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma)</span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># draws a sample of size n from our distribution</span></span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="co"># calculates the mean</span></span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x) <span class="co"># calculates the standard deviation</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu0) <span class="sc">/</span> (s <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculates the Z statistic for the sample drawn from the</span></span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   null distribution relative to the null distribution</span></span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># alternatively use t &lt;- (m-mu0)/(s/sqrt(n))</span></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"less"</span>) {</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>      p[[i]] <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>      <span class="co"># calculates the associated p value</span></span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>      <span class="co"># alternatively, use p[[i]] &lt;- pt(t, df = n-1,</span></span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   lower.tail = TRUE)</span></span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"greater"</span>) {</span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>      p[[i]] <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>      <span class="co"># calculates the associated p value</span></span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>      <span class="co"># alternatively, use p[[i]] &lt;- pt(t, df = n-1,</span></span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   lower.tail=FALSE)</span></span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"two.tailed"</span>) {</span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>        p[[i]] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>      <span class="co"># alternatively, use if (t &gt; 0) {p[[i]] &lt;-</span></span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   pt(t, df = n-1, lower.tail = FALSE)}</span></span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (z <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>        p[[i]] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a>      <span class="co"># alternatively, use if (t &lt; 0) {p[[i]] &lt;-</span></span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   pt(t, df = n-1, lower.tail = TRUE)}</span></span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">dnorm</span>(x, mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a>    mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">main =</span> <span class="fu">paste</span>(</span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sampling Distribution Under Null Hypothesis</span><span class="sc">\n</span></span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a><span class="st">      Type I error rate from simulation = "</span>,</span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a>      <span class="fu">length</span>(p[p <span class="sc">&lt;</span> alpha]) <span class="sc">/</span> k, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">"Pr(x)"</span>, <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb23-109"><a href="#cb23-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)),</span>
<span id="cb23-110"><a href="#cb23-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(mu0, mu0, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))))</span>
<span id="cb23-111"><a href="#cb23-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb23-112"><a href="#cb23-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-113"><a href="#cb23-113" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"less"</span>) {</span>
<span id="cb23-114"><a href="#cb23-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0<span class="dv">-4</span><span class="sc">*</span>sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb23-115"><a href="#cb23-115" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-116"><a href="#cb23-116" aria-hidden="true" tabindex="-1"></a>        <span class="at">to =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-117"><a href="#cb23-117" aria-hidden="true" tabindex="-1"></a>        <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb23-118"><a href="#cb23-118" aria-hidden="true" tabindex="-1"></a>      mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))),</span>
<span id="cb23-119"><a href="#cb23-119" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb23-120"><a href="#cb23-120" aria-hidden="true" tabindex="-1"></a>        <span class="at">to =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb23-121"><a href="#cb23-121" aria-hidden="true" tabindex="-1"></a>        <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)), <span class="dv">0</span>),</span>
<span id="cb23-122"><a href="#cb23-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb23-123"><a href="#cb23-123" aria-hidden="true" tabindex="-1"></a>    q <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb23-124"><a href="#cb23-124" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">-</span></span>
<span id="cb23-125"><a href="#cb23-125" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pnorm</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb23-126"><a href="#cb23-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb23-127"><a href="#cb23-127" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-128"><a href="#cb23-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-129"><a href="#cb23-129" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"greater"</span>) {</span>
<span id="cb23-130"><a href="#cb23-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb23-131"><a href="#cb23-131" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb23-132"><a href="#cb23-132" aria-hidden="true" tabindex="-1"></a>        <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out=</span><span class="dv">100</span>),</span>
<span id="cb23-133"><a href="#cb23-133" aria-hidden="true" tabindex="-1"></a>      mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))),</span>
<span id="cb23-134"><a href="#cb23-134" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb23-135"><a href="#cb23-135" aria-hidden="true" tabindex="-1"></a>        <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb23-136"><a href="#cb23-136" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)),<span class="dv">0</span>),</span>
<span id="cb23-137"><a href="#cb23-137" aria-hidden="true" tabindex="-1"></a>      <span class="at">border =</span> <span class="st">"black"</span>,<span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb23-138"><a href="#cb23-138" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0,</span>
<span id="cb23-139"><a href="#cb23-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">-</span></span>
<span id="cb23-140"><a href="#cb23-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pnorm</span>(mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha) <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb23-141"><a href="#cb23-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb23-142"><a href="#cb23-142" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-143"><a href="#cb23-143" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"two.tailed"</span>) {</span>
<span id="cb23-144"><a href="#cb23-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), </span>
<span id="cb23-145"><a href="#cb23-145" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-146"><a href="#cb23-146" aria-hidden="true" tabindex="-1"></a>      <span class="at">to =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-147"><a href="#cb23-147" aria-hidden="true" tabindex="-1"></a>      <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb23-148"><a href="#cb23-148" aria-hidden="true" tabindex="-1"></a>      mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))),</span>
<span id="cb23-149"><a href="#cb23-149" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-150"><a href="#cb23-150" aria-hidden="true" tabindex="-1"></a>      <span class="at">to =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-151"><a href="#cb23-151" aria-hidden="true" tabindex="-1"></a>      <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="dv">0</span>),</span>
<span id="cb23-152"><a href="#cb23-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">border=</span><span class="st">"black"</span>,<span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb23-153"><a href="#cb23-153" aria-hidden="true" tabindex="-1"></a>    <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-154"><a href="#cb23-154" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-155"><a href="#cb23-155" aria-hidden="true" tabindex="-1"></a>      <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb23-156"><a href="#cb23-156" aria-hidden="true" tabindex="-1"></a>      mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))),</span>
<span id="cb23-157"><a href="#cb23-157" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span></span>
<span id="cb23-158"><a href="#cb23-158" aria-hidden="true" tabindex="-1"></a>      sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-159"><a href="#cb23-159" aria-hidden="true" tabindex="-1"></a>      <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="dv">0</span>),</span>
<span id="cb23-160"><a href="#cb23-160" aria-hidden="true" tabindex="-1"></a>      <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb23-161"><a href="#cb23-161" aria-hidden="true" tabindex="-1"></a>    q <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-162"><a href="#cb23-162" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">-</span> <span class="fu">pnorm</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span></span>
<span id="cb23-163"><a href="#cb23-163" aria-hidden="true" tabindex="-1"></a>      sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span></span>
<span id="cb23-164"><a href="#cb23-164" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pnorm</span>(mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0,</span>
<span id="cb23-165"><a href="#cb23-165" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))<span class="sc">-</span> <span class="fu">pnorm</span>(mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span></span>
<span id="cb23-166"><a href="#cb23-166" aria-hidden="true" tabindex="-1"></a>     sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb23-167"><a href="#cb23-167" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-168"><a href="#cb23-168" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(round(q,digits=3))</span></span>
<span id="cb23-169"><a href="#cb23-169" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   this prints area in the shaded portion(s) of the curve</span></span>
<span id="cb23-170"><a href="#cb23-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">length</span>(p[p <span class="sc">&lt;</span> alpha]) <span class="sc">/</span> k)</span>
<span id="cb23-171"><a href="#cb23-171" aria-hidden="true" tabindex="-1"></a>  <span class="co"># returns the proportion of simulations where p &lt; alpha</span></span>
<span id="cb23-172"><a href="#cb23-172" aria-hidden="true" tabindex="-1"></a>  <span class="co"># or `return(mean(p&lt;alpha))`</span></span>
<span id="cb23-173"><a href="#cb23-173" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-174"><a href="#cb23-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-175"><a href="#cb23-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-176"><a href="#cb23-176" aria-hidden="true" tabindex="-1"></a>Here, $\mu_0$ is our sample mean and $\sigma$ is our sample standard deviation.</span>
<span id="cb23-177"><a href="#cb23-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-178"><a href="#cb23-178" aria-hidden="true" tabindex="-1"></a>Can you explain what each step of this code is doing?</span>
<span id="cb23-179"><a href="#cb23-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-180"><a href="#cb23-180" aria-hidden="true" tabindex="-1"></a>Now, run our Type I error test function with a couple of different values of $\mu_0$, $\sigma$, and $\alpha$. What error rates are returned? They should be always be close to $\alpha$!</span>
<span id="cb23-181"><a href="#cb23-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-184"><a href="#cb23-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-185"><a href="#cb23-185" aria-hidden="true" tabindex="-1"></a>eI <span class="ot">&lt;-</span> <span class="fu">typeI</span>(<span class="at">mu0 =</span> <span class="sc">-</span><span class="dv">3</span>,</span>
<span id="cb23-186"><a href="#cb23-186" aria-hidden="true" tabindex="-1"></a>            <span class="at">sigma =</span> <span class="dv">2</span>,</span>
<span id="cb23-187"><a href="#cb23-187" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="dv">1000</span>,</span>
<span id="cb23-188"><a href="#cb23-188" aria-hidden="true" tabindex="-1"></a>            <span class="at">alternative =</span> <span class="st">"greater"</span>,</span>
<span id="cb23-189"><a href="#cb23-189" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb23-190"><a href="#cb23-190" aria-hidden="true" tabindex="-1"></a>eI <span class="ot">&lt;-</span> <span class="fu">typeI</span>(<span class="at">mu0 =</span> <span class="dv">5</span>,</span>
<span id="cb23-191"><a href="#cb23-191" aria-hidden="true" tabindex="-1"></a>            <span class="at">sigma =</span> <span class="dv">2</span>,</span>
<span id="cb23-192"><a href="#cb23-192" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="dv">1000</span>,</span>
<span id="cb23-193"><a href="#cb23-193" aria-hidden="true" tabindex="-1"></a>            <span class="at">alternative =</span> <span class="st">"less"</span>,</span>
<span id="cb23-194"><a href="#cb23-194" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.01</span>)</span>
<span id="cb23-195"><a href="#cb23-195" aria-hidden="true" tabindex="-1"></a>eI <span class="ot">&lt;-</span> <span class="fu">typeI</span>(<span class="at">mu0 =</span> <span class="dv">10</span>,</span>
<span id="cb23-196"><a href="#cb23-196" aria-hidden="true" tabindex="-1"></a>            <span class="at">sigma =</span> <span class="dv">4</span>,</span>
<span id="cb23-197"><a href="#cb23-197" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="dv">1000</span>,</span>
<span id="cb23-198"><a href="#cb23-198" aria-hidden="true" tabindex="-1"></a>            <span class="at">alternative =</span> <span class="st">"two.tailed"</span>,</span>
<span id="cb23-199"><a href="#cb23-199" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb23-200"><a href="#cb23-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-201"><a href="#cb23-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-202"><a href="#cb23-202" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb23-203"><a href="#cb23-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-204"><a href="#cb23-204" aria-hidden="true" tabindex="-1"></a>How does the Type I error rate change with $n$? With $\sigma$? With $\alpha$?</span>
<span id="cb23-205"><a href="#cb23-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-206"><a href="#cb23-206" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **HINT:** It shouldn't change much... the Type I error rate is defined by $\alpha$!</span></span>
<span id="cb23-207"><a href="#cb23-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-208"><a href="#cb23-208" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple Comparison Corrections</span></span>
<span id="cb23-209"><a href="#cb23-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-210"><a href="#cb23-210" aria-hidden="true" tabindex="-1"></a>One way we can address the multiple testing problem mentioned above is by using what is called the **Bonferroni** correction, which suggests that when doing a total of $k$ independent hypothesis tests, each with a significance level of $\alpha$, we should adjust the $\alpha$ level we use to interpret statistical significance as follow: $\alpha_B = \alpha/k$. For example, if we run 10 independent hypothesis tests, then we should set our adjusted $\alpha$ level for each test as 0.05/10 = 0.005.</span>
<span id="cb23-211"><a href="#cb23-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-212"><a href="#cb23-212" aria-hidden="true" tabindex="-1"></a>With the Bonferroni correction, we are essentially saying that we want to control the rate at which we have even one incorrect rejection of $H_0$ given the entire family of tests we do. This is also referred to as limiting the "family-wise error rate" to level $\alpha$.</span>
<span id="cb23-213"><a href="#cb23-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-216"><a href="#cb23-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-217"><a href="#cb23-217" aria-hidden="true" tabindex="-1"></a><span class="co"># example Bonferroni correction</span></span>
<span id="cb23-218"><a href="#cb23-218" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb23-219"><a href="#cb23-219" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.003</span>, <span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.04</span>, <span class="fl">0.045</span>,</span>
<span id="cb23-220"><a href="#cb23-220" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.11</span>, <span class="fl">0.18</span>, <span class="fl">0.23</span>)</span>
<span id="cb23-221"><a href="#cb23-221" aria-hidden="true" tabindex="-1"></a><span class="co"># vector of p values associated with a set of tests</span></span>
<span id="cb23-222"><a href="#cb23-222" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> pvals <span class="sc">&lt;=</span> alpha<span class="sc">/</span><span class="fu">length</span>(pvals)</span>
<span id="cb23-223"><a href="#cb23-223" aria-hidden="true" tabindex="-1"></a><span class="co"># returns a boolean vector of pvals less than or equal to the</span></span>
<span id="cb23-224"><a href="#cb23-224" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted alpha</span></span>
<span id="cb23-225"><a href="#cb23-225" aria-hidden="true" tabindex="-1"></a>sig <span class="co"># first 3 values are less than the adjusted alpha</span></span>
<span id="cb23-226"><a href="#cb23-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-227"><a href="#cb23-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-228"><a href="#cb23-228" aria-hidden="true" tabindex="-1"></a>Many statisticians consider the **Bonferroni** correction to be an overly conservative one, and there are other corrections we might use to account for multiple testing.</span>
<span id="cb23-229"><a href="#cb23-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-230"><a href="#cb23-230" aria-hidden="true" tabindex="-1"></a>One common alternative is the **Benjamini &amp; Hochberg** correction, which is less conservative. It attempts to control for the "false discovery rate", which is different than the "family-wise error rate". Here, we aim to limit the number of false "discoveries" (i.e., incorrect rejections of the null hypothesis) out of a set of discoveries (i.e., out of the set of results where we would reject the null hypothesis) to $\alpha$.</span>
<span id="cb23-231"><a href="#cb23-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-232"><a href="#cb23-232" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate $p$ values for all tests</span>
<span id="cb23-233"><a href="#cb23-233" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Order $p$ values from smallest to largest (from $p_1$ to $p_m$)</span>
<span id="cb23-234"><a href="#cb23-234" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Call any $p$ value where $p_i ≤ \alpha \times i/m$ significant</span>
<span id="cb23-235"><a href="#cb23-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-238"><a href="#cb23-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-239"><a href="#cb23-239" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb23-240"><a href="#cb23-240" aria-hidden="true" tabindex="-1"></a>psig <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb23-241"><a href="#cb23-241" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.003</span>, <span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.04</span>, <span class="fl">0.045</span>, <span class="fl">0.11</span>, <span class="fl">0.18</span>, .<span class="dv">27</span>)</span>
<span id="cb23-242"><a href="#cb23-242" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pvals)){</span>
<span id="cb23-243"><a href="#cb23-243" aria-hidden="true" tabindex="-1"></a>  psig[i] <span class="ot">&lt;-</span> alpha <span class="sc">*</span> i<span class="sc">/</span><span class="fu">length</span>(pvals)</span>
<span id="cb23-244"><a href="#cb23-244" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-245"><a href="#cb23-245" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">rank=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">pvals =</span> pvals, <span class="at">psig =</span> psig)</span>
<span id="cb23-246"><a href="#cb23-246" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> rank, <span class="at">y =</span> pvals)) <span class="sc">+</span></span>
<span id="cb23-247"><a href="#cb23-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> rank, <span class="at">y =</span> psig))</span>
<span id="cb23-248"><a href="#cb23-248" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb23-249"><a href="#cb23-249" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> pvals <span class="sc">&lt;=</span> psig <span class="co"># vector of significant pvalues</span></span>
<span id="cb23-250"><a href="#cb23-250" aria-hidden="true" tabindex="-1"></a>sig <span class="co"># first 5 values are less than the adjusted alpha, the remaining are not</span></span>
<span id="cb23-251"><a href="#cb23-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-252"><a href="#cb23-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-253"><a href="#cb23-253" aria-hidden="true" tabindex="-1"></a>An alternative way of thinking about this is to adjust **p values** themselves rather than the $\alpha$ levels. We can do this with a built-in ***R*** function, <span class="in">`p.adjust()`</span>, which makes the calculation easy. Using this function, we can specify the kind of correction method we want to apply.</span>
<span id="cb23-254"><a href="#cb23-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-257"><a href="#cb23-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-258"><a href="#cb23-258" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pvals, <span class="at">method=</span><span class="st">"bonferroni"</span>) <span class="sc">&lt;=</span> <span class="fl">0.05</span></span>
<span id="cb23-259"><a href="#cb23-259" aria-hidden="true" tabindex="-1"></a>sig <span class="co"># first 3 adjusted p values are less alpha</span></span>
<span id="cb23-260"><a href="#cb23-260" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pvals, <span class="at">method=</span><span class="st">"BH"</span>) <span class="sc">&lt;=</span> <span class="fl">0.05</span></span>
<span id="cb23-261"><a href="#cb23-261" aria-hidden="true" tabindex="-1"></a>sig <span class="co"># first 5 adjusted p values are less alpha</span></span>
<span id="cb23-262"><a href="#cb23-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-263"><a href="#cb23-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-264"><a href="#cb23-264" aria-hidden="true" tabindex="-1"></a><span class="fu">## Type II Error</span></span>
<span id="cb23-265"><a href="#cb23-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-266"><a href="#cb23-266" aria-hidden="true" tabindex="-1"></a>By reducing the $\alpha$ level we use as our criterion for statistical significance, we can reduce the chance of committing a Type I error (i.e., of incorrectly rejecting a true null hypothesis)... but doing so directly increases our chance of committing a Type II error (i.e., of incorrectly ***failing*** to reject a false null). The shaded area in the figure below, $\beta$, is the probability of incorrectly failing to reject the null...</span>
<span id="cb23-267"><a href="#cb23-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-270"><a href="#cb23-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-271"><a href="#cb23-271" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb23-272"><a href="#cb23-272" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb23-273"><a href="#cb23-273" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/typeII.png"</span>)</span>
<span id="cb23-274"><a href="#cb23-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-275"><a href="#cb23-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-276"><a href="#cb23-276" aria-hidden="true" tabindex="-1"></a>It should be clear from this figure that if the critical value (which, again, is defined by $\alpha$) is shifted to the right (i.e., if we reduce $\alpha$), or if $\mu$ under the alternative hypothesis shifts left, then $\beta$, the area under the alternative hypothesis distribution curve to the left of the critical value, increases! Intuitively, this makes sense: the lower the difference between the true $\mu_A$ value and $\mu_0$ and/or the higher the $\alpha$ level, the harder it will be to reject the null hypothesis that $\mu$ = $\mu_0$.</span>
<span id="cb23-277"><a href="#cb23-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-278"><a href="#cb23-278" aria-hidden="true" tabindex="-1"></a>In practice, we cannot usually calculate $\beta$ because of the need to know where the true distribution is really centered (i.e., we need to know the value of $\mu_A$, which is often unknown). However, we can explore via simulation what $\beta$ is expected to look like under different alternative hypotheses (e.g., under different $\mu_A$) and under different sample sizes and $\alpha$ levels.</span>
<span id="cb23-279"><a href="#cb23-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-280"><a href="#cb23-280" aria-hidden="true" tabindex="-1"></a>Let's do this using the simulation approach we developed above. Again, we will write some code to simulate a bunch of random datasets, this time drawn from a normal distribution associated with a particular alternative hypothesis, $H_A$, that we define... i.e., where we specify $\mu_A$ and $\sigma$, i.e., a mean and a standard deviation. We then calculate a $Z$ (or $T$) statistic based on each sample dataset relative to $\mu_0$, the expected mean under $H_0$, and determine the associated p value for each one. Based on this, we can calculate the Type II error rate... the proportion of times that, based on our sample, we would conclude that it was drawn from the $H_0$ distribution rather than the $H_A$ distribution that we set to be true. Note that, as above, we can use the "t" family of functions in lieu of the "norm" family.</span>
<span id="cb23-281"><a href="#cb23-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-284"><a href="#cb23-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-285"><a href="#cb23-285" aria-hidden="true" tabindex="-1"></a>typeII <span class="ot">&lt;-</span> <span class="cf">function</span>(mu0, muA, sigma, n, <span class="at">alternative =</span> <span class="st">"two.tailed"</span>,</span>
<span id="cb23-286"><a href="#cb23-286" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">k =</span> <span class="dv">10000</span>){</span>
<span id="cb23-287"><a href="#cb23-287" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, k) <span class="co"># sets up a vector of empty p values</span></span>
<span id="cb23-288"><a href="#cb23-288" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb23-289"><a href="#cb23-289" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma)</span>
<span id="cb23-290"><a href="#cb23-290" aria-hidden="true" tabindex="-1"></a>    <span class="co"># draw a sample of size n from Ha</span></span>
<span id="cb23-291"><a href="#cb23-291" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb23-292"><a href="#cb23-292" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb23-293"><a href="#cb23-293" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu0) <span class="sc">/</span> (s <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb23-294"><a href="#cb23-294" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculates the Z statistic for the sample drawn from Ha</span></span>
<span id="cb23-295"><a href="#cb23-295" aria-hidden="true" tabindex="-1"></a>    <span class="co"># relative to the null distribution</span></span>
<span id="cb23-296"><a href="#cb23-296" aria-hidden="true" tabindex="-1"></a>    <span class="co"># or... t &lt;- (m-mu0)/(s/sqrt(n)) # calculates the t statistic</span></span>
<span id="cb23-297"><a href="#cb23-297" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"greater"</span>) {</span>
<span id="cb23-298"><a href="#cb23-298" aria-hidden="true" tabindex="-1"></a>      p[[i]] <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-299"><a href="#cb23-299" aria-hidden="true" tabindex="-1"></a>      <span class="co"># calculates the associated p value for the Z statistic</span></span>
<span id="cb23-300"><a href="#cb23-300" aria-hidden="true" tabindex="-1"></a>      <span class="co"># or... p[[i]] &lt;- pt(t,lower.tail=FALSE,df=n-1)</span></span>
<span id="cb23-301"><a href="#cb23-301" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   calculates the associated p value for the t statistic</span></span>
<span id="cb23-302"><a href="#cb23-302" aria-hidden="true" tabindex="-1"></a>      hyp <span class="ot">&lt;-</span> <span class="st">"muA &gt; mu0"</span></span>
<span id="cb23-303"><a href="#cb23-303" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-304"><a href="#cb23-304" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"less"</span>) {</span>
<span id="cb23-305"><a href="#cb23-305" aria-hidden="true" tabindex="-1"></a>      p[[i]] <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-306"><a href="#cb23-306" aria-hidden="true" tabindex="-1"></a>      <span class="co"># or... p[[i]] &lt;- pt(t, lower.tail = TRUE, df = n - 1)</span></span>
<span id="cb23-307"><a href="#cb23-307" aria-hidden="true" tabindex="-1"></a>    hyp <span class="ot">&lt;-</span> <span class="st">"muA &lt; mu0"</span></span>
<span id="cb23-308"><a href="#cb23-308" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-309"><a href="#cb23-309" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"two.tailed"</span>) {</span>
<span id="cb23-310"><a href="#cb23-310" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {p[[i]] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)}</span>
<span id="cb23-311"><a href="#cb23-311" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (z <span class="sc">&lt;</span> <span class="dv">0</span>) {p[[i]] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb23-312"><a href="#cb23-312" aria-hidden="true" tabindex="-1"></a>      <span class="co"># if (t &gt; 0) {p[[i]] &lt;- 2 * pt(t, lower.tail = FALSE, df = n-1)}</span></span>
<span id="cb23-313"><a href="#cb23-313" aria-hidden="true" tabindex="-1"></a>      <span class="co"># if (t &lt; 0) {p[[i]] &lt;- 2 * pt(t, lower.tail = TRUE, df = n-1)}</span></span>
<span id="cb23-314"><a href="#cb23-314" aria-hidden="true" tabindex="-1"></a>      hyp <span class="ot">&lt;-</span> <span class="st">"muA ≠ mu0"</span></span>
<span id="cb23-315"><a href="#cb23-315" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-316"><a href="#cb23-316" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-317"><a href="#cb23-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-318"><a href="#cb23-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(</span>
<span id="cb23-319"><a href="#cb23-319" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(x, mu0, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-320"><a href="#cb23-320" aria-hidden="true" tabindex="-1"></a>    mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">main =</span> <span class="fu">paste</span>(</span>
<span id="cb23-321"><a href="#cb23-321" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sampling Distributions Under Null (red) and Alternative (blue) Hypotheses</span><span class="sc">\n</span></span>
<span id="cb23-322"><a href="#cb23-322" aria-hidden="true" tabindex="-1"></a><span class="st">      Type II error rate from simulation = "</span>,</span>
<span id="cb23-323"><a href="#cb23-323" aria-hidden="true" tabindex="-1"></a>      <span class="fu">length</span>(p[p <span class="sc">&gt;=</span> alpha]) <span class="sc">/</span> k, <span class="at">sep =</span> <span class="st">""</span>),</span>
<span id="cb23-324"><a href="#cb23-324" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"Pr(x)"</span>, <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb23-325"><a href="#cb23-325" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(<span class="fu">c</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-326"><a href="#cb23-326" aria-hidden="true" tabindex="-1"></a>      muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))),</span>
<span id="cb23-327"><a href="#cb23-327" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(<span class="fu">c</span>(mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)))),</span>
<span id="cb23-328"><a href="#cb23-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">c</span>(<span class="fu">dnorm</span>(mu0, mu0, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))),</span>
<span id="cb23-329"><a href="#cb23-329" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dnorm</span>(muA, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))))</span>
<span id="cb23-330"><a href="#cb23-330" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-331"><a href="#cb23-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-332"><a href="#cb23-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(</span>
<span id="cb23-333"><a href="#cb23-333" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(x, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-334"><a href="#cb23-334" aria-hidden="true" tabindex="-1"></a>    muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb23-335"><a href="#cb23-335" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-336"><a href="#cb23-336" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-337"><a href="#cb23-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb23-338"><a href="#cb23-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-339"><a href="#cb23-339" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"less"</span>) {</span>
<span id="cb23-340"><a href="#cb23-340" aria-hidden="true" tabindex="-1"></a>    <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-341"><a href="#cb23-341" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-342"><a href="#cb23-342" aria-hidden="true" tabindex="-1"></a>        <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb23-343"><a href="#cb23-343" aria-hidden="true" tabindex="-1"></a>      muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))),</span>
<span id="cb23-344"><a href="#cb23-344" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span></span>
<span id="cb23-345"><a href="#cb23-345" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-346"><a href="#cb23-346" aria-hidden="true" tabindex="-1"></a>        <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="dv">0</span>),</span>
<span id="cb23-347"><a href="#cb23-347" aria-hidden="true" tabindex="-1"></a>      <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb23-348"><a href="#cb23-348" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-349"><a href="#cb23-349" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb23-350"><a href="#cb23-350" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-351"><a href="#cb23-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-352"><a href="#cb23-352" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"greater"</span>) {</span>
<span id="cb23-353"><a href="#cb23-353" aria-hidden="true" tabindex="-1"></a>    <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-354"><a href="#cb23-354" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-355"><a href="#cb23-355" aria-hidden="true" tabindex="-1"></a>        <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-356"><a href="#cb23-356" aria-hidden="true" tabindex="-1"></a>        <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb23-357"><a href="#cb23-357" aria-hidden="true" tabindex="-1"></a>      mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))),</span>
<span id="cb23-358"><a href="#cb23-358" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-359"><a href="#cb23-359" aria-hidden="true" tabindex="-1"></a>        <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-360"><a href="#cb23-360" aria-hidden="true" tabindex="-1"></a>        <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb23-361"><a href="#cb23-361" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="dv">0</span>),</span>
<span id="cb23-362"><a href="#cb23-362" aria-hidden="true" tabindex="-1"></a>      <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb23-363"><a href="#cb23-363" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-364"><a href="#cb23-364" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb23-365"><a href="#cb23-365" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-366"><a href="#cb23-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-367"><a href="#cb23-367" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">"two.tailed"</span>) {</span>
<span id="cb23-368"><a href="#cb23-368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-369"><a href="#cb23-369" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb23-370"><a href="#cb23-370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-371"><a href="#cb23-371" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb23-372"><a href="#cb23-372" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-373"><a href="#cb23-373" aria-hidden="true" tabindex="-1"></a>    <span class="co"># greater</span></span>
<span id="cb23-374"><a href="#cb23-374" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-375"><a href="#cb23-375" aria-hidden="true" tabindex="-1"></a>        <span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-376"><a href="#cb23-376" aria-hidden="true" tabindex="-1"></a>          <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-377"><a href="#cb23-377" aria-hidden="true" tabindex="-1"></a>          <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb23-378"><a href="#cb23-378" aria-hidden="true" tabindex="-1"></a>        mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))),</span>
<span id="cb23-379"><a href="#cb23-379" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-380"><a href="#cb23-380" aria-hidden="true" tabindex="-1"></a>          <span class="at">to =</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-381"><a href="#cb23-381" aria-hidden="true" tabindex="-1"></a>          <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb23-382"><a href="#cb23-382" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="dv">0</span>),</span>
<span id="cb23-383"><a href="#cb23-383" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb23-384"><a href="#cb23-384" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-385"><a href="#cb23-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-386"><a href="#cb23-386" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (z <span class="sc">&lt;</span> <span class="dv">0</span>){</span>
<span id="cb23-387"><a href="#cb23-387" aria-hidden="true" tabindex="-1"></a>      <span class="co"># less</span></span>
<span id="cb23-388"><a href="#cb23-388" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-389"><a href="#cb23-389" aria-hidden="true" tabindex="-1"></a>        <span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-390"><a href="#cb23-390" aria-hidden="true" tabindex="-1"></a>          <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb23-391"><a href="#cb23-391" aria-hidden="true" tabindex="-1"></a>        muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))),</span>
<span id="cb23-392"><a href="#cb23-392" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span></span>
<span id="cb23-393"><a href="#cb23-393" aria-hidden="true" tabindex="-1"></a>          sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-394"><a href="#cb23-394" aria-hidden="true" tabindex="-1"></a>          <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb23-395"><a href="#cb23-395" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="dv">0</span>),</span>
<span id="cb23-396"><a href="#cb23-396" aria-hidden="true" tabindex="-1"></a>      <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb23-397"><a href="#cb23-397" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-398"><a href="#cb23-398" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-399"><a href="#cb23-399" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-400"><a href="#cb23-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">length</span>(p[p <span class="sc">&gt;=</span> alpha]) <span class="sc">/</span> k)</span>
<span id="cb23-401"><a href="#cb23-401" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-402"><a href="#cb23-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-403"><a href="#cb23-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-404"><a href="#cb23-404" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb23-405"><a href="#cb23-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-406"><a href="#cb23-406" aria-hidden="true" tabindex="-1"></a>Explore this function using different values of $\mu_0$, $\sigma$, $n$, and different types of one- and two-tailed tests.</span>
<span id="cb23-407"><a href="#cb23-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-410"><a href="#cb23-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-411"><a href="#cb23-411" aria-hidden="true" tabindex="-1"></a><span class="co"># Ha &lt; H0</span></span>
<span id="cb23-412"><a href="#cb23-412" aria-hidden="true" tabindex="-1"></a>eII <span class="ot">&lt;-</span> <span class="fu">typeII</span>(<span class="at">mu0 =</span> <span class="dv">5</span>, <span class="at">muA =</span> <span class="dv">2</span>, <span class="at">sigma =</span> <span class="dv">4</span>, <span class="at">n =</span> <span class="dv">18</span>,</span>
<span id="cb23-413"><a href="#cb23-413" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative=</span><span class="st">"less"</span>)</span>
<span id="cb23-414"><a href="#cb23-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-415"><a href="#cb23-415" aria-hidden="true" tabindex="-1"></a><span class="co"># Ha ≠ H0</span></span>
<span id="cb23-416"><a href="#cb23-416" aria-hidden="true" tabindex="-1"></a>eII <span class="ot">&lt;-</span> <span class="fu">typeII</span>(<span class="at">mu0 =</span> <span class="dv">5</span>, <span class="at">muA =</span> <span class="dv">7</span>, <span class="at">sigma =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">15</span>,</span>
<span id="cb23-417"><a href="#cb23-417" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative=</span><span class="st">"two.tailed"</span>)</span>
<span id="cb23-418"><a href="#cb23-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-419"><a href="#cb23-419" aria-hidden="true" tabindex="-1"></a><span class="co"># Ha &gt; H0</span></span>
<span id="cb23-420"><a href="#cb23-420" aria-hidden="true" tabindex="-1"></a>eII <span class="ot">&lt;-</span> <span class="fu">typeII</span>(<span class="at">mu0 =</span> <span class="dv">0</span>, <span class="at">muA =</span> <span class="fl">0.5</span>, <span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">n =</span> <span class="dv">30</span>,</span>
<span id="cb23-421"><a href="#cb23-421" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative=</span><span class="st">"greater"</span>, <span class="at">alpha=</span><span class="fl">0.01</span>)</span>
<span id="cb23-422"><a href="#cb23-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-423"><a href="#cb23-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-424"><a href="#cb23-424" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What happens if you increase $\sigma$ keeping other values constant?</span>
<span id="cb23-425"><a href="#cb23-425" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What happens if you reduce $n$ or increase $n$?</span>
<span id="cb23-426"><a href="#cb23-426" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What happens if you increase the difference between $\mu_A$ and $\mu_0$?</span>
<span id="cb23-427"><a href="#cb23-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-428"><a href="#cb23-428" aria-hidden="true" tabindex="-1"></a><span class="fu">## Power and Effect Size</span></span>
<span id="cb23-429"><a href="#cb23-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-430"><a href="#cb23-430" aria-hidden="true" tabindex="-1"></a>**Power** is the *probability of correctly rejecting a null hypothesis that is untrue*. For a test that has a Type II error rate of $\beta$, the statistical power is defined, simply, as $1-\beta$. Power values of 0.8 or greater are conventionally considered to be "high". Power for any given test depends on the difference in means between groups or treatments, $\alpha$, $n$, and $\sigma$.</span>
<span id="cb23-431"><a href="#cb23-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-432"><a href="#cb23-432" aria-hidden="true" tabindex="-1"></a>Generally speaking, **effect size** is a quantitative measure of the *strength of a phenomenon*. Here, we are interested in comparing two sample means, and the most common way to describe the effect size is as a **standardized difference** between the means of the groups being compared. In this case, we divide the absolute values of the difference between the means by the standard deviation: $\frac{\vert(\mu_0 - \mu_A)\vert}{\sigma}$. This results in a scaleless measure. Conventionally, effect sizes of 0.2 or less are considered to be low and of 0.8 or greater are considered to be high.</span>
<span id="cb23-433"><a href="#cb23-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-434"><a href="#cb23-434" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualizing Power and Effect Size</span></span>
<span id="cb23-435"><a href="#cb23-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-436"><a href="#cb23-436" aria-hidden="true" tabindex="-1"></a>The code below lets you explore power and effect size interactively. You can use the sliders to set $\mu_0$ and $\mu_A$ for a one-sample test (or, alternatively, think about these as $\mu_1$ and $\mu_2$ for a two-sample test), $\sigma$, $\alpha$, and $n$, and you can choose whether you are testing a one-sided hypothesis of $\mu_A$ being "greater" or "less" than $\mu_0$ or are testing the two-sided hypothesis that $\mu_A$ ≠ $\mu_0$ ("two.tailed"). The figure will output **power** and **effect size**. Note that $n$ is the number of observations (or differences) being considered and $\sigma$ is the standard deviation in the observation (or difference values).</span>
<span id="cb23-437"><a href="#cb23-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-438"><a href="#cb23-438" aria-hidden="true" tabindex="-1"></a>First, we define a function that plots the relationship between these factors and power:</span>
<span id="cb23-439"><a href="#cb23-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-442"><a href="#cb23-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-443"><a href="#cb23-443" aria-hidden="true" tabindex="-1"></a>power.plot <span class="ot">&lt;-</span> <span class="cf">function</span>(mu0, muA, n, sigma, alpha, <span class="at">alternative =</span> <span class="st">"two.tailed"</span>){</span>
<span id="cb23-444"><a href="#cb23-444" aria-hidden="true" tabindex="-1"></a>  pow <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-445"><a href="#cb23-445" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> (muA <span class="sc">-</span> mu0) <span class="sc">/</span> (sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb23-446"><a href="#cb23-446" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">mu =</span> <span class="fu">c</span>(</span>
<span id="cb23-447"><a href="#cb23-447" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(mu0 <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)),</span>
<span id="cb23-448"><a href="#cb23-448" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(mu0 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)))),</span>
<span id="cb23-449"><a href="#cb23-449" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> mu)) <span class="sc">+</span></span>
<span id="cb23-450"><a href="#cb23-450" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Explore Power and Effect Size for Z Test</span></span>
<span id="cb23-451"><a href="#cb23-451" aria-hidden="true" tabindex="-1"></a><span class="st">      for a sample of size "</span>, n))</span>
<span id="cb23-452"><a href="#cb23-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-453"><a href="#cb23-453" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(</span>
<span id="cb23-454"><a href="#cb23-454" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dnorm</span>(mu0, mu0, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.1</span>,</span>
<span id="cb23-455"><a href="#cb23-455" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dnorm</span>(muA, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.1</span>)))</span>
<span id="cb23-456"><a href="#cb23-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-457"><a href="#cb23-457" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="cb23-458"><a href="#cb23-458" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb23-459"><a href="#cb23-459" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-460"><a href="#cb23-460" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="cb23-461"><a href="#cb23-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> muA, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb23-462"><a href="#cb23-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-463"><a href="#cb23-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-464"><a href="#cb23-464" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative<span class="sc">==</span><span class="st">"greater"</span>){</span>
<span id="cb23-465"><a href="#cb23-465" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-466"><a href="#cb23-466" aria-hidden="true" tabindex="-1"></a>      xcrit <span class="ot">=</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb23-467"><a href="#cb23-467" aria-hidden="true" tabindex="-1"></a>      g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="at">x =</span> xcrit, <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb23-468"><a href="#cb23-468" aria-hidden="true" tabindex="-1"></a>        <span class="at">xend =</span> xcrit,</span>
<span id="cb23-469"><a href="#cb23-469" aria-hidden="true" tabindex="-1"></a>        <span class="at">yend =</span> <span class="fu">max</span>(</span>
<span id="cb23-470"><a href="#cb23-470" aria-hidden="true" tabindex="-1"></a>          <span class="fu">dnorm</span>(mu0, mu0, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>,</span>
<span id="cb23-471"><a href="#cb23-471" aria-hidden="true" tabindex="-1"></a>          <span class="fu">dnorm</span>(muA, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>),</span>
<span id="cb23-472"><a href="#cb23-472" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="dv">3</span>)</span>
<span id="cb23-473"><a href="#cb23-473" aria-hidden="true" tabindex="-1"></a>      g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(</span>
<span id="cb23-474"><a href="#cb23-474" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">c</span>(xcrit, <span class="fu">seq</span>(<span class="at">from =</span> xcrit,</span>
<span id="cb23-475"><a href="#cb23-475" aria-hidden="true" tabindex="-1"></a>          <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb23-476"><a href="#cb23-476" aria-hidden="true" tabindex="-1"></a>          muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)),</span>
<span id="cb23-477"><a href="#cb23-477" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> xcrit,</span>
<span id="cb23-478"><a href="#cb23-478" aria-hidden="true" tabindex="-1"></a>          <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb23-479"><a href="#cb23-479" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="dv">0</span>))),</span>
<span id="cb23-480"><a href="#cb23-480" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb23-481"><a href="#cb23-481" aria-hidden="true" tabindex="-1"></a>      pow <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), muA,</span>
<span id="cb23-482"><a href="#cb23-482" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">-</span> <span class="fu">pnorm</span>(xcrit, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb23-483"><a href="#cb23-483" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-484"><a href="#cb23-484" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-485"><a href="#cb23-485" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-486"><a href="#cb23-486" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative<span class="sc">==</span><span class="st">"less"</span>){</span>
<span id="cb23-487"><a href="#cb23-487" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (z<span class="sc">&lt;</span><span class="dv">0</span>) {</span>
<span id="cb23-488"><a href="#cb23-488" aria-hidden="true" tabindex="-1"></a>      xcrit <span class="ot">=</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb23-489"><a href="#cb23-489" aria-hidden="true" tabindex="-1"></a>      g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="at">x =</span> xcrit, <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb23-490"><a href="#cb23-490" aria-hidden="true" tabindex="-1"></a>        <span class="at">xend =</span> xcrit,</span>
<span id="cb23-491"><a href="#cb23-491" aria-hidden="true" tabindex="-1"></a>        <span class="at">yend =</span> <span class="fu">max</span>(</span>
<span id="cb23-492"><a href="#cb23-492" aria-hidden="true" tabindex="-1"></a>          <span class="fu">dnorm</span>(mu0, mu0, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>,</span>
<span id="cb23-493"><a href="#cb23-493" aria-hidden="true" tabindex="-1"></a>          <span class="fu">dnorm</span>(muA, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>),</span>
<span id="cb23-494"><a href="#cb23-494" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="dv">3</span>)</span>
<span id="cb23-495"><a href="#cb23-495" aria-hidden="true" tabindex="-1"></a>      g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(</span>
<span id="cb23-496"><a href="#cb23-496" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">c</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-497"><a href="#cb23-497" aria-hidden="true" tabindex="-1"></a>          <span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">to =</span> xcrit,</span>
<span id="cb23-498"><a href="#cb23-498" aria-hidden="true" tabindex="-1"></a>            <span class="at">length.out =</span> <span class="dv">1000</span>), xcrit),</span>
<span id="cb23-499"><a href="#cb23-499" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-500"><a href="#cb23-500" aria-hidden="true" tabindex="-1"></a>          <span class="at">to =</span> xcrit, <span class="at">length.out =</span> <span class="dv">1000</span>), <span class="at">mean =</span> muA,</span>
<span id="cb23-501"><a href="#cb23-501" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="dv">0</span>))),</span>
<span id="cb23-502"><a href="#cb23-502" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb23-503"><a href="#cb23-503" aria-hidden="true" tabindex="-1"></a>      pow <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(xcrit, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">-</span></span>
<span id="cb23-504"><a href="#cb23-504" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pnorm</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), muA, sigma <span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb23-505"><a href="#cb23-505" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-506"><a href="#cb23-506" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-507"><a href="#cb23-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-508"><a href="#cb23-508" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative<span class="sc">==</span><span class="st">"two.tailed"</span>){</span>
<span id="cb23-509"><a href="#cb23-509" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-510"><a href="#cb23-510" aria-hidden="true" tabindex="-1"></a>      xcrit <span class="ot">=</span> mu0 <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb23-511"><a href="#cb23-511" aria-hidden="true" tabindex="-1"></a>      g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="at">x =</span> xcrit, <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb23-512"><a href="#cb23-512" aria-hidden="true" tabindex="-1"></a>        <span class="at">xend =</span> xcrit,</span>
<span id="cb23-513"><a href="#cb23-513" aria-hidden="true" tabindex="-1"></a>        <span class="at">yend =</span> <span class="fu">max</span>(</span>
<span id="cb23-514"><a href="#cb23-514" aria-hidden="true" tabindex="-1"></a>          <span class="fu">dnorm</span>(mu0, mu0, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>,</span>
<span id="cb23-515"><a href="#cb23-515" aria-hidden="true" tabindex="-1"></a>          <span class="fu">dnorm</span>(muA, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>),</span>
<span id="cb23-516"><a href="#cb23-516" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="dv">3</span>)</span>
<span id="cb23-517"><a href="#cb23-517" aria-hidden="true" tabindex="-1"></a>      g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(</span>
<span id="cb23-518"><a href="#cb23-518" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">c</span>(xcrit, <span class="fu">seq</span>(<span class="at">from =</span> xcrit,</span>
<span id="cb23-519"><a href="#cb23-519" aria-hidden="true" tabindex="-1"></a>          <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb23-520"><a href="#cb23-520" aria-hidden="true" tabindex="-1"></a>          muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)),</span>
<span id="cb23-521"><a href="#cb23-521" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> xcrit,</span>
<span id="cb23-522"><a href="#cb23-522" aria-hidden="true" tabindex="-1"></a>          <span class="at">to =</span> muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb23-523"><a href="#cb23-523" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> muA, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="dv">0</span>))),</span>
<span id="cb23-524"><a href="#cb23-524" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb23-525"><a href="#cb23-525" aria-hidden="true" tabindex="-1"></a>      pow <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(muA <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">-</span></span>
<span id="cb23-526"><a href="#cb23-526" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pnorm</span>(xcrit, muA, sigma <span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb23-527"><a href="#cb23-527" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-528"><a href="#cb23-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-529"><a href="#cb23-529" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (z <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-530"><a href="#cb23-530" aria-hidden="true" tabindex="-1"></a>      xcrit <span class="ot">=</span> mu0 <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb23-531"><a href="#cb23-531" aria-hidden="true" tabindex="-1"></a>      g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="at">x =</span> xcrit, <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb23-532"><a href="#cb23-532" aria-hidden="true" tabindex="-1"></a>        <span class="at">xend =</span> xcrit,</span>
<span id="cb23-533"><a href="#cb23-533" aria-hidden="true" tabindex="-1"></a>        <span class="at">yend =</span> <span class="fu">max</span>(</span>
<span id="cb23-534"><a href="#cb23-534" aria-hidden="true" tabindex="-1"></a>          <span class="fu">dnorm</span>(mu0, mu0, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>,</span>
<span id="cb23-535"><a href="#cb23-535" aria-hidden="true" tabindex="-1"></a>          <span class="fu">dnorm</span>(muA, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.025</span>),</span>
<span id="cb23-536"><a href="#cb23-536" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="dv">3</span>)</span>
<span id="cb23-537"><a href="#cb23-537" aria-hidden="true" tabindex="-1"></a>      g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(</span>
<span id="cb23-538"><a href="#cb23-538" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">c</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-539"><a href="#cb23-539" aria-hidden="true" tabindex="-1"></a>          <span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="at">to =</span> xcrit,</span>
<span id="cb23-540"><a href="#cb23-540" aria-hidden="true" tabindex="-1"></a>            <span class="at">length.out =</span> <span class="dv">1000</span>), xcrit),</span>
<span id="cb23-541"><a href="#cb23-541" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-542"><a href="#cb23-542" aria-hidden="true" tabindex="-1"></a>          <span class="at">to =</span> xcrit, <span class="at">length.out =</span> <span class="dv">1000</span>), <span class="at">mean =</span> muA,</span>
<span id="cb23-543"><a href="#cb23-543" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="dv">0</span>))),</span>
<span id="cb23-544"><a href="#cb23-544" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb23-545"><a href="#cb23-545" aria-hidden="true" tabindex="-1"></a>      pow <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(xcrit, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">-</span></span>
<span id="cb23-546"><a href="#cb23-546" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pnorm</span>(muA <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n), muA, sigma <span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb23-547"><a href="#cb23-547" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-548"><a href="#cb23-548" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-549"><a href="#cb23-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-550"><a href="#cb23-550" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span></span>
<span id="cb23-551"><a href="#cb23-551" aria-hidden="true" tabindex="-1"></a>    g <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb23-552"><a href="#cb23-552" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">max</span>(mu0, muA) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-553"><a href="#cb23-553" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">max</span>(</span>
<span id="cb23-554"><a href="#cb23-554" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dnorm</span>(mu0, mu0, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.075</span>,</span>
<span id="cb23-555"><a href="#cb23-555" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dnorm</span>(muA, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.075</span>),</span>
<span id="cb23-556"><a href="#cb23-556" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Effect Size = "</span>,</span>
<span id="cb23-557"><a href="#cb23-557" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(<span class="fu">abs</span>((muA <span class="sc">-</span> mu0)) <span class="sc">/</span> sigma, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb23-558"><a href="#cb23-558" aria-hidden="true" tabindex="-1"></a>        <span class="st">"</span><span class="sc">\n</span><span class="st">Power = "</span>, <span class="fu">round</span>(pow, <span class="at">digits =</span> <span class="dv">3</span>), <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb23-559"><a href="#cb23-559" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-560"><a href="#cb23-560" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">min</span>(mu0, muA) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb23-561"><a href="#cb23-561" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">max</span>(</span>
<span id="cb23-562"><a href="#cb23-562" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dnorm</span>(mu0, mu0, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.075</span>,</span>
<span id="cb23-563"><a href="#cb23-563" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dnorm</span>(muA, muA, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">+</span> <span class="fl">0.075</span>),</span>
<span id="cb23-564"><a href="#cb23-564" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Red = mu0</span><span class="sc">\n</span><span class="st">Blue = muA"</span>)</span>
<span id="cb23-565"><a href="#cb23-565" aria-hidden="true" tabindex="-1"></a>  g</span>
<span id="cb23-566"><a href="#cb23-566" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-567"><a href="#cb23-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-568"><a href="#cb23-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-571"><a href="#cb23-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-572"><a href="#cb23-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb23-573"><a href="#cb23-573" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(</span>
<span id="cb23-574"><a href="#cb23-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">power.plot</span>(mu0, muA, n, sigma, alpha, alternative),</span>
<span id="cb23-575"><a href="#cb23-575" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu0 =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="at">step =</span> <span class="fl">0.1</span>, <span class="at">initial =</span> <span class="dv">0</span>),</span>
<span id="cb23-576"><a href="#cb23-576" aria-hidden="true" tabindex="-1"></a>  <span class="at">muA =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="at">step =</span> <span class="fl">0.1</span>, <span class="at">initial =</span> <span class="dv">2</span>),</span>
<span id="cb23-577"><a href="#cb23-577" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">slider</span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="at">step =</span> <span class="dv">1</span>, <span class="at">initial =</span> <span class="dv">15</span>),</span>
<span id="cb23-578"><a href="#cb23-578" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">slider</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="at">step =</span> <span class="fl">0.1</span>, <span class="at">initial =</span> <span class="dv">2</span>),</span>
<span id="cb23-579"><a href="#cb23-579" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">slider</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="at">step =</span> <span class="fl">0.01</span>, <span class="at">initial =</span> <span class="fl">0.05</span>),</span>
<span id="cb23-580"><a href="#cb23-580" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="fu">picker</span>(<span class="st">"two.tailed"</span>,<span class="st">"greater"</span>,<span class="st">"less"</span>)</span>
<span id="cb23-581"><a href="#cb23-581" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-582"><a href="#cb23-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-583"><a href="#cb23-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-584"><a href="#cb23-584" aria-hidden="true" tabindex="-1"></a>In most cases, since we are dealing with limited samples from a population, we will want to use the t rather than the normal distribution as the basis for making our power evaluations. The <span class="in">`power.t.test()`</span> function lets us easily implement power calculations based on the t distribution, and the results of using it should be very similar to those we found above by simulation. The <span class="in">`power.t.test()`</span> function takes as possible arguments the sample size, <span class="in">`n=`</span> ($n$), the difference, <span class="in">`delta=`</span> ($\delta$) between group means, the standard deviation of the differences between means (<span class="in">`sd=`</span>, $\sigma$), the significance level (<span class="in">`sig.level=`</span>, $\alpha$), the test <span class="in">`type=`</span> ("two.sample", "one.sample", or "paired"), the <span class="in">`alternative=`</span> test to run ("two.sided", "one.sided"), and the <span class="in">`desired_power=`</span> ($1-\beta$). Power, $n$, or the difference between means is left as null and the other arguments are specified. The function then calculates the missing argument.</span>
<span id="cb23-585"><a href="#cb23-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-586"><a href="#cb23-586" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb23-587"><a href="#cb23-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-588"><a href="#cb23-588" aria-hidden="true" tabindex="-1"></a>Using the code below, which graphs the Type II error rate ($\beta$) and power ($1-\beta$) for T tests (using the <span class="in">`power.t.test()`</span> function), explore the effects of changing $\alpha$, within sample variability ($\sigma$), and the difference between sample means (i.e., $\mu_0$ and $\mu_A$ for a one sample test (or, equivalently, $\mu_1$ and $\mu_2$ for a two sample test). The plot shows the effect size, given the difference between the means, (i.e., $\vert(\mu_0 - \mu_A)\vert/\sigma$) and marks the sample size ($n$) needed to achieve a power of 0.8.</span>
<span id="cb23-589"><a href="#cb23-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-592"><a href="#cb23-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-593"><a href="#cb23-593" aria-hidden="true" tabindex="-1"></a>power.test <span class="ot">&lt;-</span> <span class="cf">function</span>(mu0, muA, sigma, <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb23-594"><a href="#cb23-594" aria-hidden="true" tabindex="-1"></a>  <span class="at">desired_power =</span> <span class="fl">0.8</span>, type, alternative) {</span>
<span id="cb23-595"><a href="#cb23-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-596"><a href="#cb23-596" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-597"><a href="#cb23-597" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">200</span>){</span>
<span id="cb23-598"><a href="#cb23-598" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">n =</span> i, <span class="at">delta =</span> <span class="fu">abs</span>(muA <span class="sc">-</span> mu0), <span class="at">sd =</span> sigma,</span>
<span id="cb23-599"><a href="#cb23-599" aria-hidden="true" tabindex="-1"></a>      <span class="at">sig.level =</span> alpha, <span class="at">power =</span> <span class="cn">NULL</span>, <span class="at">type =</span> type,</span>
<span id="cb23-600"><a href="#cb23-600" aria-hidden="true" tabindex="-1"></a>      <span class="at">alternative =</span> alternative)</span>
<span id="cb23-601"><a href="#cb23-601" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">c</span>(p, x<span class="sc">$</span>power)</span>
<span id="cb23-602"><a href="#cb23-602" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-603"><a href="#cb23-603" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, p, <span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb23-604"><a href="#cb23-604" aria-hidden="true" tabindex="-1"></a>  critn <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb23-605"><a href="#cb23-605" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">199</span>){</span>
<span id="cb23-606"><a href="#cb23-606" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (p[i] <span class="sc">&lt;</span> desired_power <span class="sc">&amp;&amp;</span> p[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">&gt;=</span> desired_power) {critn <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span>}</span>
<span id="cb23-607"><a href="#cb23-607" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {critn <span class="ot">&lt;-</span> critn}</span>
<span id="cb23-608"><a href="#cb23-608" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-609"><a href="#cb23-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(d) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"n"</span>, <span class="st">"power"</span>, <span class="st">"beta"</span>)</span>
<span id="cb23-610"><a href="#cb23-610" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"sample size n"</span>) <span class="sc">+</span></span>
<span id="cb23-611"><a href="#cb23-611" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Type II Error Rate, Beta  (Red)</span><span class="sc">\n</span><span class="st">and</span><span class="sc">\n</span><span class="st">Power, 1-Beta (Blue)"</span>) <span class="sc">+</span></span>
<span id="cb23-612"><a href="#cb23-612" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Power Explorer for T Tests</span><span class="sc">\n</span></span>
<span id="cb23-613"><a href="#cb23-613" aria-hidden="true" tabindex="-1"></a><span class="st">      (assuming equal n and variance across the two groups)"</span>) <span class="sc">+</span></span>
<span id="cb23-614"><a href="#cb23-614" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-615"><a href="#cb23-615" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb23-616"><a href="#cb23-616" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-617"><a href="#cb23-617" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power), <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-618"><a href="#cb23-618" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> desired_power), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-619"><a href="#cb23-619" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> beta), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb23-620"><a href="#cb23-620" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-621"><a href="#cb23-621" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> beta), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-622"><a href="#cb23-622" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">x =</span> critn, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> desired_power),</span>
<span id="cb23-623"><a href="#cb23-623" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">lwd =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb23-624"><a href="#cb23-624" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(</span>
<span id="cb23-625"><a href="#cb23-625" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Effect Size = "</span>, <span class="fu">round</span>(<span class="fu">abs</span>(mu0 <span class="sc">-</span> muA) <span class="sc">/</span> sigma, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb23-626"><a href="#cb23-626" aria-hidden="true" tabindex="-1"></a>        <span class="st">"</span><span class="sc">\n</span><span class="st">Critical n = "</span>, critn, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb23-627"><a href="#cb23-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(g)</span>
<span id="cb23-628"><a href="#cb23-628" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-629"><a href="#cb23-629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-630"><a href="#cb23-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-633"><a href="#cb23-633" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-634"><a href="#cb23-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb23-635"><a href="#cb23-635" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(<span class="fu">power.test</span>(mu0, muA, sigma, alpha, desired_power,</span>
<span id="cb23-636"><a href="#cb23-636" aria-hidden="true" tabindex="-1"></a>  type, alternative),</span>
<span id="cb23-637"><a href="#cb23-637" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu0=</span><span class="fu">slider</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="at">initial=</span><span class="dv">3</span>,<span class="at">step=</span><span class="dv">1</span>),</span>
<span id="cb23-638"><a href="#cb23-638" aria-hidden="true" tabindex="-1"></a>    <span class="at">muA=</span><span class="fu">slider</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="at">initial=</span><span class="dv">0</span>,<span class="at">step=</span><span class="dv">1</span>),</span>
<span id="cb23-639"><a href="#cb23-639" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma=</span><span class="fu">slider</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">initial=</span><span class="dv">3</span>,<span class="at">step=</span><span class="dv">1</span>),</span>
<span id="cb23-640"><a href="#cb23-640" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fu">slider</span>(<span class="fl">0.01</span>,<span class="fl">0.10</span>,<span class="at">initial=</span><span class="fl">0.05</span>,<span class="at">step=</span><span class="fl">0.01</span>),</span>
<span id="cb23-641"><a href="#cb23-641" aria-hidden="true" tabindex="-1"></a>    <span class="at">desired_power=</span><span class="fu">slider</span>(<span class="dv">0</span>,<span class="fl">1.0</span>,<span class="at">initial=</span><span class="fl">0.8</span>,<span class="at">step=</span><span class="fl">0.05</span>),</span>
<span id="cb23-642"><a href="#cb23-642" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative=</span><span class="fu">picker</span>(<span class="st">"two.sided"</span>,<span class="st">"one.sided"</span>),</span>
<span id="cb23-643"><a href="#cb23-643" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="fu">picker</span>(<span class="st">"two.sample"</span>,<span class="st">"one.sample"</span>,<span class="st">"paired"</span>))</span>
<span id="cb23-644"><a href="#cb23-644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-645"><a href="#cb23-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-648"><a href="#cb23-648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-649"><a href="#cb23-649" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb23-650"><a href="#cb23-650" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>manipulate)</span>
<span id="cb23-651"><a href="#cb23-651" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>tidyverse)</span>
<span id="cb23-652"><a href="#cb23-652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-653"><a href="#cb23-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-654"><a href="#cb23-654" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb23-655"><a href="#cb23-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-656"><a href="#cb23-656" aria-hidden="true" tabindex="-1"></a><span class="fu">## Concept Review {.unnumbered}</span></span>
<span id="cb23-657"><a href="#cb23-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-658"><a href="#cb23-658" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Classical null hypothesis significance testing tries to minimize the rate of type I error ($\alpha$, i.e., the probability of incorrectly rejecting a null hypothesis when it's correct)</span>
<span id="cb23-659"><a href="#cb23-659" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When we try to reduce the rate of type I error (e.g., by decreasing $\alpha$), all else being equal, we increase the rate of type II error ($\beta$, i.e., the probability of incorrectly failing to reject the null hypothesis when it's wrong)</span>
<span id="cb23-660"><a href="#cb23-660" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **power** of a statistical test, $1-\beta$, is our ability to correctly reject the null hypothesis when it is false</span>
<span id="cb23-661"><a href="#cb23-661" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Power depends on the difference between sample means, the standard deviation in the population the sample is drawn from, and the sample size</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>