<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applied Data Analysis - 15&nbsp; Classical Hypothesis Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./16-module.html" rel="next">
<link href="./14-module.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./15-module.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-logistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Logistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course-schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-typography-and-formatting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Typography and Formatting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-programming-style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming Style Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>RStudio</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extending the Functionality of <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamentals of the <strong><em>R</em></strong> Language</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basics of Version Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Additional Data Structures in <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting Data into <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Functions and Flow Control</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part II - Statistics and Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Descriptive Statisics and Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-module.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Using Permutation Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Elements of Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression and ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Model Selection in Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Mixed Effects or Multilevel Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Part III - Miscellany</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-maximum_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Maximum Likelihood Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-python-from-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using <strong><em>Python</em></strong> from <strong><em>R</em></strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-r-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building Custom <strong><em>R</em></strong> Packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building Interactive Web Apps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-using-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working with and Managing Packages</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 07</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 08</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-08-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 08 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 09</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-09-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 09 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-10-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 10 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 11</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-11-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 11 Solution</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-analysis-replication-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis Replication</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./collaborative-data-science-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Collaborative Data Science Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./creative-dataviz-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creative Data Visualization</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Packages Used</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives"><span class="header-section-number">15.1</span> Objectives</a></li>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link" data-scroll-target="#preliminaries"><span class="header-section-number">15.2</span> Preliminaries</a></li>
  <li><a href="#null-and-alternative-hypotheses" id="toc-null-and-alternative-hypotheses" class="nav-link" data-scroll-target="#null-and-alternative-hypotheses"><span class="header-section-number">15.3</span> Null and Alternative Hypotheses</a></li>
  <li><a href="#parametric-hypothesis-testing" id="toc-parametric-hypothesis-testing" class="nav-link" data-scroll-target="#parametric-hypothesis-testing"><span class="header-section-number">15.4</span> Parametric Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#important-comments-on-p-values" id="toc-important-comments-on-p-values" class="nav-link" data-scroll-target="#important-comments-on-p-values"><span class="header-section-number">15.4.1</span> Important Comments on P Values</a></li>
  <li><a href="#working-with-means" id="toc-working-with-means" class="nav-link" data-scroll-target="#working-with-means">Working with Means</a></li>
  <li><a href="#challenge" id="toc-challenge" class="nav-link" data-scroll-target="#challenge">CHALLENGE</a></li>
  <li><a href="#challenge-1" id="toc-challenge-1" class="nav-link" data-scroll-target="#challenge-1">CHALLENGE</a></li>
  <li><a href="#challenge-2" id="toc-challenge-2" class="nav-link" data-scroll-target="#challenge-2">CHALLENGE</a></li>
  <li><a href="#working-with-proportions" id="toc-working-with-proportions" class="nav-link" data-scroll-target="#working-with-proportions">Working with Proportions</a></li>
  <li><a href="#challenge-3" id="toc-challenge-3" class="nav-link" data-scroll-target="#challenge-3">CHALLENGE</a></li>
  <li><a href="#challenge-4" id="toc-challenge-4" class="nav-link" data-scroll-target="#challenge-4">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#concept-review" id="toc-concept-review" class="nav-link" data-scroll-target="#concept-review">Concept Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./15-module.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="module-15" class="quarto-section-identifier"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="objectives" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="objectives"><span class="header-section-number">15.1</span> Objectives</h2>
<blockquote class="blockquote">
<p>The objective of this module is to introduce basic <em>hypothesis testing</em> from a classical or “frequentist” statistics approach.</p>
</blockquote>
</section>
<section id="preliminaries" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="preliminaries"><span class="header-section-number">15.2</span> Preliminaries</h2>
<ul>
<li>Load {tidyverse} and {mosaic}</li>
</ul>
</section>
<section id="null-and-alternative-hypotheses" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="null-and-alternative-hypotheses"><span class="header-section-number">15.3</span> Null and Alternative Hypotheses</h2>
<div style="float:right; padding-top: 10px; padding-left: 20px; padding-right: 20px; padding-bottom: 10px">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/null_hypothesis.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="150"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Classical hypothesis testing typically involves formally stating a claim - the <strong>null hypothesis</strong> - which is then followed up by statistical evaluation of the null versus an <strong>alternative hypothesis</strong>. The null hypothesis is interpreted as a baseline hypothesis and is the claim that is presumed to be true. That claim is typically that a particular value of a population parameter estimated by a sample statistic we have calculated is <em>consistent with a particular null expectation</em>. The alternative hypothesis is the conjecture that we are testing, usually that the sample statistic is inconsistent with a null expectation.</p>
<p>Typically, our null and alternative hypotheses are expressed something like as follows:</p>
<ul>
<li><span class="math inline">\(H_0\)</span> = <strong>null hypothesis</strong> = a sample statistic shows no deviation from what is expected or neutral based on the parameter space of possible outcomes under the presumed random sampling process.</li>
</ul>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> This parameter space is defined both by <em>how we sample</em> and <em>how we intend to sample</em>, including our stopping rules (e.g., number of observations, amount of time we plan to sample, and so on).</p>
</blockquote>
<ul>
<li><span class="math inline">\(H_A\)</span> = <strong>alternative hypothesis</strong> = a sample statistic deviates more than expected by chance from what is expected or neutral.</li>
</ul>
<p>We can test several different comparisons between <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_A\)</span>.</p>
<ul>
<li><span class="math inline">\(H_A &gt; H_0\)</span>, which constitutes an “upper one-tailed test” (i.e., our sample statistic is greater than that expected under the null)</li>
<li><span class="math inline">\(H_A &lt; H_0\)</span>, which constitutes a “lower one-tailed test” (i.e., our sample statistic is less than that expected under the null)</li>
<li><span class="math inline">\(H_A ≠ H_0\)</span>, which constitutes a “two-tailed test” (i.e., our sample statistic is different, maybe greater maybe less, than that expected under the null)</li>
</ul>
<p>To formally do any statistical test under such a “null hypothesis significance testing” (or NHST) framework, we need some kind of statistical evidence - typically based on probabilities and confidence intervals - to reject the null hypothesis in favor of an alternative hypothesis. This evidence involves considering some measure of <em>how unexpected it would be</em> for a sample we have collected to have been drawn, by chance, from a particular null distribution.</p>
<p>To effect a hypothesis test, we then need to…</p>
<ul>
<li>Calculate a <strong>test statistic</strong> based on our data.</li>
<li>Calculate the <strong>p value</strong> associated with that test statistic, which is the probability of obtaining, by chance, a test statistic that is as high or higher than our calculated one, <em>assuming the null hypothesis is true</em>. Classically, this is done by comparing the value to some appropriate standardized <strong>sampling distribution</strong> with well-known mathematical properties (e.g., normal or <span class="math inline">\(t\)</span>) to yield the <strong>p value</strong>.</li>
<li>Evaluate whether the <strong>p value</strong> is less than or greater than the <strong>significance level</strong>, or <span class="math inline">\(\alpha\)</span>, that we set for our test. That is, <span class="math inline">\(\alpha\)</span> can be thought of as the cutoff level for <strong>p values</strong> below which we feel comfortable rejecting a null hypothesis (i.e., we reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(p &lt; \alpha\)</span>).</li>
</ul>
<p>Under the null hypothesis significance testing framework, there are then four possible outcomes to our statistical decision, each with an associated probability:</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th>What is True</th>
<th>What We Decide</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(H_0\)</span></td>
<td><span class="math inline">\(H_0\)</span></td>
<td>Correctly “accept” the null (<span class="math inline">\(1 - \alpha\)</span>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(H_0\)</span></td>
<td><span class="math inline">\(H_A\)</span></td>
<td>Falsely reject the null (Type I error) <span class="math inline">\(\alpha\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(H_A\)</span></td>
<td><span class="math inline">\(H_0\)</span></td>
<td>Falsely “accept” the null (Type II error) <span class="math inline">\(\beta\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(H_A\)</span></td>
<td><span class="math inline">\(H_A\)</span></td>
<td>Correctly reject the null (<span class="math inline">\(1 - \beta\)</span>), or “power”</td>
</tr>
</tbody>
</table>
<p>We typically approach hypothesis testing by trying to minimize our probability of committing a Type I error (<span class="math inline">\(\alpha\)</span>)… i.e., we aim for having a high bar for falsely rejecting the null hypothesis (e.g., for incorrectly finding an innocent person guilty) and thus set <span class="math inline">\(\alpha\)</span> very low (0.05 or 0.01) to reflect what we decide is an acceptable level of Type I error.</p>
<p>When we set a high bar for falsely rejecting the null, we necessarily lower the bar for incorrectly accepting (i.e., for failing to reject) the null (e.g., for concluding that a guilty person is innocent). The probability of incorrectly “accepting” the null is referred to as Type II error (<span class="math inline">\(\beta\)</span>). The “power” of a statistical test is (<span class="math inline">\(1 - \beta\)</span>), the probability with which we correctly reject the null.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/significant_final.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="parametric-hypothesis-testing" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="parametric-hypothesis-testing"><span class="header-section-number">15.4</span> Parametric Hypothesis Testing</h2>
<p>In traditional <strong>parametric</strong> statistics, we make the assumption that the sampling distribution of our statistic of interest (e.g., a mean) takes the form of a particular well-understood mathematical distribution (e.g., the normal), and we calculate a test statistic that basically summarizes the “location” of a summary statistic about our data relative to that implied, theoretical sampling distribution.</p>
<p>The particular value of our test statistic is determined by both the <strong>difference between the original sample statistic and the expected null value</strong> (e.g., the difference between the mean of our sample and the expected population mean) and the <strong>standard error of the sample statistic</strong>. The value of our test statistic (i.e., the “distance” of that test statistic from what is expected) and the shape of the presumed sampling distribution for that statistic are the sole drivers of the smallness of the <strong>p value</strong>. The <strong>p value</strong> effectively represents the area under the sampling distribution associated with test statistic values <strong>as or more extreme</strong> than the one we observed.</p>
<p>How do we calculate the <strong>p value</strong> for a parametric test?</p>
<ul>
<li><p>Specify the sample statistic we want to evaluate (e.g., the mean).</p></li>
<li><p>Specify the test statistic of interest and the form of the sampling distribution for that statistic (e.g., <span class="math inline">\(Z\)</span> or <span class="math inline">\(T\)</span> and a <em>standard normal</em> or <em>T</em> distribution).</p></li>
<li><p>Calculate the <em>tail probability</em>, i.e., the probability of obtaining a statistic (e.g., a mean) as or more extreme than was observed assuming that null distribution.</p></li>
</ul>
<section id="important-comments-on-p-values" class="level3" data-number="15.4.1">
<h3 data-number="15.4.1" class="anchored" data-anchor-id="important-comments-on-p-values"><span class="header-section-number">15.4.1</span> Important Comments on P Values</h3>
<ul>
<li><p>The <strong>p value</strong> is simply the probability of seeing some descriptive statistic (mean, median, regression coefficient, whatever) given the data you have and <em>given particular assumptions you make about the model generating the data</em>! The <strong>p value</strong> says nothing about effect size, biological meaning, or the accuracy of the model.</p></li>
<li><p>Statistical “significance”, i.e., if some statistic you calculate has a low <strong>p value</strong>, does NOT mean the effect is strong is or biologically important!</p></li>
<li><p>There is no problem with <em>reporting</em> <strong>p values</strong>… but using <strong>p values</strong> as line for dichotomously classifying results into “significant” versus “not significant” (or for interpreting results in this way) <strong>is</strong> problematic and not good statistical practice!</p></li>
<li><p>Finally, it is valuable, I believe, to contrast <strong>p values</strong> as estimated via the classical/Fisherian frequentist approaches where the “model” generating the data is one that is reasonably approximated by some well-characterized mathematical distribution (Gaussian, binomial, etc.) versus <strong>p values</strong> estimated based on permutation/resampling from the particular data we have collected (see <a href="16-module.html"><strong>Module 16</strong></a>. That latter approach is much more relevant for the situation that many of us in this class face, where we often do not have a good idea about what the data-generating model or the resultant distribution of the data is likely to be.</p></li>
</ul>
</section>
<section id="working-with-means" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="working-with-means">Working with Means</h3>
<section id="one-sample-z-and-t-test" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="one-sample-z-and-t-test">One Sample <span class="math inline">\(Z\)</span> and <span class="math inline">\(T\)</span> Test</h4>
<p>Let’s do an example where we try to evaluate whether the mean of a single set of observations is significantly different than that expected under a null hypothesis… i.e., this is a ONE-SAMPLE test.</p>
<p>Suppose we have a vector describing the adult weights of vervet monkeys trapped in South Africa during the 2015 trapping season. We have the sense they are heavier than vervets we trapped in previous years, which averaged 5.0 kilograms. We calculate the mean of our sample of trapped vervets and then need to decide whether that mean is significantly greater than our expectation based on prior information.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/vervets.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>First, we read in our data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/vervet-weights.csv"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 2
##      id weight
##   &lt;dbl&gt;  &lt;dbl&gt;
## 1     1   5.17
## 2     2   7.13
## 3     3   4.7 
## 4     4   6.1 
## 5     5   6.36
## 6     6   4.93</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(d<span class="sc">$</span>weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.323922</code></pre>
</div>
</div>
<ul>
<li>What is our <span class="math inline">\(H_0\)</span>?</li>
<li>What is our <span class="math inline">\(H_A\)</span>?</li>
<li>What is the hypothesis we want to test? Is it two-tailed? Upper-tailed? Lower-tailed?</li>
<li>Calculate the mean, standard deviation, and SE of the sample</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d<span class="sc">$</span>weight  <span class="co"># current weights</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.323922</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.9754016</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> s<span class="sc">/</span><span class="fu">sqrt</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.1365835</code></pre>
</div>
</div>
<ul>
<li>Plot a histogram of the sample</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(x, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> s, <span class="at">to =</span> m <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> s, <span class="at">length.out =</span> <span class="dv">20</span>), <span class="at">main =</span> <span class="st">"Histogram of Vervet</span><span class="sc">\n</span><span class="st">Weights"</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Proportion of Total"</span>, <span class="at">type =</span> <span class="st">"density"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> mu, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>))  <span class="co"># expected mean</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> m, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>))  <span class="co"># observed mean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Using the <code>plotDist()</code> function from {mosaic}, plot the location of your sample mean, the sampling distribution suggested by your sample’s standard error, and the location of the expected mean from the 2015 data.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"norm"</span>, <span class="at">mean =</span> m, <span class="at">sd =</span> se, <span class="at">xlim =</span> <span class="fu">c</span>(m <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> se, m <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> se), <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The following code demonstrates that more than 95% of the sampling distribution suggested by your sample is above the expected mean of 5.0…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.05</span>)  <span class="co"># define lower bound of upper 95% of distribution</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(m <span class="sc">+</span> z <span class="sc">*</span> se, <span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">+</span> z <span class="sc">*</span> se, <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(x)), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">+</span> z <span class="sc">*</span> se, <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">1000</span>), m,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    se), <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For a formal statistical test of whether our sample mean is greater than the expected mean, we first calculate the test statistic. It takes a familiar form… it is effectively the position of our sample mean relative to the expected population mean and the expected population standard deviation (which we have estimated from our sample).</p>
<p><span class="math display">\[Z = \frac{\bar{x}-\mu}{s/\sqrt{n}}\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\bar{x}\)</span> = mean of sample observations</li>
<li><span class="math inline">\(\mu\)</span> = expected mean</li>
<li><span class="math inline">\(s\)</span> = sample standard deviation (as an estimate of the population SD)</li>
<li><span class="math inline">\(n\)</span> = number of sample observations</li>
</ul>
<p>Or, to use our variables from above…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu)<span class="sc">/</span>se</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 2.3716</code></pre>
</div>
</div>
<p>In this case, our test statistic, <span class="math inline">\(Z\)</span>, is a quantile… the estimated number of standard errors away from the expected population mean that our sample mean falls based on the implied sampling distribution. If our sample mean is greater than expected, then the test statistic is positive; if our sample mean is less than expected, then the test statistic is negative.</p>
<p>To evaluate whether <span class="math inline">\(Z\)</span> is “significant” under a NHST framework, we need to calculate the total probability of our seeing a deviation from the expected mean as great or greater than this by chance. For a two-tailed test, this deviation can be in either the positive or negative direction, while for a one-tailed test, we are only interested in the probability associated with our specific alternative hypothesis (i.e., <span class="math inline">\(\mu_{H_A} \gt \mu_{H_0}\)</span> or <span class="math inline">\(\mu_{H_A} \lt \mu_{H_0}\)</span>).</p>
<p>To calculate these probabilities, we can use the <code>pnorm()</code> function. Because in calculating a <span class="math inline">\(Z\)</span> score we have converted our sample mean to the standard normal scale, the <code>mean=</code> and <code>sd=</code> arguments of <code>pnorm()</code> are the defaults of 0 and 1, respectively.</p>
<p>For this specific example, where we want to test the idea that our sample mean is greater than expected, we want the probability of seeing a <span class="math inline">\(Z\)</span> as large or larger by chance. This corresponds to the area under the normal curve to the right of <span class="math inline">\(Z\)</span> (the “upper.tail”), which we can calculate as:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(z)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.008855621</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.008855621</code></pre>
</div>
</div>
<p>To visualize this on a standard normal curve…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"norm"</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Standard Normal Distribution</span><span class="sc">\n</span><span class="st">blue area = "</span>, <span class="fu">round</span>(p,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%"</span>), <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="st">"SD"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> z, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(z, <span class="fu">seq</span>(<span class="at">from =</span> z, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> z,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also consider the “significance” in a different way, by asking does our value for <span class="math inline">\(Z\)</span> fall in the upper 5% of the normal distribution for <span class="math inline">\(Z\)</span> scores. For this, we can use <code>qnorm()</code> to return the critical value demarking the boundary of the upper 5% of the distribution and see of <span class="math inline">\(Z\)</span> falls to the right of that, which indeed it does.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"norm"</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Standard Normal Distribution</span><span class="sc">\n</span><span class="st">red area = upper 5%"</span>),</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="st">"SD"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> z, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>critical_val <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.95</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> critical_val, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(critical_val, <span class="fu">seq</span>(<span class="at">from =</span> critical_val, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> critical_val, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">0</span>)),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(z, <span class="fu">seq</span>(<span class="at">from =</span> z, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> z,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Another way to think about whether there is a “significant” difference between our observed and expected mean weight is to look at the 95% CI around our estimate of mean weight. We can calculate this by hand for the one-tailed test…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> m <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">*</span> se  <span class="co"># by hand... lower limit for 95% of sampling distribution</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(x, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> s, <span class="at">to =</span> m <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> s, <span class="at">length.out =</span> <span class="dv">20</span>), <span class="at">main =</span> <span class="st">"Histogram of Vervet</span><span class="sc">\n</span><span class="st">Weights"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Proportion of Total"</span>, <span class="at">type =</span> <span class="st">"density"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> mu, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>))  <span class="co"># expected mean</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> m, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>))  <span class="co"># observed mean</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> ci, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>))  <span class="co"># lower bound for 95% CI</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.05</span>)  <span class="co"># define lower bound of upper 95% of distribution</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(m <span class="sc">+</span> z <span class="sc">*</span> se, <span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">+</span> z <span class="sc">*</span> se, <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(x)), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">+</span> z <span class="sc">*</span> se, <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">1000</span>), m,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    se), <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>… and for a two-tailed CI…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">*</span> se  <span class="co"># by hand...</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> ci, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>))  <span class="co"># upper and lower bounds for 95% CI</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As noted above, our sample size from a population is typically limited. So, instead of using the normal distribution (as we did here) to determine the <strong>p value</strong> of our statistic, we actually <strong>should</strong> use the <span class="math inline">\(t\)</span> distribution, which, as we have seen, has slightly fatter tails. The statistic and process is exactly the same, though, as for the normal distribution.</p>
<p><span class="math display">\[T = \frac{\bar{x}-\mu}{s/\sqrt{n}}\]</span></p>
<p>or, equivalently…</p>
<p><span class="math display">\[T = \frac{\bar{x}-\mu}{\sqrt{s^2/n}}\]</span></p>
<p>with</p>
<p><span class="math display">\[df = n - 1\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu)<span class="sc">/</span>se</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(z, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.01080157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pt</span>(z, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.01080157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(critical_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.95</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.675905</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"t"</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"t Distribution with DF = "</span>, n <span class="sc">-</span> <span class="dv">1</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">blue area = "</span>,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(p, <span class="dv">4</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%"</span>), <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="st">"SD"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> z, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(z, <span class="fu">seq</span>(<span class="at">from =</span> z, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="at">from =</span> z,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>), <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="fl">0.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>R</em></strong> has built into it a single function, <code>t.test()</code>, that lets us do all this in one line. We give it our data and the expected population mean, <span class="math inline">\(\mu\)</span>, along with the kind of test we want to do.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x =</span> x, <span class="at">mu =</span> mu, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>t_stat  <span class="co"># the value of the t statistic is a Z score</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
##  One Sample t-test
## 
## data:  x
## t = 2.3716, df = 50, p-value = 0.0108
## alternative hypothesis: true mean is greater than 5
## 95 percent confidence interval:
##  5.095021      Inf
## sample estimates:
## mean of x 
##  5.323922</code></pre>
</div>
</div>
<p>Note that the <code>t.test()</code> function to also calculates <span class="math inline">\(t\)</span>- distribution based CIs for us easily. For the above test, the 95% CI is open-ended on the upper end because we are doing a one-tailed test. Doing the same thing by hand…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">c</span>(m <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se, <span class="cn">Inf</span>)  <span class="co"># lower bound calculated by hand... note we do not divide alpha by 2</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>ci</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.095021      Inf</code></pre>
</div>
</div>
<p>For an equivalent two-tailed test with the same data…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x =</span> x, <span class="at">mu =</span> mu, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> t_stat<span class="sc">$</span>conf.int  <span class="co"># using t test</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>ci</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.049585 5.598258
## attr(,"conf.level")
## [1] 0.95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se  <span class="co"># upper and lower bounds calculated by hand</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>ci</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.049585 5.598258</code></pre>
</div>
</div>
</section>
</section>
<section id="challenge" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge">CHALLENGE</h3>
<p>Adult lowland woolly monkeys are reported to have an average body weight of 7.2 kilograms. You are working with an isolated population of woolly monkeys from the Colombian Andes that you think may be a different species from lowland form, and you collect a sample of 15 weights from adult individuals at that site. From your sample, you calculate a mean of 6.43 kilograms and a standard deviation of 0.89 kilograms. Perform a hypothesis test to evaluate whether body weights in your population are different from the reported average for lowland woolly monkeys by setting up a “two-tailed” hypothesis, carrying out the analysis, and interpreting the <strong>p value</strong> (assume the significance level is <span class="math inline">\(\alpha\)</span> = 0.05).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/woolly.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p><strong>HINT:</strong> Your sample size is &lt; 30, so you should use the <span class="math inline">\(t\)</span> distribution and do a <strong>t test</strong>. Do your calculations both by hand and using the <code>t.test()</code> function and confirm that they match.</p>
</blockquote>
<p>First, read in the data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/woolly-weights.csv"</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 2
##      id weight
##   &lt;dbl&gt;  &lt;dbl&gt;
## 1     1   6.14
## 2     2   6.19
## 3     3   7.08
## 4     4   5.67
## 5     5   4.83
## 6     6   6.83</code></pre>
</div>
</div>
<p>Then, calculate the mean, standard deviation, and SE of your sample:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d<span class="sc">$</span>weight</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 6.427333</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>(s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 0.8968235</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> s<span class="sc">/</span><span class="fu">sqrt</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 0.2315588</code></pre>
</details>
</div>
</div>
<p>Finally, calculate the <span class="math inline">\(T\)</span> statistic and then determine the <strong>p value</strong> associated with that statistic.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Because this is a two-tailed test, we need to calculate the probability of seeing a <span class="math inline">\(T\)</span> statistic as far from the mean in either the positive or negative direction. This is why we sum the probabilities associated with the upper and lower tails…</p>
</blockquote>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">7.2</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu)<span class="sc">/</span>se</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>t_stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] -3.336805</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>p_upper <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_stat), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or 1 - pt(t_stat, df=n-1, lower.tail = FALSE)</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>p_lower <span class="ot">&lt;-</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">abs</span>(t_stat), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># or pt(t_stat, df=n-1, lower.tail = TRUE)</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p_upper <span class="sc">+</span> p_lower</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 0.004890693</code></pre>
</details>
</div>
</div>
<p>To visualize this…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"t"</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"t Distribution with DF = "</span>, n <span class="sc">-</span> <span class="dv">1</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">red area = 2.5% in each tail"</span>,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">blue = "</span>, <span class="fu">round</span>(p, <span class="dv">4</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%"</span>), <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="st">"SD"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> <span class="fu">abs</span>(t_stat), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">abs</span>(t_stat), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>))</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot upper tail</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(<span class="fu">abs</span>(t_stat), <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">abs</span>(t_stat), <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">abs</span>(t_stat), <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>), <span class="dv">0</span>)),</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)))</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot lower tail</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">abs</span>(t_stat), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">abs</span>(t_stat)), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">abs</span>(t_stat), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>), <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)))</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>critical_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># identify critical values - boundaries for 95% of the t distribution</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> <span class="fu">abs</span>(critical_val), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>))</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">abs</span>(critical_val), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>))</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(critical_val, <span class="fu">seq</span>(<span class="at">from =</span> critical_val, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="at">from =</span> critical_val, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)))</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">abs</span>(critical_val), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">abs</span>(critical_val)), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">abs</span>(critical_val),</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>), <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can implement a simple test to see if the value of our <span class="math inline">\(T\)</span> statistic is farther away from zero than the critical value…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> (<span class="fu">abs</span>(t_stat) <span class="sc">&gt;</span> critical_val)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># boolean test as to whether t is larger than the critical value at either tail</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<p>Another way to think about whether there is a significant difference between our observed and expected mean weight is to look at the 95% CI around our estimate of mean weight. We can calculate this by hand or use the output of the <strong>t test</strong>…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> critical_val <span class="sc">*</span> se)  <span class="co"># by hand</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.930689 6.923978</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> x, <span class="at">mu =</span> mu, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)  <span class="co"># `t.test()` function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
##  One Sample t-test
## 
## data:  x
## t = -3.3368, df = 14, p-value = 0.004891
## alternative hypothesis: true mean is not equal to 7.2
## 95 percent confidence interval:
##  5.930689 6.923978
## sample estimates:
## mean of x 
##  6.427333</code></pre>
</div>
</div>
<p>The 95% CI does not include the expected mean weight.</p>
<section id="two-sample-z-and-t-test" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="two-sample-z-and-t-test">Two Sample <span class="math inline">\(Z\)</span> and <span class="math inline">\(T\)</span> Test</h4>
<p>Sometimes we want to compare two groups of measurements to one another, which boils down to a hypothesis test for the difference between two means, <span class="math inline">\(\mu1\)</span> and <span class="math inline">\(\mu2\)</span>. The null hypothesis is that the <strong>difference between these means</strong> is zero.</p>
<p>Before getting to the appropriate test, there are a couple of things that we need to consider:</p>
<p>[1] How, if at all, <strong>are the two samples related to one another</strong>? Sometimes we may have PAIRED samples (e.g., the same individuals before and after some treatment) and sometimes the samples are UNPAIRED or INDEPENDENT (e.g., weights for different samples of black-and-white colobus monkeys collected in the rainy versus dry seasons).</p>
<p>[2] Are the <strong>variances in the two samples roughly equal or not</strong>? E.g., if we are comparing male and female heights, are the variances comparable?</p>
<section id="samples-with-unequal-variances" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="samples-with-unequal-variances">Samples with Unequal Variances</h5>
<p>For the most generic case, where the two samples are independent and we cannot assume the variances of the two samples are equal, we can do what is called <strong>Welch’s t test</strong> where our test statistic is:</p>
<p><span class="math display">\[T = \frac{\bar{x_2} - \bar{x_1} - \mu}{\sqrt{s_1^2/n_1 + s_2^2/n_2}}\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\bar{x_1}\)</span> and <span class="math inline">\(\bar{x_2}\)</span> = means of observations in each sample group</li>
<li><span class="math inline">\(\mu\)</span> = expected difference in means between sample groups under the null hypothesis, which is usually zero</li>
<li><span class="math inline">\(s_1\)</span> and <span class="math inline">\(s_2\)</span> = standard deviations of each sample group</li>
<li><span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> = numbers of observations in each sample group</li>
</ul>
</section>
</section>
</section>
<section id="challenge-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-1">CHALLENGE</h3>
<p>Let’s do an example. Load in a file of black-and-white colobus weights and examine the <code>str()</code> of the file.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/bwcolobus.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/colobus-weights.csv"</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 3
##      id weight sex  
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1     1   7.24 male 
## 2     2   6.09 male 
## 3     3   6.97 male 
## 4     4   6.98 male 
## 5     5   6.08 male 
## 6     6   6.22 male</code></pre>
</div>
</div>
<p>Then, create two vectors, <strong>x</strong> and <strong>y</strong>, for male and female weights. Plot these in boxplots side by side and then calculate the mean, sd, and sample size for both males and females. Do the variances look similar for the two sexes?</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d<span class="sc">$</span>weight[d<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"male"</span>]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> d<span class="sc">$</span>weight[d<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"female"</span>]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>minval <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(x, y)) <span class="sc">-</span> <span class="fl">0.1</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>maxval <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(x, y)) <span class="sc">+</span> <span class="fl">0.1</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(x, <span class="at">ylim =</span> <span class="fu">c</span>(minval, maxval), <span class="at">main =</span> <span class="st">"Weight (kg)"</span>, <span class="at">xlab =</span> <span class="st">"Males"</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># `ylim=` argument uses x and y ranges to set range for y axis</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(y, <span class="at">ylim =</span> <span class="fu">c</span>(minval, maxval), <span class="at">main =</span> <span class="st">"Weight (kg)"</span>, <span class="at">xlab =</span> <span class="st">"Females"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># you could leave this out... the default argument value is 0</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(y)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now calculate the <span class="math inline">\(T\)</span> statistic and test the two-tailed hypothesis that the sample means differ. Note that for the <strong>Welch’s t test</strong>, the number of degrees of freedom is calculated as:</p>
<p><span class="math display">\[df = \frac{(s_1^2/n_1 + s_2^2/n_2)^2}{(s_1^2/n_1)^2/(n_1-1)+(s_2^2/n_2)^2/(n_2-1)}\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> (s2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n2 <span class="sc">+</span> s1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n1)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>((s2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n2)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(n2 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> (s1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n1)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(n1 <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 31.21733</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> (m2 <span class="sc">-</span> m1 <span class="sc">-</span> mu)<span class="sc">/</span><span class="fu">sqrt</span>(s2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n2 <span class="sc">+</span> s1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n1)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>t_stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] -11.45952</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note that because our hypothesis is 2-tailed, it does not matter which group</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (males or females) is m1 and which is m2, so we take the absolute values of t</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># below when testing whether it is greater than the critical value</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>critical_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> df)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># identify the critical value, i.e., how far apart the means of the two samples</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># need to be to be more extreme than expected by chance at the given alpha</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># level</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>critical_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 2.038938</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">abs</span>(t_stat) <span class="sc">&gt;</span> critical_val  <span class="co"># boolean test</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>test  <span class="co"># if true, the two means are significantly different</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] TRUE</code></pre>
</details>
</div>
</div>
<p>We can visualize this as below by plotting histograms of body weights for males and females and adding the sampling distribution curves and 95% CIs around the estimates of the means for the two sexes atop of the histogram.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> minval, <span class="at">to =</span> maxval, <span class="at">length.out =</span> <span class="dv">15</span>), <span class="at">xlim =</span> <span class="fu">c</span>(minval,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    maxval), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>), <span class="at">main =</span> <span class="st">"Histogram and Sampling Distributions</span><span class="sc">\n</span><span class="st">for Body Weights</span><span class="sc">\n</span><span class="st">(red = females, blue = males)"</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># `xlim=` argument uses x and y ranges to set range for y axis</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> minval, <span class="at">to =</span> maxval, <span class="at">length.out =</span> <span class="dv">15</span>), <span class="at">xlim =</span> <span class="fu">c</span>(minval,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    maxval), <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, m1, s1<span class="sc">/</span><span class="fu">sqrt</span>(n1)), <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, m2, s2<span class="sc">/</span><span class="fu">sqrt</span>(n2)), <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> m1 <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> df) <span class="sc">*</span> s1<span class="sc">/</span><span class="fu">sqrt</span>(n1))</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> m1 <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> df) <span class="sc">*</span> s1<span class="sc">/</span><span class="fu">sqrt</span>(n1))</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> m2 <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> df) <span class="sc">*</span> s2<span class="sc">/</span><span class="fu">sqrt</span>(n2))</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> m2 <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> df) <span class="sc">*</span> s2<span class="sc">/</span><span class="fu">sqrt</span>(n2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> The 95% CIs around each sample mean do not overlap, so the means are significantly different.</p>
</blockquote>
<p>We can do the same thing using the <code>t.test()</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">abs</span>(m1 <span class="sc">-</span> m2))  <span class="co"># difference between means</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.449</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># var.equal = FALSE is the DEFAULT for `t.test()`</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>t_stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  x and y
## t = 11.46, df = 31.217, p-value = 1.023e-12
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  1.191186 1.706814
## sample estimates:
## mean of x mean of y 
##     6.689     5.240</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> The 95% CI returned by the t test is the interval around the DIFFERENCE between the means.</p>
</blockquote>
<section id="samples-with-equal-variances" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="samples-with-equal-variances">Samples with Equal Variances</h5>
<p>There’s a simpler <span class="math inline">\(T\)</span> statistic we can use if the variances of the two samples are more or less equal.</p>
<p><span class="math display">\[T=\frac{\bar{x_2}-\bar{x_1}-\mu}{\sqrt{s_p^2(1/n_1+1/n_2)}}\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(s_p^2=\frac{(n_1-1)s_1^2+(n_2-1)s_2^2}{n_1+n_2-2}\)</span></li>
<li><span class="math inline">\(\bar{x_1}\)</span> and <span class="math inline">\(\bar{x_2}\)</span> = means of observations in each sample group</li>
<li><span class="math inline">\(\mu\)</span> = expected difference in means between sample groups (usually set to zero)</li>
<li><span class="math inline">\(s_p\)</span> = pooled sample standard deviation</li>
<li><span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> = numbers of observations in each sample group</li>
</ul>
<p>The degrees of freedom for this test is calculated as follows:</p>
<p><span class="math display">\[df=n_1+n_2-2\]</span></p>
<p>Calculating the <span class="math inline">\(t\)</span> statistic and degrees of freedom by hand…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((((n1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> s1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> ((n2 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> s2<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>(n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> (m2 <span class="sc">-</span> m1 <span class="sc">-</span> mu)<span class="sc">/</span>(<span class="fu">sqrt</span>(s<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2)))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>t_stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] -11.45952</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 38</code></pre>
</div>
</div>
<p>… matches what we see when we use <code>t.test()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>t_stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
##  Two Sample t-test
## 
## data:  x and y
## t = 11.46, df = 38, p-value = 6.787e-14
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  1.193025 1.704975
## sample estimates:
## mean of x mean of y 
##     6.689     5.240</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> A crude test for equality of variances is to divide the larger by the smaller and if the result is &lt; 2, you can go ahead and used the pooled variance version of the test (which has many fewer degrees of freedom).</p>
</blockquote>
<p>In our case, we should not really use the equal variances version of the <strong>t test</strong>, since the ratio of variances exceeds 2…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">var</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 2.746196</code></pre>
</div>
</div>
<p>We can use the <code>var.test()</code> function to conduct an actual statistical test on the ratio of variances, which compares the ratio test statistic we just calculated to an <span class="math inline">\(F\)</span> <strong>distribution</strong>. The <span class="math inline">\(F\)</span> distribution is often used to model <em>ratios</em> of random variables and thus is useful in regression applications and, as here, for testing whether variances from two samples are different. It is dependent upon the specification of a pair of degrees of freedom values supplied as the arguments <code>df1=</code> and <code>df2=</code> (or inferred from the number of observations in each sample).</p>
<p>Below, the results of <code>var.test()</code> are saved to a variable. Calling the variable provides a brief descriptive summary.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>vt <span class="ot">&lt;-</span> <span class="fu">var.test</span>(x, y)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>vt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
##  F test to compare two variances
## 
## data:  x and y
## F = 2.7462, num df = 19, denom df = 19, p-value = 0.03319
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  1.086978 6.938128
## sample estimates:
## ratio of variances 
##           2.746196</code></pre>
</div>
</div>
</section>
<section id="paired-samples" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="paired-samples">Paired Samples</h5>
<p>For a paired samples test, the null hypothesis is that the mean of individual paired differences between the two samples (e.g., before and after) is zero.</p>
<p>Our test statistic is:</p>
<p><span class="math display">\[T = \frac{d-\mu}{\sqrt{s_d^2/n}}\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\bar{d}\)</span> = mean of difference between paired samples</li>
<li><span class="math inline">\(\mu\)</span> = expected mean difference between paired samples (usually set to zero)</li>
<li><span class="math inline">\(s_d\)</span> = standard deviation in the set of differences between paired samples</li>
<li><span class="math inline">\(n\)</span> = number of sample <strong>pairs</strong></li>
</ul>
<p>Again, note that <span class="math inline">\(\mu\)</span> here is the expected <strong>difference</strong> between the means under the null hypothesis, which is zero, and we are dividing by the standard error of the mean for the set of differences between pairs.</p>
</section>
</section>
<section id="challenge-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-2">CHALLENGE</h3>
<p>Let’s play with a sample… test scores of individuals taking a certain statistics course pre and post a lecture on null hypothesis significance testing. Load in the <code>test_scores.csv</code> data file, look at it, plot a barchart of values before and after and construct a paired t test to evaluate the means before and after.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/test_scores.csv"</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 3
##      id `Score before` `Score after`
##   &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;
## 1     1           89.0          95.4
## 2     2           90.0          94.2
## 3     3           90.7          92.2
## 4     4           82.1          92.4
## 5     5           87.4          94.8
## 6     6           88.3          90.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d<span class="sc">$</span><span class="st">`</span><span class="at">Score after</span><span class="st">`</span> <span class="sc">-</span> d<span class="sc">$</span><span class="st">`</span><span class="at">Score before</span><span class="st">`</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># can leave this out</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> s<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span><span class="st">`</span><span class="at">Score before</span><span class="st">`</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">100</span>), <span class="at">main =</span> <span class="st">"Score"</span>, <span class="at">xlab =</span> <span class="st">"Before"</span>)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span><span class="st">`</span><span class="at">Score after</span><span class="st">`</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">100</span>), <span class="at">main =</span> <span class="st">"Score"</span>, <span class="at">xlab =</span> <span class="st">"After"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu)<span class="sc">/</span>se</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>t_stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.789636</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>critical_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># identify critical values</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>critical_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 2.093024</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">abs</span>(t_stat) <span class="sc">&gt;</span> critical_val  <span class="co"># boolean test</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(d<span class="sc">$</span><span class="st">`</span><span class="at">Score before</span><span class="st">`</span>, d<span class="sc">$</span><span class="st">`</span><span class="at">Score after</span><span class="st">`</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
##  Paired t-test
## 
## data:  d$`Score before` and d$`Score after`
## t = -1.7896, df = 19, p-value = 0.08946
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##  -4.830292  0.377435
## sample estimates:
## mean difference 
##       -2.226429</code></pre>
</div>
</div>
</section>
<section id="working-with-proportions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="working-with-proportions">Working with Proportions</h3>
<section id="one-sample-z-test" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="one-sample-z-test">One Sample <span class="math inline">\(Z\)</span> Test</h4>
<p>As we have seen, the theoretical sampling distribution of sample means for independent and identically distributed random continuous variables is roughly normal (and, as shown by the CLT, this distribution increasingly approaches normal as sample size increases). Similarly, the sampling distribution for another kind of sample statistic, the number of “successes” <span class="math inline">\(x\)</span> out of a series of <span class="math inline">\(k\)</span> trials is also roughly normally distributed. If the true population proportion of “successes” is <span class="math inline">\(\pi\)</span>, then the sampling distribution for the proportion of successes in a sample of size <span class="math inline">\(n\)</span> is expected to be roughly normally distributed with mean = <span class="math inline">\(\pi\)</span> and standard error = <span class="math inline">\(\sqrt{\pi(1-\pi)/n}\)</span>.</p>
<p>Let’s set up a simulation to show this…</p>
<p>First we create a population of 500 “1”s and 500 “0”s, i.e., where <span class="math inline">\(\pi\)</span> = 0.5…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">500</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">500</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we will take 1000 random samples of size <span class="math inline">\(n\)</span>=10 from that population and calculate the proportion of “1”s in each sample…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(pop, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># taking the mean of a bunch of 0s and 1s yields the proportion of 1s!</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.4886</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.1566352</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pi)<span class="sc">/</span>n)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>se  <span class="co"># the SE is an estimate of the SD of the sampling distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.1581139</code></pre>
</div>
</div>
<p>The same is true if we create a population of 800 “1”s and 200 “0”s, i.e., where <span class="math inline">\(\pi\)</span> = 0.8…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">800</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">200</span>))</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(pop, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># taking the mean of a bunch of 0s and 1s yields the proportion of 1s!</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.2018</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.1240651</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pi)<span class="sc">/</span>n)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>se  <span class="co"># the SE is an estimate of the SD of the sampling distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.1264911</code></pre>
</div>
</div>
<p>This normal approximation is true as long as <span class="math inline">\(n\)</span> is fairly large and <span class="math inline">\(\pi\)</span> is not close to 0 or 1. One rule of thumb is to check that both <span class="math inline">\(n\times\pi\)</span> and <span class="math inline">\(n\times(1-\pi)\)</span> are greater than 5.</p>
<p>With all this in mind, we can construct <span class="math inline">\(Z\)</span> statistics for proportions just like we constructed <span class="math inline">\(Z\)</span> and <span class="math inline">\(T\)</span> statistics for means and test those proportions for differences from an expected value or for differences between two sample proportions. The <span class="math inline">\(Z\)</span> statistic for proportions takes the same general form as that for means…</p>
<p><span class="math inline">\(Z =\)</span> (observed statistic - expected statistic) / expected standard error</p>
<p>or,</p>
<p><span class="math display">\[Z = \frac{\hat{p}-\pi}{\sqrt{\pi(1-\pi)/n}}\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\hat{p}\)</span> = proportion in sample</li>
<li><span class="math inline">\(\pi\)</span> = expected proportion</li>
<li><span class="math inline">\(n\)</span> = number of observations in sample</li>
</ul>
</section>
</section>
<section id="challenge-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-3">CHALLENGE</h3>
<p>A neotropical ornithological working in the western Amazon deploys 30 mist nets in a 100 ha grid.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/birdnet.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>She monitors the nets on one morning and records whether or not she captures any birds in the net (i.e., a “success” or “failure” for every net during a netting session). The following vector summarizes her netting results:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Her netting success over the previous three seasons suggests that she should catch birds in 80% of her nets. This season, she feels, her success rate is lower than in previous years (so… this implies that we want to do a lower one-tailed test). Does her trapping data support this hypothesis?</p>
<ul>
<li>What is <span class="math inline">\(H_0\)</span>?</li>
<li>What is <span class="math inline">\(H_A\)</span>?</li>
<li>Are both <span class="math inline">\(n\times\pi\)</span> and <span class="math inline">\(n\times(1-\pi)\)</span> &gt; 5?</li>
<li>Calculate <span class="math inline">\(Z\)</span> statistic and the p value associated with <span class="math inline">\(Z\)</span>. We use the <code>lower.tail=TRUE</code> argument to <code>pnorm()</code> because we’re testing a lower-tailed one-tailed hypothesis.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>phat <span class="ot">&lt;-</span> <span class="fu">mean</span>(v)  <span class="co"># the mean of binomial 0,1 variables yields the proportion!</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>phat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 0.6</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (phat <span class="sc">-</span> pi)<span class="sc">/</span><span class="fu">sqrt</span>(pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pi)<span class="sc">/</span><span class="dv">30</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># we use the population expected proportion in the denominator</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] -2.738613</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 0.00308495</code></pre>
</details>
</div>
</div>
<p>Graphically, our <span class="math inline">\(Z\)</span> value (in blue) is farther from the center of the standard normal curve than the critical value marking the lower 5% of the total distribution (in red).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">yaxt =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">"SD"</span>, <span class="at">main =</span> <span class="st">"Sampling Distribution"</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> z, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">qnorm</span>(<span class="fl">0.05</span>), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15-module_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The 95% confidence interval around the sample proportion can be estimated, based on the normal distribution, as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> phat <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(phat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> phat)<span class="sc">/</span><span class="dv">30</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> phat <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(phat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> phat)<span class="sc">/</span><span class="dv">30</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">c</span>(lower, upper)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>ci</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.4246955 0.7753045</code></pre>
</div>
</div>
<p>This approach using quantiles of the standard normal distribution is but one method of calculating CIs for proportion data, and it generates a CI referred to as a <em>Wald confidence interval</em>. Note that this CI does not include the value of <span class="math inline">\(\pi\)</span>… rather, <span class="math inline">\(\pi\)</span> is greater than the upper bound of the CI, suggesting that the observed success rate is indeed lower than in previous years.</p>
<p>We can do the same test with a one-liner in <strong><em>R</em></strong>…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>pt <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">sum</span>(v), <span class="at">n =</span> <span class="fu">length</span>(v), <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">alternative =</span> <span class="st">"less"</span>,</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">correct =</span> <span class="cn">FALSE</span>)  <span class="co"># use correct=FALSE if we satisfy that n*pi and n*(1-pi) are both &gt;5</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>pt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
##  1-sample proportions test without continuity correction
## 
## data:  sum out of lengthv out of v
## X-squared = 7.5, df = 1, p-value = 0.003085
## alternative hypothesis: true p is less than 0.8
## 95 percent confidence interval:
##  0.0000000 0.7328738
## sample estimates:
##   p 
## 0.6</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> The CI returned here is different than we calculated based on the normal distribution, although the p value is the same… <code>prop.test()</code> implements a slightly different procedure for estimating the CI rather than basing this on the normal distribution and the CLT.</p>
</blockquote>
<section id="two-sample-z-test" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="two-sample-z-test">Two Sample <span class="math inline">\(Z\)</span> Test</h4>
<p>The <span class="math inline">\(Z\)</span> statistic for the two-sample test comparing proportions is also very similar to that for comparing means.</p>
<p><span class="math display">\[Z=\frac{\hat{p_2}-\hat{p_1}-\pi}{\sqrt{p^*(1-p^*)(1/n_1+1/n_2)}}\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(p^* = \frac{x_1 + x_2}{n_1+n_2}\)</span> = pooled proportion</li>
<li><span class="math inline">\(\hat{p_1}\)</span> and <span class="math inline">\(\hat{p_2}\)</span> = proportions of “successes” in each sample group</li>
<li><span class="math inline">\(\pi\)</span> = expected difference in proportions between sample groups (usually set to zero)</li>
<li><span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> = numbers of observations in each sample group</li>
</ul>
</section>
</section>
<section id="challenge-4" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-4">CHALLENGE</h3>
<p>A biologist studying two species of tropical bats captures females of both species in a mist net over the course of a week of nightly netting. For each species, the researcher records whether females is lactating or not.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/batnet.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>The two vectors below summarize the data for each species.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>species1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>species2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Based on your mist netting data, do the species differ significantly in the proportion of lactating females? What are <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_A\)</span>?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>pstar <span class="ot">&lt;-</span> (<span class="fu">sum</span>(species1) <span class="sc">+</span> <span class="fu">sum</span>(species2))<span class="sc">/</span>(<span class="fu">length</span>(species1) <span class="sc">+</span> <span class="fu">length</span>(species2))</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>pstar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.6363636</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>phat1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(species1)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>phat1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>phat2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(species2)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>phat2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (phat2 <span class="sc">-</span> phat1 <span class="sc">-</span> pi)<span class="sc">/</span><span class="fu">sqrt</span>((pstar <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pstar)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(species1) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(species2)))</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.074709</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>p_upper <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>p_lower <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="co"># two-tailed probability, so we add the upper and lower tails</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p_upper <span class="sc">+</span> p_lower</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.2825049</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>critical_val <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)  <span class="co"># identify critical values</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>critical_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.959964</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">abs</span>(z) <span class="sc">&gt;</span> critical_val  <span class="co"># boolean test</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] FALSE</code></pre>
</div>
</div>
<p>We can use the <code>prop.test()</code> function to do this in one line.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fu">sum</span>(species2), <span class="fu">sum</span>(species1)), <span class="at">n =</span> <span class="fu">c</span>(<span class="fu">length</span>(species2), <span class="fu">length</span>(species1)),</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
##  2-sample test for equality of proportions without continuity correction
## 
## data:  c out of csum(species2) out of length(species2)sum(species1) out of length(species1)
## X-squared = 1.155, df = 1, p-value = 0.2825
## alternative hypothesis: two.sided
## 95 percent confidence interval:
##  -0.1144634  0.3944634
## sample estimates:
## prop 1 prop 2 
##   0.70   0.56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use correct=FALSE if we satisfy that n*pi and n*(1-pi) are both &gt;5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="concept-review" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="concept-review">Concept Review</h2>
<ul>
<li><p><span class="math inline">\(Z\)</span> and <span class="math inline">\(T\)</span> tests are used to evaluate whether a given sample statistic (e.g., a mean or proportion) deviates significantly from what is expected under a null model or whether two samples statistics deviate significantly from one another</p></li>
<li><p>They are used for dealing with normally distributed, continuous variables or those that can be approximated closely by the normal distribution (e.g., proportion data)</p>
<ul>
<li>We REJECT a <span class="math inline">\(H_0\)</span> if the p value obtained for a given <span class="math inline">\(Z\)</span> or <span class="math inline">\(T\)</span> test statistic is &lt; <span class="math inline">\(\alpha\)</span></li>
<li>CIs for our sample statistic are calculated as <span class="math inline">\(mean ± [T_{(1-\alpha/2)}\)</span> or <span class="math inline">\(Z_{(1-\alpha/2)}] \times SE\)</span>, and we can REJECT an <span class="math inline">\(H_0\)</span> if the <span class="math inline">\((1-\alpha)\)</span> CI around does not include the expected value of the statistic</li>
<li>When we are dealing with data for a population or for sample sizes &gt; 30, or when we are dealing with proportions, we use <span class="math inline">\(Z\)</span> distribution quantiles for calculating CIs and p values, but for sample sizes &lt; 30, we use <span class="math inline">\(t\)</span> distribution quantiles</li>
</ul></li>
</ul>
<section id="formula-summary" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="formula-summary">Formula Summary</h4>
<section id="the-z-or-t-statistic-for-testing-a-single-mean" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="the-z-or-t-statistic-for-testing-a-single-mean">The <span class="math inline">\(Z\)</span> or <span class="math inline">\(T\)</span> Statistic for Testing a Single Mean</h5>
<p><span class="math display">\[Z\ {\rm or}\ T = \frac{\bar{x}-\mu}{s/\sqrt{n}}\]</span></p>
</section>
<section id="the-t-statistic-for-comparing-means" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="the-t-statistic-for-comparing-means">The <span class="math inline">\(T\)</span> Statistic for Comparing Means</h5>
<section id="unequal-variance" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="unequal-variance">Unequal Variance</h6>
<p><span class="math display">\[Z\ {\rm or}\ T = \frac{\bar{x_2} - \bar{x_1} - \mu}{\sqrt{s_1^2/n_1 + s_2^2/n_2}}\]</span></p>
</section>
<section id="equal-variance" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="equal-variance">Equal Variance</h6>
<p><span class="math display">\[Z\ {\rm or}\ T =\frac{\bar{x_2}-\bar{x_1}-\mu}{\sqrt{s_p^2(1/n_1+1/n_2)}}\]</span></p>
</section>
<section id="paired-samples-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="paired-samples-1">Paired Samples</h6>
<p><span class="math display">\[Z\ {\rm or}\ T = \frac{d-\mu}{\sqrt{s_d^2/n}}\]</span></p>
</section>
</section>
<section id="the-z-statistic-for-testing-a-single-proportion" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="the-z-statistic-for-testing-a-single-proportion">The <span class="math inline">\(Z\)</span> Statistic for Testing a Single Proportion</h5>
<p><span class="math display">\[Z = \frac{\hat{p}-\pi}{\sqrt{\pi(1-\pi)/n}}\]</span></p>
</section>
<section id="the-z-statistic-for-comparing-proportions" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="the-z-statistic-for-comparing-proportions">The <span class="math inline">\(Z\)</span> Statistic for Comparing Proportions</h5>
<p><span class="math display">\[Z = \frac{\hat{p_2}-\hat{p_1}-\pi}{\sqrt{p^*(1-p^*)(1/n_1+1/n_2)}}\]</span></p>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./14-module.html" class="pagination-link  aria-label=" &lt;span="" intervals&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./16-module.html" class="pagination-link" aria-label="<span class='chapter-number'>16</span>&nbsp; <span class='chapter-title'>Using Permutation Tests</span>">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Using Permutation Tests</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb139" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Classical Hypothesis Testing {#module-15}</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objectives</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The objective of this module is to introduce basic *hypothesis testing* from a classical or "frequentist" statistics approach.</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminaries</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load {tidyverse} and {mosaic}</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Null and Alternative Hypotheses</span></span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a>&lt;div style = "float:right; padding-top: 10px; padding-left: 20px; padding-right: 20px; padding-bottom: 10px"&gt;</span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: 150px </span></span>
<span id="cb139-28"><a href="#cb139-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/null_hypothesis.png"</span>)</span>
<span id="cb139-29"><a href="#cb139-29" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-30"><a href="#cb139-30" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb139-31"><a href="#cb139-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-32"><a href="#cb139-32" aria-hidden="true" tabindex="-1"></a>Classical hypothesis testing typically involves formally stating a claim - the **null hypothesis** - which is then followed up by statistical evaluation of the null versus an **alternative hypothesis**. The null hypothesis is interpreted as a baseline hypothesis and is the claim that is presumed to be true. That claim is typically that a particular value of a population parameter estimated by a sample statistic we have calculated is *consistent with a particular null expectation*. The alternative hypothesis is the conjecture that we are testing, usually that the sample statistic is inconsistent with a null expectation.</span>
<span id="cb139-33"><a href="#cb139-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-34"><a href="#cb139-34" aria-hidden="true" tabindex="-1"></a>Typically, our null and alternative hypotheses are expressed something like as follows:</span>
<span id="cb139-35"><a href="#cb139-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-36"><a href="#cb139-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$H_0$ = **null hypothesis** = a sample statistic shows no deviation from what is expected or neutral based on the parameter space of possible outcomes under the presumed random sampling process.</span>
<span id="cb139-37"><a href="#cb139-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-38"><a href="#cb139-38" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** This parameter space is defined both by *how we sample* and *how we intend to sample*, including our stopping rules (e.g., number of observations, amount of time we plan to sample, and so on).</span></span>
<span id="cb139-39"><a href="#cb139-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-40"><a href="#cb139-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$H_A$ = **alternative hypothesis** = a sample statistic deviates more than expected by chance from what is expected or neutral.</span>
<span id="cb139-41"><a href="#cb139-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-42"><a href="#cb139-42" aria-hidden="true" tabindex="-1"></a>We can test several different comparisons between $H_0$ and $H_A$.</span>
<span id="cb139-43"><a href="#cb139-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-44"><a href="#cb139-44" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$H_A &gt; H_0$, which constitutes an "upper one-tailed test" (i.e., our sample statistic is greater than that expected under the null)</span>
<span id="cb139-45"><a href="#cb139-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$H_A &lt; H_0$, which constitutes a "lower one-tailed test" (i.e., our sample statistic is less than that expected under the null)</span>
<span id="cb139-46"><a href="#cb139-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$H_A ≠ H_0$, which constitutes a "two-tailed test" (i.e., our sample statistic is different, maybe greater maybe less, than that expected under the null)</span>
<span id="cb139-47"><a href="#cb139-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-48"><a href="#cb139-48" aria-hidden="true" tabindex="-1"></a>To formally do any statistical test under such a "null hypothesis significance testing" (or NHST) framework, we need some kind of statistical evidence - typically based on probabilities and confidence intervals - to reject the null hypothesis in favor of an alternative hypothesis. This evidence involves considering some measure of *how unexpected it would be* for a sample we have collected to have been drawn, by chance, from a particular null distribution.</span>
<span id="cb139-49"><a href="#cb139-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-50"><a href="#cb139-50" aria-hidden="true" tabindex="-1"></a>To effect a hypothesis test, we then need to...</span>
<span id="cb139-51"><a href="#cb139-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-52"><a href="#cb139-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate a **test statistic** based on our data.</span>
<span id="cb139-53"><a href="#cb139-53" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate the **p value** associated with that test statistic, which is the probability of obtaining, by chance, a test statistic that is as high or higher than our calculated one, *assuming the null hypothesis is true*. Classically, this is done by comparing the value to some appropriate standardized **sampling distribution** with well-known mathematical properties (e.g., normal or $t$) to yield the **p value**.</span>
<span id="cb139-54"><a href="#cb139-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Evaluate whether the **p value** is less than or greater than the **significance level**, or $\alpha$, that we set for our test. That is, $\alpha$ can be thought of as the cutoff level for **p values** below which we feel comfortable rejecting a null hypothesis (i.e., we reject $H_0$ when $p &lt; \alpha$).</span>
<span id="cb139-55"><a href="#cb139-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-56"><a href="#cb139-56" aria-hidden="true" tabindex="-1"></a>Under the null hypothesis significance testing framework, there are then four possible outcomes to our statistical decision, each with an associated probability:</span>
<span id="cb139-57"><a href="#cb139-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-58"><a href="#cb139-58" aria-hidden="true" tabindex="-1"></a>| What is True | What We Decide | Result                                              |</span>
<span id="cb139-59"><a href="#cb139-59" aria-hidden="true" tabindex="-1"></a>|---------------|---------------|------------------------------------------|</span>
<span id="cb139-60"><a href="#cb139-60" aria-hidden="true" tabindex="-1"></a>| $H_0$        | $H_0$          | Correctly "accept" the null ($1 - \alpha$)          |</span>
<span id="cb139-61"><a href="#cb139-61" aria-hidden="true" tabindex="-1"></a>| $H_0$        | $H_A$          | Falsely reject the null (Type I error) $\alpha$     |</span>
<span id="cb139-62"><a href="#cb139-62" aria-hidden="true" tabindex="-1"></a>| $H_A$        | $H_0$          | Falsely "accept" the null (Type II error) $\beta$   |</span>
<span id="cb139-63"><a href="#cb139-63" aria-hidden="true" tabindex="-1"></a>| $H_A$        | $H_A$          | Correctly reject the null ($1 - \beta$), or "power" |</span>
<span id="cb139-64"><a href="#cb139-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-65"><a href="#cb139-65" aria-hidden="true" tabindex="-1"></a>We typically approach hypothesis testing by trying to minimize our probability of committing a Type I error ($\alpha$)... i.e., we aim for having a high bar for falsely rejecting the null hypothesis (e.g., for incorrectly finding an innocent person guilty) and thus set $\alpha$ very low (0.05 or 0.01) to reflect what we decide is an acceptable level of Type I error.</span>
<span id="cb139-66"><a href="#cb139-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-67"><a href="#cb139-67" aria-hidden="true" tabindex="-1"></a>When we set a high bar for falsely rejecting the null, we necessarily lower the bar for incorrectly accepting (i.e., for failing to reject) the null (e.g., for concluding that a guilty person is innocent). The probability of incorrectly "accepting" the null is referred to as Type II error ($\beta$). The "power" of a statistical test is ($1 - \beta$), the probability with which we correctly reject the null.</span>
<span id="cb139-68"><a href="#cb139-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-71"><a href="#cb139-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-72"><a href="#cb139-72" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb139-73"><a href="#cb139-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "90%"</span></span>
<span id="cb139-74"><a href="#cb139-74" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/significant_final.png"</span>)</span>
<span id="cb139-75"><a href="#cb139-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-76"><a href="#cb139-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-77"><a href="#cb139-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parametric Hypothesis Testing</span></span>
<span id="cb139-78"><a href="#cb139-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-79"><a href="#cb139-79" aria-hidden="true" tabindex="-1"></a>In traditional **parametric** statistics, we make the assumption that the sampling distribution of our statistic of interest (e.g., a mean) takes the form of a particular well-understood mathematical distribution (e.g., the normal), and we calculate a test statistic that basically summarizes the "location" of a summary statistic about our data relative to that implied, theoretical sampling distribution.</span>
<span id="cb139-80"><a href="#cb139-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-81"><a href="#cb139-81" aria-hidden="true" tabindex="-1"></a>The particular value of our test statistic is determined by both the **difference between the original sample statistic and the expected null value** (e.g., the difference between the mean of our sample and the expected population mean) and the **standard error of the sample statistic**. The value of our test statistic (i.e., the "distance" of that test statistic from what is expected) and the shape of the presumed sampling distribution for that statistic are the sole drivers of the smallness of the **p value**. The **p value** effectively represents the area under the sampling distribution associated with test statistic values **as or more extreme** than the one we observed.</span>
<span id="cb139-82"><a href="#cb139-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-83"><a href="#cb139-83" aria-hidden="true" tabindex="-1"></a>How do we calculate the **p value** for a parametric test?</span>
<span id="cb139-84"><a href="#cb139-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-85"><a href="#cb139-85" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Specify the sample statistic we want to evaluate (e.g., the mean).</span>
<span id="cb139-86"><a href="#cb139-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-87"><a href="#cb139-87" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Specify the test statistic of interest and the form of the sampling distribution for that statistic (e.g., $Z$ or $T$ and a *standard normal* or *T* distribution).</span>
<span id="cb139-88"><a href="#cb139-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-89"><a href="#cb139-89" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate the *tail probability*, i.e., the probability of obtaining a statistic (e.g., a mean) as or more extreme than was observed assuming that null distribution.</span>
<span id="cb139-90"><a href="#cb139-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-91"><a href="#cb139-91" aria-hidden="true" tabindex="-1"></a><span class="fu">### Important Comments on P Values</span></span>
<span id="cb139-92"><a href="#cb139-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-93"><a href="#cb139-93" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **p value** is simply the probability of seeing some descriptive statistic (mean, median, regression coefficient, whatever) given the data you have and *given particular assumptions you make about the model generating the data*! The **p value** says nothing about effect size, biological meaning, or the accuracy of the model.</span>
<span id="cb139-94"><a href="#cb139-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-95"><a href="#cb139-95" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Statistical "significance", i.e., if some statistic you calculate has a low **p value**, does NOT mean the effect is strong is or biologically important!</span>
<span id="cb139-96"><a href="#cb139-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-97"><a href="#cb139-97" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There is no problem with *reporting* **p values**... but using **p values** as line for dichotomously classifying results into "significant" versus "not significant" (or for interpreting results in this way) **is** problematic and not good statistical practice!</span>
<span id="cb139-98"><a href="#cb139-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-99"><a href="#cb139-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Finally, it is  valuable, I believe, to contrast **p values** as estimated via the classical/Fisherian frequentist approaches where the "model" generating the data is one that is reasonably approximated by some well-characterized mathematical distribution (Gaussian, binomial, etc.) versus **p values** estimated based on permutation/resampling from the particular data we have collected (see [**Module 16**](#module-16). That latter approach is much more relevant for the situation that many of us in this class face, where we often do not have a good idea about what the data-generating model or the resultant distribution of the data is likely to be.</span>
<span id="cb139-100"><a href="#cb139-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-101"><a href="#cb139-101" aria-hidden="true" tabindex="-1"></a><span class="fu">### Working with Means {.unnumbered}</span></span>
<span id="cb139-102"><a href="#cb139-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-103"><a href="#cb139-103" aria-hidden="true" tabindex="-1"></a><span class="fu">#### One Sample $Z$ and $T$ Test {.unnumbered}</span></span>
<span id="cb139-104"><a href="#cb139-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-105"><a href="#cb139-105" aria-hidden="true" tabindex="-1"></a>Let's do an example where we try to evaluate whether the mean of a single set of observations is significantly different than that expected under a null hypothesis... i.e., this is a ONE-SAMPLE test.</span>
<span id="cb139-106"><a href="#cb139-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-107"><a href="#cb139-107" aria-hidden="true" tabindex="-1"></a>Suppose we have a vector describing the adult weights of vervet monkeys trapped in South Africa during the 2015 trapping season. We have the sense they are heavier than vervets we trapped in previous years, which averaged 5.0 kilograms. We calculate the mean of our sample of trapped vervets and then need to decide whether that mean is significantly greater than our expectation based on prior information.</span>
<span id="cb139-108"><a href="#cb139-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-111"><a href="#cb139-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-112"><a href="#cb139-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb139-113"><a href="#cb139-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb139-114"><a href="#cb139-114" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/vervets.jpg"</span>)</span>
<span id="cb139-115"><a href="#cb139-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-116"><a href="#cb139-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-117"><a href="#cb139-117" aria-hidden="true" tabindex="-1"></a>First, we read in our data:</span>
<span id="cb139-118"><a href="#cb139-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-121"><a href="#cb139-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-122"><a href="#cb139-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb139-123"><a href="#cb139-123" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/vervet-weights.csv"</span></span>
<span id="cb139-124"><a href="#cb139-124" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names=</span><span class="cn">TRUE</span>)</span>
<span id="cb139-125"><a href="#cb139-125" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb139-126"><a href="#cb139-126" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(d<span class="sc">$</span>weight)</span>
<span id="cb139-127"><a href="#cb139-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-128"><a href="#cb139-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-129"><a href="#cb139-129" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is our $H_0$?</span>
<span id="cb139-130"><a href="#cb139-130" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is our $H_A$?</span>
<span id="cb139-131"><a href="#cb139-131" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the hypothesis we want to test? Is it two-tailed? Upper-tailed? Lower-tailed?</span>
<span id="cb139-132"><a href="#cb139-132" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate the mean, standard deviation, and SE of the sample</span>
<span id="cb139-133"><a href="#cb139-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-136"><a href="#cb139-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-137"><a href="#cb139-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb139-138"><a href="#cb139-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb139-139"><a href="#cb139-139" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">5.0</span></span>
<span id="cb139-140"><a href="#cb139-140" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d<span class="sc">$</span>weight <span class="co"># current weights</span></span>
<span id="cb139-141"><a href="#cb139-141" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb139-142"><a href="#cb139-142" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x))</span>
<span id="cb139-143"><a href="#cb139-143" aria-hidden="true" tabindex="-1"></a>(s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x))</span>
<span id="cb139-144"><a href="#cb139-144" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> s<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb139-145"><a href="#cb139-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-146"><a href="#cb139-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-147"><a href="#cb139-147" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plot a histogram of the sample</span>
<span id="cb139-148"><a href="#cb139-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-151"><a href="#cb139-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-152"><a href="#cb139-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb139-153"><a href="#cb139-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb139-154"><a href="#cb139-154" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb139-155"><a href="#cb139-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: 'last'</span></span>
<span id="cb139-156"><a href="#cb139-156" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(x, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> s, <span class="at">to =</span> m <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> s,</span>
<span id="cb139-157"><a href="#cb139-157" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">20</span>),</span>
<span id="cb139-158"><a href="#cb139-158" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Histogram of Vervet</span><span class="sc">\n</span><span class="st">Weights"</span>, <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Proportion of Total"</span>,</span>
<span id="cb139-159"><a href="#cb139-159" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"density"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb139-160"><a href="#cb139-160" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))</span>
<span id="cb139-161"><a href="#cb139-161" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span>mu, <span class="at">col=</span><span class="st">"black"</span>,<span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>)) <span class="co"># expected mean</span></span>
<span id="cb139-162"><a href="#cb139-162" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span>m, <span class="at">col=</span><span class="st">"black"</span>,<span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)) <span class="co"># observed mean</span></span>
<span id="cb139-163"><a href="#cb139-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-164"><a href="#cb139-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-165"><a href="#cb139-165" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Using the <span class="in">`plotDist()`</span> function from {mosaic}, plot the location of your sample mean, the sampling distribution suggested by your sample's standard error, and the location of the expected mean from the 2015 data.</span>
<span id="cb139-166"><a href="#cb139-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-169"><a href="#cb139-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-170"><a href="#cb139-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb139-171"><a href="#cb139-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb139-172"><a href="#cb139-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb139-173"><a href="#cb139-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: 'last'</span></span>
<span id="cb139-174"><a href="#cb139-174" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"norm"</span>, <span class="at">mean=</span>m, <span class="at">sd=</span>se, <span class="at">xlim=</span><span class="fu">c</span>(m <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> se, m <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>se), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col=</span> <span class="st">"black"</span>, <span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb139-175"><a href="#cb139-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-176"><a href="#cb139-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-177"><a href="#cb139-177" aria-hidden="true" tabindex="-1"></a>The following code demonstrates that more than 95% of the sampling distribution suggested by your sample is above the expected mean of 5.0...</span>
<span id="cb139-178"><a href="#cb139-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-181"><a href="#cb139-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-182"><a href="#cb139-182" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: 'last'</span></span>
<span id="cb139-183"><a href="#cb139-183" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.05</span>) <span class="co"># define lower bound of upper 95% of distribution</span></span>
<span id="cb139-184"><a href="#cb139-184" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(</span>
<span id="cb139-185"><a href="#cb139-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb139-186"><a href="#cb139-186" aria-hidden="true" tabindex="-1"></a>    m <span class="sc">+</span> z <span class="sc">*</span> se,</span>
<span id="cb139-187"><a href="#cb139-187" aria-hidden="true" tabindex="-1"></a>    <span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">+</span> z <span class="sc">*</span> se, <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb139-188"><a href="#cb139-188" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(x)</span>
<span id="cb139-189"><a href="#cb139-189" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb139-190"><a href="#cb139-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb139-191"><a href="#cb139-191" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb139-192"><a href="#cb139-192" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">+</span> z <span class="sc">*</span> se, <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">1000</span>), m, se),</span>
<span id="cb139-193"><a href="#cb139-193" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span></span>
<span id="cb139-194"><a href="#cb139-194" aria-hidden="true" tabindex="-1"></a>  )), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)))</span>
<span id="cb139-195"><a href="#cb139-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-196"><a href="#cb139-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-197"><a href="#cb139-197" aria-hidden="true" tabindex="-1"></a>For a formal statistical test of whether our sample mean is greater than the expected mean, we first calculate the test statistic. It takes a familiar form... it is effectively the position of our sample mean relative to the expected population mean and the expected population standard deviation (which we have estimated from our sample).</span>
<span id="cb139-198"><a href="#cb139-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-199"><a href="#cb139-199" aria-hidden="true" tabindex="-1"></a>$$Z = \frac{\bar{x}-\mu}{s/\sqrt{n}}$$</span>
<span id="cb139-200"><a href="#cb139-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-201"><a href="#cb139-201" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb139-202"><a href="#cb139-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-203"><a href="#cb139-203" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\bar{x}$ = mean of sample observations</span>
<span id="cb139-204"><a href="#cb139-204" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mu$ = expected mean</span>
<span id="cb139-205"><a href="#cb139-205" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$s$ = sample standard deviation (as an estimate of the population SD)</span>
<span id="cb139-206"><a href="#cb139-206" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$n$ = number of sample observations</span>
<span id="cb139-207"><a href="#cb139-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-208"><a href="#cb139-208" aria-hidden="true" tabindex="-1"></a>Or, to use our variables from above...</span>
<span id="cb139-209"><a href="#cb139-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-212"><a href="#cb139-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-213"><a href="#cb139-213" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu)<span class="sc">/</span>se</span>
<span id="cb139-214"><a href="#cb139-214" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb139-215"><a href="#cb139-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-216"><a href="#cb139-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-217"><a href="#cb139-217" aria-hidden="true" tabindex="-1"></a>In this case, our test statistic, $Z$, is a quantile... the estimated number of standard errors away from the expected population mean that our sample mean falls based on the implied sampling distribution. If our sample mean is greater than expected, then the test statistic is positive; if our sample mean is less than expected, then the test statistic is negative.</span>
<span id="cb139-218"><a href="#cb139-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-219"><a href="#cb139-219" aria-hidden="true" tabindex="-1"></a>To evaluate whether $Z$ is "significant" under a NHST framework, we need to calculate the total probability of our seeing a deviation from the expected mean as great or greater than this by chance. For a two-tailed test, this deviation can be in either the positive or negative direction, while for a one-tailed test, we are only interested in the probability associated with our specific alternative hypothesis (i.e., $\mu_{H_A} \gt \mu_{H_0}$ or $\mu_{H_A} \lt \mu_{H_0}$).</span>
<span id="cb139-220"><a href="#cb139-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-221"><a href="#cb139-221" aria-hidden="true" tabindex="-1"></a>To calculate these probabilities, we can use the <span class="in">`pnorm()`</span> function. Because in calculating a $Z$ score we have converted our sample mean to the standard normal scale, the <span class="in">`mean=`</span> and <span class="in">`sd=`</span> arguments of <span class="in">`pnorm()`</span> are the defaults of 0 and 1, respectively.</span>
<span id="cb139-222"><a href="#cb139-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-223"><a href="#cb139-223" aria-hidden="true" tabindex="-1"></a>For this specific example, where we want to test the idea that our sample mean is greater than expected, we want the probability of seeing a $Z$ as large or larger by chance. This corresponds to the area under the normal curve to the right of $Z$ (the "upper.tail"), which we can calculate as:</span>
<span id="cb139-224"><a href="#cb139-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-227"><a href="#cb139-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-228"><a href="#cb139-228" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(z)</span>
<span id="cb139-229"><a href="#cb139-229" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb139-230"><a href="#cb139-230" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb139-231"><a href="#cb139-231" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb139-232"><a href="#cb139-232" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb139-233"><a href="#cb139-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-234"><a href="#cb139-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-235"><a href="#cb139-235" aria-hidden="true" tabindex="-1"></a>To visualize this on a standard normal curve...</span>
<span id="cb139-236"><a href="#cb139-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-239"><a href="#cb139-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-240"><a href="#cb139-240" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: 'last'</span></span>
<span id="cb139-241"><a href="#cb139-241" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"norm"</span>, <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Standard Normal Distribution</span><span class="sc">\n</span><span class="st">blue area = "</span>, <span class="fu">round</span>(p, <span class="dv">4</span>) <span class="sc">*</span><span class="dv">100</span>, <span class="st">"%"</span>), <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">"SD"</span>)</span>
<span id="cb139-242"><a href="#cb139-242" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span>z, <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>))</span>
<span id="cb139-243"><a href="#cb139-243" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(z, <span class="fu">seq</span>(<span class="at">from=</span>z, <span class="at">to=</span><span class="dv">4</span>, <span class="at">length.out=</span><span class="dv">100</span>),<span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from=</span>z, <span class="at">to=</span><span class="dv">4</span>, <span class="at">length.out=</span><span class="dv">100</span>),<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">0</span>)), <span class="at">border=</span><span class="st">"black"</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)))</span>
<span id="cb139-244"><a href="#cb139-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-245"><a href="#cb139-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-246"><a href="#cb139-246" aria-hidden="true" tabindex="-1"></a>We can also consider the "significance" in a different way, by asking does our value for $Z$ fall in the upper 5% of the normal distribution for $Z$ scores. For this, we can use <span class="in">`qnorm()`</span> to return the critical value demarking the boundary of the upper 5% of the distribution and see of $Z$ falls to the right of that, which indeed it does.</span>
<span id="cb139-247"><a href="#cb139-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-250"><a href="#cb139-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-251"><a href="#cb139-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: 'last'</span></span>
<span id="cb139-252"><a href="#cb139-252" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"norm"</span>,</span>
<span id="cb139-253"><a href="#cb139-253" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Standard Normal Distribution</span><span class="sc">\n</span><span class="st">red area = upper 5%"</span>),</span>
<span id="cb139-254"><a href="#cb139-254" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">"SD"</span>)</span>
<span id="cb139-255"><a href="#cb139-255" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span>z, <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>))</span>
<span id="cb139-256"><a href="#cb139-256" aria-hidden="true" tabindex="-1"></a>critical_val <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.95</span>)</span>
<span id="cb139-257"><a href="#cb139-257" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span>critical_val, <span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>))</span>
<span id="cb139-258"><a href="#cb139-258" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(critical_val, <span class="fu">seq</span>(<span class="at">from =</span> critical_val, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">4</span>),<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> critical_val, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)))</span>
<span id="cb139-259"><a href="#cb139-259" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(z, <span class="fu">seq</span>(<span class="at">from =</span> z, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> z, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">0</span>)), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)))</span>
<span id="cb139-260"><a href="#cb139-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-261"><a href="#cb139-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-262"><a href="#cb139-262" aria-hidden="true" tabindex="-1"></a>Another way to think about whether there is a "significant" difference between our observed and expected mean weight is to look at the 95% CI around our estimate of mean weight. We can calculate this by hand for the one-tailed test...</span>
<span id="cb139-263"><a href="#cb139-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-266"><a href="#cb139-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-267"><a href="#cb139-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: 'last'</span></span>
<span id="cb139-268"><a href="#cb139-268" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb139-269"><a href="#cb139-269" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> m <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd =</span><span class="dv">1</span>) <span class="sc">*</span> se <span class="co"># by hand... lower limit for 95% of sampling distribution</span></span>
<span id="cb139-270"><a href="#cb139-270" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(x, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> s, <span class="at">to =</span> m <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> s,</span>
<span id="cb139-271"><a href="#cb139-271" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">20</span>),</span>
<span id="cb139-272"><a href="#cb139-272" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Histogram of Vervet</span><span class="sc">\n</span><span class="st">Weights"</span>, <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Proportion of Total"</span>,</span>
<span id="cb139-273"><a href="#cb139-273" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"density"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb139-274"><a href="#cb139-274" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))</span>
<span id="cb139-275"><a href="#cb139-275" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span>mu, <span class="at">col=</span><span class="st">"black"</span>,<span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>)) <span class="co"># expected mean</span></span>
<span id="cb139-276"><a href="#cb139-276" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span>m, <span class="at">col=</span><span class="st">"black"</span>,<span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)) <span class="co"># observed mean</span></span>
<span id="cb139-277"><a href="#cb139-277" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span>ci, <span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)) <span class="co"># lower bound for 95% CI</span></span>
<span id="cb139-278"><a href="#cb139-278" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.05</span>) <span class="co"># define lower bound of upper 95% of distribution</span></span>
<span id="cb139-279"><a href="#cb139-279" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(</span>
<span id="cb139-280"><a href="#cb139-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb139-281"><a href="#cb139-281" aria-hidden="true" tabindex="-1"></a>    m <span class="sc">+</span> z <span class="sc">*</span> se,</span>
<span id="cb139-282"><a href="#cb139-282" aria-hidden="true" tabindex="-1"></a>    <span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">+</span> z <span class="sc">*</span> se, <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb139-283"><a href="#cb139-283" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(x)</span>
<span id="cb139-284"><a href="#cb139-284" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb139-285"><a href="#cb139-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb139-286"><a href="#cb139-286" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb139-287"><a href="#cb139-287" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="at">from =</span> m <span class="sc">+</span> z <span class="sc">*</span> se, <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">1000</span>), m, se),</span>
<span id="cb139-288"><a href="#cb139-288" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span></span>
<span id="cb139-289"><a href="#cb139-289" aria-hidden="true" tabindex="-1"></a>  )), <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)))</span>
<span id="cb139-290"><a href="#cb139-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-291"><a href="#cb139-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-292"><a href="#cb139-292" aria-hidden="true" tabindex="-1"></a>... and for a two-tailed CI...</span>
<span id="cb139-293"><a href="#cb139-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-296"><a href="#cb139-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-297"><a href="#cb139-297" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: 'last'</span></span>
<span id="cb139-298"><a href="#cb139-298" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd =</span><span class="dv">1</span>) <span class="sc">*</span> se <span class="co"># by hand...</span></span>
<span id="cb139-299"><a href="#cb139-299" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span>ci, <span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)) <span class="co"># upper and lower bounds for 95% CI</span></span>
<span id="cb139-300"><a href="#cb139-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-301"><a href="#cb139-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-302"><a href="#cb139-302" aria-hidden="true" tabindex="-1"></a>As noted above, our sample size from a population is typically limited. So, instead of using the normal distribution (as we did here) to determine the **p value** of our statistic, we actually **should** use the $t$ distribution, which, as we have seen, has slightly fatter tails. The statistic and process is exactly the same, though, as for the normal distribution.</span>
<span id="cb139-303"><a href="#cb139-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-304"><a href="#cb139-304" aria-hidden="true" tabindex="-1"></a>$$T = \frac{\bar{x}-\mu}{s/\sqrt{n}}$$</span>
<span id="cb139-305"><a href="#cb139-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-306"><a href="#cb139-306" aria-hidden="true" tabindex="-1"></a>or, equivalently...</span>
<span id="cb139-307"><a href="#cb139-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-308"><a href="#cb139-308" aria-hidden="true" tabindex="-1"></a>$$T = \frac{\bar{x}-\mu}{\sqrt{s^2/n}}$$</span>
<span id="cb139-309"><a href="#cb139-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-310"><a href="#cb139-310" aria-hidden="true" tabindex="-1"></a>with</span>
<span id="cb139-311"><a href="#cb139-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-312"><a href="#cb139-312" aria-hidden="true" tabindex="-1"></a>$$df = n - 1$$</span>
<span id="cb139-313"><a href="#cb139-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-316"><a href="#cb139-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-317"><a href="#cb139-317" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu)<span class="sc">/</span>se</span>
<span id="cb139-318"><a href="#cb139-318" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(z, <span class="at">df=</span>n<span class="dv">-1</span>))</span>
<span id="cb139-319"><a href="#cb139-319" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pt</span>(z, <span class="at">df=</span>n<span class="dv">-1</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>))</span>
<span id="cb139-320"><a href="#cb139-320" aria-hidden="true" tabindex="-1"></a>(critical_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.95</span>, <span class="at">df=</span>n<span class="dv">-1</span>))</span>
<span id="cb139-321"><a href="#cb139-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-322"><a href="#cb139-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-325"><a href="#cb139-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-326"><a href="#cb139-326" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: 'last'</span></span>
<span id="cb139-327"><a href="#cb139-327" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"t"</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"t Distribution with DF = "</span>,</span>
<span id="cb139-328"><a href="#cb139-328" aria-hidden="true" tabindex="-1"></a>  n<span class="dv">-1</span>,<span class="st">"</span><span class="sc">\n</span><span class="st">blue area = "</span>,<span class="fu">round</span>(p, <span class="dv">4</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">"%"</span>), <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">"SD"</span>)</span>
<span id="cb139-329"><a href="#cb139-329" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span>z, <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>))</span>
<span id="cb139-330"><a href="#cb139-330" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(z,<span class="fu">seq</span>(<span class="at">from=</span>z, <span class="at">to=</span><span class="dv">4</span>, <span class="at">length.out=</span><span class="dv">100</span>), <span class="dv">4</span>),</span>
<span id="cb139-331"><a href="#cb139-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="at">from=</span>z, <span class="at">to=</span><span class="dv">4</span>, <span class="at">length.out=</span><span class="dv">100</span>),<span class="at">df=</span>n<span class="dv">-1</span>),<span class="dv">0</span>)),</span>
<span id="cb139-332"><a href="#cb139-332" aria-hidden="true" tabindex="-1"></a>  <span class="at">border=</span><span class="st">"black"</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)))</span>
<span id="cb139-333"><a href="#cb139-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-334"><a href="#cb139-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-335"><a href="#cb139-335" aria-hidden="true" tabindex="-1"></a>***R*** has built into it a single function, <span class="in">`t.test()`</span>, that lets us do all this in one line. We give it our data and the expected population mean, $\mu$, along with the kind of test we want to do.</span>
<span id="cb139-336"><a href="#cb139-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-339"><a href="#cb139-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-340"><a href="#cb139-340" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x=</span>x, <span class="at">mu=</span>mu, <span class="at">alternative=</span><span class="st">"greater"</span>)</span>
<span id="cb139-341"><a href="#cb139-341" aria-hidden="true" tabindex="-1"></a>t_stat <span class="co"># the value of the t statistic is a Z score</span></span>
<span id="cb139-342"><a href="#cb139-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-343"><a href="#cb139-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-344"><a href="#cb139-344" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`t.test()`</span> function to also calculates $t$- distribution based CIs for us easily. For the above test, the 95% CI is open-ended on the upper end because we are doing a one-tailed test. Doing the same thing by hand...</span>
<span id="cb139-345"><a href="#cb139-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-348"><a href="#cb139-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-349"><a href="#cb139-349" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb139-350"><a href="#cb139-350" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">c</span>(m <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se, <span class="cn">Inf</span>) <span class="co"># lower bound calculated by hand... note we do not divide alpha by 2</span></span>
<span id="cb139-351"><a href="#cb139-351" aria-hidden="true" tabindex="-1"></a>ci</span>
<span id="cb139-352"><a href="#cb139-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-353"><a href="#cb139-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-354"><a href="#cb139-354" aria-hidden="true" tabindex="-1"></a>For an equivalent two-tailed test with the same data...</span>
<span id="cb139-355"><a href="#cb139-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-358"><a href="#cb139-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-359"><a href="#cb139-359" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x=</span>x, <span class="at">mu=</span>mu, <span class="at">alternative=</span><span class="st">"two.sided"</span>)</span>
<span id="cb139-360"><a href="#cb139-360" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> t_stat<span class="sc">$</span>conf.int <span class="co"># using t test</span></span>
<span id="cb139-361"><a href="#cb139-361" aria-hidden="true" tabindex="-1"></a>ci</span>
<span id="cb139-362"><a href="#cb139-362" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span>se <span class="co"># upper and lower bounds calculated by hand</span></span>
<span id="cb139-363"><a href="#cb139-363" aria-hidden="true" tabindex="-1"></a>ci </span>
<span id="cb139-364"><a href="#cb139-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-365"><a href="#cb139-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-366"><a href="#cb139-366" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb139-367"><a href="#cb139-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-368"><a href="#cb139-368" aria-hidden="true" tabindex="-1"></a>Adult lowland woolly monkeys are reported to have an average body weight of 7.2 kilograms. You are working with an isolated population of woolly monkeys from the Colombian Andes that you think may be a different species from lowland form, and you collect a sample of 15 weights from adult individuals at that site. From your sample, you calculate a mean of 6.43 kilograms and a standard deviation of 0.89 kilograms. Perform a hypothesis test to evaluate whether body weights in your population are different from the reported average for lowland woolly monkeys by setting up a "two-tailed" hypothesis, carrying out the analysis, and interpreting the **p value** (assume the significance level is $\alpha$ = 0.05).</span>
<span id="cb139-369"><a href="#cb139-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-372"><a href="#cb139-372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-373"><a href="#cb139-373" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb139-374"><a href="#cb139-374" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb139-375"><a href="#cb139-375" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/woolly.jpg"</span>)</span>
<span id="cb139-376"><a href="#cb139-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-377"><a href="#cb139-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-378"><a href="#cb139-378" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **HINT:** Your sample size is \&lt; 30, so you should use the $t$ distribution and do a **t test**. Do your calculations both by hand and using the </span><span class="in">`t.test()`</span><span class="at"> function and confirm that they match.</span></span>
<span id="cb139-379"><a href="#cb139-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-380"><a href="#cb139-380" aria-hidden="true" tabindex="-1"></a>First, read in the data:</span>
<span id="cb139-381"><a href="#cb139-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-384"><a href="#cb139-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-385"><a href="#cb139-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb139-386"><a href="#cb139-386" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/woolly-weights.csv"</span></span>
<span id="cb139-387"><a href="#cb139-387" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names=</span><span class="cn">TRUE</span>)</span>
<span id="cb139-388"><a href="#cb139-388" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb139-389"><a href="#cb139-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-390"><a href="#cb139-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-391"><a href="#cb139-391" aria-hidden="true" tabindex="-1"></a>Then, calculate the mean, standard deviation, and SE of your sample:</span>
<span id="cb139-392"><a href="#cb139-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-395"><a href="#cb139-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-396"><a href="#cb139-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb139-397"><a href="#cb139-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb139-398"><a href="#cb139-398" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb139-399"><a href="#cb139-399" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d<span class="sc">$</span>weight</span>
<span id="cb139-400"><a href="#cb139-400" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb139-401"><a href="#cb139-401" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x))</span>
<span id="cb139-402"><a href="#cb139-402" aria-hidden="true" tabindex="-1"></a>(s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x))</span>
<span id="cb139-403"><a href="#cb139-403" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> s<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb139-404"><a href="#cb139-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-405"><a href="#cb139-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-406"><a href="#cb139-406" aria-hidden="true" tabindex="-1"></a>Finally, calculate the $T$ statistic and then determine the **p value** associated with that statistic.</span>
<span id="cb139-407"><a href="#cb139-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-408"><a href="#cb139-408" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Because this is a two-tailed test, we need to calculate the probability of seeing a $T$ statistic as far from the mean in either the positive or negative direction. This is why we sum the probabilities associated with the upper and lower tails...</span></span>
<span id="cb139-409"><a href="#cb139-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-412"><a href="#cb139-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-413"><a href="#cb139-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb139-414"><a href="#cb139-414" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb139-415"><a href="#cb139-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb139-416"><a href="#cb139-416" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">7.2</span></span>
<span id="cb139-417"><a href="#cb139-417" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu)<span class="sc">/</span>se</span>
<span id="cb139-418"><a href="#cb139-418" aria-hidden="true" tabindex="-1"></a>t_stat</span>
<span id="cb139-419"><a href="#cb139-419" aria-hidden="true" tabindex="-1"></a>p_upper <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(t_stat ), <span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb139-420"><a href="#cb139-420" aria-hidden="true" tabindex="-1"></a><span class="co"># or 1 - pt(t_stat, df=n-1, lower.tail = FALSE)</span></span>
<span id="cb139-421"><a href="#cb139-421" aria-hidden="true" tabindex="-1"></a>p_lower <span class="ot">&lt;-</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">abs</span>(t_stat ), <span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb139-422"><a href="#cb139-422" aria-hidden="true" tabindex="-1"></a><span class="co"># or pt(t_stat, df=n-1, lower.tail = TRUE)</span></span>
<span id="cb139-423"><a href="#cb139-423" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p_upper <span class="sc">+</span> p_lower</span>
<span id="cb139-424"><a href="#cb139-424" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb139-425"><a href="#cb139-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-426"><a href="#cb139-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-427"><a href="#cb139-427" aria-hidden="true" tabindex="-1"></a>To visualize this...</span>
<span id="cb139-428"><a href="#cb139-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-431"><a href="#cb139-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-432"><a href="#cb139-432" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: "last"</span></span>
<span id="cb139-433"><a href="#cb139-433" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"t"</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"t Distribution with DF = "</span>, n<span class="dv">-1</span>,<span class="st">"</span><span class="sc">\n</span><span class="st">red area = 2.5% in each tail"</span>,<span class="st">"</span><span class="sc">\n</span><span class="st">blue = "</span>,<span class="fu">round</span>(p,<span class="dv">4</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">"%"</span>), <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">"SD"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb139-434"><a href="#cb139-434" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span><span class="fu">abs</span>(t_stat), <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>))</span>
<span id="cb139-435"><a href="#cb139-435" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span><span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">abs</span>(t_stat), <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>))</span>
<span id="cb139-436"><a href="#cb139-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-437"><a href="#cb139-437" aria-hidden="true" tabindex="-1"></a><span class="co"># plot upper tail</span></span>
<span id="cb139-438"><a href="#cb139-438" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(<span class="fu">abs</span>(t_stat),<span class="fu">seq</span>(<span class="at">from=</span><span class="fu">abs</span>(t_stat), <span class="at">to=</span><span class="dv">4</span>, <span class="at">length.out=</span><span class="dv">100</span>), <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">dt</span>(<span class="fu">seq</span>(<span class="at">from=</span><span class="fu">abs</span>(t_stat), <span class="at">to=</span><span class="dv">4</span>, <span class="at">length.out=</span><span class="dv">100</span>),<span class="at">df=</span>n<span class="dv">-1</span>),<span class="dv">0</span>)), <span class="at">border=</span><span class="st">"black"</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)))</span>
<span id="cb139-439"><a href="#cb139-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-440"><a href="#cb139-440" aria-hidden="true" tabindex="-1"></a><span class="co"># plot lower tail</span></span>
<span id="cb139-441"><a href="#cb139-441" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">abs</span>(t_stat), <span class="at">length.out=</span><span class="dv">100</span>), <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">abs</span>(t_stat)),<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">dt</span>(<span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">abs</span>(t_stat), <span class="at">length.out=</span><span class="dv">100</span>), <span class="at">df=</span>n<span class="dv">-1</span>),<span class="dv">0</span>)), <span class="at">border=</span><span class="st">"black"</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)))</span>
<span id="cb139-442"><a href="#cb139-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-443"><a href="#cb139-443" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb139-444"><a href="#cb139-444" aria-hidden="true" tabindex="-1"></a>critical_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>n<span class="dv">-1</span>) <span class="co"># identify critical values - boundaries for 95% of the t distribution</span></span>
<span id="cb139-445"><a href="#cb139-445" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span><span class="fu">abs</span>(critical_val), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>))</span>
<span id="cb139-446"><a href="#cb139-446" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span><span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">abs</span>(critical_val), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>))</span>
<span id="cb139-447"><a href="#cb139-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-448"><a href="#cb139-448" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(critical_val,<span class="fu">seq</span>(<span class="at">from=</span>critical_val, <span class="at">to=</span><span class="dv">4</span>, <span class="at">length.out=</span><span class="dv">100</span>), <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">dt</span>(<span class="fu">seq</span>(<span class="at">from=</span>critical_val, <span class="at">to=</span><span class="dv">4</span>, <span class="at">length.out=</span><span class="dv">100</span>),<span class="at">df =</span> n<span class="dv">-1</span>),<span class="dv">0</span>)), <span class="at">border=</span><span class="st">"black"</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>)))</span>
<span id="cb139-449"><a href="#cb139-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-450"><a href="#cb139-450" aria-hidden="true" tabindex="-1"></a><span class="fu">ladd</span>(<span class="fu">panel.polygon</span>(<span class="fu">cbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">abs</span>(critical_val), <span class="at">length.out=</span><span class="dv">100</span>), <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">abs</span>(critical_val)), <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">dt</span>(<span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">abs</span>(critical_val), <span class="at">length.out=</span><span class="dv">100</span>), <span class="at">df =</span> n<span class="dv">-1</span>),<span class="dv">0</span>)), <span class="at">border=</span><span class="st">"black"</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>)))</span>
<span id="cb139-451"><a href="#cb139-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-452"><a href="#cb139-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-453"><a href="#cb139-453" aria-hidden="true" tabindex="-1"></a>We can implement a simple test to see if the value of our $T$ statistic is farther away from zero than the critical value...</span>
<span id="cb139-454"><a href="#cb139-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-457"><a href="#cb139-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-458"><a href="#cb139-458" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> (<span class="fu">abs</span>(t_stat) <span class="sc">&gt;</span> critical_val)</span>
<span id="cb139-459"><a href="#cb139-459" aria-hidden="true" tabindex="-1"></a><span class="co"># boolean test as to whether t is larger than the critical value at either tail</span></span>
<span id="cb139-460"><a href="#cb139-460" aria-hidden="true" tabindex="-1"></a>test</span>
<span id="cb139-461"><a href="#cb139-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-462"><a href="#cb139-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-463"><a href="#cb139-463" aria-hidden="true" tabindex="-1"></a>Another way to think about whether there is a significant difference between our observed and expected mean weight is to look at the 95% CI around our estimate of mean weight. We can calculate this by hand or use the output of the **t test**...</span>
<span id="cb139-464"><a href="#cb139-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-467"><a href="#cb139-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-468"><a href="#cb139-468" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">*</span> critical_val <span class="sc">*</span> se) <span class="co"># by hand</span></span>
<span id="cb139-469"><a href="#cb139-469" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x=</span>x, <span class="at">mu=</span>mu, <span class="at">alternative=</span><span class="st">"two.sided"</span>) <span class="co"># `t.test()` function</span></span>
<span id="cb139-470"><a href="#cb139-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-471"><a href="#cb139-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-472"><a href="#cb139-472" aria-hidden="true" tabindex="-1"></a>The 95% CI does not include the expected mean weight.</span>
<span id="cb139-473"><a href="#cb139-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-474"><a href="#cb139-474" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Two Sample $Z$ and $T$ Test {.unnumbered}</span></span>
<span id="cb139-475"><a href="#cb139-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-476"><a href="#cb139-476" aria-hidden="true" tabindex="-1"></a>Sometimes we want to compare two groups of measurements to one another, which boils down to a hypothesis test for the difference between two means, $\mu1$ and $\mu2$. The null hypothesis is that the **difference between these means** is zero.</span>
<span id="cb139-477"><a href="#cb139-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-478"><a href="#cb139-478" aria-hidden="true" tabindex="-1"></a>Before getting to the appropriate test, there are a couple of things that we need to consider:</span>
<span id="cb139-479"><a href="#cb139-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-480"><a href="#cb139-480" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">1</span><span class="co">]</span> How, if at all, **are the two samples related to one another**? Sometimes we may have PAIRED samples (e.g., the same individuals before and after some treatment) and sometimes the samples are UNPAIRED or INDEPENDENT (e.g., weights for different samples of black-and-white colobus monkeys collected in the rainy versus dry seasons).</span>
<span id="cb139-481"><a href="#cb139-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-482"><a href="#cb139-482" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">2</span><span class="co">]</span> Are the **variances in the two samples roughly equal or not**? E.g., if we are comparing male and female heights, are the variances comparable?</span>
<span id="cb139-483"><a href="#cb139-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-484"><a href="#cb139-484" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Samples with Unequal Variances {.unnumbered}</span></span>
<span id="cb139-485"><a href="#cb139-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-486"><a href="#cb139-486" aria-hidden="true" tabindex="-1"></a>For the most generic case, where the two samples are independent and we cannot assume the variances of the two samples are equal, we can do what is called **Welch's t test** where our test statistic is:</span>
<span id="cb139-487"><a href="#cb139-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-488"><a href="#cb139-488" aria-hidden="true" tabindex="-1"></a>$$T = \frac{\bar{x_2} - \bar{x_1} - \mu}{\sqrt{s_1^2/n_1 + s_2^2/n_2}}$$</span>
<span id="cb139-489"><a href="#cb139-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-490"><a href="#cb139-490" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb139-491"><a href="#cb139-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-492"><a href="#cb139-492" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\bar{x_1}$ and $\bar{x_2}$ = means of observations in each sample group</span>
<span id="cb139-493"><a href="#cb139-493" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mu$ = expected difference in means between sample groups under the null hypothesis, which is usually zero</span>
<span id="cb139-494"><a href="#cb139-494" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$s_1$ and $s_2$ = standard deviations of each sample group</span>
<span id="cb139-495"><a href="#cb139-495" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$n_1$ and $n_2$ = numbers of observations in each sample group</span>
<span id="cb139-496"><a href="#cb139-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-497"><a href="#cb139-497" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb139-498"><a href="#cb139-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-499"><a href="#cb139-499" aria-hidden="true" tabindex="-1"></a>Let's do an example. Load in a file of black-and-white colobus weights and examine the <span class="in">`str()`</span> of the file.</span>
<span id="cb139-500"><a href="#cb139-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-503"><a href="#cb139-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-504"><a href="#cb139-504" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb139-505"><a href="#cb139-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb139-506"><a href="#cb139-506" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/bwcolobus.jpg"</span>)</span>
<span id="cb139-507"><a href="#cb139-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-508"><a href="#cb139-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-511"><a href="#cb139-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-512"><a href="#cb139-512" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb139-513"><a href="#cb139-513" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/colobus-weights.csv"</span></span>
<span id="cb139-514"><a href="#cb139-514" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names=</span><span class="cn">TRUE</span>)</span>
<span id="cb139-515"><a href="#cb139-515" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb139-516"><a href="#cb139-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-517"><a href="#cb139-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-518"><a href="#cb139-518" aria-hidden="true" tabindex="-1"></a>Then, create two vectors, **x** and **y**, for male and female weights. Plot these in boxplots side by side and then calculate the mean, sd, and sample size for both males and females. Do the variances look similar for the two sexes?</span>
<span id="cb139-519"><a href="#cb139-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-522"><a href="#cb139-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-523"><a href="#cb139-523" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb139-524"><a href="#cb139-524" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb139-525"><a href="#cb139-525" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb139-526"><a href="#cb139-526" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d<span class="sc">$</span>weight[d<span class="sc">$</span>sex <span class="sc">==</span><span class="st">"male"</span>]</span>
<span id="cb139-527"><a href="#cb139-527" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> d<span class="sc">$</span>weight[d<span class="sc">$</span>sex <span class="sc">==</span><span class="st">"female"</span>]</span>
<span id="cb139-528"><a href="#cb139-528" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb139-529"><a href="#cb139-529" aria-hidden="true" tabindex="-1"></a>minval <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(x,y)) <span class="sc">-</span> <span class="fl">0.1</span></span>
<span id="cb139-530"><a href="#cb139-530" aria-hidden="true" tabindex="-1"></a>maxval <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(x,y)) <span class="sc">+</span> <span class="fl">0.1</span></span>
<span id="cb139-531"><a href="#cb139-531" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(x, <span class="at">ylim=</span><span class="fu">c</span>(minval,maxval), <span class="at">main=</span><span class="st">"Weight (kg)"</span>,<span class="at">xlab=</span><span class="st">"Males"</span>)</span>
<span id="cb139-532"><a href="#cb139-532" aria-hidden="true" tabindex="-1"></a><span class="co"># `ylim=` argument uses x and y ranges to set range for y axis</span></span>
<span id="cb139-533"><a href="#cb139-533" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(y, <span class="at">ylim=</span><span class="fu">c</span>(minval,maxval), <span class="at">main=</span><span class="st">"Weight (kg)"</span>,<span class="at">xlab=</span><span class="st">"Females"</span>)</span>
<span id="cb139-534"><a href="#cb139-534" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb139-535"><a href="#cb139-535" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb139-536"><a href="#cb139-536" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># you could leave this out... the default argument value is 0</span></span>
<span id="cb139-537"><a href="#cb139-537" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb139-538"><a href="#cb139-538" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(y)</span>
<span id="cb139-539"><a href="#cb139-539" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb139-540"><a href="#cb139-540" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb139-541"><a href="#cb139-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-542"><a href="#cb139-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-543"><a href="#cb139-543" aria-hidden="true" tabindex="-1"></a>Now calculate the $T$ statistic and test the two-tailed hypothesis that the sample means differ. Note that for the **Welch's t test**, the number of degrees of freedom is calculated as:</span>
<span id="cb139-544"><a href="#cb139-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-545"><a href="#cb139-545" aria-hidden="true" tabindex="-1"></a>$$df = \frac{(s_1^2/n_1 + s_2^2/n_2)^2}{(s_1^2/n_1)^2/(n_1-1)+(s_2^2/n_2)^2/(n_2-1)}$$</span>
<span id="cb139-546"><a href="#cb139-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-549"><a href="#cb139-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-550"><a href="#cb139-550" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> (s2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n2 <span class="sc">+</span> s1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n1)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> ((s2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n2)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(n2<span class="dv">-1</span>) <span class="sc">+</span> (s1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n1)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(n1<span class="dv">-1</span>))</span>
<span id="cb139-551"><a href="#cb139-551" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb139-552"><a href="#cb139-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-553"><a href="#cb139-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-556"><a href="#cb139-556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-557"><a href="#cb139-557" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb139-558"><a href="#cb139-558" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb139-559"><a href="#cb139-559" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb139-560"><a href="#cb139-560" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb139-561"><a href="#cb139-561" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> (m2 <span class="sc">-</span> m1 <span class="sc">-</span> mu) <span class="sc">/</span> <span class="fu">sqrt</span>(s2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n2 <span class="sc">+</span> s1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n1)</span>
<span id="cb139-562"><a href="#cb139-562" aria-hidden="true" tabindex="-1"></a>t_stat</span>
<span id="cb139-563"><a href="#cb139-563" aria-hidden="true" tabindex="-1"></a><span class="co"># note that because our hypothesis is 2-tailed, it does not matter which group</span></span>
<span id="cb139-564"><a href="#cb139-564" aria-hidden="true" tabindex="-1"></a><span class="co"># (males or females) is m1 and which is m2, so we take the absolute values of t</span></span>
<span id="cb139-565"><a href="#cb139-565" aria-hidden="true" tabindex="-1"></a><span class="co"># below when testing whether it is greater than the critical value</span></span>
<span id="cb139-566"><a href="#cb139-566" aria-hidden="true" tabindex="-1"></a>critical_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>df)</span>
<span id="cb139-567"><a href="#cb139-567" aria-hidden="true" tabindex="-1"></a><span class="co"># identify the critical value, i.e., how far apart the means of the two samples</span></span>
<span id="cb139-568"><a href="#cb139-568" aria-hidden="true" tabindex="-1"></a><span class="co"># need to be to be more extreme than expected by chance at the given alpha level</span></span>
<span id="cb139-569"><a href="#cb139-569" aria-hidden="true" tabindex="-1"></a>critical_val</span>
<span id="cb139-570"><a href="#cb139-570" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">abs</span>(t_stat) <span class="sc">&gt;</span> critical_val <span class="co"># boolean test</span></span>
<span id="cb139-571"><a href="#cb139-571" aria-hidden="true" tabindex="-1"></a>test <span class="co"># if true, the two means are significantly different</span></span>
<span id="cb139-572"><a href="#cb139-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-573"><a href="#cb139-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-574"><a href="#cb139-574" aria-hidden="true" tabindex="-1"></a>We can visualize this as below by plotting histograms of body weights for males and females and adding the sampling distribution curves and 95% CIs around the estimates of the means for the two sexes atop of the histogram.</span>
<span id="cb139-575"><a href="#cb139-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-578"><a href="#cb139-578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-579"><a href="#cb139-579" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb139-580"><a href="#cb139-580" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,</span>
<span id="cb139-581"><a href="#cb139-581" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span>minval, <span class="at">to=</span>maxval, <span class="at">length.out=</span><span class="dv">15</span>),</span>
<span id="cb139-582"><a href="#cb139-582" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(minval,maxval),</span>
<span id="cb139-583"><a href="#cb139-583" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">9</span>),</span>
<span id="cb139-584"><a href="#cb139-584" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Histogram and Sampling Distributions</span><span class="sc">\n</span><span class="st">for Body Weights</span><span class="sc">\n</span><span class="st">(red = females, blue = males)"</span>,</span>
<span id="cb139-585"><a href="#cb139-585" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>))</span>
<span id="cb139-586"><a href="#cb139-586" aria-hidden="true" tabindex="-1"></a><span class="co"># `xlim=` argument uses x and y ranges to set range for y axis</span></span>
<span id="cb139-587"><a href="#cb139-587" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span>minval, <span class="at">to=</span>maxval, <span class="at">length.out=</span><span class="dv">15</span>), <span class="at">xlim=</span><span class="fu">c</span>(minval,maxval),</span>
<span id="cb139-588"><a href="#cb139-588" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb139-589"><a href="#cb139-589" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,m1,s1<span class="sc">/</span><span class="fu">sqrt</span>(n1)), <span class="at">n=</span><span class="dv">1000</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb139-590"><a href="#cb139-590" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,m2,s2<span class="sc">/</span><span class="fu">sqrt</span>(n2)), <span class="at">n=</span><span class="dv">1000</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb139-591"><a href="#cb139-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-592"><a href="#cb139-592" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>m1<span class="sc">-</span><span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>df)<span class="sc">*</span>s1<span class="sc">/</span><span class="fu">sqrt</span>(n1))</span>
<span id="cb139-593"><a href="#cb139-593" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>m1<span class="sc">+</span><span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>df)<span class="sc">*</span>s1<span class="sc">/</span><span class="fu">sqrt</span>(n1))</span>
<span id="cb139-594"><a href="#cb139-594" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>m2<span class="sc">-</span><span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>df)<span class="sc">*</span>s2<span class="sc">/</span><span class="fu">sqrt</span>(n2))</span>
<span id="cb139-595"><a href="#cb139-595" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>m2<span class="sc">+</span><span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>df)<span class="sc">*</span>s2<span class="sc">/</span><span class="fu">sqrt</span>(n2))</span>
<span id="cb139-596"><a href="#cb139-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-597"><a href="#cb139-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-598"><a href="#cb139-598" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** The 95% CIs around each sample mean do not overlap, so the means are significantly different.</span></span>
<span id="cb139-599"><a href="#cb139-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-600"><a href="#cb139-600" aria-hidden="true" tabindex="-1"></a>We can do the same thing using the <span class="in">`t.test()`</span> function.</span>
<span id="cb139-601"><a href="#cb139-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-604"><a href="#cb139-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-605"><a href="#cb139-605" aria-hidden="true" tabindex="-1"></a>(<span class="fu">abs</span>(m1<span class="sc">-</span>m2)) <span class="co"># difference between means</span></span>
<span id="cb139-606"><a href="#cb139-606" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">mu=</span><span class="dv">0</span>, <span class="at">alternative=</span><span class="st">"two.sided"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb139-607"><a href="#cb139-607" aria-hidden="true" tabindex="-1"></a><span class="co"># var.equal = FALSE is the DEFAULT for `t.test()`</span></span>
<span id="cb139-608"><a href="#cb139-608" aria-hidden="true" tabindex="-1"></a>t_stat</span>
<span id="cb139-609"><a href="#cb139-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-610"><a href="#cb139-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-611"><a href="#cb139-611" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** The 95% CI returned by the t test is the interval around the DIFFERENCE between the means.</span></span>
<span id="cb139-612"><a href="#cb139-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-613"><a href="#cb139-613" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Samples with Equal Variances {.unnumbered}</span></span>
<span id="cb139-614"><a href="#cb139-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-615"><a href="#cb139-615" aria-hidden="true" tabindex="-1"></a>There's a simpler $T$ statistic we can use if the variances of the two samples are more or less equal.</span>
<span id="cb139-616"><a href="#cb139-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-617"><a href="#cb139-617" aria-hidden="true" tabindex="-1"></a>$$T=\frac{\bar{x_2}-\bar{x_1}-\mu}{\sqrt{s_p^2(1/n_1+1/n_2)}}$$</span>
<span id="cb139-618"><a href="#cb139-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-619"><a href="#cb139-619" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb139-620"><a href="#cb139-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-621"><a href="#cb139-621" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$s_p^2=\frac{(n_1-1)s_1^2+(n_2-1)s_2^2}{n_1+n_2-2}$</span>
<span id="cb139-622"><a href="#cb139-622" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\bar{x_1}$ and $\bar{x_2}$ = means of observations in each sample group</span>
<span id="cb139-623"><a href="#cb139-623" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mu$ = expected difference in means between sample groups (usually set to zero)</span>
<span id="cb139-624"><a href="#cb139-624" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$s_p$ = pooled sample standard deviation</span>
<span id="cb139-625"><a href="#cb139-625" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$n_1$ and $n_2$ = numbers of observations in each sample group</span>
<span id="cb139-626"><a href="#cb139-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-627"><a href="#cb139-627" aria-hidden="true" tabindex="-1"></a>The degrees of freedom for this test is calculated as follows:</span>
<span id="cb139-628"><a href="#cb139-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-629"><a href="#cb139-629" aria-hidden="true" tabindex="-1"></a>$$df=n_1+n_2-2$$</span>
<span id="cb139-630"><a href="#cb139-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-631"><a href="#cb139-631" aria-hidden="true" tabindex="-1"></a>Calculating the $t$ statistic and degrees of freedom by hand...</span>
<span id="cb139-632"><a href="#cb139-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-635"><a href="#cb139-635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-636"><a href="#cb139-636" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((((n1<span class="dv">-1</span>)<span class="sc">*</span>s1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span>((n2<span class="dv">-1</span>)<span class="sc">*</span>s2<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span> (n1<span class="sc">+</span>n2<span class="dv">-2</span>))</span>
<span id="cb139-637"><a href="#cb139-637" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> (m2 <span class="sc">-</span> m1 <span class="sc">-</span> mu)<span class="sc">/</span>(<span class="fu">sqrt</span>(s<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2)))</span>
<span id="cb139-638"><a href="#cb139-638" aria-hidden="true" tabindex="-1"></a>t_stat</span>
<span id="cb139-639"><a href="#cb139-639" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb139-640"><a href="#cb139-640" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb139-641"><a href="#cb139-641" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-642"><a href="#cb139-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-643"><a href="#cb139-643" aria-hidden="true" tabindex="-1"></a>... matches what we see when we use <span class="in">`t.test()`</span>.</span>
<span id="cb139-644"><a href="#cb139-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-647"><a href="#cb139-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-648"><a href="#cb139-648" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">mu=</span><span class="dv">0</span>, <span class="at">var.equal=</span><span class="cn">TRUE</span>, <span class="at">alternative=</span><span class="st">"two.sided"</span>)</span>
<span id="cb139-649"><a href="#cb139-649" aria-hidden="true" tabindex="-1"></a>t_stat</span>
<span id="cb139-650"><a href="#cb139-650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-651"><a href="#cb139-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-652"><a href="#cb139-652" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** A crude test for equality of variances is to divide the larger by the smaller and if the result is </span><span class="sc">\&lt;</span><span class="at"> 2, you can go ahead and used the pooled variance version of the test (which has many fewer degrees of freedom).</span></span>
<span id="cb139-653"><a href="#cb139-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-654"><a href="#cb139-654" aria-hidden="true" tabindex="-1"></a>In our case, we should not really use the equal variances version of the **t test**, since the ratio of variances exceeds 2...</span>
<span id="cb139-655"><a href="#cb139-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-658"><a href="#cb139-658" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-659"><a href="#cb139-659" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">var</span>(y)</span>
<span id="cb139-660"><a href="#cb139-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-661"><a href="#cb139-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-662"><a href="#cb139-662" aria-hidden="true" tabindex="-1"></a>We can use the <span class="in">`var.test()`</span> function to conduct an actual statistical test on the ratio of variances, which compares the ratio test statistic we just calculated to an $F$ **distribution**. The $F$ distribution is often used to model *ratios* of random variables and thus is useful in regression applications and, as here, for testing whether variances from two samples are different. It is dependent upon the specification of a pair of degrees of freedom values supplied as the arguments <span class="in">`df1=`</span> and <span class="in">`df2=`</span> (or inferred from the number of observations in each sample).</span>
<span id="cb139-663"><a href="#cb139-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-664"><a href="#cb139-664" aria-hidden="true" tabindex="-1"></a>Below, the results of <span class="in">`var.test()`</span> are saved to a variable. Calling the variable provides a brief descriptive summary.</span>
<span id="cb139-665"><a href="#cb139-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-668"><a href="#cb139-668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-669"><a href="#cb139-669" aria-hidden="true" tabindex="-1"></a>vt <span class="ot">&lt;-</span> <span class="fu">var.test</span>(x, y)</span>
<span id="cb139-670"><a href="#cb139-670" aria-hidden="true" tabindex="-1"></a>vt</span>
<span id="cb139-671"><a href="#cb139-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-672"><a href="#cb139-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-673"><a href="#cb139-673" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Paired Samples {.unnumbered}</span></span>
<span id="cb139-674"><a href="#cb139-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-675"><a href="#cb139-675" aria-hidden="true" tabindex="-1"></a>For a paired samples test, the null hypothesis is that the mean of individual paired differences between the two samples (e.g., before and after) is zero.</span>
<span id="cb139-676"><a href="#cb139-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-677"><a href="#cb139-677" aria-hidden="true" tabindex="-1"></a>Our test statistic is:</span>
<span id="cb139-678"><a href="#cb139-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-679"><a href="#cb139-679" aria-hidden="true" tabindex="-1"></a>$$T = \frac{d-\mu}{\sqrt{s_d^2/n}}$$</span>
<span id="cb139-680"><a href="#cb139-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-681"><a href="#cb139-681" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb139-682"><a href="#cb139-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-683"><a href="#cb139-683" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\bar{d}$ = mean of difference between paired samples</span>
<span id="cb139-684"><a href="#cb139-684" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mu$ = expected mean difference between paired samples (usually set to zero)</span>
<span id="cb139-685"><a href="#cb139-685" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$s_d$ = standard deviation in the set of differences between paired samples</span>
<span id="cb139-686"><a href="#cb139-686" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$n$ = number of sample **pairs**</span>
<span id="cb139-687"><a href="#cb139-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-688"><a href="#cb139-688" aria-hidden="true" tabindex="-1"></a>Again, note that $\mu$ here is the expected **difference** between the means under the null hypothesis, which is zero, and we are dividing by the standard error of the mean for the set of differences between pairs.</span>
<span id="cb139-689"><a href="#cb139-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-690"><a href="#cb139-690" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb139-691"><a href="#cb139-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-692"><a href="#cb139-692" aria-hidden="true" tabindex="-1"></a>Let's play with a sample... test scores of individuals taking a certain statistics course pre and post a lecture on null hypothesis significance testing. Load in the <span class="in">`test_scores.csv`</span> data file, look at it, plot a barchart of values before and after and construct a paired t test to evaluate the means before and after.</span>
<span id="cb139-693"><a href="#cb139-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-696"><a href="#cb139-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-697"><a href="#cb139-697" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb139-698"><a href="#cb139-698" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/test_scores.csv"</span></span>
<span id="cb139-699"><a href="#cb139-699" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb139-700"><a href="#cb139-700" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb139-701"><a href="#cb139-701" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d<span class="sc">$</span><span class="st">`</span><span class="at">Score after</span><span class="st">`</span><span class="sc">-</span>d<span class="sc">$</span><span class="st">`</span><span class="at">Score before</span><span class="st">`</span></span>
<span id="cb139-702"><a href="#cb139-702" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb139-703"><a href="#cb139-703" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># can leave this out</span></span>
<span id="cb139-704"><a href="#cb139-704" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb139-705"><a href="#cb139-705" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb139-706"><a href="#cb139-706" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> s<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb139-707"><a href="#cb139-707" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb139-708"><a href="#cb139-708" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span><span class="st">`</span><span class="at">Score before</span><span class="st">`</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">100</span>), <span class="at">main=</span><span class="st">"Score"</span>,<span class="at">xlab=</span><span class="st">"Before"</span>)</span>
<span id="cb139-709"><a href="#cb139-709" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span><span class="st">`</span><span class="at">Score after</span><span class="st">`</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">100</span>), <span class="at">main=</span><span class="st">"Score"</span>,<span class="at">xlab=</span><span class="st">"After"</span>)</span>
<span id="cb139-710"><a href="#cb139-710" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> (m <span class="sc">-</span> mu)<span class="sc">/</span>se</span>
<span id="cb139-711"><a href="#cb139-711" aria-hidden="true" tabindex="-1"></a>t_stat</span>
<span id="cb139-712"><a href="#cb139-712" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb139-713"><a href="#cb139-713" aria-hidden="true" tabindex="-1"></a>critical_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>n<span class="dv">-1</span>) <span class="co"># identify critical values</span></span>
<span id="cb139-714"><a href="#cb139-714" aria-hidden="true" tabindex="-1"></a>critical_val</span>
<span id="cb139-715"><a href="#cb139-715" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">abs</span>(t_stat) <span class="sc">&gt;</span> critical_val <span class="co"># boolean test</span></span>
<span id="cb139-716"><a href="#cb139-716" aria-hidden="true" tabindex="-1"></a>test</span>
<span id="cb139-717"><a href="#cb139-717" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(d<span class="sc">$</span><span class="st">`</span><span class="at">Score before</span><span class="st">`</span>,d<span class="sc">$</span><span class="st">`</span><span class="at">Score after</span><span class="st">`</span>,<span class="at">df=</span>n<span class="dv">-1</span>, <span class="at">alternative=</span><span class="st">"two.sided"</span>, <span class="at">paired=</span><span class="cn">TRUE</span>)</span>
<span id="cb139-718"><a href="#cb139-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-719"><a href="#cb139-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-720"><a href="#cb139-720" aria-hidden="true" tabindex="-1"></a><span class="fu">### Working with Proportions {.unnumbered}</span></span>
<span id="cb139-721"><a href="#cb139-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-722"><a href="#cb139-722" aria-hidden="true" tabindex="-1"></a><span class="fu">#### One Sample $Z$ Test {.unnumbered}</span></span>
<span id="cb139-723"><a href="#cb139-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-724"><a href="#cb139-724" aria-hidden="true" tabindex="-1"></a>As we have seen, the theoretical sampling distribution of sample means for independent and identically distributed random continuous variables is roughly normal (and, as shown by the CLT, this distribution increasingly approaches normal as sample size increases). Similarly, the sampling distribution for another kind of sample statistic, the number of "successes" $x$ out of a series of $k$ trials is also roughly normally distributed. If the true population proportion of "successes" is $\pi$, then the sampling distribution for the proportion of successes in a sample of size $n$ is expected to be roughly normally distributed with mean = $\pi$ and standard error = $\sqrt{\pi(1-\pi)/n}$.</span>
<span id="cb139-725"><a href="#cb139-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-726"><a href="#cb139-726" aria-hidden="true" tabindex="-1"></a>Let's set up a simulation to show this...</span>
<span id="cb139-727"><a href="#cb139-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-728"><a href="#cb139-728" aria-hidden="true" tabindex="-1"></a>First we create a population of 500 "1"s and 500 "0"s, i.e., where $\pi$ = 0.5...</span>
<span id="cb139-729"><a href="#cb139-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-732"><a href="#cb139-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-733"><a href="#cb139-733" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">500</span>),<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">500</span>))</span>
<span id="cb139-734"><a href="#cb139-734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-735"><a href="#cb139-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-736"><a href="#cb139-736" aria-hidden="true" tabindex="-1"></a>Now, we will take 1000 random samples of size $n$=10 from that population and calculate the proportion of "1"s in each sample...</span>
<span id="cb139-737"><a href="#cb139-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-740"><a href="#cb139-740" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-741"><a href="#cb139-741" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb139-742"><a href="#cb139-742" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb139-743"><a href="#cb139-743" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb139-744"><a href="#cb139-744" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb139-745"><a href="#cb139-745" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(pop,<span class="at">size=</span>n,<span class="at">replace=</span><span class="cn">FALSE</span>))</span>
<span id="cb139-746"><a href="#cb139-746" aria-hidden="true" tabindex="-1"></a>  <span class="co"># taking the mean of a bunch of 0s and 1s yields the proportion of 1s!</span></span>
<span id="cb139-747"><a href="#cb139-747" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-748"><a href="#cb139-748" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb139-749"><a href="#cb139-749" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb139-750"><a href="#cb139-750" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb139-751"><a href="#cb139-751" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb139-752"><a href="#cb139-752" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pi)<span class="sc">/</span>n) </span>
<span id="cb139-753"><a href="#cb139-753" aria-hidden="true" tabindex="-1"></a>se <span class="co"># the SE is an estimate of the SD of the sampling distribution</span></span>
<span id="cb139-754"><a href="#cb139-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-755"><a href="#cb139-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-756"><a href="#cb139-756" aria-hidden="true" tabindex="-1"></a>The same is true if we create a population of 800 "1"s and 200 "0"s, i.e., where $\pi$ = 0.8...</span>
<span id="cb139-757"><a href="#cb139-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-760"><a href="#cb139-760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-761"><a href="#cb139-761" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">800</span>),<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">200</span>))</span>
<span id="cb139-762"><a href="#cb139-762" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb139-763"><a href="#cb139-763" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb139-764"><a href="#cb139-764" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb139-765"><a href="#cb139-765" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb139-766"><a href="#cb139-766" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(pop,<span class="at">size=</span>n,<span class="at">replace=</span><span class="cn">FALSE</span>))</span>
<span id="cb139-767"><a href="#cb139-767" aria-hidden="true" tabindex="-1"></a>  <span class="co"># taking the mean of a bunch of 0s and 1s yields the proportion of 1s!</span></span>
<span id="cb139-768"><a href="#cb139-768" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-769"><a href="#cb139-769" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb139-770"><a href="#cb139-770" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb139-771"><a href="#cb139-771" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb139-772"><a href="#cb139-772" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb139-773"><a href="#cb139-773" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pi)<span class="sc">/</span>n) </span>
<span id="cb139-774"><a href="#cb139-774" aria-hidden="true" tabindex="-1"></a>se <span class="co"># the SE is an estimate of the SD of the sampling distribution</span></span>
<span id="cb139-775"><a href="#cb139-775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-776"><a href="#cb139-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-777"><a href="#cb139-777" aria-hidden="true" tabindex="-1"></a>This normal approximation is true as long as $n$ is fairly large and $\pi$ is not close to 0 or 1. One rule of thumb is to check that both $n\times\pi$ and $n\times(1-\pi)$ are greater than 5.</span>
<span id="cb139-778"><a href="#cb139-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-779"><a href="#cb139-779" aria-hidden="true" tabindex="-1"></a>With all this in mind, we can construct $Z$ statistics for proportions just like we constructed $Z$ and $T$ statistics for means and test those proportions for differences from an expected value or for differences between two sample proportions. The $Z$ statistic for proportions takes the same general form as that for means...</span>
<span id="cb139-780"><a href="#cb139-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-781"><a href="#cb139-781" aria-hidden="true" tabindex="-1"></a>$Z =$ (observed statistic - expected statistic) / expected standard error</span>
<span id="cb139-782"><a href="#cb139-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-783"><a href="#cb139-783" aria-hidden="true" tabindex="-1"></a>or,</span>
<span id="cb139-784"><a href="#cb139-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-785"><a href="#cb139-785" aria-hidden="true" tabindex="-1"></a>$$Z = \frac{\hat{p}-\pi}{\sqrt{\pi(1-\pi)/n}}$$</span>
<span id="cb139-786"><a href="#cb139-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-787"><a href="#cb139-787" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb139-788"><a href="#cb139-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-789"><a href="#cb139-789" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\hat{p}$ = proportion in sample</span>
<span id="cb139-790"><a href="#cb139-790" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\pi$ = expected proportion</span>
<span id="cb139-791"><a href="#cb139-791" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$n$ = number of observations in sample</span>
<span id="cb139-792"><a href="#cb139-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-793"><a href="#cb139-793" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb139-794"><a href="#cb139-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-795"><a href="#cb139-795" aria-hidden="true" tabindex="-1"></a>A neotropical ornithological working in the western Amazon deploys 30 mist nets in a 100 ha grid.</span>
<span id="cb139-796"><a href="#cb139-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-799"><a href="#cb139-799" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-800"><a href="#cb139-800" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb139-801"><a href="#cb139-801" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb139-802"><a href="#cb139-802" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/birdnet.jpg"</span>)</span>
<span id="cb139-803"><a href="#cb139-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-804"><a href="#cb139-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-805"><a href="#cb139-805" aria-hidden="true" tabindex="-1"></a>She monitors the nets on one morning and records whether or not she captures any birds in the net (i.e., a "success" or "failure" for every net during a netting session). The following vector summarizes her netting results:</span>
<span id="cb139-806"><a href="#cb139-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-809"><a href="#cb139-809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-810"><a href="#cb139-810" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb139-811"><a href="#cb139-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-812"><a href="#cb139-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-813"><a href="#cb139-813" aria-hidden="true" tabindex="-1"></a>Her netting success over the previous three seasons suggests that she should catch birds in 80% of her nets. This season, she feels, her success rate is lower than in previous years (so... this implies that we want to do a lower one-tailed test). Does her trapping data support this hypothesis?</span>
<span id="cb139-814"><a href="#cb139-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-815"><a href="#cb139-815" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is $H_0$?</span>
<span id="cb139-816"><a href="#cb139-816" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is $H_A$?</span>
<span id="cb139-817"><a href="#cb139-817" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Are both $n\times\pi$ and $n\times(1-\pi)$ <span class="sc">\&gt;</span> 5?</span>
<span id="cb139-818"><a href="#cb139-818" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate $Z$ statistic and the p value associated with $Z$. We use the <span class="in">`lower.tail=TRUE`</span> argument to <span class="in">`pnorm()`</span> because we're testing a lower-tailed one-tailed hypothesis.</span>
<span id="cb139-819"><a href="#cb139-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-822"><a href="#cb139-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-823"><a href="#cb139-823" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb139-824"><a href="#cb139-824" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb139-825"><a href="#cb139-825" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb139-826"><a href="#cb139-826" aria-hidden="true" tabindex="-1"></a>phat <span class="ot">&lt;-</span> <span class="fu">mean</span>(v) <span class="co"># the mean of binomial 0,1 variables yields the proportion!</span></span>
<span id="cb139-827"><a href="#cb139-827" aria-hidden="true" tabindex="-1"></a>phat</span>
<span id="cb139-828"><a href="#cb139-828" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fl">0.80</span></span>
<span id="cb139-829"><a href="#cb139-829" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb139-830"><a href="#cb139-830" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (phat <span class="sc">-</span> pi)<span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pi)<span class="sc">/</span><span class="dv">30</span>)</span>
<span id="cb139-831"><a href="#cb139-831" aria-hidden="true" tabindex="-1"></a><span class="co"># we use the population expected proportion in the denominator</span></span>
<span id="cb139-832"><a href="#cb139-832" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb139-833"><a href="#cb139-833" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail=</span><span class="cn">TRUE</span>)</span>
<span id="cb139-834"><a href="#cb139-834" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb139-835"><a href="#cb139-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-836"><a href="#cb139-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-837"><a href="#cb139-837" aria-hidden="true" tabindex="-1"></a>Graphically, our $Z$ value (in blue) is farther from the center of the standard normal curve than the critical value marking the lower 5% of the total distribution (in red).</span>
<span id="cb139-838"><a href="#cb139-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-841"><a href="#cb139-841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-842"><a href="#cb139-842" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb139-843"><a href="#cb139-843" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>), <span class="at">ylab=</span><span class="st">""</span>,<span class="at">yaxt=</span><span class="st">"n"</span>,<span class="at">xlab=</span><span class="st">"SD"</span>,</span>
<span id="cb139-844"><a href="#cb139-844" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Sampling Distribution"</span>)</span>
<span id="cb139-845"><a href="#cb139-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-846"><a href="#cb139-846" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>z, <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb139-847"><a href="#cb139-847" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">qnorm</span>(<span class="fl">0.05</span>), <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb139-848"><a href="#cb139-848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-849"><a href="#cb139-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-850"><a href="#cb139-850" aria-hidden="true" tabindex="-1"></a>The 95% confidence interval around the sample proportion can be estimated, based on the normal distribution, as follows:</span>
<span id="cb139-851"><a href="#cb139-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-854"><a href="#cb139-854" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-855"><a href="#cb139-855" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> phat <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sqrt</span>(phat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>phat)<span class="sc">/</span><span class="dv">30</span>)</span>
<span id="cb139-856"><a href="#cb139-856" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> phat <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sqrt</span>(phat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>phat)<span class="sc">/</span><span class="dv">30</span>)</span>
<span id="cb139-857"><a href="#cb139-857" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">c</span>(lower, upper)</span>
<span id="cb139-858"><a href="#cb139-858" aria-hidden="true" tabindex="-1"></a>ci</span>
<span id="cb139-859"><a href="#cb139-859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-860"><a href="#cb139-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-861"><a href="#cb139-861" aria-hidden="true" tabindex="-1"></a>This approach using quantiles of the standard normal distribution is but one method of calculating CIs for proportion data, and it generates a CI referred to as a *Wald confidence interval*. Note that this CI does not include the value of $\pi$... rather, $\pi$ is greater than the upper bound of the CI, suggesting that the observed success rate is indeed lower than in previous years.</span>
<span id="cb139-862"><a href="#cb139-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-863"><a href="#cb139-863" aria-hidden="true" tabindex="-1"></a>We can do the same test with a one-liner in ***R***...</span>
<span id="cb139-864"><a href="#cb139-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-867"><a href="#cb139-867" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-868"><a href="#cb139-868" aria-hidden="true" tabindex="-1"></a>pt <span class="ot">&lt;-</span></span>
<span id="cb139-869"><a href="#cb139-869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prop.test</span>(</span>
<span id="cb139-870"><a href="#cb139-870" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">sum</span>(v),</span>
<span id="cb139-871"><a href="#cb139-871" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">length</span>(v),</span>
<span id="cb139-872"><a href="#cb139-872" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="fl">0.8</span>,</span>
<span id="cb139-873"><a href="#cb139-873" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb139-874"><a href="#cb139-874" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">"less"</span>,</span>
<span id="cb139-875"><a href="#cb139-875" aria-hidden="true" tabindex="-1"></a>    <span class="at">correct =</span> <span class="cn">FALSE</span></span>
<span id="cb139-876"><a href="#cb139-876" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># use correct=FALSE if we satisfy that n*pi and n*(1-pi) are both &gt;5</span></span>
<span id="cb139-877"><a href="#cb139-877" aria-hidden="true" tabindex="-1"></a>pt</span>
<span id="cb139-878"><a href="#cb139-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-879"><a href="#cb139-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-880"><a href="#cb139-880" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** The CI returned here is different than we calculated based on the normal distribution, although the p value is the same... </span><span class="in">`prop.test()`</span><span class="at"> implements a slightly different procedure for estimating the CI rather than basing this on the normal distribution and the CLT.</span></span>
<span id="cb139-881"><a href="#cb139-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-882"><a href="#cb139-882" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Two Sample $Z$ Test {.unnumbered}</span></span>
<span id="cb139-883"><a href="#cb139-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-884"><a href="#cb139-884" aria-hidden="true" tabindex="-1"></a>The $Z$ statistic for the two-sample test comparing proportions is also very similar to that for comparing means.</span>
<span id="cb139-885"><a href="#cb139-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-886"><a href="#cb139-886" aria-hidden="true" tabindex="-1"></a>$$Z=\frac{\hat{p_2}-\hat{p_1}-\pi}{\sqrt{p^*(1-p^*)(1/n_1+1/n_2)}}$$</span>
<span id="cb139-887"><a href="#cb139-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-888"><a href="#cb139-888" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb139-889"><a href="#cb139-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-890"><a href="#cb139-890" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$p^* = \frac{x_1 + x_2}{n_1+n_2}$ = pooled proportion</span>
<span id="cb139-891"><a href="#cb139-891" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\hat{p_1}$ and $\hat{p_2}$ = proportions of "successes" in each sample group</span>
<span id="cb139-892"><a href="#cb139-892" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\pi$ = expected difference in proportions between sample groups (usually set to zero)</span>
<span id="cb139-893"><a href="#cb139-893" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$n_1$ and $n_2$ = numbers of observations in each sample group</span>
<span id="cb139-894"><a href="#cb139-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-895"><a href="#cb139-895" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb139-896"><a href="#cb139-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-897"><a href="#cb139-897" aria-hidden="true" tabindex="-1"></a>A biologist studying two species of tropical bats captures females of both species in a mist net over the course of a week of nightly netting. For each species, the researcher records whether females is lactating or not.</span>
<span id="cb139-898"><a href="#cb139-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-901"><a href="#cb139-901" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-902"><a href="#cb139-902" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb139-903"><a href="#cb139-903" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb139-904"><a href="#cb139-904" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/batnet.jpg"</span>)</span>
<span id="cb139-905"><a href="#cb139-905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-906"><a href="#cb139-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-907"><a href="#cb139-907" aria-hidden="true" tabindex="-1"></a>The two vectors below summarize the data for each species.</span>
<span id="cb139-908"><a href="#cb139-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-911"><a href="#cb139-911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-912"><a href="#cb139-912" aria-hidden="true" tabindex="-1"></a>species1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb139-913"><a href="#cb139-913" aria-hidden="true" tabindex="-1"></a>species2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb139-914"><a href="#cb139-914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-915"><a href="#cb139-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-916"><a href="#cb139-916" aria-hidden="true" tabindex="-1"></a>Based on your mist netting data, do the species differ significantly in the proportion of lactating females? What are $H_0$ and $H_A$?</span>
<span id="cb139-917"><a href="#cb139-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-920"><a href="#cb139-920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-921"><a href="#cb139-921" aria-hidden="true" tabindex="-1"></a>pstar <span class="ot">&lt;-</span> (<span class="fu">sum</span>(species1) <span class="sc">+</span> <span class="fu">sum</span>(species2))<span class="sc">/</span>(<span class="fu">length</span>(species1)<span class="sc">+</span><span class="fu">length</span>(species2))</span>
<span id="cb139-922"><a href="#cb139-922" aria-hidden="true" tabindex="-1"></a>pstar</span>
<span id="cb139-923"><a href="#cb139-923" aria-hidden="true" tabindex="-1"></a>phat1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(species1)</span>
<span id="cb139-924"><a href="#cb139-924" aria-hidden="true" tabindex="-1"></a>phat1</span>
<span id="cb139-925"><a href="#cb139-925" aria-hidden="true" tabindex="-1"></a>phat2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(species2)</span>
<span id="cb139-926"><a href="#cb139-926" aria-hidden="true" tabindex="-1"></a>phat2</span>
<span id="cb139-927"><a href="#cb139-927" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb139-928"><a href="#cb139-928" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (phat2<span class="sc">-</span>phat1<span class="sc">-</span>pi)<span class="sc">/</span><span class="fu">sqrt</span>((pstar<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pstar))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(species1)<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(species2)))</span>
<span id="cb139-929"><a href="#cb139-929" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb139-930"><a href="#cb139-930" aria-hidden="true" tabindex="-1"></a>p_upper <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(z, <span class="at">lower.tail=</span><span class="cn">TRUE</span>) </span>
<span id="cb139-931"><a href="#cb139-931" aria-hidden="true" tabindex="-1"></a>p_lower <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb139-932"><a href="#cb139-932" aria-hidden="true" tabindex="-1"></a><span class="co"># two-tailed probability, so we add the upper and lower tails</span></span>
<span id="cb139-933"><a href="#cb139-933" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p_upper <span class="sc">+</span> p_lower</span>
<span id="cb139-934"><a href="#cb139-934" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb139-935"><a href="#cb139-935" aria-hidden="true" tabindex="-1"></a>critical_val <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="co"># identify critical values</span></span>
<span id="cb139-936"><a href="#cb139-936" aria-hidden="true" tabindex="-1"></a>critical_val</span>
<span id="cb139-937"><a href="#cb139-937" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">abs</span>(z) <span class="sc">&gt;</span> critical_val <span class="co"># boolean test</span></span>
<span id="cb139-938"><a href="#cb139-938" aria-hidden="true" tabindex="-1"></a>test</span>
<span id="cb139-939"><a href="#cb139-939" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-940"><a href="#cb139-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-941"><a href="#cb139-941" aria-hidden="true" tabindex="-1"></a>We can use the <span class="in">`prop.test()`</span> function to do this in one line.</span>
<span id="cb139-942"><a href="#cb139-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-945"><a href="#cb139-945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-946"><a href="#cb139-946" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fu">sum</span>(species2),<span class="fu">sum</span>(species1)),<span class="at">n=</span><span class="fu">c</span>(<span class="fu">length</span>(species2),<span class="fu">length</span>(species1)),</span>
<span id="cb139-947"><a href="#cb139-947" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative=</span><span class="st">"two.sided"</span>, <span class="at">correct=</span><span class="cn">FALSE</span>)</span>
<span id="cb139-948"><a href="#cb139-948" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use correct=FALSE if we satisfy that n*pi and n*(1-pi) are both &gt;5</span></span>
<span id="cb139-949"><a href="#cb139-949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-950"><a href="#cb139-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-951"><a href="#cb139-951" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb139-952"><a href="#cb139-952" aria-hidden="true" tabindex="-1"></a><span class="in">detach(package:mosaic)</span></span>
<span id="cb139-953"><a href="#cb139-953" aria-hidden="true" tabindex="-1"></a><span class="in">detach(package:tidyverse)</span></span>
<span id="cb139-954"><a href="#cb139-954" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-955"><a href="#cb139-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-956"><a href="#cb139-956" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-957"><a href="#cb139-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-958"><a href="#cb139-958" aria-hidden="true" tabindex="-1"></a><span class="fu">## Concept Review {.unnumbered}</span></span>
<span id="cb139-959"><a href="#cb139-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-960"><a href="#cb139-960" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$Z$ and $T$ tests are used to evaluate whether a given sample statistic (e.g., a mean or proportion) deviates significantly from what is expected under a null model or whether two samples statistics deviate significantly from one another</span>
<span id="cb139-961"><a href="#cb139-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-962"><a href="#cb139-962" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>They are used for dealing with normally distributed, continuous variables or those that can be approximated closely by the normal distribution (e.g., proportion data)</span>
<span id="cb139-963"><a href="#cb139-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-964"><a href="#cb139-964" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>We REJECT a $H_0$ if the p value obtained for a given $Z$ or $T$ test statistic is <span class="sc">\&lt;</span> $\alpha$</span>
<span id="cb139-965"><a href="#cb139-965" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>CIs for our sample statistic are calculated as $mean ± <span class="co">[</span><span class="ot">T_{(1-\alpha/2)}$ or $Z_{(1-\alpha/2)}</span><span class="co">]</span> \times SE$, and we can REJECT an $H_0$ if the $(1-\alpha)$ CI around does not include the expected value of the statistic</span>
<span id="cb139-966"><a href="#cb139-966" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>When we are dealing with data for a population or for sample sizes <span class="sc">\&gt;</span> 30, or when we are dealing with proportions, we use $Z$ distribution quantiles for calculating CIs and p values, but for sample sizes <span class="sc">\&lt;</span> 30, we use $t$ distribution quantiles</span>
<span id="cb139-967"><a href="#cb139-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-968"><a href="#cb139-968" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Formula Summary {.unnumbered}</span></span>
<span id="cb139-969"><a href="#cb139-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-970"><a href="#cb139-970" aria-hidden="true" tabindex="-1"></a><span class="fu">##### The $Z$ or $T$ Statistic for Testing a Single Mean {.unnumbered}</span></span>
<span id="cb139-971"><a href="#cb139-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-972"><a href="#cb139-972" aria-hidden="true" tabindex="-1"></a>$$Z\ {\rm or}\ T = \frac{\bar{x}-\mu}{s/\sqrt{n}}$$</span>
<span id="cb139-973"><a href="#cb139-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-974"><a href="#cb139-974" aria-hidden="true" tabindex="-1"></a><span class="fu">##### The $T$ Statistic for Comparing Means {.unnumbered}</span></span>
<span id="cb139-975"><a href="#cb139-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-976"><a href="#cb139-976" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Unequal Variance {.unnumbered}</span></span>
<span id="cb139-977"><a href="#cb139-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-978"><a href="#cb139-978" aria-hidden="true" tabindex="-1"></a>$$Z\ {\rm or}\ T = \frac{\bar{x_2} - \bar{x_1} - \mu}{\sqrt{s_1^2/n_1 + s_2^2/n_2}}$$</span>
<span id="cb139-979"><a href="#cb139-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-980"><a href="#cb139-980" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Equal Variance {.unnumbered}</span></span>
<span id="cb139-981"><a href="#cb139-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-982"><a href="#cb139-982" aria-hidden="true" tabindex="-1"></a>$$Z\ {\rm or}\ T =\frac{\bar{x_2}-\bar{x_1}-\mu}{\sqrt{s_p^2(1/n_1+1/n_2)}}$$</span>
<span id="cb139-983"><a href="#cb139-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-984"><a href="#cb139-984" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Paired Samples {.unnumbered}</span></span>
<span id="cb139-985"><a href="#cb139-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-986"><a href="#cb139-986" aria-hidden="true" tabindex="-1"></a>$$Z\ {\rm or}\ T = \frac{d-\mu}{\sqrt{s_d^2/n}}$$</span>
<span id="cb139-987"><a href="#cb139-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-988"><a href="#cb139-988" aria-hidden="true" tabindex="-1"></a><span class="fu">##### The $Z$ Statistic for Testing a Single Proportion {.unnumbered}</span></span>
<span id="cb139-989"><a href="#cb139-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-990"><a href="#cb139-990" aria-hidden="true" tabindex="-1"></a>$$Z = \frac{\hat{p}-\pi}{\sqrt{\pi(1-\pi)/n}}$$</span>
<span id="cb139-991"><a href="#cb139-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-992"><a href="#cb139-992" aria-hidden="true" tabindex="-1"></a><span class="fu">##### The $Z$ Statistic for Comparing Proportions {.unnumbered}</span></span>
<span id="cb139-993"><a href="#cb139-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-994"><a href="#cb139-994" aria-hidden="true" tabindex="-1"></a>$$Z = \frac{\hat{p_2}-\hat{p_1}-\pi}{\sqrt{p^*(1-p^*)(1/n_1+1/n_2)}}$$</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>