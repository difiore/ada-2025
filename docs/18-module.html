<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>18&nbsp; Introduction to Linear Modeling – Applied Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./19-module.html" rel="next">
<link href="./17-module.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./18-module.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-logistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Logistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course-schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-typography-and-formatting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Typography and Formatting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-programming-style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming Style Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>RStudio</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extending the Functionality of <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamentals of the <strong><em>R</em></strong> Language</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basics of Version Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Additional Data Structures in <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting Data into <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Functions and Flow Control</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II - Statistics and Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Descriptive Statisics and Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Using Permutation Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-module.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Elements of Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06 Solution</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-analysis-replication-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis Replication</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Packages Used</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives"><span class="header-section-number">18.1</span> Objectives</a></li>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link" data-scroll-target="#preliminaries"><span class="header-section-number">18.2</span> Preliminaries</a></li>
  <li><a href="#covariance-and-correlation" id="toc-covariance-and-correlation" class="nav-link" data-scroll-target="#covariance-and-correlation"><span class="header-section-number">18.3</span> Covariance and Correlation</a>
  <ul class="collapse">
  <li><a href="#challenge" id="toc-challenge" class="nav-link" data-scroll-target="#challenge">CHALLENGE</a></li>
  <li><a href="#challenge-1" id="toc-challenge-1" class="nav-link" data-scroll-target="#challenge-1">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression"><span class="header-section-number">18.4</span> Regression</a>
  <ul class="collapse">
  <li><a href="#ordinary-least-squares-ols" id="toc-ordinary-least-squares-ols" class="nav-link" data-scroll-target="#ordinary-least-squares-ols"><span class="header-section-number">18.4.1</span> Ordinary Least Squares (OLS)</a></li>
  <li><a href="#challenge-2" id="toc-challenge-2" class="nav-link" data-scroll-target="#challenge-2">CHALLENGE</a></li>
  <li><a href="#challenge-3" id="toc-challenge-3" class="nav-link" data-scroll-target="#challenge-3">CHALLENGE</a></li>
  <li><a href="#the-lm-function" id="toc-the-lm-function" class="nav-link" data-scroll-target="#the-lm-function"><span class="header-section-number">18.4.2</span> The <code>lm()</code> Function</a></li>
  <li><a href="#alternatives-to-ols" id="toc-alternatives-to-ols" class="nav-link" data-scroll-target="#alternatives-to-ols"><span class="header-section-number">18.4.3</span> Alternatives to OLS</a></li>
  <li><a href="#challenge-4" id="toc-challenge-4" class="nav-link" data-scroll-target="#challenge-4">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#inference-in-regression" id="toc-inference-in-regression" class="nav-link" data-scroll-target="#inference-in-regression"><span class="header-section-number">18.5</span> Inference in Regression</a>
  <ul class="collapse">
  <li><a href="#classical-theory-based-inference" id="toc-classical-theory-based-inference" class="nav-link" data-scroll-target="#classical-theory-based-inference">Classical Theory-Based Inference</a></li>
  <li><a href="#simulation-based-inference" id="toc-simulation-based-inference" class="nav-link" data-scroll-target="#simulation-based-inference">Simulation-Based Inference</a></li>
  </ul></li>
  <li><a href="#interpreting-regression-results" id="toc-interpreting-regression-results" class="nav-link" data-scroll-target="#interpreting-regression-results"><span class="header-section-number">18.6</span> Interpreting Regression Results</a>
  <ul class="collapse">
  <li><a href="#challenge-5" id="toc-challenge-5" class="nav-link" data-scroll-target="#challenge-5">CHALLENGE</a></li>
  <li><a href="#predicted-values" id="toc-predicted-values" class="nav-link" data-scroll-target="#predicted-values">Predicted Values</a></li>
  <li><a href="#confidence-intervals-around-predicted-means" id="toc-confidence-intervals-around-predicted-means" class="nav-link" data-scroll-target="#confidence-intervals-around-predicted-means">Confidence Intervals around Predicted Means</a></li>
  <li><a href="#prediction-intervals-for-individual-responses" id="toc-prediction-intervals-for-individual-responses" class="nav-link" data-scroll-target="#prediction-intervals-for-individual-responses">Prediction Intervals for Individual Responses</a></li>
  <li><a href="#challenge-6" id="toc-challenge-6" class="nav-link" data-scroll-target="#challenge-6">CHALLENGE</a></li>
  <li><a href="#challenge-7" id="toc-challenge-7" class="nav-link" data-scroll-target="#challenge-7">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals"><span class="header-section-number">18.7</span> Residuals</a></li>
  <li><a href="#concept-review" id="toc-concept-review" class="nav-link" data-scroll-target="#concept-review">Concept Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./18-module.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="module-18" class="quarto-section-identifier"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="objectives" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="objectives"><span class="header-section-number">18.1</span> Objectives</h2>
<blockquote class="blockquote">
<p>The objective of this module is to discuss the use of simple linear regression to explore the relationship among two continuous variables: a single predictor variable and a single response variable.</p>
</blockquote>
</section>
<section id="preliminaries" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="preliminaries"><span class="header-section-number">18.2</span> Preliminaries</h2>
<ul>
<li>Install the following package in <strong><em>R</em></strong>: <a href="https://cran.r-project.org/web/packages/lmodel2/lmodel2.pdf">{lmodel2}</a></li>
<li>Install and load the following package in <strong><em>R</em></strong>: <a href="https://cran.r-project.org/web/packages/broom/broom.pdf">{broom}</a></li>
<li>Load {tidyverse}, {manipulate}, {patchwork}, and {infer}</li>
</ul>
</section>
<section id="covariance-and-correlation" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="covariance-and-correlation"><span class="header-section-number">18.3</span> Covariance and Correlation</h2>
<p>So far, we have looked principally at single variables, but one of the main things we are often interested in is the relationships among two or more variables. <strong>Regression modeling</strong> is one of the most powerful and important set of tools for looking at relationships among more than one variable. With our zombie apocalypse survivors dataset, we started to do this using simple bivariate scatterplots… let’s look at those data again and do a simple bivariate plot of height by weight.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 10
##      id first_name last_name gender height weight zombies_killed
##   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;
## 1     1 Sarah      Little    Female   62.9   132.              2
## 2     2 Mark       Duncan    Male     67.8   146.              5
## 3     3 Brandon    Perez     Male     72.1   153.              1
## 4     4 Roger      Coleman   Male     66.8   130.              5
## 5     5 Tammy      Powell    Female   64.7   132.              4
## 6     6 Anthony    Green     Male     71.2   153.              1
## # ℹ 3 more variables: years_of_education &lt;dbl&gt;, major &lt;chr&gt;, age &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These variables clearly seem to be related to one another, in that as weight increases, height increases. There are a couple of different ways we can quantify the relationship between these variables. One is by calculating the <strong>covariance</strong>, which expresses how much two numeric variables “change together” and whether that change is positive or negative.</p>
<p>Recall that the variance in a variable is simply the sum of the squared deviatiations of each observation from the mean divided by sample size (<strong>n</strong> for population variance or <strong>n-1</strong> for sample variance). Thus, sample variance is:</p>
<p><span class="math display">\[var(x)=\sum\frac{(x-\bar{x})^2}{(n-1)}\]</span></p>
<p>Similarly, the <strong>covariance</strong> is simply the product of the deviations of each of two variables from their respective means divided by sample size. Thus, for two vectors, <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, each of length <span class="math inline">\(n\)</span>, representing two variables describing a sample…</p>
<p><span class="math display">\[cov(x,y) = \sum\frac{(x-\bar{x})(y-\bar{y})}{(n-1)}\]</span></p>
<section id="challenge" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge">CHALLENGE</h3>
<p>What is the covariance between zombie apocalypse survivor weight and zombie apocalypse survivor height? What does it mean if the covariance is positive versus negative? Does it matter if you switch the order of the two variables?</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> d<span class="sc">$</span>weight</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> d<span class="sc">$</span>height</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(w)  <span class="co"># or length(h)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>cov_wh <span class="ot">&lt;-</span> <span class="fu">sum</span>((w <span class="sc">-</span> <span class="fu">mean</span>(w)) <span class="sc">*</span> (h <span class="sc">-</span> <span class="fu">mean</span>(h)))<span class="sc">/</span>(n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>cov_wh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 66.03314</code></pre>
</details>
</div>
</div>
<p>The built-in <strong><em>R</em></strong> function <code>cov()</code> yields the same.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(w, h)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 66.03314</code></pre>
</div>
</div>
<p>We often describe the relationship between two variables using the <strong>correlation</strong> coefficient, which is a <em>standardized</em> form of the covariance that summarizes, on a scale from -1 to +1, both the strength and direction of a relationship. The correlation is simply the covariance divided by the product of the standard deviations of the two variables.</p>
<p><span class="math display">\[cor(x,y)=\frac{cov(x,y)}{sd(x)sd(y)}\]</span></p>
</section>
<section id="challenge-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-1">CHALLENGE</h3>
<p>Calculate the correlation between zombie apocalypse survivor weight and zombie apocalypse survivor height.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sd_w <span class="ot">&lt;-</span> <span class="fu">sd</span>(w)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>sd_h <span class="ot">&lt;-</span> <span class="fu">sd</span>(h)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>cor_wh <span class="ot">&lt;-</span> cov_wh<span class="sc">/</span>(sd_w <span class="sc">*</span> sd_h)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>cor_wh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 0.8325862</code></pre>
</details>
</div>
</div>
<p>Again, there is a built-in <strong><em>R</em></strong> function <code>cor()</code> which yields the same.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(w, h)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.8325862</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(w, h, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.8325862</code></pre>
</div>
</div>
<p>This formulation of the correlation coefficient is referred to as <strong>Pearson’s product-moment correlation coefficient</strong> and is often abbreviated as <span class="math inline">\(\rho\)</span>.</p>
<p>There are other, nonparametric forms of the correlation coefficient we might also calculate, which are based on the relationship among rank scores for the two variables:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(w, h, <span class="at">method =</span> <span class="st">"kendall"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.6331932</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(w, h, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.82668</code></pre>
</div>
</div>
</section>
</section>
<section id="regression" class="level2" data-number="18.4">
<h2 data-number="18.4" class="anchored" data-anchor-id="regression"><span class="header-section-number">18.4</span> Regression</h2>
<p>Regression refers to a set of tools that lets us explore the relationships between variables further. In regression analysis, we are typically identifying and exploring linear <strong>models</strong>, or functions, that describe the relationship between variables. There are a couple of main purposes for undertaking regression analyses:</p>
<ul>
<li>To use one or more variables to <strong>predict</strong> the value of another</li>
<li>To develop and choose among different <strong>models</strong> of the relationship between variables</li>
<li>To do <strong>analyses of covariation</strong> among sets of variables to identify/explore their relative explanatory power</li>
</ul>
<p>The general purpose of linear regression is to come up with a model or function that estimates the expected value of one variable (a mean, a proportion, etc.), i.e., the <strong>response</strong> or <strong>outcome</strong> variable, given the particular value(s) of another variable (or set of variables), i.e., the <strong>predictor</strong> variable(s).</p>
<p>We are going to start off with simple bivariate regression, where we have a single predictor and a single response variable. In our case, we may be interested in coming up with a model that estimates the expected value for zombie apocalypse survivor height (as the response variable) given zombie apocalypse survivor weight (as the predictor variable). That is, we want to explore possible functions that link these two variables and choose the best one.</p>
<p>In general, the model for linear regression represents a dependent (or response) variable, <span class="math inline">\(Y\)</span> as a linear function of an independent (or predictor) variable, <span class="math inline">\(X\)</span>.</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + \epsilon_i\]</span></p>
<p>The function has two <strong>coefficients</strong>. The first, <span class="math inline">\(\beta_0\)</span> is the intercept, i.e., the value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(X\)</span> = 0. The second <span class="math inline">\(\beta_1\)</span> is the slope of the line describing the relationship between the predictor and response. The error term, <span class="math inline">\(\epsilon_i\)</span>, is a normal random variable, <span class="math inline">\(\epsilon_i \sim N(0,\sigma^2)\)</span>, with the standard deviation assumed to be constant across all values of <span class="math inline">\(X\)</span>. A regression analysis calls for estimating the values of all three parameters (<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, and the residual or error term). How this is accomplished will depend on what assumptions are employed in the analysis.</p>
<p>Looking at our scatterplot above, it seems pretty clear that there is indeed some linear relationship among these variables, and so a reasonable function to connect height to weight should simply be some kind of line of best fit. Recall that the general formula for a line is:</p>
<p><span class="math display">\[\hat{y} = slope \times x + intercept\]</span></p>
<p>where <span class="math inline">\(\hat{y}\)</span> = our predicted (or expected, or mean) value for y given a particular value of x.</p>
<p>In regression parlance…</p>
<p><span class="math display">\[\hat{y_i} = \beta_1x_i + \beta_0\]</span></p>
<p>Here, <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_0\)</span> are referred to as the <strong>regression coefficients</strong>, and it is those coefficients that our regression analysis is trying to estimate, while minimizing, according to some criterion, the error term. This process of estimation is called “fitting the model.”</p>
<section id="ordinary-least-squares-ols" class="level3" data-number="18.4.1">
<h3 data-number="18.4.1" class="anchored" data-anchor-id="ordinary-least-squares-ols"><span class="header-section-number">18.4.1</span> Ordinary Least Squares (OLS)</h3>
<p>A typical linear regression analysis further assumes that <span class="math inline">\(X\)</span>, our “independent” or predictor variable, is controlled and thus measured with much greater precision than <span class="math inline">\(Y\)</span>, our “dependent” or response variable. Thus the error, <span class="math inline">\(\epsilon_i\)</span> is assumed to be restricted to the <span class="math inline">\(Y\)</span> dimension, with little or no error in measuring <span class="math inline">\(X\)</span>, and we employ “ordinary least squares” as our criterion for best fit.</p>
<p>What does this mean? Well, we can imagine a family of lines with different slope (<span class="math inline">\(\beta_1\)</span>) and intercept (<span class="math inline">\(\beta_0\)</span>) going through any cloud of points, and one “best fit” criterion we could use is to find the line whose coefficients (<span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_0\)</span>, or slope and intercept) minimize the <em>sum of the squared deviations</em> of each observation in the <span class="math inline">\(Y\)</span> direction from that predicted by the line. This is the basis of <strong>ordinary least squares</strong> or <strong>OLS</strong> regression. We want to wind up with an equation that tells us how <span class="math inline">\(Y\)</span> varies in response to changes in <span class="math inline">\(X\)</span>.</p>
<p>In other words, we want to find <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_0\)</span> that minimizes…</p>
<p><span class="math display">\[\sum(y_i-\hat{y})^2\]</span></p>
<p>or, equivalently,</p>
<p><span class="math display">\[\sum(y_i-(\beta_1 x_i + \beta_0))^2\]</span></p>
<p>In terms of our variables, this is…</p>
<p><span class="math display">\[\sum(height - (\beta_1 weight + \beta_0))^2\]</span></p>
<p>Let’s first fit such a model by hand… The first thing to do is estimate the slope, which we can do if we first “center” each of our variables by subtracting the mean from each value (essentially, this shifts the distribution to eliminate the intercept term).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">mutate</span>(d, <span class="at">centered_height =</span> height <span class="sc">-</span> <span class="fu">mean</span>(height))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">mutate</span>(d, <span class="at">centered_weight =</span> weight <span class="sc">-</span> <span class="fu">mean</span>(weight))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> centered_weight, <span class="at">y =</span> centered_height)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Once we do this, we just need to minimize…</p>
<p><span class="math display">\[\sum(y_{centered} - (\beta_1 x_{centered}))^2\]</span></p>
<p>We can explore finding the best slope (<span class="math inline">\(\beta_1\)</span>) for this line using an interactive approach.</p>
<p>First we define a custom function…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>slope.test <span class="ot">&lt;-</span> <span class="cf">function</span>(beta1, data) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> centered_weight, <span class="at">y =</span> centered_height))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> beta1, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"blue"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    ols <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>centered_height <span class="sc">-</span> beta1 <span class="sc">*</span> data<span class="sc">$</span>centered_weight)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Slope = "</span>, beta1, <span class="st">"</span><span class="sc">\n</span><span class="st">Sum of Squared Deviations = "</span>, <span class="fu">round</span>(ols,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="dv">3</span>)))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    g</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>… that we can then play with interactively!</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> The following code is not run… to use it, copy and paste it into <strong><em>RStudio</em></strong> and then run it.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(<span class="fu">slope.test</span>(beta1, <span class="at">data =</span> d), <span class="at">beta1 =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">initial =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="fl">0.005</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similarly, we can calculate <span class="math inline">\(\beta_1\)</span> analytically as follows …</p>
<p><span class="math display">\[\beta_1 = cor(x,y)\frac{sd(y)}{sd(x)}=\frac{cov(x,y)}{var(x)}=\frac{SS_{XY}}{SS_X}\]</span></p>
<p>We can also calculate estimates for the standard errors in our regression coefficients analytically as follows:</p>
<p><span class="math display">\[SE_{\beta_1} = \sqrt\frac{\sum\epsilon_i^2}{(n-2)\sum(x_i -\bar{x})^2} = \sqrt\frac{\sum(\hat{y_i}-\bar{y})^2}{(n-2)\sum(x_i -\bar{x})^2}\]</span> <span class="math display">\[SE_{\beta_0} = SE_{\beta_1}\sqrt\frac{\sum{x_i}^2}{n}\]</span> As for any standard errors, these are estimates of the <em>standard deviation in the sampling distribution</em> of the two regression coefficients.</p>
</section>
<section id="challenge-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-2">CHALLENGE</h3>
<p>Solve for <span class="math inline">\(\beta_1\)</span> by hand…</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(beta1 <span class="ot">&lt;-</span> <span class="fu">cor</span>(w, h) <span class="sc">*</span> (<span class="fu">sd</span>(h)<span class="sc">/</span><span class="fu">sd</span>(w)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 0.1950187</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(beta1 <span class="ot">&lt;-</span> <span class="fu">cov</span>(w, h)<span class="sc">/</span><span class="fu">var</span>(w))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 0.1950187</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(beta1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((h <span class="sc">-</span> <span class="fu">mean</span>(h)) <span class="sc">*</span> (w <span class="sc">-</span> <span class="fu">mean</span>(w)))<span class="sc">/</span><span class="fu">sum</span>((w <span class="sc">-</span> <span class="fu">mean</span>(w))<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 0.1950187</code></pre>
</details>
</div>
</div>
<p>Then, to find <span class="math inline">\(\beta_0\)</span>, we can simply plug back into our original regression model. The line of best fit has to run through the centroid of our data points, which is the point determined by the mean of the <span class="math inline">\(X\)</span> values and the mean of the <span class="math inline">\(Y\)</span> values, so we can use the following:</p>
<p><span class="math display">\[\bar{y}=\beta_1\bar{x}+\beta_0\]</span></p>
<p>which, rearranged to solve for <span class="math inline">\(\beta_0\)</span> gives…</p>
<p><span class="math display">\[\beta_0=\bar{y}-\beta_1\bar{x}\]</span></p>
</section>
<section id="challenge-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-3">CHALLENGE</h3>
<p>Solve for <span class="math inline">\(\beta_0\)</span> by hand…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(beta0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(h) <span class="sc">-</span> beta1 <span class="sc">*</span> <span class="fu">mean</span>(w))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 39.56545</code></pre>
</div>
</div>
<p>Note that in the example above, we have taken our least squares criterion to mean minimizing the deviation of each of our <span class="math inline">\(Y\)</span> variables from a line of best fit <strong>in a dimension perpendicular</strong> to the <span class="math inline">\(Y\)</span> axis. In general, this kind of regression - where deviation is measured perpendicular to one of the axes - is known as <strong>Model I</strong> regression, and is used when the levels of the predictor variable are either measured without error (or, practically speaking, are measured with much less uncertainty than those of the response variable) or are set by the researcher (e.g., for defined treatment variables in an ecological experiment).</p>
</section>
<section id="the-lm-function" class="level3" data-number="18.4.2">
<h3 data-number="18.4.2" class="anchored" data-anchor-id="the-lm-function"><span class="header-section-number">18.4.2</span> The <code>lm()</code> Function</h3>
<p>The function <code>lm()</code> (“linear model”) in <strong><em>R</em></strong> makes all of the calculations we did above for <strong>Model I</strong> regression very easy! Below, we pass the zombies dataframe (<strong>d</strong>) and variables directly to <code>lm()</code> and assign the result to an <strong><em>R</em></strong> object called <strong>m</strong>. We can then look at the various elements that <strong><em>R</em></strong> calculates about this model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> weight, <span class="at">data =</span> d)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ weight, data = d)
## 
## Coefficients:
## (Intercept)       weight  
##      39.565        0.195</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(m)  <span class="co"># components of the object, m</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  [1] "coefficients"  "residuals"     "effects"       "rank"         
##  [5] "fitted.values" "assign"        "qr"            "df.residual"  
##  [9] "xlevels"       "call"          "terms"         "model"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>coefficients  <span class="co"># regression coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## (Intercept)      weight 
##  39.5654460   0.1950187</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m<span class="sc">$</span>model)  <span class="co"># x values and fitted y values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##     height   weight
## 1 62.88951 132.0872
## 2 67.80277 146.3753
## 3 72.12908 152.9370
## 4 66.78484 129.7418
## 5 64.71832 132.4265
## 6 71.24326 152.5246</code></pre>
</div>
</div>
<p>Applying the <code>tidy()</code> function from the {broom} package to our model makes it easy to extract certain output of interest, such as beta coefficients.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 2 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)   39.6     0.596        66.4 0        
## 2 weight         0.195   0.00411      47.5 2.65e-258</code></pre>
</div>
</div>
<p>The <code>glance()</code> function also returns other information of interest about the model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.693         0.693  2.39     2255. 2.65e-258     1 -2289. 4583. 4598.
## # ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>In {ggplot}, we can easily create a plot that adds the linear model along with confidence intervals around the estimated value of <strong>y</strong>, or <span class="math inline">\(\hat{y}\)</span> at each <strong>x</strong> by calling <code>geom_smooth()</code> with the argument <code>method=</code> specified as “lm”. Those intervals are important for when we move on to talking about inference in the regression context.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="alternatives-to-ols" class="level3" data-number="18.4.3">
<h3 data-number="18.4.3" class="anchored" data-anchor-id="alternatives-to-ols"><span class="header-section-number">18.4.3</span> Alternatives to OLS</h3>
<p>The assumption of greater uncertainty in our response variable than in our predictor variable may be reasonable in controlled experiments, but for natural observations, measurement of the <span class="math inline">\(X\)</span> variable also typically involves some error and, in fact, in many cases we may not be concered about PREDICTING <span class="math inline">\(Y\)</span> from <span class="math inline">\(X\)</span> but rather want to treat both <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> as independent variables and explore the relationship between them or consider that both are dependent on some additional parameter, which may be unknown. That is, both are measured rather than “controlled” and both include uncertainty. We thus are not seeking an equation of how <span class="math inline">\(Y\)</span> varies with changes in <span class="math inline">\(X\)</span>, but rather we are look for how they both co-vary in response to some other variable or process. Under these conditions <strong>Model II</strong> regression analysis may be more appropriate. In <strong>Model II</strong> approaches, a line of best fit is chosen that minimizes in some way the direct distance of each point to the best fit line. There are several different types of <strong>Model II</strong> regression, and which to use depends upon the specifics of the case. Common approaches are know as <em>major axis</em>, <em>ranged major axis</em>, and <em>reduced major axis</em> (a.k.a. <em>standard major axis</em>) regression.</p>
<p>The {lmodel2} package allows us to do <strong>Model II</strong> regression easily (as well as <strong>Model I</strong>). In this package, the signficance of the regression coefficients, which we discuss below, is determined based on permutation.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmodel2)  <span class="co"># load the lmodel2 package</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the regression</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>mII <span class="ot">&lt;-</span> <span class="fu">lmodel2</span>(height <span class="sc">~</span> weight, <span class="at">data =</span> d, <span class="at">range.y =</span> <span class="st">"relative"</span>, <span class="at">range.x =</span> <span class="st">"relative"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">nperm =</span> <span class="dv">1000</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>mII</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Model II regression
## 
## Call: lmodel2(formula = height ~ weight, data = d, range.y =
## "relative", range.x = "relative", nperm = 1000)
## 
## n = 1000   r = 0.8325862   r-square = 0.6931998 
## Parametric P-values:   2-tailed = 2.646279e-258    1-tailed = 1.32314e-258 
## Angle between the two OLS regression lines = 4.677707 degrees
## 
## Permutation tests of OLS, MA, RMA slopes: 1-tailed, tail corresponding to sign
## A permutation test of r is equivalent to a permutation test of the OLS slope
## P-perm for SMA = NA because the SMA slope cannot be tested
## 
## Regression results
##   Method Intercept     Slope Angle (degrees) P-perm (1-tailed)
## 1    OLS  39.56545 0.1950187        11.03524       0.000999001
## 2     MA  39.10314 0.1982313        11.21246       0.000999001
## 3    SMA  33.92229 0.2342325        13.18287                NA
## 4    RMA  36.80125 0.2142269        12.09153       0.000999001
## 
## Confidence intervals
##   Method 2.5%-Intercept 97.5%-Intercept 2.5%-Slope 97.5%-Slope
## 1    OLS       38.39625        40.73464  0.1869597   0.2030778
## 2     MA       37.92239        40.28020  0.1900520   0.2064362
## 3    SMA       32.74259        35.06211  0.2263120   0.2424301
## 4    RMA       35.51434        38.06296  0.2054593   0.2231695
## 
## Eigenvalues: 351.6888 5.48735 
## 
## H statistic used for computing C.I. of MA: 6.212738e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mII, <span class="st">"OLS"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mII, <span class="st">"MA"</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mII, <span class="st">"SMA"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mII, <span class="st">"RMA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>lmodel2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that, here, running <code>lmodel2()</code> and using OLS to detemine the best coefficients yields equivalent results to our Model I regression done above using <code>lm()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>mI <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> weight, <span class="at">data =</span> d)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mI)  <span class="co"># show lm() results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ weight, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.1519 -1.5206 -0.0535  1.5167  9.4439 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 39.565446   0.595815   66.41   &lt;2e-16 ***
## weight       0.195019   0.004107   47.49   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.389 on 998 degrees of freedom
## Multiple R-squared:  0.6932, Adjusted R-squared:  0.6929 
## F-statistic:  2255 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show lmodel2() OLS results</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mII<span class="sc">$</span>regression.results, Method <span class="sc">==</span> <span class="st">"OLS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##   Method Intercept     Slope Angle (degrees) P-perm (1-tailed)
## 1    OLS  39.56545 0.1950187        11.03524       0.000999001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mII, <span class="at">main =</span> <span class="st">"lmodel2() OLS"</span>, <span class="at">xlab =</span> <span class="st">"weight"</span>, <span class="at">ylab =</span> <span class="st">"height"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight, <span class="at">main =</span> <span class="st">"lm()"</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mI, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="challenge-4" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-4">CHALLENGE</h3>
<p>Using the zombie apocalypse survivors dataset, try the following…</p>
<ul>
<li>Plot survivor height as a function of age</li>
<li>Derive by hand the ordinary least squares regression coefficients <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_0\)</span> for these data</li>
<li>Confirm that you get the same results using the <code>lm()</code> function</li>
<li>Repeat the analysis above for males and females separately</li>
<li>Do your regression coefficients differ by sex? How might you determine this?</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 12
##      id first_name last_name gender height weight zombies_killed
##   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;
## 1     1 Sarah      Little    Female   62.9   132.              2
## 2     2 Mark       Duncan    Male     67.8   146.              5
## 3     3 Brandon    Perez     Male     72.1   153.              1
## 4     4 Roger      Coleman   Male     66.8   130.              5
## 5     5 Tammy      Powell    Female   64.7   132.              4
## 6     6 Anthony    Green     Male     71.2   153.              1
## # ℹ 5 more variables: years_of_education &lt;dbl&gt;, major &lt;chr&gt;, age &lt;dbl&gt;,
## #   centered_height &lt;dbl&gt;, centered_weight &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">cor</span>(d<span class="sc">$</span>height, d<span class="sc">$</span>age) <span class="sc">*</span> <span class="fu">sd</span>(d<span class="sc">$</span>height)<span class="sc">/</span><span class="fu">sd</span>(d<span class="sc">$</span>age)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>beta1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.9425086</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(d<span class="sc">$</span>height) <span class="sc">-</span> beta1 <span class="sc">*</span> <span class="fu">mean</span>(d<span class="sc">$</span>age)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>beta0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 48.73566</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> age, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ age, data = d)
## 
## Coefficients:
## (Intercept)          age  
##     48.7357       0.9425</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>males <span class="ot">&lt;-</span> <span class="fu">filter</span>(d, gender <span class="sc">==</span> <span class="st">"Male"</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> age, <span class="at">data =</span> males))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ age, data = males)
## 
## Coefficients:
## (Intercept)          age  
##      49.341        1.011</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>females <span class="ot">&lt;-</span> <span class="fu">filter</span>(d, gender <span class="sc">==</span> <span class="st">"Female"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> age, <span class="at">data =</span> females))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ age, data = females)
## 
## Coefficients:
## (Intercept)          age  
##     48.1811       0.8691</code></pre>
</div>
</div>
</section>
</section>
<section id="inference-in-regression" class="level2" data-number="18.5">
<h2 data-number="18.5" class="anchored" data-anchor-id="inference-in-regression"><span class="header-section-number">18.5</span> Inference in Regression</h2>
<section id="classical-theory-based-inference" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="classical-theory-based-inference">Classical Theory-Based Inference</h3>
<p>Once we have our linear model and associated regression coefficients, we want to know a bit more about the model. First, we want to be able to evaluate whether there is <strong>statistical evidence</strong> that there is indeed a relationship between these variables. If so, then our regression coefficients can indeed allow us to estimate or predict the value of one variable given another. Additionally, we also would like to be able to extend our estimates from our sample out to the population they are drawn from. These next steps involve the process of statistical inference.</p>
<p>The output of the <code>lm()</code> function provides a lot of information useful for inference. Run the command <code>summary()</code> on the output of <code>lm(data = d, height ~ weight)</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ weight, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.1519 -1.5206 -0.0535  1.5167  9.4439 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 39.565446   0.595815   66.41   &lt;2e-16 ***
## weight       0.195019   0.004107   47.49   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.389 on 998 degrees of freedom
## Multiple R-squared:  0.6932, Adjusted R-squared:  0.6929 
## F-statistic:  2255 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>One of the outputs for the model, seen in the 2nd to last line in the output above, is the “R-squared” value, or the <strong>coefficient of determination</strong>, which is a summary of the total amount of variation in the <strong>y</strong> variable that is explained by the <strong>x</strong> variable. In our regression, ~69% of the variation in zombie height is explained by zombie weight.</p>
<p>Another output is the <strong>standard error</strong> of the estimate of each regression coefficient, along with a corresponding <strong>t value</strong> and <strong>p value</strong>. Recall that t statistics are calculated as the difference between an observed and expected value divided by a standard error. The p value comes from evaluating the magnitude of the t statistic against a t distribution with <strong>n-2</strong> degrees of freedom. That is, we can calculate p values mathematically for our statistics (the regression slope and intercept) if the sampling distribution of these statistics conform to a t distribution.</p>
<p>As we saw above, running the <code>tidy()</code> function from the {broom} package pulls out a clean table of the relevant information.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>m.summary <span class="ot">&lt;-</span> <span class="fu">tidy</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can confirm the t statistic and p value output by <code>lm()</code> by hand by calculating t and p based on the regression coefficient estimates and the standard errors of those estimates. The t statistic is simply the value of the estimated regression coefficient divided by the estimate of the standard error for that coefficient (i.e., <span class="math inline">\(\beta/SE_\beta\)</span>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>m.summary<span class="sc">$</span>calc.statistic <span class="ot">&lt;-</span> (m.summary<span class="sc">$</span>estimate <span class="sc">-</span> <span class="dv">0</span>)<span class="sc">/</span>m.summary<span class="sc">$</span>std.error</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>m.summary<span class="sc">$</span>calc.p.value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(m.summary<span class="sc">$</span>calc.statistic, <span class="at">df =</span> <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we use 2 * pt to get the 2-tailed p value alternatively, we could do...</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># m.summary$calc.p.value &lt;- pt(-1*abs(m.summary$calc.statistic), df = nrow(d) -</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2, lower.tail = TRUE) + pt(abs(m.summary$calc.statistic), df = nrow(d) - 2,</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lower.tail = FALSE) or m.summary$calc.p.value &lt;-</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co"># pt(-1*abs(m.summary$calc.statistic), df = nrow(d) - 2, lower.tail = TRUE) +</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (1-pt(abs(m.summary$calc.statistic), df = nrow(d) - 2, lower.tail = TRUE))</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>m.summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 2 × 7
##   term        estimate std.error statistic   p.value calc.statistic calc.p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;
## 1 (Intercept)   39.6     0.596        66.4 0                   66.4    0        
## 2 weight         0.195   0.00411      47.5 2.65e-258           47.5    2.65e-258</code></pre>
</div>
</div>
<p>Note that the <code>glance()</code> function also returns other information of interest about a regression model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.693         0.693  2.39     2255. 2.65e-258     1 -2289. 4583. 4598.
## # ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>We can get t distribution-based confidence intervals for our estimates easily, too, using either the by-hand approach we’ve used before or by using a built-in function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract CIs from the model with using the results of lm()</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>(CI <span class="ot">&lt;-</span> <span class="fu">confint</span>(m, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##                  2.5 %     97.5 %
## (Intercept) 38.3962527 40.7346393
## weight       0.1869597  0.2030778</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using tidy()</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>(CI <span class="ot">&lt;-</span> <span class="fu">tidy</span>(m, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 2 × 7
##   term        estimate std.error statistic   p.value conf.low conf.high
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)   39.6     0.596        66.4 0           38.4      40.7  
## 2 weight         0.195   0.00411      47.5 2.65e-258    0.187     0.203</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># by hand</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> m.summary<span class="sc">$</span>estimate <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> m.summary<span class="sc">$</span>std.error</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> m.summary<span class="sc">$</span>estimate <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> m.summary<span class="sc">$</span>std.error</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lower, upper)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(CI) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"weight"</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(CI) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="fu">as.character</span>(alpha<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">100</span>), <span class="st">" %"</span>), <span class="fu">paste0</span>(<span class="fu">as.character</span>((<span class="dv">1</span> <span class="sc">-</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>), <span class="st">" %"</span>))</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>CI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##                  2.5 %     97.5 %
## (Intercept) 38.3962527 40.7346393
## weight       0.1869597  0.2030778</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Remember that these mathematical methods of calculating p values and CIs are only valid if the <strong>LINE</strong> technical conditions for linear regression are met. These conditions are:</p>
<ul>
<li><strong>L</strong>inearity of the relationship between the explanatory and response variables</li>
<li><strong>I</strong>ndependence of observations and their residuals</li>
<li><strong>N</strong>ormality of the residual values of the response variable around the regression line</li>
<li><strong>E</strong>quality of the variance in residual values across the range of explanatory variable values</li>
</ul>
</blockquote>
</section>
<section id="simulation-based-inference" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="simulation-based-inference">Simulation-Based Inference</h3>
<section id="significance-of-coefficients-by-permutation" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="significance-of-coefficients-by-permutation">Significance of Coefficients by Permutation</h4>
<p>As we saw in <a href="16-module.html"><strong>Module 16</strong></a>, the {infer} package offers a convenient set of functions and a standard workflow for using permutation methods for statistical hypothesis testing, rather than relying on mathematical assumptions. In that module, we considered whether means, differences between means, proportions, or differences in proportions differed from what we would expect under a particular null hypothesis… and we can apply the same workflow to evaluating regression coefficients! The permutation approach lets us relax the <strong>normality</strong> condition of the <strong>LINE</strong> assumptions for linear regression. To demonstrate this process, we will run the same model of <strong>height</strong> ~ <strong>weight</strong> using the zombie apocalypse survivors dataset that we ran above:</p>
<p>First, we run the model and pull out <span class="math inline">\(\beta_1\)</span>, the regression slope, and its estimated standard error:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first define alpha, CI boundaries, and critical values</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>confidence_level <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> alpha</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>p_lower <span class="ot">&lt;-</span> alpha<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>p_upper <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>degrees_of_freedom <span class="ot">&lt;-</span> <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>critical_value <span class="ot">&lt;-</span> <span class="fu">qt</span>(p_upper, <span class="at">df =</span> degrees_of_freedom)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># original slope</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>original.slope <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight) <span class="sc">|&gt;</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tidy the model and add the CI based on the t distribution</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> confidence_level) <span class="sc">|&gt;</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># or manually calculate the CI based on the t distribution</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">lower =</span> estimate <span class="sc">-</span> std.error <span class="sc">*</span> critical_value, <span class="at">upper =</span> estimate <span class="sc">+</span> std.error <span class="sc">*</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>    critical_value) <span class="sc">|&gt;</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"weight"</span>)</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>original.slope  <span class="co"># show model results for slope of weight</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 1 × 9
##   term   estimate std.error statistic   p.value conf.low conf.high lower upper
##   &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 weight    0.195   0.00411      47.5 2.65e-258    0.187     0.203 0.187 0.203</code></pre>
</div>
</div>
<p>We can generate a null distribution for our slope estimates via permutation using {infer} package functions… essentially, each permutation involves randomly shuffling values of the response variable under the null hypothesis such that they are independent of the explanatory variable (and vice versa).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>permuted.slope <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># specify model</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">specify</span>(height <span class="sc">~</span> weight) <span class="sc">|&gt;</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># use a null hypothesis of independence</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate permutation replicates</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the slope statistic</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"slope"</span>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(permuted.slope)  <span class="co"># slopes from first few permutation replicates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Response: height (numeric)
## Explanatory: weight (numeric)
## Null Hypothesis: independence
## # A tibble: 6 × 2
##   replicate      stat
##       &lt;int&gt;     &lt;dbl&gt;
## 1         1  0.0199  
## 2         2 -0.00786 
## 3         3 -0.00714 
## 4         4  0.00280 
## 5         5  0.00415 
## 6         6  0.000827</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create confidence intervals</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>permuted.slope.summary <span class="ot">&lt;-</span> permuted.slope <span class="sc">|&gt;</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># summarize the mean (which should be very close to zero), standard error,</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CI based on the SE and t distribution, and CI based on the quantile</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (percentile) method</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">estimate =</span> <span class="fu">mean</span>(stat), <span class="at">std.error =</span> <span class="fu">sd</span>(stat), <span class="at">lower =</span> estimate <span class="sc">-</span> std.error <span class="sc">*</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    critical_value, <span class="at">upper =</span> estimate <span class="sc">+</span> std.error <span class="sc">*</span> critical_value, <span class="at">perm.lower =</span> <span class="fu">quantile</span>(stat,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    p_lower), <span class="at">perm.upper =</span> <span class="fu">quantile</span>(stat, p_upper))</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># show summary of permuted sampling distribution</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>permuted.slope.summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 1 × 6
##    estimate std.error   lower  upper perm.lower perm.upper
##       &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1 0.0000106   0.00741 -0.0145 0.0145    -0.0149     0.0151</code></pre>
</div>
</div>
<p>The <code>get_ci()</code> function from {infer} can be used to return these different types of confidence intervals, too… i.e., either based on the standard error of the permutation distribution or actual quantiles from that distribution.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_ci</span>(permuted.slope, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">type =</span> <span class="st">"percentile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 1 × 2
##   lower_ci upper_ci
##      &lt;dbl&gt;    &lt;dbl&gt;
## 1  -0.0149   0.0151</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_ci</span>(permuted.slope, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">type =</span> <span class="st">"se"</span>, <span class="at">point_estimate =</span> <span class="fu">pull</span>(permuted.slope.summary,</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    estimate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 1 × 2
##   lower_ci upper_ci
##      &lt;dbl&gt;    &lt;dbl&gt;
## 1  -0.0145   0.0145</code></pre>
</div>
</div>
<p>We can also visualize the null distribution of slope coefficients based on permutation and superimpose our actual slope coefficient.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the null distribution based on permutation</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(permuted.slope<span class="sc">$</span>stat, <span class="at">main =</span> <span class="st">"Histogram of Permuted</span><span class="sc">\n</span><span class="st">Slope Values"</span>, <span class="at">xlab =</span> <span class="st">"Slope Coefficient"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or using `visualize()` from {infer}</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">visualize</span>(permuted.slope) <span class="sc">+</span> <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> original.slope<span class="sc">$</span>estimate, <span class="at">direction =</span> <span class="st">"two_sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Finally, to determine the two-sided p value associated with our observed slope coefficient, we determine the proportion of permuted simulations that yielded a slope estimate as great or greater than the the one based on our original data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> permuted.slope <span class="sc">|&gt;</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of the absolute value of the slope</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">abs_stat =</span> <span class="fu">abs</span>(stat)) <span class="sc">|&gt;</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate a summary statistic as the proportion of cases where the</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># absolute value of the permuted slope is greater than or equal to the</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># absolute value of the observed slope</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">estimate =</span> <span class="fu">mean</span>(abs_stat <span class="sc">&gt;=</span> <span class="fu">abs</span>(<span class="fu">pull</span>(original.slope, estimate))))</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 1 × 1
##   estimate
##      &lt;dbl&gt;
## 1        0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the function `get_p_value()` returns this value directly...</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>(p.value <span class="ot">&lt;-</span> permuted.slope <span class="sc">|&gt;</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> original.slope<span class="sc">$</span>estimate, <span class="at">direction =</span> <span class="st">"two_sided"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## Warning: Please be cautious in reporting a p-value of 0. This result is an approximation
## based on the number of `reps` chosen in the `generate()` step.
## ℹ See `get_p_value()` (`?infer::get_p_value()`) for more information.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 1 × 1
##   p_value
##     &lt;dbl&gt;
## 1       0</code></pre>
</div>
</div>
</section>
<section id="cis-for-coefficients-by-bootstrapping" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="cis-for-coefficients-by-bootstrapping">CIs for Coefficients by Bootstrapping</h4>
<p>We can also use the {infer} package to generate CIs around our regression coefficient estimates using bootstrapping.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>boot.slope <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># specify model</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">specify</span>(height <span class="sc">~</span> weight) <span class="sc">|&gt;</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate bootstrap replicates</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"bootstrap"</span>) <span class="sc">|&gt;</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the slope statistic</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"slope"</span>)</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(boot.slope)  <span class="co"># slopes from first few bootstrap replicates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Response: height (numeric)
## Explanatory: weight (numeric)
## # A tibble: 6 × 2
##   replicate  stat
##       &lt;int&gt; &lt;dbl&gt;
## 1         1 0.197
## 2         2 0.190
## 3         3 0.185
## 4         4 0.200
## 5         5 0.195
## 6         6 0.192</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create confidence intervals for regression coefficients</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>boot.slope.summary <span class="ot">&lt;-</span> boot.slope <span class="sc">|&gt;</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># summarize the mean, standard error, CI based on the SE and t</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># distribution, and CI based on the quantile (percentile) method</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">estimate =</span> <span class="fu">mean</span>(stat), <span class="at">std.error =</span> <span class="fu">sd</span>(stat), <span class="at">lower =</span> estimate <span class="sc">-</span> std.error <span class="sc">*</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    critical_value, <span class="at">upper =</span> estimate <span class="sc">+</span> std.error <span class="sc">*</span> critical_value, <span class="at">boot.lower =</span> <span class="fu">quantile</span>(stat,</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    p_lower), <span class="at">boot.upper =</span> <span class="fu">quantile</span>(stat, p_upper))</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="co"># show summary of bootstrap sampling distribution</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>boot.slope.summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 1 × 6
##   estimate std.error lower upper boot.lower boot.upper
##      &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1    0.195   0.00423 0.187 0.203      0.187      0.203</code></pre>
</div>
</div>
<p>Again, the <code>get_ci()</code> function from {infer} can be used to return these different types of confidence intervals…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>CI.percentile <span class="ot">&lt;-</span> <span class="fu">get_ci</span>(boot.slope, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">type =</span> <span class="st">"percentile"</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>CI.theory <span class="ot">&lt;-</span> <span class="fu">get_ci</span>(boot.slope, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">type =</span> <span class="st">"se"</span>, <span class="at">point_estimate =</span> <span class="fu">pull</span>(boot.slope.summary,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    estimate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also easily visualize the sampling distribution (and CI) based on bootstrapping.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the sampling distribution for based on bootstrapping plus a CI</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot.slope<span class="sc">$</span>stat, <span class="at">main =</span> <span class="st">"Histogram of Bootstrapped</span><span class="sc">\n</span><span class="st">Slope Values"</span>, <span class="at">xlab =</span> <span class="st">"Slope Coefficient"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> CI.percentile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or...</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">visualize</span>(boot.slope) <span class="sc">+</span> <span class="fu">shade_ci</span>(<span class="at">endpoints =</span> CI.percentile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="interpreting-regression-results" class="level2" data-number="18.6">
<h2 data-number="18.6" class="anchored" data-anchor-id="interpreting-regression-results"><span class="header-section-number">18.6</span> Interpreting Regression Results</h2>
<p>As shown above, estimating our regression coefficients is pretty straightforward. But what do they mean? How do we interpret them?</p>
<ul>
<li>The intercept, <span class="math inline">\(\beta_0\)</span>, is the PREDICTED value of <span class="math inline">\(y\)</span>, our response variable, when the value of <span class="math inline">\(x\)</span>, our explanatory variable, is zero.</li>
<li>The slope, <span class="math inline">\(\beta_1\)</span> is EXPECTED CHANGE in units of <span class="math inline">\(y\)</span> for every 1 unit of change in <span class="math inline">\(x\)</span>.</li>
<li>The overall equation allows us to calculate PREDICTED values of <span class="math inline">\(y\)</span> for new observations of <span class="math inline">\(x\)</span>. We can also calculate CONFIDENCE INTERVALS (CIs) around the predicted mean value of <span class="math inline">\(y\)</span> for each value of <span class="math inline">\(x\)</span> (which addresses our uncertainly in the estimate of the mean), and we can get PREDICTION INTERVALS (PIs) around our prediction (which gives the range of actual values of <span class="math inline">\(y\)</span> that we might expect to see at a given value of <span class="math inline">\(x\)</span>). That is, for each value of <span class="math inline">\(x\)</span>, we can calculate a CI, which is the the range of values into which <span class="math inline">\(\hat{y}\)</span> is expected to fall 95% of the time, and a PI, which is the range of y values into which 95% of predicted individual y values are expected to fall.</li>
</ul>
<section id="challenge-5" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-5">CHALLENGE</h3>
<ul>
<li>If zombie apocalypse survivor weight is measured in <em>pounds</em> and zombie apocalypse survivor height is measured in <em>inches</em>, what is the expected height of a survivor weighing 150 pounds?</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> m.summary <span class="sc">|&gt;</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(estimate)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> m.summary <span class="sc">|&gt;</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"weight"</span>) <span class="sc">|&gt;</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(estimate)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>(h.hat <span class="ot">&lt;-</span> beta1 <span class="sc">*</span> <span class="dv">150</span> <span class="sc">+</span> beta0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 68.81825</code></pre>
</details>
</div>
</div>
<ul>
<li>What is the predicted difference in height between a survivor weighing 180 and 220 pounds?</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>(h.hat.difference <span class="ot">&lt;-</span> (beta1 <span class="sc">*</span> <span class="dv">220</span> <span class="sc">+</span> beta0) <span class="sc">-</span> (beta1 <span class="sc">*</span> <span class="dv">180</span> <span class="sc">+</span> beta0))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 7.800749</code></pre>
</details>
</div>
</div>
</section>
<section id="predicted-values" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="predicted-values">Predicted Values</h3>
<p>The <code>predict()</code> function allows us to generate predicted (i.e., <span class="math inline">\(\hat{y}\)</span>) values for a vector of values of <strong>x</strong>. Note the structure of the 2nd argument in the function, <code>newdata=</code>… it has to be a data frame and include the variable name(s) we are going to use to predict <strong>y</strong> on the basis of. Here, we pass it a vector of actual <strong>x</strong> values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>y.hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> d<span class="sc">$</span>weight))</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(d<span class="sc">$</span>weight, d<span class="sc">$</span>height, y.hat))</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"yhat"</span>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##          x        y     yhat
## 1 132.0872 62.88951 65.32492
## 2 146.3753 67.80277 68.11137
## 3 152.9370 72.12908 69.39103
## 4 129.7418 66.78484 64.86753
## 5 132.4265 64.71832 65.39109
## 6 152.5246 71.24326 69.31059</code></pre>
</div>
</div>
<p>The <code>augment()</code> function from {broom} also generates comparable predicted or “fitted” values for a model. With default arguments, it generates .fitted and .resid values for the original data and can also calculate .se.fit values (standard errors around the fitted values) by setting <code>se_fit=TRUE</code> (it is <code>FALSE</code> by default). With the <code>newdata=</code> argument, it generates .fitted values for novel data. As for <code>predict()</code>, the <code>newdata=</code> argument has to be a data frame and include the predictor variable name(s).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">augment</span>(m, <span class="at">se_fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 9
##   height weight .fitted .se.fit .resid    .hat .sigma    .cooksd .std.resid
##    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1   62.9   132.    65.3  0.0898 -2.44  0.00141   2.39 0.000737       -1.02 
## 2   67.8   146.    68.1  0.0762 -0.309 0.00102   2.39 0.00000851     -0.129
## 3   72.1   153.    69.4  0.0841  2.74  0.00124   2.39 0.000817        1.15 
## 4   66.8   130.    64.9  0.0953  1.92  0.00159   2.39 0.000515        0.803
## 5   64.7   132.    65.4  0.0890 -0.673 0.00139   2.39 0.0000553      -0.282
## 6   71.2   153.    69.3  0.0834  1.93  0.00122   2.39 0.000400        0.810</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> .fitted))</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.25</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> .fitted, <span class="at">xend =</span> weight, <span class="at">yend =</span> height),</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.25</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Each vertical line in the figure above represents a <strong>residual</strong>, the difference between the observed and the fitted or predicted value of <span class="math inline">\(y\)</span> (<span class="math inline">\(\hat{y}\)</span>) at the given <span class="math inline">\(x\)</span> value.</p>
</section>
<section id="confidence-intervals-around-predicted-means" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="confidence-intervals-around-predicted-means">Confidence Intervals around Predicted Means</h3>
<p>The <code>predict()</code> function also allows us to easily generate <em>confidence intervals</em> around our predicted <span class="math inline">\(\hat{y}\)</span> values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> <span class="dv">150</span>), <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    alpha)  <span class="co"># for a single value</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>ci</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##        fit      lwr     upr
## 1 68.81825 68.66211 68.9744</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> d<span class="sc">$</span>weight), <span class="at">interval =</span> <span class="st">"confidence"</span>,</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha)  <span class="co"># for a vector of values</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ci)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df<span class="sc">$</span>weight, ci)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ci) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"weight"</span>, <span class="st">"c.fit"</span>, <span class="st">"c.lwr"</span>, <span class="st">"c.upr"</span>)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height))</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> ci, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.fit), <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> ci, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.lwr), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> ci, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.upr), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This can be also be done by hand using the data from the <code>augment()</code>ed model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate a confidence interval for the predicted values</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">c.lwr =</span> .fitted <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(df) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> .se.fit, <span class="at">c.upr =</span> .fitted <span class="sc">+</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(df) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> .se.fit)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 11
##   height weight .fitted .se.fit .resid    .hat .sigma   .cooksd .std.resid c.lwr
##    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
## 1   62.9   132.    65.3  0.0898 -2.44  0.00141   2.39   7.37e-4     -1.02   65.1
## 2   67.8   146.    68.1  0.0762 -0.309 0.00102   2.39   8.51e-6     -0.129  68.0
## 3   72.1   153.    69.4  0.0841  2.74  0.00124   2.39   8.17e-4      1.15   69.2
## 4   66.8   130.    64.9  0.0953  1.92  0.00159   2.39   5.15e-4      0.803  64.7
## 5   64.7   132.    65.4  0.0890 -0.673 0.00139   2.39   5.53e-5     -0.282  65.2
## 6   71.2   153.    69.3  0.0834  1.93  0.00122   2.39   4.00e-4      0.810  69.1
## # ℹ 1 more variable: c.upr &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height))</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.lwr), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.upr), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="prediction-intervals-for-individual-responses" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="prediction-intervals-for-individual-responses">Prediction Intervals for Individual Responses</h3>
<p>The <code>predict()</code> function also allows us to easily generate <em>prediction intervals</em> for the range of possible values of individual observations of <span class="math inline">\(y\)</span> (rather than the 95% CI around <span class="math inline">\(\hat{y}\)</span> at each <span class="math inline">\(x\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> <span class="dv">150</span>), <span class="at">interval =</span> <span class="st">"prediction"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)  <span class="co"># for a single value</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>pi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##        fit      lwr      upr
## 1 68.81825 64.12849 73.50802</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> d<span class="sc">$</span>weight), <span class="at">interval =</span> <span class="st">"prediction"</span>,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span>)  <span class="co"># for a vector of values</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pi)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(d<span class="sc">$</span>weight, pi)</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pi) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"weight"</span>, <span class="st">"p.fit"</span>, <span class="st">"p.lwr"</span>, <span class="st">"p.upr"</span>)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> pi, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> p.lwr), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> pi, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> p.upr), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again, this can be also be done by hand using the data from the <code>augment()</code>ed model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">glance</span>(m) <span class="sc">|&gt;</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(sigma)  <span class="co"># sd deviation of residuals</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate a confidence interval for the predicted values</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">se.prediction =</span> <span class="fu">sqrt</span>(sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> .se.fit<span class="sc">^</span><span class="dv">2</span>), <span class="at">p.lower =</span> .fitted <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(df) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> se.prediction, <span class="at">p.upper =</span> .fitted <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(df) <span class="sc">-</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>) <span class="sc">*</span> se.prediction)</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height))</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.lwr), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.upr), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> p.lower), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> p.upper), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="challenge-6" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-6">CHALLENGE</h3>
<p>Construct a linear model using <code>lm()</code> for the regression of zombie apocalypse survivor <strong>height</strong> on <strong>age</strong> and predict the mean height (<span class="math inline">\(\hat{h}\)</span>). Then, use the <code>augment()</code> and <code>mutate()</code> or <code>predict()</code> functions to calculate the t distribution-based 95% confidence interval (CI) around the predicted mean height and the 95% prediction interval (PI) for height for a vector of zombie ages, <code>v &lt;- seq(from=10, to=30, by=1)</code>. Finally, plot your points, your regression line, and lines for the lower and upper limits of the CI and of the PI.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> The <code>augment()</code> and <code>predict()</code> functions work similarly, but whereas <code>predict()</code> returns a vector of fitted <span class="math inline">\(y\)</span> values for each <span class="math inline">\(x\)</span> value in <strong>newdata</strong>, <code>augment()</code> will return a dataframe of <span class="math inline">\(x\)</span>s, fitted <span class="math inline">\(y\)</span>s, and standard errors for the fitted <span class="math inline">\(y\)</span>s. Helpfully, if the <strong>newdata</strong> argument is left out for <code>augment()</code>, the function will use the original dataset and simply add in the new fitted <span class="math inline">\(y\)</span>, standard errors, etc.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">glance</span>(m) <span class="sc">|&gt;</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(sigma)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">augment</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> v), <span class="at">se_fit =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add CI</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">c.lower =</span> .fitted <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> .se.fit, <span class="at">c.upper =</span> .fitted <span class="sc">+</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> .se.fit) <span class="sc">|&gt;</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add PI</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">se.prediction =</span> <span class="fu">sqrt</span>(sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> .se.fit<span class="sc">^</span><span class="dv">2</span>), <span class="at">p.lower =</span> .fitted <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> se.prediction, <span class="at">p.upper =</span> .fitted <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>    se.prediction)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively...  ci &lt;- predict(m, newdata = data.frame(age = v), interval =</span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 'confidence', level = 1 - alpha) pi &lt;- predict(m, newdata = data.frame(age =</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a><span class="co"># v), interval = 'prediction', 1 - alpha)</span></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age)</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> df<span class="sc">$</span>age, <span class="at">y =</span> df<span class="sc">$</span>.fitted, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> df<span class="sc">$</span>age, <span class="at">y =</span> df<span class="sc">$</span>c.lower, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> df<span class="sc">$</span>age, <span class="at">y =</span> df<span class="sc">$</span>c.upper, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> df<span class="sc">$</span>age, <span class="at">y =</span> df<span class="sc">$</span>p.lower, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> df<span class="sc">$</span>age, <span class="at">y =</span> df<span class="sc">$</span>p.upper, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height))</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> c.lower), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> c.upper), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> p.lower), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> p.upper), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>g1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="at">data =</span> df,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">ymin =</span> c.lower, <span class="at">ymax =</span> c.upper), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="at">data =</span> df,</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">ymin =</span> p.lower, <span class="at">ymax =</span> p.upper), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"red"</span>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>g2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-42-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can use a one-liner in {ggplot} to plot the CIs, too…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">TRUE</span>)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>g3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again, in these plots, the CI band shows where the mean height (<span class="math inline">\(\hat{h}\)</span>) is expected to fall in 95% of samples, while the PI band shows where the individual points are expected to fall 95% of the time.</p>
</section>
<section id="challenge-7" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-7">CHALLENGE</h3>
<p>For the same regression model in the challenge above, use bootstrapping with 1000 replicates to generate a quantile-based 95% CI around the estimate of the slope of the relationship. Plot the regression lines associated with each of your first 20 replicates atop a bivariate scatterplot of <strong>height</strong> ~ <strong>age</strong>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>p_lower <span class="ot">&lt;-</span> alpha<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>p_upper <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>boot.slope <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># specify model</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="fu">specify</span>(height <span class="sc">~</span> age) <span class="sc">|&gt;</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate bootstrap replicates</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"bootstrap"</span>) <span class="sc">|&gt;</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the slope statistic</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"slope"</span>) <span class="sc">|&gt;</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">boot.mean =</span> <span class="fu">mean</span>(stat), <span class="at">boot.lower =</span> <span class="fu">quantile</span>(stat, p_lower), <span class="at">boot.upper =</span> <span class="fu">quantile</span>(stat,</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>        p_upper))</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>boot.slope <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># specify model</span></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a><span class="fu">specify</span>(height <span class="sc">~</span> age) <span class="sc">|&gt;</span></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate bootstrap replicates</span></span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a><span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">20</span>, <span class="at">type =</span> <span class="st">"bootstrap"</span>)</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">data =</span> boot.slope,</span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height, <span class="at">group =</span> replicate), <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">lwd =</span> <span class="fl">0.1</span>)</span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18-module_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="residuals" class="level2" data-number="18.7">
<h2 data-number="18.7" class="anchored" data-anchor-id="residuals"><span class="header-section-number">18.7</span> Residuals</h2>
<p>From our various plots above, it’s clear that our model is not explaining all of the variation we see in our dataset… our <strong>y</strong> points do not all fall on the <span class="math inline">\(\hat{y}\)</span> line but rather are distributed around it. The distance of each of these points from the predicted value for <span class="math inline">\(y\)</span> at that value of <span class="math inline">\(x\)</span> is known as the “residual”. We can think about the residuals as “what is left over” after accounting for the predicted relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Residuals are often thought of as estimates of the “error” term in a regression model, and most regression analyses assume that residuals are random normal variables with uniform variance across the range of <span class="math inline">\(x\)</span> values (more on this later). In ordinary least squares regression, the line of best fit is defined as that which minimizes the sum of the squared residuals, and the expected value for a residual is 0.</p>
<p>Residuals are also used to create “covariate adjusted” variables, as they can be thought of as the response variable, <span class="math inline">\(y\)</span>, with the linear effect of other predictor variables removed. We’ll return to this idea when we move on to multivariate regression.</p>
<hr>
</section>
<section id="concept-review" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="concept-review">Concept Review</h2>
<ul>
<li><p>Regression analysis is used to identify and explore models describing the relationship between variables of interest</p></li>
<li><p>We can use regression analysis…</p>
<ul>
<li>to <strong>predict</strong> the value of a response variable given the value of one or more predictor variables</li>
<li>to evaluate alternative <strong>models</strong> of the relationship between a response variable and possible predictor variables</li>
<li>to explore the relative <strong>explanatory power</strong> of different predictor variables</li>
</ul></li>
<li><p>Linear regression involves finding the “line of best fit” between the predictor and response variable</p></li>
<li><p>This means finding the coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> that define the line that minizes the sum of the squared deviations of observed and predicted values for the response variable, i.e, that minimizes <span class="math inline">\(\sum(y - \hat{y})\)</span> where <span class="math inline">\(\hat{y}= \beta_0 + \beta_1 x\)</span></p></li>
<li><p>There are LOTS of types of regression analyses, and we will explore more of them in the modules to come [see Table 8.1 in <strong><em>R in Action</em></strong>]</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/RinActionTable8.1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./17-module.html" class="pagination-link" aria-label="Error, Power, and Effect Size">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./19-module.html" class="pagination-link" aria-label="Elements of Regression Analysis">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Elements of Regression Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb126" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span><span class="co"> html_document</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction to Linear Modeling {#module-18}</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objectives</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The objective of this module is to discuss the use of simple linear regression to explore the relationship among two continuous variables: a single predictor variable and a single response variable.</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminaries</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Install the following package in ***R***: <span class="co">[</span><span class="ot">{lmodel2}</span><span class="co">](https://cran.r-project.org/web/packages/lmodel2/lmodel2.pdf)</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Install and load the following package in ***R***: <span class="co">[</span><span class="ot">{broom}</span><span class="co">](https://cran.r-project.org/web/packages/broom/broom.pdf)</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load {tidyverse}, {manipulate}, {patchwork}, and {infer}</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manipulate)</span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## Covariance and Correlation</span></span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>So far, we have looked principally at single variables, but one of the main things we are often interested in is the relationships among two or more variables. **Regression modeling** is one of the most powerful and important set of tools for looking at relationships among more than one variable. With our zombie apocalypse survivors dataset, we started to do this using simple bivariate scatterplots... let's look at those data again and do a simple bivariate plot of height by weight.</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight)</span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a>These variables clearly seem to be related to one another, in that as weight increases, height increases. There are a couple of different ways we can quantify the relationship between these variables. One is by calculating the **covariance**, which expresses how much two numeric variables "change together" and whether that change is positive or negative.</span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a>Recall that the variance in a variable is simply the sum of the squared deviatiations of each observation from the mean divided by sample size (**n** for population variance or **n-1** for sample variance). Thus, sample variance is:</span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a>$$var(x)=\sum\frac{(x-\bar{x})^2}{(n-1)}$$</span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a>Similarly, the **covariance** is simply the product of the deviations of each of two variables from their respective means divided by sample size. Thus, for two vectors, $x$ and $y$, each of length $n$, representing two variables describing a sample...</span>
<span id="cb126-51"><a href="#cb126-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-52"><a href="#cb126-52" aria-hidden="true" tabindex="-1"></a>$$cov(x,y) = \sum\frac{(x-\bar{x})(y-\bar{y})}{(n-1)}$$</span>
<span id="cb126-53"><a href="#cb126-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-54"><a href="#cb126-54" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb126-55"><a href="#cb126-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-56"><a href="#cb126-56" aria-hidden="true" tabindex="-1"></a>What is the covariance between zombie apocalypse survivor weight and zombie apocalypse survivor height? What does it mean if the covariance is positive versus negative? Does it matter if you switch the order of the two variables?</span>
<span id="cb126-57"><a href="#cb126-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-60"><a href="#cb126-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-61"><a href="#cb126-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb126-62"><a href="#cb126-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb126-63"><a href="#cb126-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb126-64"><a href="#cb126-64" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> d<span class="sc">$</span>weight</span>
<span id="cb126-65"><a href="#cb126-65" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> d<span class="sc">$</span>height</span>
<span id="cb126-66"><a href="#cb126-66" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(w) <span class="co"># or length(h)</span></span>
<span id="cb126-67"><a href="#cb126-67" aria-hidden="true" tabindex="-1"></a>cov_wh <span class="ot">&lt;-</span> <span class="fu">sum</span>((w <span class="sc">-</span> <span class="fu">mean</span>(w)) <span class="sc">*</span> (h <span class="sc">-</span> <span class="fu">mean</span>(h))) <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb126-68"><a href="#cb126-68" aria-hidden="true" tabindex="-1"></a>cov_wh</span>
<span id="cb126-69"><a href="#cb126-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-70"><a href="#cb126-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-71"><a href="#cb126-71" aria-hidden="true" tabindex="-1"></a>The built-in ***R*** function <span class="in">`cov()`</span> yields the same.</span>
<span id="cb126-72"><a href="#cb126-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-75"><a href="#cb126-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-76"><a href="#cb126-76" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(w, h)</span>
<span id="cb126-77"><a href="#cb126-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-78"><a href="#cb126-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-79"><a href="#cb126-79" aria-hidden="true" tabindex="-1"></a>We often describe the relationship between two variables using the **correlation** coefficient, which is a *standardized* form of the covariance that summarizes, on a scale from -1 to +1, both the strength and direction of a relationship. The correlation is simply the covariance divided by the product of the standard deviations of the two variables.</span>
<span id="cb126-80"><a href="#cb126-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-81"><a href="#cb126-81" aria-hidden="true" tabindex="-1"></a>$$cor(x,y)=\frac{cov(x,y)}{sd(x)sd(y)}$$</span>
<span id="cb126-82"><a href="#cb126-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-83"><a href="#cb126-83" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb126-84"><a href="#cb126-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-85"><a href="#cb126-85" aria-hidden="true" tabindex="-1"></a>Calculate the correlation between zombie apocalypse survivor weight and zombie apocalypse survivor height.</span>
<span id="cb126-86"><a href="#cb126-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-89"><a href="#cb126-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-90"><a href="#cb126-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb126-91"><a href="#cb126-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb126-92"><a href="#cb126-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb126-93"><a href="#cb126-93" aria-hidden="true" tabindex="-1"></a>sd_w <span class="ot">&lt;-</span> <span class="fu">sd</span>(w)</span>
<span id="cb126-94"><a href="#cb126-94" aria-hidden="true" tabindex="-1"></a>sd_h <span class="ot">&lt;-</span> <span class="fu">sd</span>(h)</span>
<span id="cb126-95"><a href="#cb126-95" aria-hidden="true" tabindex="-1"></a>cor_wh <span class="ot">&lt;-</span> cov_wh <span class="sc">/</span> (sd_w <span class="sc">*</span> sd_h)</span>
<span id="cb126-96"><a href="#cb126-96" aria-hidden="true" tabindex="-1"></a>cor_wh</span>
<span id="cb126-97"><a href="#cb126-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-98"><a href="#cb126-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-99"><a href="#cb126-99" aria-hidden="true" tabindex="-1"></a>Again, there is a built-in ***R*** function <span class="in">`cor()`</span> which yields the same.</span>
<span id="cb126-100"><a href="#cb126-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-103"><a href="#cb126-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-104"><a href="#cb126-104" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(w, h)</span>
<span id="cb126-105"><a href="#cb126-105" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(w, h, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb126-106"><a href="#cb126-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-107"><a href="#cb126-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-108"><a href="#cb126-108" aria-hidden="true" tabindex="-1"></a>This formulation of the correlation coefficient is referred to as **Pearson's product-moment correlation coefficient** and is often abbreviated as $\rho$.</span>
<span id="cb126-109"><a href="#cb126-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-110"><a href="#cb126-110" aria-hidden="true" tabindex="-1"></a>There are other, nonparametric forms of the correlation coefficient we might also calculate, which are based on the relationship among rank scores for the two variables:</span>
<span id="cb126-111"><a href="#cb126-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-114"><a href="#cb126-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-115"><a href="#cb126-115" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(w, h, <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb126-116"><a href="#cb126-116" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(w, h, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb126-117"><a href="#cb126-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-118"><a href="#cb126-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-119"><a href="#cb126-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression</span></span>
<span id="cb126-120"><a href="#cb126-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-121"><a href="#cb126-121" aria-hidden="true" tabindex="-1"></a>Regression refers to a set of tools that lets us explore the relationships between variables further. In regression analysis, we are typically identifying and exploring linear **models**, or functions, that describe the relationship between variables. There are a couple of main purposes for undertaking regression analyses:</span>
<span id="cb126-122"><a href="#cb126-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-123"><a href="#cb126-123" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>To use one or more variables to **predict** the value of another</span>
<span id="cb126-124"><a href="#cb126-124" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>To develop and choose among different **models** of the relationship between variables</span>
<span id="cb126-125"><a href="#cb126-125" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>To do **analyses of covariation** among sets of variables to identify/explore their relative explanatory power</span>
<span id="cb126-126"><a href="#cb126-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-127"><a href="#cb126-127" aria-hidden="true" tabindex="-1"></a>The general purpose of linear regression is to come up with a model or function that estimates the expected value of one variable (a mean, a proportion, etc.), i.e., the **response** or **outcome** variable, given the particular value(s) of another variable (or set of variables), i.e., the **predictor** variable(s).</span>
<span id="cb126-128"><a href="#cb126-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-129"><a href="#cb126-129" aria-hidden="true" tabindex="-1"></a>We are going to start off with simple bivariate regression, where we have a single predictor and a single response variable. In our case, we may be interested in coming up with a model that estimates the expected value for zombie apocalypse survivor height (as the response variable) given zombie apocalypse survivor weight (as the predictor variable). That is, we want to explore possible functions that link these two variables and choose the best one.</span>
<span id="cb126-130"><a href="#cb126-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-131"><a href="#cb126-131" aria-hidden="true" tabindex="-1"></a>In general, the model for linear regression represents a dependent (or response) variable, $Y$ as a linear function of an independent (or predictor) variable, $X$.</span>
<span id="cb126-132"><a href="#cb126-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-133"><a href="#cb126-133" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 + \beta_1 X_i + \epsilon_i$$</span>
<span id="cb126-134"><a href="#cb126-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-135"><a href="#cb126-135" aria-hidden="true" tabindex="-1"></a>The function has two **coefficients**. The first, $\beta_0$ is the intercept, i.e., the value of $Y$ when $X$ = 0. The second $\beta_1$ is the slope of the line describing the relationship between the predictor and response. The error term, $\epsilon_i$, is a normal random variable, $\epsilon_i \sim N(0,\sigma^2)$, with the standard deviation assumed to be constant across all values of $X$. A regression analysis calls for estimating the values of all three parameters ($\beta_0$, $\beta_1$, and the residual or error term). How this is accomplished will depend on what assumptions are employed in the analysis.</span>
<span id="cb126-136"><a href="#cb126-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-137"><a href="#cb126-137" aria-hidden="true" tabindex="-1"></a>Looking at our scatterplot above, it seems pretty clear that there is indeed some linear relationship among these variables, and so a reasonable function to connect height to weight should simply be some kind of line of best fit. Recall that the general formula for a line is:</span>
<span id="cb126-138"><a href="#cb126-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-139"><a href="#cb126-139" aria-hidden="true" tabindex="-1"></a>$$\hat{y} = slope \times x + intercept$$</span>
<span id="cb126-140"><a href="#cb126-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-141"><a href="#cb126-141" aria-hidden="true" tabindex="-1"></a>where $\hat{y}$ = our predicted (or expected, or mean) value for y given a particular value of x.</span>
<span id="cb126-142"><a href="#cb126-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-143"><a href="#cb126-143" aria-hidden="true" tabindex="-1"></a>In regression parlance...</span>
<span id="cb126-144"><a href="#cb126-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-145"><a href="#cb126-145" aria-hidden="true" tabindex="-1"></a>$$\hat{y_i} = \beta_1x_i + \beta_0$$</span>
<span id="cb126-146"><a href="#cb126-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-147"><a href="#cb126-147" aria-hidden="true" tabindex="-1"></a>Here, $\beta_1$ and $\beta_0$ are referred to as the **regression coefficients**, and it is those coefficients that our regression analysis is trying to estimate, while minimizing, according to some criterion, the error term. This process of estimation is called "fitting the model."</span>
<span id="cb126-148"><a href="#cb126-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-149"><a href="#cb126-149" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ordinary Least Squares (OLS)</span></span>
<span id="cb126-150"><a href="#cb126-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-151"><a href="#cb126-151" aria-hidden="true" tabindex="-1"></a>A typical linear regression analysis further assumes that $X$, our "independent" or predictor variable, is controlled and thus measured with much greater precision than $Y$, our "dependent" or response variable. Thus the error, $\epsilon_i$ is assumed to be restricted to the $Y$ dimension, with little or no error in measuring $X$, and we employ "ordinary least squares" as our criterion for best fit.</span>
<span id="cb126-152"><a href="#cb126-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-153"><a href="#cb126-153" aria-hidden="true" tabindex="-1"></a>What does this mean? Well, we can imagine a family of lines with different slope ($\beta_1$) and intercept ($\beta_0$) going through any cloud of points, and one "best fit" criterion we could use is to find the line whose coefficients ($\beta_1$ and $\beta_0$, or slope and intercept) minimize the *sum of the squared deviations* of each observation in the $Y$ direction from that predicted by the line. This is the basis of **ordinary least squares** or **OLS** regression. We want to wind up with an equation that tells us how $Y$ varies in response to changes in $X$.</span>
<span id="cb126-154"><a href="#cb126-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-155"><a href="#cb126-155" aria-hidden="true" tabindex="-1"></a>In other words, we want to find $\beta_1$ and $\beta_0$ that minimizes...</span>
<span id="cb126-156"><a href="#cb126-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-157"><a href="#cb126-157" aria-hidden="true" tabindex="-1"></a>$$\sum(y_i-\hat{y})^2$$</span>
<span id="cb126-158"><a href="#cb126-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-159"><a href="#cb126-159" aria-hidden="true" tabindex="-1"></a>or, equivalently,</span>
<span id="cb126-160"><a href="#cb126-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-161"><a href="#cb126-161" aria-hidden="true" tabindex="-1"></a>$$\sum(y_i-(\beta_1 x_i + \beta_0))^2$$</span>
<span id="cb126-162"><a href="#cb126-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-163"><a href="#cb126-163" aria-hidden="true" tabindex="-1"></a>In terms of our variables, this is...</span>
<span id="cb126-164"><a href="#cb126-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-165"><a href="#cb126-165" aria-hidden="true" tabindex="-1"></a>$$\sum(height - (\beta_1 weight + \beta_0))^2$$</span>
<span id="cb126-166"><a href="#cb126-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-167"><a href="#cb126-167" aria-hidden="true" tabindex="-1"></a>Let's first fit such a model by hand... The first thing to do is estimate the slope, which we can do if we first "center" each of our variables by subtracting the mean from each value (essentially, this shifts the distribution to eliminate the intercept term).</span>
<span id="cb126-168"><a href="#cb126-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-171"><a href="#cb126-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-172"><a href="#cb126-172" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">mutate</span>(d, <span class="at">centered_height =</span> height <span class="sc">-</span> <span class="fu">mean</span>(height))</span>
<span id="cb126-173"><a href="#cb126-173" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">mutate</span>(d, <span class="at">centered_weight =</span> weight <span class="sc">-</span> <span class="fu">mean</span>(weight))</span>
<span id="cb126-174"><a href="#cb126-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-175"><a href="#cb126-175" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb126-176"><a href="#cb126-176" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> centered_weight,</span>
<span id="cb126-177"><a href="#cb126-177" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> centered_height)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb126-178"><a href="#cb126-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-179"><a href="#cb126-179" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span>
<span id="cb126-180"><a href="#cb126-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-181"><a href="#cb126-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-182"><a href="#cb126-182" aria-hidden="true" tabindex="-1"></a>Once we do this, we just need to minimize...</span>
<span id="cb126-183"><a href="#cb126-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-184"><a href="#cb126-184" aria-hidden="true" tabindex="-1"></a>$$\sum(y_{centered} - (\beta_1 x_{centered}))^2$$</span>
<span id="cb126-185"><a href="#cb126-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-186"><a href="#cb126-186" aria-hidden="true" tabindex="-1"></a>We can explore finding the best slope ($\beta_1$) for this line using an interactive approach.</span>
<span id="cb126-187"><a href="#cb126-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-188"><a href="#cb126-188" aria-hidden="true" tabindex="-1"></a>First we define a custom function...</span>
<span id="cb126-189"><a href="#cb126-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-192"><a href="#cb126-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-193"><a href="#cb126-193" aria-hidden="true" tabindex="-1"></a>slope.test <span class="ot">&lt;-</span> <span class="cf">function</span>(beta1, data){</span>
<span id="cb126-194"><a href="#cb126-194" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>data, <span class="fu">aes</span>(<span class="at">x =</span> centered_weight, <span class="at">y =</span> centered_height))</span>
<span id="cb126-195"><a href="#cb126-195" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb126-196"><a href="#cb126-196" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> beta1, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour=</span><span class="st">"blue"</span>, <span class="at">alpha=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb126-197"><a href="#cb126-197" aria-hidden="true" tabindex="-1"></a>  ols <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>centered_height <span class="sc">-</span> beta1 <span class="sc">*</span> data<span class="sc">$</span>centered_weight) <span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb126-198"><a href="#cb126-198" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Slope = "</span>, beta1,</span>
<span id="cb126-199"><a href="#cb126-199" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">Sum of Squared Deviations = "</span>, <span class="fu">round</span>(ols, <span class="dv">3</span>)))</span>
<span id="cb126-200"><a href="#cb126-200" aria-hidden="true" tabindex="-1"></a>  g</span>
<span id="cb126-201"><a href="#cb126-201" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-202"><a href="#cb126-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-203"><a href="#cb126-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-204"><a href="#cb126-204" aria-hidden="true" tabindex="-1"></a>... that we can then play with interactively!</span>
<span id="cb126-205"><a href="#cb126-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-206"><a href="#cb126-206" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** The following code is not run... to use it, copy and paste it into ***RStudio*** and then run it.</span></span>
<span id="cb126-207"><a href="#cb126-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-210"><a href="#cb126-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-211"><a href="#cb126-211" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb126-212"><a href="#cb126-212" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(<span class="fu">slope.test</span>(beta1, <span class="at">data=</span>d),</span>
<span id="cb126-213"><a href="#cb126-213" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta1 =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">initial =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="fl">0.005</span>))</span>
<span id="cb126-214"><a href="#cb126-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-215"><a href="#cb126-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-216"><a href="#cb126-216" aria-hidden="true" tabindex="-1"></a>Similarly, we can calculate $\beta_1$ analytically as follows ...</span>
<span id="cb126-217"><a href="#cb126-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-218"><a href="#cb126-218" aria-hidden="true" tabindex="-1"></a>$$\beta_1 = cor(x,y)\frac{sd(y)}{sd(x)}=\frac{cov(x,y)}{var(x)}=\frac{SS_{XY}}{SS_X}$$</span>
<span id="cb126-219"><a href="#cb126-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-220"><a href="#cb126-220" aria-hidden="true" tabindex="-1"></a>We can also calculate estimates for the standard errors in our regression coefficients analytically as follows:</span>
<span id="cb126-221"><a href="#cb126-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-222"><a href="#cb126-222" aria-hidden="true" tabindex="-1"></a>$$SE_{\beta_1} = \sqrt\frac{\sum\epsilon_i^2}{(n-2)\sum(x_i -\bar{x})^2} = \sqrt\frac{\sum(\hat{y_i}-\bar{y})^2}{(n-2)\sum(x_i -\bar{x})^2}$$</span>
<span id="cb126-223"><a href="#cb126-223" aria-hidden="true" tabindex="-1"></a>$$SE_{\beta_0} = SE_{\beta_1}\sqrt\frac{\sum{x_i}^2}{n}$$</span>
<span id="cb126-224"><a href="#cb126-224" aria-hidden="true" tabindex="-1"></a>As for any standard errors, these are estimates of the *standard deviation in the sampling distribution* of the two regression coefficients.</span>
<span id="cb126-225"><a href="#cb126-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-226"><a href="#cb126-226" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb126-227"><a href="#cb126-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-228"><a href="#cb126-228" aria-hidden="true" tabindex="-1"></a>Solve for $\beta_1$ by hand...</span>
<span id="cb126-229"><a href="#cb126-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-232"><a href="#cb126-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-233"><a href="#cb126-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb126-234"><a href="#cb126-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb126-235"><a href="#cb126-235" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb126-236"><a href="#cb126-236" aria-hidden="true" tabindex="-1"></a>(beta1 <span class="ot">&lt;-</span> <span class="fu">cor</span>(w, h) <span class="sc">*</span> (<span class="fu">sd</span>(h) <span class="sc">/</span> <span class="fu">sd</span>(w)))</span>
<span id="cb126-237"><a href="#cb126-237" aria-hidden="true" tabindex="-1"></a>(beta1 <span class="ot">&lt;-</span> <span class="fu">cov</span>(w,h) <span class="sc">/</span> <span class="fu">var</span>(w))</span>
<span id="cb126-238"><a href="#cb126-238" aria-hidden="true" tabindex="-1"></a>(beta1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((h<span class="sc">-</span><span class="fu">mean</span>(h))<span class="sc">*</span>(w<span class="sc">-</span><span class="fu">mean</span>(w)))<span class="sc">/</span><span class="fu">sum</span>((w<span class="sc">-</span><span class="fu">mean</span>(w))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb126-239"><a href="#cb126-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-240"><a href="#cb126-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-241"><a href="#cb126-241" aria-hidden="true" tabindex="-1"></a>Then, to find $\beta_0$, we can simply plug back into our original regression model. The line of best fit has to run through the centroid of our data points, which is the point determined by the mean of the $X$ values and the mean of the $Y$ values, so we can use the following:</span>
<span id="cb126-242"><a href="#cb126-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-243"><a href="#cb126-243" aria-hidden="true" tabindex="-1"></a>$$\bar{y}=\beta_1\bar{x}+\beta_0$$</span>
<span id="cb126-244"><a href="#cb126-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-245"><a href="#cb126-245" aria-hidden="true" tabindex="-1"></a>which, rearranged to solve for $\beta_0$ gives...</span>
<span id="cb126-246"><a href="#cb126-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-247"><a href="#cb126-247" aria-hidden="true" tabindex="-1"></a>$$\beta_0=\bar{y}-\beta_1\bar{x}$$</span>
<span id="cb126-248"><a href="#cb126-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-249"><a href="#cb126-249" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb126-250"><a href="#cb126-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-251"><a href="#cb126-251" aria-hidden="true" tabindex="-1"></a>Solve for $\beta_0$ by hand...</span>
<span id="cb126-252"><a href="#cb126-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-255"><a href="#cb126-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-256"><a href="#cb126-256" aria-hidden="true" tabindex="-1"></a>(beta0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(h) <span class="sc">-</span> beta1 <span class="sc">*</span> <span class="fu">mean</span>(w))</span>
<span id="cb126-257"><a href="#cb126-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-258"><a href="#cb126-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-259"><a href="#cb126-259" aria-hidden="true" tabindex="-1"></a>Note that in the example above, we have taken our least squares criterion to mean minimizing the deviation of each of our $Y$ variables from a line of best fit **in a dimension perpendicular** to the $Y$ axis. In general, this kind of regression - where deviation is measured perpendicular to one of the axes - is known as **Model I** regression, and is used when the levels of the predictor variable are either measured without error (or, practically speaking, are measured with much less uncertainty than those of the response variable) or are set by the researcher (e.g., for defined treatment variables in an ecological experiment).</span>
<span id="cb126-260"><a href="#cb126-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-261"><a href="#cb126-261" aria-hidden="true" tabindex="-1"></a><span class="fu">### The `lm()` Function</span></span>
<span id="cb126-262"><a href="#cb126-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-263"><a href="#cb126-263" aria-hidden="true" tabindex="-1"></a>The function <span class="in">`lm()`</span> ("linear model") in ***R*** makes all of the calculations we did above for **Model I** regression very easy! Below, we pass the zombies dataframe (**d**) and variables directly to `lm()` and assign the result to an ***R*** object called **m**. We can then look at the various elements that ***R*** calculates about this model.</span>
<span id="cb126-264"><a href="#cb126-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-267"><a href="#cb126-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-268"><a href="#cb126-268" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> weight, <span class="at">data =</span> d)</span>
<span id="cb126-269"><a href="#cb126-269" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb126-270"><a href="#cb126-270" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(m) <span class="co"># components of the object, m</span></span>
<span id="cb126-271"><a href="#cb126-271" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>coefficients <span class="co"># regression coefficients</span></span>
<span id="cb126-272"><a href="#cb126-272" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m<span class="sc">$</span>model) <span class="co"># x values and fitted y values</span></span>
<span id="cb126-273"><a href="#cb126-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-274"><a href="#cb126-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-275"><a href="#cb126-275" aria-hidden="true" tabindex="-1"></a>Applying the <span class="in">`tidy()`</span> function from the {broom} package to our model makes it easy to extract certain output of interest, such as beta coefficients.</span>
<span id="cb126-276"><a href="#cb126-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-279"><a href="#cb126-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-280"><a href="#cb126-280" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m)</span>
<span id="cb126-281"><a href="#cb126-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-282"><a href="#cb126-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-283"><a href="#cb126-283" aria-hidden="true" tabindex="-1"></a>The <span class="in">`glance()`</span> function also returns other information of interest about the model.</span>
<span id="cb126-284"><a href="#cb126-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-287"><a href="#cb126-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-288"><a href="#cb126-288" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(m)</span>
<span id="cb126-289"><a href="#cb126-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-290"><a href="#cb126-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-291"><a href="#cb126-291" aria-hidden="true" tabindex="-1"></a>In {ggplot}, we can easily create a plot that adds the linear model along with confidence intervals around the estimated value of **y**, or $\hat{y}$ at each **x** by calling <span class="in">`geom_smooth()`</span> with the argument <span class="in">`method=`</span> specified as "lm". Those intervals are important for when we move on to talking about inference in the regression context.</span>
<span id="cb126-292"><a href="#cb126-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-295"><a href="#cb126-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-296"><a href="#cb126-296" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height))</span>
<span id="cb126-297"><a href="#cb126-297" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb126-298"><a href="#cb126-298" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x)</span>
<span id="cb126-299"><a href="#cb126-299" aria-hidden="true" tabindex="-1"></a>g</span>
<span id="cb126-300"><a href="#cb126-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-301"><a href="#cb126-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-302"><a href="#cb126-302" aria-hidden="true" tabindex="-1"></a><span class="fu">### Alternatives to OLS</span></span>
<span id="cb126-303"><a href="#cb126-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-304"><a href="#cb126-304" aria-hidden="true" tabindex="-1"></a>The assumption of greater uncertainty in our response variable than in our predictor variable may be reasonable in controlled experiments, but for natural observations, measurement of the $X$ variable also typically involves some error and, in fact, in many cases we may not be concered about PREDICTING $Y$ from $X$ but rather want to treat both $X$ and $Y$ as independent variables and explore the relationship between them or consider that both are dependent on some additional parameter, which may be unknown. That is, both are measured rather than "controlled" and both include uncertainty. We thus are not seeking an equation of how $Y$ varies with changes in $X$, but rather we are look for how they both co-vary in response to some other variable or process. Under these conditions **Model II** regression analysis may be more appropriate. In **Model II** approaches, a line of best fit is chosen that minimizes in some way the direct distance of each point to the best fit line. There are several different types of **Model II** regression, and which to use depends upon the specifics of the case. Common approaches are know as *major axis*, *ranged major axis*, and *reduced major axis* (a.k.a. *standard major axis*) regression.</span>
<span id="cb126-305"><a href="#cb126-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-306"><a href="#cb126-306" aria-hidden="true" tabindex="-1"></a>The {lmodel2} package allows us to do **Model II** regression easily (as well as **Model I**). In this package, the signficance of the regression coefficients, which we discuss below, is determined based on permutation.</span>
<span id="cb126-307"><a href="#cb126-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-310"><a href="#cb126-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-311"><a href="#cb126-311" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmodel2) <span class="co"># load the lmodel2 package</span></span>
<span id="cb126-312"><a href="#cb126-312" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the regression</span></span>
<span id="cb126-313"><a href="#cb126-313" aria-hidden="true" tabindex="-1"></a>mII <span class="ot">&lt;-</span> <span class="fu">lmodel2</span>(</span>
<span id="cb126-314"><a href="#cb126-314" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> weight,</span>
<span id="cb126-315"><a href="#cb126-315" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d,</span>
<span id="cb126-316"><a href="#cb126-316" aria-hidden="true" tabindex="-1"></a>  <span class="at">range.y =</span> <span class="st">"relative"</span>,</span>
<span id="cb126-317"><a href="#cb126-317" aria-hidden="true" tabindex="-1"></a>  <span class="at">range.x =</span> <span class="st">"relative"</span>,</span>
<span id="cb126-318"><a href="#cb126-318" aria-hidden="true" tabindex="-1"></a>  <span class="at">nperm =</span> <span class="dv">1000</span></span>
<span id="cb126-319"><a href="#cb126-319" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb126-320"><a href="#cb126-320" aria-hidden="true" tabindex="-1"></a>mII</span>
<span id="cb126-321"><a href="#cb126-321" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb126-322"><a href="#cb126-322" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mII, <span class="st">"OLS"</span>)</span>
<span id="cb126-323"><a href="#cb126-323" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mII, <span class="st">"MA"</span>)</span>
<span id="cb126-324"><a href="#cb126-324" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mII, <span class="st">"SMA"</span>)</span>
<span id="cb126-325"><a href="#cb126-325" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mII, <span class="st">"RMA"</span>)</span>
<span id="cb126-326"><a href="#cb126-326" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>lmodel2)</span>
<span id="cb126-327"><a href="#cb126-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-328"><a href="#cb126-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-329"><a href="#cb126-329" aria-hidden="true" tabindex="-1"></a>Note that, here, running <span class="in">`lmodel2()`</span> and using OLS to detemine the best coefficients yields equivalent results to our Model I regression done above using <span class="in">`lm()`</span>.</span>
<span id="cb126-330"><a href="#cb126-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-333"><a href="#cb126-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-334"><a href="#cb126-334" aria-hidden="true" tabindex="-1"></a>mI <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> weight, <span class="at">data =</span> d)</span>
<span id="cb126-335"><a href="#cb126-335" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mI) <span class="co"># show lm() results</span></span>
<span id="cb126-336"><a href="#cb126-336" aria-hidden="true" tabindex="-1"></a><span class="co"># show lmodel2() OLS results</span></span>
<span id="cb126-337"><a href="#cb126-337" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mII<span class="sc">$</span>regression.results, Method <span class="sc">==</span> <span class="st">"OLS"</span>)</span>
<span id="cb126-338"><a href="#cb126-338" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb126-339"><a href="#cb126-339" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mII,</span>
<span id="cb126-340"><a href="#cb126-340" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"lmodel2() OLS"</span>,</span>
<span id="cb126-341"><a href="#cb126-341" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"weight"</span>,</span>
<span id="cb126-342"><a href="#cb126-342" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"height"</span>)</span>
<span id="cb126-343"><a href="#cb126-343" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight, <span class="at">main =</span> <span class="st">"lm()"</span>)</span>
<span id="cb126-344"><a href="#cb126-344" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mI, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb126-345"><a href="#cb126-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-346"><a href="#cb126-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-347"><a href="#cb126-347" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb126-348"><a href="#cb126-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-349"><a href="#cb126-349" aria-hidden="true" tabindex="-1"></a>Using the zombie apocalypse survivors dataset, try the following...</span>
<span id="cb126-350"><a href="#cb126-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-351"><a href="#cb126-351" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plot survivor height as a function of age</span>
<span id="cb126-352"><a href="#cb126-352" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Derive by hand the ordinary least squares regression coefficients $\beta_1$ and $\beta_0$ for these data</span>
<span id="cb126-353"><a href="#cb126-353" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Confirm that you get the same results using the <span class="in">`lm()`</span> function</span>
<span id="cb126-354"><a href="#cb126-354" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Repeat the analysis above for males and females separately</span>
<span id="cb126-355"><a href="#cb126-355" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Do your regression coefficients differ by sex? How might you determine this?</span>
<span id="cb126-356"><a href="#cb126-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-359"><a href="#cb126-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-360"><a href="#cb126-360" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb126-361"><a href="#cb126-361" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age)</span>
<span id="cb126-362"><a href="#cb126-362" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb126-363"><a href="#cb126-363" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">cor</span>(d<span class="sc">$</span>height, d<span class="sc">$</span>age) <span class="sc">*</span> <span class="fu">sd</span>(d<span class="sc">$</span>height) <span class="sc">/</span> <span class="fu">sd</span>(d<span class="sc">$</span>age)</span>
<span id="cb126-364"><a href="#cb126-364" aria-hidden="true" tabindex="-1"></a>beta1</span>
<span id="cb126-365"><a href="#cb126-365" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(d<span class="sc">$</span>height) <span class="sc">-</span> beta1 <span class="sc">*</span> <span class="fu">mean</span>(d<span class="sc">$</span>age)</span>
<span id="cb126-366"><a href="#cb126-366" aria-hidden="true" tabindex="-1"></a>beta0</span>
<span id="cb126-367"><a href="#cb126-367" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> age, <span class="at">data =</span> d))</span>
<span id="cb126-368"><a href="#cb126-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-369"><a href="#cb126-369" aria-hidden="true" tabindex="-1"></a>males <span class="ot">&lt;-</span> <span class="fu">filter</span>(d, gender <span class="sc">==</span> <span class="st">"Male"</span>)</span>
<span id="cb126-370"><a href="#cb126-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-371"><a href="#cb126-371" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> age, <span class="at">data =</span> males))</span>
<span id="cb126-372"><a href="#cb126-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-373"><a href="#cb126-373" aria-hidden="true" tabindex="-1"></a>females <span class="ot">&lt;-</span>  <span class="fu">filter</span>(d, gender <span class="sc">==</span> <span class="st">"Female"</span>)</span>
<span id="cb126-374"><a href="#cb126-374" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> age, <span class="at">data =</span> females))</span>
<span id="cb126-375"><a href="#cb126-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-376"><a href="#cb126-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-377"><a href="#cb126-377" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inference in Regression</span></span>
<span id="cb126-378"><a href="#cb126-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-379"><a href="#cb126-379" aria-hidden="true" tabindex="-1"></a><span class="fu">### Classical Theory-Based Inference {.unnumbered}</span></span>
<span id="cb126-380"><a href="#cb126-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-381"><a href="#cb126-381" aria-hidden="true" tabindex="-1"></a>Once we have our linear model and associated regression coefficients, we want to know a bit more about the model. First, we want to be able to evaluate whether there is **statistical evidence** that there is indeed a relationship between these variables. If so, then our regression coefficients can indeed allow us to estimate or predict the value of one variable given another. Additionally, we also would like to be able to extend our estimates from our sample out to the population they are drawn from. These next steps involve the process of statistical inference.</span>
<span id="cb126-382"><a href="#cb126-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-383"><a href="#cb126-383" aria-hidden="true" tabindex="-1"></a>The output of the <span class="in">`lm()`</span> function provides a lot of information useful for inference. Run the command <span class="in">`summary()`</span> on the output of <span class="in">`lm(data = d, height ~ weight)`</span></span>
<span id="cb126-384"><a href="#cb126-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-387"><a href="#cb126-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-388"><a href="#cb126-388" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight)</span>
<span id="cb126-389"><a href="#cb126-389" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb126-390"><a href="#cb126-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-391"><a href="#cb126-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-392"><a href="#cb126-392" aria-hidden="true" tabindex="-1"></a>One of the outputs for the model, seen in the 2nd to last line in the output above, is the "R-squared" value, or the **coefficient of determination**, which is a summary of the total amount of variation in the **y** variable that is explained by the **x** variable. In our regression, ~69% of the variation in zombie height is explained by zombie weight.</span>
<span id="cb126-393"><a href="#cb126-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-394"><a href="#cb126-394" aria-hidden="true" tabindex="-1"></a>Another output is the **standard error** of the estimate of each regression coefficient, along with a corresponding **t value** and **p value**. Recall that t statistics are calculated as the difference between an observed and expected value divided by a standard error. The p value comes from evaluating the magnitude of the t statistic against a t distribution with **n-2** degrees of freedom. That is, we can calculate p values mathematically for our statistics (the regression slope and intercept) if the sampling distribution of these statistics conform to a t distribution.</span>
<span id="cb126-395"><a href="#cb126-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-396"><a href="#cb126-396" aria-hidden="true" tabindex="-1"></a>As we saw above, running the <span class="in">`tidy()`</span> function from the {broom} package pulls out a clean table of the relevant information.</span>
<span id="cb126-397"><a href="#cb126-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-400"><a href="#cb126-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-401"><a href="#cb126-401" aria-hidden="true" tabindex="-1"></a>m.summary <span class="ot">&lt;-</span> <span class="fu">tidy</span>(m)</span>
<span id="cb126-402"><a href="#cb126-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-403"><a href="#cb126-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-404"><a href="#cb126-404" aria-hidden="true" tabindex="-1"></a>We can confirm the t statistic and p value output by <span class="in">`lm()`</span> by hand by calculating t and p based on the regression coefficient estimates and the standard errors of those estimates. The t statistic is simply the value of the estimated regression coefficient divided by the estimate of the standard error for that coefficient (i.e., $\beta/SE_\beta$)</span>
<span id="cb126-405"><a href="#cb126-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-408"><a href="#cb126-408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-409"><a href="#cb126-409" aria-hidden="true" tabindex="-1"></a>m.summary<span class="sc">$</span>calc.statistic <span class="ot">&lt;-</span> (m.summary<span class="sc">$</span>estimate <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> m.summary<span class="sc">$</span>std.error</span>
<span id="cb126-410"><a href="#cb126-410" aria-hidden="true" tabindex="-1"></a>m.summary<span class="sc">$</span>calc.p.value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(m.summary<span class="sc">$</span>calc.statistic,</span>
<span id="cb126-411"><a href="#cb126-411" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">df =</span> <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>,</span>
<span id="cb126-412"><a href="#cb126-412" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb126-413"><a href="#cb126-413" aria-hidden="true" tabindex="-1"></a><span class="co"># we use 2 * pt to get the 2-tailed p value</span></span>
<span id="cb126-414"><a href="#cb126-414" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively, we could do...</span></span>
<span id="cb126-415"><a href="#cb126-415" aria-hidden="true" tabindex="-1"></a><span class="co"># m.summary$calc.p.value &lt;- pt(-1*abs(m.summary$calc.statistic),</span></span>
<span id="cb126-416"><a href="#cb126-416" aria-hidden="true" tabindex="-1"></a><span class="co">#   df = nrow(d) - 2, lower.tail = TRUE) +</span></span>
<span id="cb126-417"><a href="#cb126-417" aria-hidden="true" tabindex="-1"></a><span class="co">#   pt(abs(m.summary$calc.statistic), df = nrow(d) - 2,</span></span>
<span id="cb126-418"><a href="#cb126-418" aria-hidden="true" tabindex="-1"></a><span class="co">#   lower.tail = FALSE)</span></span>
<span id="cb126-419"><a href="#cb126-419" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb126-420"><a href="#cb126-420" aria-hidden="true" tabindex="-1"></a><span class="co"># m.summary$calc.p.value &lt;- pt(-1*abs(m.summary$calc.statistic),</span></span>
<span id="cb126-421"><a href="#cb126-421" aria-hidden="true" tabindex="-1"></a><span class="co">#   df = nrow(d) - 2, lower.tail = TRUE) +</span></span>
<span id="cb126-422"><a href="#cb126-422" aria-hidden="true" tabindex="-1"></a><span class="co">#   (1-pt(abs(m.summary$calc.statistic), df = nrow(d) - 2,</span></span>
<span id="cb126-423"><a href="#cb126-423" aria-hidden="true" tabindex="-1"></a><span class="co">#   lower.tail = TRUE))</span></span>
<span id="cb126-424"><a href="#cb126-424" aria-hidden="true" tabindex="-1"></a>m.summary</span>
<span id="cb126-425"><a href="#cb126-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-426"><a href="#cb126-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-427"><a href="#cb126-427" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`glance()`</span> function also returns other information of interest about a regression model.</span>
<span id="cb126-428"><a href="#cb126-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-431"><a href="#cb126-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-432"><a href="#cb126-432" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(m)</span>
<span id="cb126-433"><a href="#cb126-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-434"><a href="#cb126-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-435"><a href="#cb126-435" aria-hidden="true" tabindex="-1"></a>We can get t distribution-based confidence intervals for our estimates easily, too, using either the by-hand approach we've used before or by using a built-in function.</span>
<span id="cb126-436"><a href="#cb126-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-439"><a href="#cb126-439" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-440"><a href="#cb126-440" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb126-441"><a href="#cb126-441" aria-hidden="true" tabindex="-1"></a><span class="co"># extract CIs from the model with</span></span>
<span id="cb126-442"><a href="#cb126-442" aria-hidden="true" tabindex="-1"></a><span class="co"># using the results of lm()</span></span>
<span id="cb126-443"><a href="#cb126-443" aria-hidden="true" tabindex="-1"></a>(CI <span class="ot">&lt;-</span> <span class="fu">confint</span>(m, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha))</span>
<span id="cb126-444"><a href="#cb126-444" aria-hidden="true" tabindex="-1"></a><span class="co"># using tidy()</span></span>
<span id="cb126-445"><a href="#cb126-445" aria-hidden="true" tabindex="-1"></a>(CI <span class="ot">&lt;-</span> <span class="fu">tidy</span>(m, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="dv">1</span><span class="sc">-</span> alpha))</span>
<span id="cb126-446"><a href="#cb126-446" aria-hidden="true" tabindex="-1"></a><span class="co"># by hand</span></span>
<span id="cb126-447"><a href="#cb126-447" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> m.summary<span class="sc">$</span>estimate <span class="sc">-</span></span>
<span id="cb126-448"><a href="#cb126-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> m.summary<span class="sc">$</span>std.error</span>
<span id="cb126-449"><a href="#cb126-449" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> m.summary<span class="sc">$</span>estimate <span class="sc">+</span></span>
<span id="cb126-450"><a href="#cb126-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> m.summary<span class="sc">$</span>std.error</span>
<span id="cb126-451"><a href="#cb126-451" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lower, upper)</span>
<span id="cb126-452"><a href="#cb126-452" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(CI) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"weight"</span>)</span>
<span id="cb126-453"><a href="#cb126-453" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(CI) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="fu">as.character</span>(alpha<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">100</span>), <span class="st">" %"</span>),<span class="fu">paste0</span>(<span class="fu">as.character</span>((<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>), <span class="st">" %"</span>))</span>
<span id="cb126-454"><a href="#cb126-454" aria-hidden="true" tabindex="-1"></a>CI</span>
<span id="cb126-455"><a href="#cb126-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-456"><a href="#cb126-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-457"><a href="#cb126-457" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Remember that these mathematical methods of calculating p values and CIs are only valid if the **LINE** technical conditions for linear regression are met. These conditions are:</span></span>
<span id="cb126-458"><a href="#cb126-458" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb126-459"><a href="#cb126-459" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - **L**inearity of the relationship between the explanatory and response variables</span></span>
<span id="cb126-460"><a href="#cb126-460" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - **I**ndependence of observations and their residuals</span></span>
<span id="cb126-461"><a href="#cb126-461" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - **N**ormality of the residual values of the response variable around the regression line</span></span>
<span id="cb126-462"><a href="#cb126-462" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - **E**quality of the variance in residual values across the range of explanatory variable values</span></span>
<span id="cb126-463"><a href="#cb126-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-464"><a href="#cb126-464" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simulation-Based Inference {.unnumbered}</span></span>
<span id="cb126-465"><a href="#cb126-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-466"><a href="#cb126-466" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Significance of Coefficients by Permutation {.unnumbered}</span></span>
<span id="cb126-467"><a href="#cb126-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-468"><a href="#cb126-468" aria-hidden="true" tabindex="-1"></a>As we saw in <span class="co">[</span><span class="ot">**Module 16**</span><span class="co">](#module-16)</span>, the {infer} package offers a convenient set of functions and a standard workflow for using permutation methods for statistical hypothesis testing, rather than relying on mathematical assumptions. In that module, we considered whether means, differences between means, proportions, or differences in proportions differed from what we would expect under a particular null hypothesis... and we can apply the same workflow to evaluating regression coefficients! The permutation approach lets us relax the **normality** condition of the **LINE** assumptions for linear regression. To demonstrate this process, we will run the same model of **height** ~ **weight** using the zombie apocalypse survivors dataset that we ran above:</span>
<span id="cb126-469"><a href="#cb126-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-470"><a href="#cb126-470" aria-hidden="true" tabindex="-1"></a>First, we run the model and pull out $\beta_1$, the regression slope, and its estimated standard error:</span>
<span id="cb126-471"><a href="#cb126-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-474"><a href="#cb126-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-475"><a href="#cb126-475" aria-hidden="true" tabindex="-1"></a><span class="co"># first define alpha, CI boundaries, and critical values</span></span>
<span id="cb126-476"><a href="#cb126-476" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb126-477"><a href="#cb126-477" aria-hidden="true" tabindex="-1"></a>confidence_level <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> alpha</span>
<span id="cb126-478"><a href="#cb126-478" aria-hidden="true" tabindex="-1"></a>p_lower <span class="ot">&lt;-</span> alpha <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb126-479"><a href="#cb126-479" aria-hidden="true" tabindex="-1"></a>p_upper <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (alpha <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb126-480"><a href="#cb126-480" aria-hidden="true" tabindex="-1"></a>degrees_of_freedom <span class="ot">&lt;-</span> <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb126-481"><a href="#cb126-481" aria-hidden="true" tabindex="-1"></a>critical_value <span class="ot">&lt;-</span> <span class="fu">qt</span>(p_upper, <span class="at">df =</span> degrees_of_freedom)</span>
<span id="cb126-482"><a href="#cb126-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-483"><a href="#cb126-483" aria-hidden="true" tabindex="-1"></a><span class="co"># original slope</span></span>
<span id="cb126-484"><a href="#cb126-484" aria-hidden="true" tabindex="-1"></a>original.slope <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight) <span class="sc">|&gt;</span></span>
<span id="cb126-485"><a href="#cb126-485" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tidy the model and add the CI based on the t distribution</span></span>
<span id="cb126-486"><a href="#cb126-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.level=</span>confidence_level) <span class="sc">|&gt;</span></span>
<span id="cb126-487"><a href="#cb126-487" aria-hidden="true" tabindex="-1"></a>  <span class="co"># or manually calculate the CI based on the t distribution</span></span>
<span id="cb126-488"><a href="#cb126-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb126-489"><a href="#cb126-489" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> estimate <span class="sc">-</span> std.error <span class="sc">*</span> critical_value,</span>
<span id="cb126-490"><a href="#cb126-490" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> estimate <span class="sc">+</span> std.error <span class="sc">*</span> critical_value</span>
<span id="cb126-491"><a href="#cb126-491" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb126-492"><a href="#cb126-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"weight"</span>)</span>
<span id="cb126-493"><a href="#cb126-493" aria-hidden="true" tabindex="-1"></a>original.slope <span class="co"># show model results for slope of weight</span></span>
<span id="cb126-494"><a href="#cb126-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-495"><a href="#cb126-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-496"><a href="#cb126-496" aria-hidden="true" tabindex="-1"></a>We can generate a null distribution for our slope estimates via permutation using {infer} package functions... essentially, each permutation involves randomly shuffling values of the response variable under the null hypothesis such that they are independent of the explanatory variable (and vice versa).</span>
<span id="cb126-497"><a href="#cb126-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-500"><a href="#cb126-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-501"><a href="#cb126-501" aria-hidden="true" tabindex="-1"></a>permuted.slope <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb126-502"><a href="#cb126-502" aria-hidden="true" tabindex="-1"></a>  <span class="co"># specify model</span></span>
<span id="cb126-503"><a href="#cb126-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(height <span class="sc">~</span> weight) <span class="sc">|&gt;</span></span>
<span id="cb126-504"><a href="#cb126-504" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use a null hypothesis of independence</span></span>
<span id="cb126-505"><a href="#cb126-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb126-506"><a href="#cb126-506" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate permutation replicates</span></span>
<span id="cb126-507"><a href="#cb126-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="cb126-508"><a href="#cb126-508" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the slope statistic</span></span>
<span id="cb126-509"><a href="#cb126-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"slope"</span>)</span>
<span id="cb126-510"><a href="#cb126-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-511"><a href="#cb126-511" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(permuted.slope) <span class="co"># slopes from first few permutation replicates</span></span>
<span id="cb126-512"><a href="#cb126-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-513"><a href="#cb126-513" aria-hidden="true" tabindex="-1"></a><span class="co"># create confidence intervals</span></span>
<span id="cb126-514"><a href="#cb126-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-515"><a href="#cb126-515" aria-hidden="true" tabindex="-1"></a>permuted.slope.summary <span class="ot">&lt;-</span> permuted.slope <span class="sc">|&gt;</span></span>
<span id="cb126-516"><a href="#cb126-516" aria-hidden="true" tabindex="-1"></a>  <span class="co"># summarize the mean (which should be very close to zero), standard error,</span></span>
<span id="cb126-517"><a href="#cb126-517" aria-hidden="true" tabindex="-1"></a>  <span class="co"># CI based on the SE and t distribution, and CI based on the quantile (percentile) method</span></span>
<span id="cb126-518"><a href="#cb126-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb126-519"><a href="#cb126-519" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">mean</span>(stat),</span>
<span id="cb126-520"><a href="#cb126-520" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fu">sd</span>(stat),</span>
<span id="cb126-521"><a href="#cb126-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> estimate <span class="sc">-</span> std.error <span class="sc">*</span> critical_value,</span>
<span id="cb126-522"><a href="#cb126-522" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> estimate <span class="sc">+</span> std.error <span class="sc">*</span> critical_value,</span>
<span id="cb126-523"><a href="#cb126-523" aria-hidden="true" tabindex="-1"></a>    <span class="at">perm.lower =</span> <span class="fu">quantile</span>(stat, p_lower),</span>
<span id="cb126-524"><a href="#cb126-524" aria-hidden="true" tabindex="-1"></a>    <span class="at">perm.upper =</span> <span class="fu">quantile</span>(stat, p_upper)</span>
<span id="cb126-525"><a href="#cb126-525" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-526"><a href="#cb126-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-527"><a href="#cb126-527" aria-hidden="true" tabindex="-1"></a><span class="co"># show summary of permuted sampling distribution</span></span>
<span id="cb126-528"><a href="#cb126-528" aria-hidden="true" tabindex="-1"></a>permuted.slope.summary</span>
<span id="cb126-529"><a href="#cb126-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-530"><a href="#cb126-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-531"><a href="#cb126-531" aria-hidden="true" tabindex="-1"></a>The <span class="in">`get_ci()`</span> function from {infer} can be used to return these different types of confidence intervals, too... i.e., either based on the standard error of the permutation distribution or actual quantiles from that distribution.</span>
<span id="cb126-532"><a href="#cb126-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-535"><a href="#cb126-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-536"><a href="#cb126-536" aria-hidden="true" tabindex="-1"></a><span class="fu">get_ci</span>(permuted.slope, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">type =</span> <span class="st">"percentile"</span>)</span>
<span id="cb126-537"><a href="#cb126-537" aria-hidden="true" tabindex="-1"></a><span class="fu">get_ci</span>(permuted.slope, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">type =</span> <span class="st">"se"</span>,</span>
<span id="cb126-538"><a href="#cb126-538" aria-hidden="true" tabindex="-1"></a>  <span class="at">point_estimate =</span> <span class="fu">pull</span>(permuted.slope.summary, estimate)</span>
<span id="cb126-539"><a href="#cb126-539" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb126-540"><a href="#cb126-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-541"><a href="#cb126-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-542"><a href="#cb126-542" aria-hidden="true" tabindex="-1"></a>We can also visualize the null distribution of slope coefficients based on permutation and superimpose our actual slope coefficient.</span>
<span id="cb126-543"><a href="#cb126-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-546"><a href="#cb126-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-547"><a href="#cb126-547" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the null distribution based on permutation</span></span>
<span id="cb126-548"><a href="#cb126-548" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(permuted.slope<span class="sc">$</span>stat, <span class="at">main=</span><span class="st">"Histogram of Permuted</span><span class="sc">\n</span><span class="st">Slope Values"</span>,</span>
<span id="cb126-549"><a href="#cb126-549" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Slope Coefficient"</span>)</span>
<span id="cb126-550"><a href="#cb126-550" aria-hidden="true" tabindex="-1"></a><span class="co"># or using `visualize()` from {infer}</span></span>
<span id="cb126-551"><a href="#cb126-551" aria-hidden="true" tabindex="-1"></a><span class="fu">visualize</span>(permuted.slope) <span class="sc">+</span></span>
<span id="cb126-552"><a href="#cb126-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> original.slope<span class="sc">$</span>estimate, <span class="at">direction =</span> <span class="st">"two_sided"</span>)</span>
<span id="cb126-553"><a href="#cb126-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-554"><a href="#cb126-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-555"><a href="#cb126-555" aria-hidden="true" tabindex="-1"></a>Finally, to determine the two-sided p value associated with our observed slope coefficient, we determine the proportion of permuted simulations that yielded a slope estimate as great or greater than the the one based on our original data:</span>
<span id="cb126-556"><a href="#cb126-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-559"><a href="#cb126-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-560"><a href="#cb126-560" aria-hidden="true" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> permuted.slope <span class="sc">|&gt;</span> </span>
<span id="cb126-561"><a href="#cb126-561" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a column of the absolute value of the slope</span></span>
<span id="cb126-562"><a href="#cb126-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">abs_stat=</span><span class="fu">abs</span>(stat)) <span class="sc">|&gt;</span></span>
<span id="cb126-563"><a href="#cb126-563" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate a summary statistic as the proportion of cases where the</span></span>
<span id="cb126-564"><a href="#cb126-564" aria-hidden="true" tabindex="-1"></a>  <span class="co"># absolute value of the permuted slope is greater than or equal to the </span></span>
<span id="cb126-565"><a href="#cb126-565" aria-hidden="true" tabindex="-1"></a>  <span class="co"># absolute value of the observed slope</span></span>
<span id="cb126-566"><a href="#cb126-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb126-567"><a href="#cb126-567" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">mean</span>(abs_stat <span class="sc">&gt;=</span> <span class="fu">abs</span>(<span class="fu">pull</span>(original.slope, estimate)))</span>
<span id="cb126-568"><a href="#cb126-568" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-569"><a href="#cb126-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-570"><a href="#cb126-570" aria-hidden="true" tabindex="-1"></a>p.value</span>
<span id="cb126-571"><a href="#cb126-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-572"><a href="#cb126-572" aria-hidden="true" tabindex="-1"></a><span class="co"># the function `get_p_value()` returns this value directly...</span></span>
<span id="cb126-573"><a href="#cb126-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-574"><a href="#cb126-574" aria-hidden="true" tabindex="-1"></a>(p.value <span class="ot">&lt;-</span> permuted.slope <span class="sc">|&gt;</span></span>
<span id="cb126-575"><a href="#cb126-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> original.slope<span class="sc">$</span>estimate, <span class="at">direction=</span><span class="st">"two_sided"</span>))</span>
<span id="cb126-576"><a href="#cb126-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-577"><a href="#cb126-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-578"><a href="#cb126-578" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CIs for Coefficients by Bootstrapping {.unnumbered}</span></span>
<span id="cb126-579"><a href="#cb126-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-580"><a href="#cb126-580" aria-hidden="true" tabindex="-1"></a>We can also use the {infer} package to generate CIs around our regression coefficient estimates using bootstrapping.</span>
<span id="cb126-581"><a href="#cb126-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-584"><a href="#cb126-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-585"><a href="#cb126-585" aria-hidden="true" tabindex="-1"></a>boot.slope <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb126-586"><a href="#cb126-586" aria-hidden="true" tabindex="-1"></a>  <span class="co"># specify model</span></span>
<span id="cb126-587"><a href="#cb126-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(height <span class="sc">~</span> weight) <span class="sc">|&gt;</span></span>
<span id="cb126-588"><a href="#cb126-588" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate bootstrap replicates</span></span>
<span id="cb126-589"><a href="#cb126-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"bootstrap"</span>) <span class="sc">|&gt;</span></span>
<span id="cb126-590"><a href="#cb126-590" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the slope statistic</span></span>
<span id="cb126-591"><a href="#cb126-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"slope"</span>)</span>
<span id="cb126-592"><a href="#cb126-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-593"><a href="#cb126-593" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(boot.slope) <span class="co"># slopes from first few bootstrap replicates</span></span>
<span id="cb126-594"><a href="#cb126-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-595"><a href="#cb126-595" aria-hidden="true" tabindex="-1"></a><span class="co"># create confidence intervals for regression coefficients</span></span>
<span id="cb126-596"><a href="#cb126-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-597"><a href="#cb126-597" aria-hidden="true" tabindex="-1"></a>boot.slope.summary <span class="ot">&lt;-</span> boot.slope <span class="sc">|&gt;</span></span>
<span id="cb126-598"><a href="#cb126-598" aria-hidden="true" tabindex="-1"></a>  <span class="co"># summarize the mean, standard error, CI based on the SE and t distribution,</span></span>
<span id="cb126-599"><a href="#cb126-599" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and CI based on the quantile (percentile) method</span></span>
<span id="cb126-600"><a href="#cb126-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb126-601"><a href="#cb126-601" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">mean</span>(stat),</span>
<span id="cb126-602"><a href="#cb126-602" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fu">sd</span>(stat),</span>
<span id="cb126-603"><a href="#cb126-603" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> estimate <span class="sc">-</span> std.error <span class="sc">*</span> critical_value,</span>
<span id="cb126-604"><a href="#cb126-604" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> estimate <span class="sc">+</span> std.error <span class="sc">*</span> critical_value,</span>
<span id="cb126-605"><a href="#cb126-605" aria-hidden="true" tabindex="-1"></a>    <span class="at">boot.lower =</span> <span class="fu">quantile</span>(stat, p_lower),</span>
<span id="cb126-606"><a href="#cb126-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">boot.upper =</span> <span class="fu">quantile</span>(stat, p_upper)</span>
<span id="cb126-607"><a href="#cb126-607" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-608"><a href="#cb126-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-609"><a href="#cb126-609" aria-hidden="true" tabindex="-1"></a><span class="co"># show summary of bootstrap sampling distribution</span></span>
<span id="cb126-610"><a href="#cb126-610" aria-hidden="true" tabindex="-1"></a>boot.slope.summary</span>
<span id="cb126-611"><a href="#cb126-611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-612"><a href="#cb126-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-613"><a href="#cb126-613" aria-hidden="true" tabindex="-1"></a>Again, the <span class="in">`get_ci()`</span> function from {infer} can be used to return these different types of confidence intervals...</span>
<span id="cb126-614"><a href="#cb126-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-617"><a href="#cb126-617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-618"><a href="#cb126-618" aria-hidden="true" tabindex="-1"></a>CI.percentile <span class="ot">&lt;-</span> <span class="fu">get_ci</span>(boot.slope, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">type =</span> <span class="st">"percentile"</span>)</span>
<span id="cb126-619"><a href="#cb126-619" aria-hidden="true" tabindex="-1"></a>CI.theory <span class="ot">&lt;-</span> <span class="fu">get_ci</span>(boot.slope, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">type =</span> <span class="st">"se"</span>,</span>
<span id="cb126-620"><a href="#cb126-620" aria-hidden="true" tabindex="-1"></a>  <span class="at">point_estimate =</span> <span class="fu">pull</span>(boot.slope.summary, estimate)</span>
<span id="cb126-621"><a href="#cb126-621" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb126-622"><a href="#cb126-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-623"><a href="#cb126-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-624"><a href="#cb126-624" aria-hidden="true" tabindex="-1"></a>We can also easily visualize the sampling distribution (and CI) based on bootstrapping.</span>
<span id="cb126-625"><a href="#cb126-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-628"><a href="#cb126-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-629"><a href="#cb126-629" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the sampling distribution for based on bootstrapping plus a CI</span></span>
<span id="cb126-630"><a href="#cb126-630" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot.slope<span class="sc">$</span>stat, <span class="at">main =</span> <span class="st">"Histogram of Bootstrapped</span><span class="sc">\n</span><span class="st">Slope Values"</span>,</span>
<span id="cb126-631"><a href="#cb126-631" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Slope Coefficient"</span>)</span>
<span id="cb126-632"><a href="#cb126-632" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> CI.percentile)</span>
<span id="cb126-633"><a href="#cb126-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-634"><a href="#cb126-634" aria-hidden="true" tabindex="-1"></a><span class="co"># or...</span></span>
<span id="cb126-635"><a href="#cb126-635" aria-hidden="true" tabindex="-1"></a><span class="fu">visualize</span>(boot.slope) <span class="sc">+</span></span>
<span id="cb126-636"><a href="#cb126-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_ci</span>(<span class="at">endpoints =</span> CI.percentile)</span>
<span id="cb126-637"><a href="#cb126-637" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-638"><a href="#cb126-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-639"><a href="#cb126-639" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpreting Regression Results</span></span>
<span id="cb126-640"><a href="#cb126-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-641"><a href="#cb126-641" aria-hidden="true" tabindex="-1"></a>As shown above, estimating our regression coefficients is pretty straightforward. But what do they mean? How do we interpret them?</span>
<span id="cb126-642"><a href="#cb126-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-643"><a href="#cb126-643" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The intercept, $\beta_0$, is the PREDICTED value of $y$, our response variable, when the value of $x$, our explanatory variable, is zero.</span>
<span id="cb126-644"><a href="#cb126-644" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The slope, $\beta_1$ is EXPECTED CHANGE in units of $y$ for every 1 unit of change in $x$.</span>
<span id="cb126-645"><a href="#cb126-645" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The overall equation allows us to calculate PREDICTED values of $y$ for new observations of $x$. We can also calculate CONFIDENCE INTERVALS (CIs) around the predicted mean value of $y$ for each value of $x$ (which addresses our uncertainly in the estimate of the mean), and we can get PREDICTION INTERVALS (PIs) around our prediction (which gives the range of actual values of $y$ that we might expect to see at a given value of $x$). That is, for each value of $x$, we can calculate a CI, which is the the range of values into which $\hat{y}$ is expected to fall 95% of the time, and a PI, which is the range of y values into which 95% of predicted individual y values are expected to fall.</span>
<span id="cb126-646"><a href="#cb126-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-647"><a href="#cb126-647" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb126-648"><a href="#cb126-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-649"><a href="#cb126-649" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If zombie apocalypse survivor weight is measured in *pounds* and zombie apocalypse survivor height is measured in *inches*, what is the expected height of a survivor weighing 150 pounds?</span>
<span id="cb126-650"><a href="#cb126-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-653"><a href="#cb126-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-654"><a href="#cb126-654" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb126-655"><a href="#cb126-655" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb126-656"><a href="#cb126-656" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb126-657"><a href="#cb126-657" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> m.summary <span class="sc">|&gt;</span> <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(estimate)</span>
<span id="cb126-658"><a href="#cb126-658" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> m.summary <span class="sc">|&gt;</span> <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"weight"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(estimate)</span>
<span id="cb126-659"><a href="#cb126-659" aria-hidden="true" tabindex="-1"></a>(h.hat <span class="ot">&lt;-</span> beta1 <span class="sc">*</span> <span class="dv">150</span> <span class="sc">+</span> beta0)</span>
<span id="cb126-660"><a href="#cb126-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-661"><a href="#cb126-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-662"><a href="#cb126-662" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the predicted difference in height between a survivor weighing 180 and 220 pounds?</span>
<span id="cb126-663"><a href="#cb126-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-666"><a href="#cb126-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-667"><a href="#cb126-667" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb126-668"><a href="#cb126-668" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb126-669"><a href="#cb126-669" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb126-670"><a href="#cb126-670" aria-hidden="true" tabindex="-1"></a>(h.hat.difference <span class="ot">&lt;-</span> (beta1 <span class="sc">*</span> <span class="dv">220</span> <span class="sc">+</span> beta0) <span class="sc">-</span> (beta1 <span class="sc">*</span> <span class="dv">180</span> <span class="sc">+</span> beta0))</span>
<span id="cb126-671"><a href="#cb126-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-672"><a href="#cb126-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-673"><a href="#cb126-673" aria-hidden="true" tabindex="-1"></a><span class="fu">### Predicted Values {.unnumbered}</span></span>
<span id="cb126-674"><a href="#cb126-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-675"><a href="#cb126-675" aria-hidden="true" tabindex="-1"></a>The <span class="in">`predict()`</span> function allows us to generate predicted (i.e., $\hat{y}$) values for a vector of values of **x**. Note the structure of the 2nd argument in the function, `newdata=`... it has to be a data frame and include the variable name(s) we are going to use to predict **y** on the basis of. Here, we pass it a vector of actual **x** values.</span>
<span id="cb126-676"><a href="#cb126-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-679"><a href="#cb126-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-680"><a href="#cb126-680" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> weight)</span>
<span id="cb126-681"><a href="#cb126-681" aria-hidden="true" tabindex="-1"></a>y.hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> d<span class="sc">$</span>weight))</span>
<span id="cb126-682"><a href="#cb126-682" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(d<span class="sc">$</span>weight, d<span class="sc">$</span>height, y.hat))</span>
<span id="cb126-683"><a href="#cb126-683" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"yhat"</span>)</span>
<span id="cb126-684"><a href="#cb126-684" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb126-685"><a href="#cb126-685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-686"><a href="#cb126-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-687"><a href="#cb126-687" aria-hidden="true" tabindex="-1"></a>The <span class="in">`augment()`</span> function from {broom} also generates comparable predicted or "fitted" values for a model. With default arguments, it generates .fitted and .resid values for the original data and can also calculate .se.fit values (standard errors around the fitted values) by setting <span class="in">`se_fit=TRUE`</span> (it is <span class="in">`FALSE`</span> by default). With the <span class="in">`newdata=`</span> argument, it generates .fitted values for novel data. As for <span class="in">`predict()`</span>, the <span class="in">`newdata=`</span> argument has to be a data frame and include the predictor variable name(s).</span>
<span id="cb126-688"><a href="#cb126-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-691"><a href="#cb126-691" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-692"><a href="#cb126-692" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">augment</span>(m, <span class="at">se_fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-693"><a href="#cb126-693" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb126-694"><a href="#cb126-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-695"><a href="#cb126-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-698"><a href="#cb126-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-699"><a href="#cb126-699" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> .fitted))</span>
<span id="cb126-700"><a href="#cb126-700" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.25</span>)</span>
<span id="cb126-701"><a href="#cb126-701" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb126-702"><a href="#cb126-702" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> .fitted, <span class="at">xend =</span> weight, <span class="at">yend =</span> height),</span>
<span id="cb126-703"><a href="#cb126-703" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.25</span>)</span>
<span id="cb126-704"><a href="#cb126-704" aria-hidden="true" tabindex="-1"></a>g</span>
<span id="cb126-705"><a href="#cb126-705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-706"><a href="#cb126-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-707"><a href="#cb126-707" aria-hidden="true" tabindex="-1"></a>Each vertical line in the figure above represents a **residual**, the difference between the observed and the fitted or predicted value of $y$ ($\hat{y}$) at the given $x$ value.</span>
<span id="cb126-708"><a href="#cb126-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-709"><a href="#cb126-709" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confidence Intervals around Predicted Means {.unnumbered}</span></span>
<span id="cb126-710"><a href="#cb126-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-711"><a href="#cb126-711" aria-hidden="true" tabindex="-1"></a>The <span class="in">`predict()`</span> function also allows us to easily generate *confidence intervals* around our predicted $\hat{y}$ values.</span>
<span id="cb126-712"><a href="#cb126-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-715"><a href="#cb126-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-716"><a href="#cb126-716" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> <span class="dv">150</span>),</span>
<span id="cb126-717"><a href="#cb126-717" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha) <span class="co"># for a single value</span></span>
<span id="cb126-718"><a href="#cb126-718" aria-hidden="true" tabindex="-1"></a>ci</span>
<span id="cb126-719"><a href="#cb126-719" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">weight=</span>d<span class="sc">$</span>weight),</span>
<span id="cb126-720"><a href="#cb126-720" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha) <span class="co"># for a vector of values</span></span>
<span id="cb126-721"><a href="#cb126-721" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ci)</span>
<span id="cb126-722"><a href="#cb126-722" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df<span class="sc">$</span>weight, ci)</span>
<span id="cb126-723"><a href="#cb126-723" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ci) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"weight"</span>, <span class="st">"c.fit"</span>, <span class="st">"c.lwr"</span>, <span class="st">"c.upr"</span>)</span>
<span id="cb126-724"><a href="#cb126-724" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height))</span>
<span id="cb126-725"><a href="#cb126-725" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb126-726"><a href="#cb126-726" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> ci, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.fit),</span>
<span id="cb126-727"><a href="#cb126-727" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb126-728"><a href="#cb126-728" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> ci, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.lwr),</span>
<span id="cb126-729"><a href="#cb126-729" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb126-730"><a href="#cb126-730" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> ci, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.upr),</span>
<span id="cb126-731"><a href="#cb126-731" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb126-732"><a href="#cb126-732" aria-hidden="true" tabindex="-1"></a>g</span>
<span id="cb126-733"><a href="#cb126-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-734"><a href="#cb126-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-735"><a href="#cb126-735" aria-hidden="true" tabindex="-1"></a>This can be also be done by hand using the data from the <span class="in">`augment()`</span>ed model:</span>
<span id="cb126-736"><a href="#cb126-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-739"><a href="#cb126-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-740"><a href="#cb126-740" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb126-741"><a href="#cb126-741" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate a confidence interval for the predicted values</span></span>
<span id="cb126-742"><a href="#cb126-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb126-743"><a href="#cb126-743" aria-hidden="true" tabindex="-1"></a>    <span class="at">c.lwr =</span> .fitted <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(df) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> .se.fit,</span>
<span id="cb126-744"><a href="#cb126-744" aria-hidden="true" tabindex="-1"></a>    <span class="at">c.upr =</span> .fitted <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(df) <span class="sc">-</span><span class="dv">2</span>) <span class="sc">*</span> .se.fit</span>
<span id="cb126-745"><a href="#cb126-745" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-746"><a href="#cb126-746" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb126-747"><a href="#cb126-747" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height))</span>
<span id="cb126-748"><a href="#cb126-748" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb126-749"><a href="#cb126-749" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb126-750"><a href="#cb126-750" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.lwr), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb126-751"><a href="#cb126-751" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.upr), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb126-752"><a href="#cb126-752" aria-hidden="true" tabindex="-1"></a>g</span>
<span id="cb126-753"><a href="#cb126-753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-754"><a href="#cb126-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-755"><a href="#cb126-755" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prediction Intervals for Individual Responses {.unnumbered}</span></span>
<span id="cb126-756"><a href="#cb126-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-757"><a href="#cb126-757" aria-hidden="true" tabindex="-1"></a>The <span class="in">`predict()`</span> function also allows us to easily generate *prediction intervals* for the range of possible values of individual observations of $y$ (rather than the 95% CI around $\hat{y}$ at each $x$.</span>
<span id="cb126-758"><a href="#cb126-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-761"><a href="#cb126-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-762"><a href="#cb126-762" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> <span class="dv">150</span>),</span>
<span id="cb126-763"><a href="#cb126-763" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">"prediction"</span>, <span class="at">level=</span><span class="fl">0.95</span>) <span class="co"># for a single value</span></span>
<span id="cb126-764"><a href="#cb126-764" aria-hidden="true" tabindex="-1"></a>pi</span>
<span id="cb126-765"><a href="#cb126-765" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> d<span class="sc">$</span>weight),</span>
<span id="cb126-766"><a href="#cb126-766" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval=</span><span class="st">"prediction"</span>,<span class="at">level=</span><span class="fl">0.95</span>) <span class="co"># for a vector of values</span></span>
<span id="cb126-767"><a href="#cb126-767" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pi)</span>
<span id="cb126-768"><a href="#cb126-768" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(d<span class="sc">$</span>weight, pi)</span>
<span id="cb126-769"><a href="#cb126-769" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pi) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"weight"</span>, <span class="st">"p.fit"</span>, <span class="st">"p.lwr"</span>, <span class="st">"p.upr"</span>)</span>
<span id="cb126-770"><a href="#cb126-770" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data=</span>pi, <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">y=</span>p.lwr), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb126-771"><a href="#cb126-771" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data=</span>pi, <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">y=</span>p.upr), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb126-772"><a href="#cb126-772" aria-hidden="true" tabindex="-1"></a>g</span>
<span id="cb126-773"><a href="#cb126-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-774"><a href="#cb126-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-775"><a href="#cb126-775" aria-hidden="true" tabindex="-1"></a>Again, this can be also be done by hand using the data from the <span class="in">`augment()`</span>ed model:</span>
<span id="cb126-776"><a href="#cb126-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-779"><a href="#cb126-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-780"><a href="#cb126-780" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">glance</span>(m) <span class="sc">|&gt;</span> <span class="fu">pull</span>(sigma) <span class="co"># sd deviation of residuals</span></span>
<span id="cb126-781"><a href="#cb126-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-782"><a href="#cb126-782" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb126-783"><a href="#cb126-783" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate a confidence interval for the predicted values</span></span>
<span id="cb126-784"><a href="#cb126-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se.prediction =</span> <span class="fu">sqrt</span>(sd <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> .se.fit <span class="sc">^</span> <span class="dv">2</span>),</span>
<span id="cb126-785"><a href="#cb126-785" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.lower =</span> .fitted <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(df) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> se.prediction,</span>
<span id="cb126-786"><a href="#cb126-786" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.upper =</span> .fitted <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(df) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> se.prediction</span>
<span id="cb126-787"><a href="#cb126-787" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-788"><a href="#cb126-788" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height))</span>
<span id="cb126-789"><a href="#cb126-789" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb126-790"><a href="#cb126-790" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb126-791"><a href="#cb126-791" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.lwr), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb126-792"><a href="#cb126-792" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> c.upr), <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb126-793"><a href="#cb126-793" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> p.lower), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb126-794"><a href="#cb126-794" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> p.upper), <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb126-795"><a href="#cb126-795" aria-hidden="true" tabindex="-1"></a>g</span>
<span id="cb126-796"><a href="#cb126-796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-797"><a href="#cb126-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-798"><a href="#cb126-798" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb126-799"><a href="#cb126-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-800"><a href="#cb126-800" aria-hidden="true" tabindex="-1"></a>Construct a linear model using <span class="in">`lm()`</span> for the regression of zombie apocalypse survivor **height** on **age** and predict the mean height ($\hat{h}$). Then, use the <span class="in">`augment()`</span> and <span class="in">`mutate()`</span> or <span class="in">`predict()`</span> functions to calculate the t distribution-based 95% confidence interval (CI) around the predicted mean height and the 95% prediction interval (PI) for height for a vector of zombie ages, <span class="in">`v &lt;- seq(from=10, to=30, by=1)`</span>. Finally, plot your points, your regression line, and lines for the lower and upper limits of the CI and of the PI.</span>
<span id="cb126-801"><a href="#cb126-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-802"><a href="#cb126-802" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** The `augment()` and `predict()` functions work similarly, but whereas `predict()` returns a vector of fitted $y$ values for each $x$ value in **newdata**, `augment()` will return a dataframe of $x$s, fitted $y$s, and standard errors for the fitted $y$s. Helpfully, if the **newdata** argument is left out for </span><span class="in">`augment()`</span><span class="at">, the function will use the original dataset and simply add in the new fitted $y$, standard errors, etc.</span></span>
<span id="cb126-803"><a href="#cb126-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-806"><a href="#cb126-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-807"><a href="#cb126-807" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb126-808"><a href="#cb126-808" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb126-809"><a href="#cb126-809" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb126-810"><a href="#cb126-810" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb126-811"><a href="#cb126-811" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb126-812"><a href="#cb126-812" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> d, height <span class="sc">~</span> age)</span>
<span id="cb126-813"><a href="#cb126-813" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">glance</span>(m) <span class="sc">|&gt;</span></span>
<span id="cb126-814"><a href="#cb126-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sigma)</span>
<span id="cb126-815"><a href="#cb126-815" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">augment</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> v), <span class="at">se_fit =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb126-816"><a href="#cb126-816" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add CI</span></span>
<span id="cb126-817"><a href="#cb126-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb126-818"><a href="#cb126-818" aria-hidden="true" tabindex="-1"></a>    <span class="at">c.lower =</span> .fitted <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> .se.fit,</span>
<span id="cb126-819"><a href="#cb126-819" aria-hidden="true" tabindex="-1"></a>    <span class="at">c.upper =</span> .fitted <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(d) <span class="sc">-</span><span class="dv">2</span>) <span class="sc">*</span> .se.fit</span>
<span id="cb126-820"><a href="#cb126-820" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb126-821"><a href="#cb126-821" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add PI</span></span>
<span id="cb126-822"><a href="#cb126-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se.prediction =</span> <span class="fu">sqrt</span>(sd <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> .se.fit <span class="sc">^</span> <span class="dv">2</span>),</span>
<span id="cb126-823"><a href="#cb126-823" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.lower =</span> .fitted <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> se.prediction,</span>
<span id="cb126-824"><a href="#cb126-824" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.upper =</span> .fitted <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="fu">nrow</span>(d) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> se.prediction</span>
<span id="cb126-825"><a href="#cb126-825" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-826"><a href="#cb126-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-827"><a href="#cb126-827" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively...</span></span>
<span id="cb126-828"><a href="#cb126-828" aria-hidden="true" tabindex="-1"></a><span class="co"># ci &lt;- predict(m, newdata = data.frame(age = v),</span></span>
<span id="cb126-829"><a href="#cb126-829" aria-hidden="true" tabindex="-1"></a><span class="co">#    interval = "confidence", level = 1 - alpha)</span></span>
<span id="cb126-830"><a href="#cb126-830" aria-hidden="true" tabindex="-1"></a><span class="co">#  pi &lt;- predict(m, newdata = data.frame(age = v),</span></span>
<span id="cb126-831"><a href="#cb126-831" aria-hidden="true" tabindex="-1"></a><span class="co">#    interval = "prediction", 1 - alpha)</span></span>
<span id="cb126-832"><a href="#cb126-832" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">data=</span>d, height <span class="sc">~</span> age)</span>
<span id="cb126-833"><a href="#cb126-833" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> df<span class="sc">$</span>age,</span>
<span id="cb126-834"><a href="#cb126-834" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> df<span class="sc">$</span>.fitted,</span>
<span id="cb126-835"><a href="#cb126-835" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb126-836"><a href="#cb126-836" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> df<span class="sc">$</span>age,</span>
<span id="cb126-837"><a href="#cb126-837" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> df<span class="sc">$</span>c.lower,</span>
<span id="cb126-838"><a href="#cb126-838" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb126-839"><a href="#cb126-839" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> df<span class="sc">$</span>age,</span>
<span id="cb126-840"><a href="#cb126-840" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> df<span class="sc">$</span>c.upper,</span>
<span id="cb126-841"><a href="#cb126-841" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb126-842"><a href="#cb126-842" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> df<span class="sc">$</span>age,</span>
<span id="cb126-843"><a href="#cb126-843" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> df<span class="sc">$</span>p.lower,</span>
<span id="cb126-844"><a href="#cb126-844" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb126-845"><a href="#cb126-845" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> df<span class="sc">$</span>age,</span>
<span id="cb126-846"><a href="#cb126-846" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> df<span class="sc">$</span>p.upper,</span>
<span id="cb126-847"><a href="#cb126-847" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb126-848"><a href="#cb126-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-849"><a href="#cb126-849" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb126-850"><a href="#cb126-850" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height))</span>
<span id="cb126-851"><a href="#cb126-851" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb126-852"><a href="#cb126-852" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> .fitted),</span>
<span id="cb126-853"><a href="#cb126-853" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb126-854"><a href="#cb126-854" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> c.lower),</span>
<span id="cb126-855"><a href="#cb126-855" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb126-856"><a href="#cb126-856" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> c.upper),</span>
<span id="cb126-857"><a href="#cb126-857" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb126-858"><a href="#cb126-858" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> p.lower),</span>
<span id="cb126-859"><a href="#cb126-859" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb126-860"><a href="#cb126-860" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> p.upper),</span>
<span id="cb126-861"><a href="#cb126-861" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb126-862"><a href="#cb126-862" aria-hidden="true" tabindex="-1"></a>g1</span>
<span id="cb126-863"><a href="#cb126-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-864"><a href="#cb126-864" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb126-865"><a href="#cb126-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-866"><a href="#cb126-866" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb126-867"><a href="#cb126-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb126-868"><a href="#cb126-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb126-869"><a href="#cb126-869" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb126-870"><a href="#cb126-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb126-871"><a href="#cb126-871" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">ymin =</span> c.lower, <span class="at">ymax =</span> c.upper),</span>
<span id="cb126-872"><a href="#cb126-872" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>, </span>
<span id="cb126-873"><a href="#cb126-873" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"blue"</span></span>
<span id="cb126-874"><a href="#cb126-874" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb126-875"><a href="#cb126-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb126-876"><a href="#cb126-876" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">ymin =</span> p.lower, <span class="at">ymax =</span> p.upper),</span>
<span id="cb126-877"><a href="#cb126-877" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>, </span>
<span id="cb126-878"><a href="#cb126-878" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"red"</span></span>
<span id="cb126-879"><a href="#cb126-879" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-880"><a href="#cb126-880" aria-hidden="true" tabindex="-1"></a>g2</span>
<span id="cb126-881"><a href="#cb126-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-882"><a href="#cb126-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-883"><a href="#cb126-883" aria-hidden="true" tabindex="-1"></a>We can use a one-liner in {ggplot} to plot the CIs, too...</span>
<span id="cb126-884"><a href="#cb126-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-887"><a href="#cb126-887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-888"><a href="#cb126-888" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb126-889"><a href="#cb126-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb126-890"><a href="#cb126-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-891"><a href="#cb126-891" aria-hidden="true" tabindex="-1"></a>g3</span>
<span id="cb126-892"><a href="#cb126-892" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-893"><a href="#cb126-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-894"><a href="#cb126-894" aria-hidden="true" tabindex="-1"></a>Again, in these plots, the CI band shows where the mean height ($\hat{h}$) is expected to fall in 95% of samples, while the PI band shows where the individual points are expected to fall 95% of the time.</span>
<span id="cb126-895"><a href="#cb126-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-896"><a href="#cb126-896" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb126-897"><a href="#cb126-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-898"><a href="#cb126-898" aria-hidden="true" tabindex="-1"></a>For the same regression model in the challenge above, use bootstrapping with 1000 replicates to generate a quantile-based 95% CI around the estimate of the slope of the relationship. Plot the regression lines associated with each of your first 20 replicates atop a bivariate scatterplot of **height** ~ **age**.</span>
<span id="cb126-899"><a href="#cb126-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-902"><a href="#cb126-902" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-903"><a href="#cb126-903" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb126-904"><a href="#cb126-904" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb126-905"><a href="#cb126-905" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb126-906"><a href="#cb126-906" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb126-907"><a href="#cb126-907" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb126-908"><a href="#cb126-908" aria-hidden="true" tabindex="-1"></a>p_lower <span class="ot">&lt;-</span> alpha<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb126-909"><a href="#cb126-909" aria-hidden="true" tabindex="-1"></a>p_upper <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb126-910"><a href="#cb126-910" aria-hidden="true" tabindex="-1"></a>boot.slope <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb126-911"><a href="#cb126-911" aria-hidden="true" tabindex="-1"></a>  <span class="co"># specify model</span></span>
<span id="cb126-912"><a href="#cb126-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(height <span class="sc">~</span> age) <span class="sc">|&gt;</span></span>
<span id="cb126-913"><a href="#cb126-913" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate bootstrap replicates</span></span>
<span id="cb126-914"><a href="#cb126-914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"bootstrap"</span>) <span class="sc">|&gt;</span></span>
<span id="cb126-915"><a href="#cb126-915" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the slope statistic</span></span>
<span id="cb126-916"><a href="#cb126-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"slope"</span>) <span class="sc">|&gt;</span></span>
<span id="cb126-917"><a href="#cb126-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb126-918"><a href="#cb126-918" aria-hidden="true" tabindex="-1"></a>    <span class="at">boot.mean =</span> <span class="fu">mean</span>(stat),</span>
<span id="cb126-919"><a href="#cb126-919" aria-hidden="true" tabindex="-1"></a>    <span class="at">boot.lower =</span> <span class="fu">quantile</span>(stat, p_lower),</span>
<span id="cb126-920"><a href="#cb126-920" aria-hidden="true" tabindex="-1"></a>    <span class="at">boot.upper =</span> <span class="fu">quantile</span>(stat, p_upper)</span>
<span id="cb126-921"><a href="#cb126-921" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-922"><a href="#cb126-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-923"><a href="#cb126-923" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb126-924"><a href="#cb126-924" aria-hidden="true" tabindex="-1"></a>boot.slope <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb126-925"><a href="#cb126-925" aria-hidden="true" tabindex="-1"></a>  <span class="co"># specify model</span></span>
<span id="cb126-926"><a href="#cb126-926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(height <span class="sc">~</span> age) <span class="sc">|&gt;</span></span>
<span id="cb126-927"><a href="#cb126-927" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate bootstrap replicates</span></span>
<span id="cb126-928"><a href="#cb126-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">20</span>, <span class="at">type =</span> <span class="st">"bootstrap"</span>)</span>
<span id="cb126-929"><a href="#cb126-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-930"><a href="#cb126-930" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb126-931"><a href="#cb126-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb126-932"><a href="#cb126-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> boot.slope, <span class="fu">aes</span>(<span class="at">x =</span> age,</span>
<span id="cb126-933"><a href="#cb126-933" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> height, <span class="at">group =</span> replicate), <span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">lwd=</span><span class="fl">0.1</span>)</span>
<span id="cb126-934"><a href="#cb126-934" aria-hidden="true" tabindex="-1"></a>g</span>
<span id="cb126-935"><a href="#cb126-935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-936"><a href="#cb126-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-937"><a href="#cb126-937" aria-hidden="true" tabindex="-1"></a><span class="fu">## Residuals</span></span>
<span id="cb126-938"><a href="#cb126-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-939"><a href="#cb126-939" aria-hidden="true" tabindex="-1"></a>From our various plots above, it's clear that our model is not explaining all of the variation we see in our dataset... our **y** points do not all fall on the $\hat{y}$ line but rather are distributed around it. The distance of each of these points from the predicted value for $y$ at that value of $x$ is known as the "residual". We can think about the residuals as "what is left over" after accounting for the predicted relationship between $x$ and $y$. Residuals are often thought of as estimates of the "error" term in a regression model, and most regression analyses assume that residuals are random normal variables with uniform variance across the range of $x$ values (more on this later). In ordinary least squares regression, the line of best fit is defined as that which minimizes the sum of the squared residuals, and the expected value for a residual is 0.</span>
<span id="cb126-940"><a href="#cb126-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-941"><a href="#cb126-941" aria-hidden="true" tabindex="-1"></a>Residuals are also used to create "covariate adjusted" variables, as they can be thought of as the response variable, $y$, with the linear effect of other predictor variables removed. We'll return to this idea when we move on to multivariate regression.</span>
<span id="cb126-942"><a href="#cb126-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-943"><a href="#cb126-943" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb126-944"><a href="#cb126-944" aria-hidden="true" tabindex="-1"></a><span class="in">detach(package:manipulate)</span></span>
<span id="cb126-945"><a href="#cb126-945" aria-hidden="true" tabindex="-1"></a><span class="in">detach(package:broom)</span></span>
<span id="cb126-946"><a href="#cb126-946" aria-hidden="true" tabindex="-1"></a><span class="in">detach(package:infer)</span></span>
<span id="cb126-947"><a href="#cb126-947" aria-hidden="true" tabindex="-1"></a><span class="in">detach(package:patchwork)</span></span>
<span id="cb126-948"><a href="#cb126-948" aria-hidden="true" tabindex="-1"></a><span class="in">detach(package:tidyverse)</span></span>
<span id="cb126-949"><a href="#cb126-949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb126-950"><a href="#cb126-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-951"><a href="#cb126-951" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb126-952"><a href="#cb126-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-953"><a href="#cb126-953" aria-hidden="true" tabindex="-1"></a><span class="fu">## Concept Review {.unnumbered}</span></span>
<span id="cb126-954"><a href="#cb126-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-955"><a href="#cb126-955" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Regression analysis is used to identify and explore models describing the relationship between variables of interest</span>
<span id="cb126-956"><a href="#cb126-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-957"><a href="#cb126-957" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We can use regression analysis...</span>
<span id="cb126-958"><a href="#cb126-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-959"><a href="#cb126-959" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>to **predict** the value of a response variable given the value of one or more predictor variables</span>
<span id="cb126-960"><a href="#cb126-960" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>to evaluate alternative **models** of the relationship between a response variable and possible predictor variables</span>
<span id="cb126-961"><a href="#cb126-961" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>to explore the relative **explanatory power** of different predictor variables</span>
<span id="cb126-962"><a href="#cb126-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-963"><a href="#cb126-963" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Linear regression involves finding the "line of best fit" between the predictor and response variable</span>
<span id="cb126-964"><a href="#cb126-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-965"><a href="#cb126-965" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This means finding the coefficients $\beta_0$ and $\beta_1$ that define the line that minizes the sum of the squared deviations of observed and predicted values for the response variable, i.e, that minimizes $\sum(y - \hat{y})$ where $\hat{y}= \beta_0 + \beta_1 x$</span>
<span id="cb126-966"><a href="#cb126-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-967"><a href="#cb126-967" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are LOTS of types of regression analyses, and we will explore more of them in the modules to come <span class="co">[</span><span class="ot">see Table 8.1 in ***R in Action***</span><span class="co">]</span></span>
<span id="cb126-968"><a href="#cb126-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-971"><a href="#cb126-971" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb126-972"><a href="#cb126-972" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb126-973"><a href="#cb126-973" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb126-974"><a href="#cb126-974" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/RinActionTable8.1.png"</span>)</span>
<span id="cb126-975"><a href="#cb126-975" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>