<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applied Data Analysis - 12&nbsp; Central Tendency and Spread</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./13-module.html" rel="next">
<link href="./11-module.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./12-module.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Central Tendency and Spread</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-logistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Logistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course-schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-typography-and-formatting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Typography and Formatting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-programming-style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming Style Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>RStudio</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extending the Functionality of <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamentals of the <strong><em>R</em></strong> Language</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basics of Version Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Additional Data Structures in <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting Data into <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Functions and Flow Control</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part II - Statistics and Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-module.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Central Tendency and Spread</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Using Permutation Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Elements of Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-analysis-replication-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis Replication</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Packages Used</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives"><span class="header-section-number">12.1</span> Objectives</a></li>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link" data-scroll-target="#preliminaries"><span class="header-section-number">12.2</span> Preliminaries</a></li>
  <li><a href="#important-terms" id="toc-important-terms" class="nav-link" data-scroll-target="#important-terms"><span class="header-section-number">12.3</span> Important Terms</a></li>
  <li><a href="#describing-sets-of-observations" id="toc-describing-sets-of-observations" class="nav-link" data-scroll-target="#describing-sets-of-observations"><span class="header-section-number">12.4</span> Describing Sets of Observations</a>
  <ul class="collapse">
  <li><a href="#measures-of-central-tendency" id="toc-measures-of-central-tendency" class="nav-link" data-scroll-target="#measures-of-central-tendency">Measures of Central Tendency</a></li>
  <li><a href="#challenge" id="toc-challenge" class="nav-link" data-scroll-target="#challenge">CHALLENGE</a></li>
  <li><a href="#measures-of-spread" id="toc-measures-of-spread" class="nav-link" data-scroll-target="#measures-of-spread">Measures of Spread</a></li>
  <li><a href="#challenge-1" id="toc-challenge-1" class="nav-link" data-scroll-target="#challenge-1">CHALLENGE</a></li>
  <li><a href="#challenge-2" id="toc-challenge-2" class="nav-link" data-scroll-target="#challenge-2">CHALLENGE</a></li>
  <li><a href="#questions-to-explore" id="toc-questions-to-explore" class="nav-link" data-scroll-target="#questions-to-explore">Questions to Explore</a></li>
  </ul></li>
  <li><a href="#using-measures-of-spread" id="toc-using-measures-of-spread" class="nav-link" data-scroll-target="#using-measures-of-spread"><span class="header-section-number">12.5</span> Using Measures of Spread</a>
  <ul class="collapse">
  <li><a href="#sampling-distributions" id="toc-sampling-distributions" class="nav-link" data-scroll-target="#sampling-distributions">Sampling Distributions</a></li>
  <li><a href="#standard-errors" id="toc-standard-errors" class="nav-link" data-scroll-target="#standard-errors">Standard Errors</a></li>
  <li><a href="#questions-to-explore-1" id="toc-questions-to-explore-1" class="nav-link" data-scroll-target="#questions-to-explore-1">Questions to Explore</a></li>
  <li><a href="#challenge-3" id="toc-challenge-3" class="nav-link" data-scroll-target="#challenge-3">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#concept-review" id="toc-concept-review" class="nav-link" data-scroll-target="#concept-review">Concept Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./12-module.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Central Tendency and Spread</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="module-12" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Central Tendency and Spread</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="objectives" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="objectives"><span class="header-section-number">12.1</span> Objectives</h2>
<blockquote class="blockquote">
<p>The objective of this module is to review some key terms and ideas that form the foundation of statistics and statistical inference. In particular, this module considers ways for describing distributions of data, particularly measures of <em>central tendency</em> and <em>spread</em> (i.e., variation) in our observations of a variable, which play an important role in both descriptive statistics and in various approaches to statistical hypothesis testing.</p>
</blockquote>
</section>
<section id="preliminaries" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="preliminaries"><span class="header-section-number">12.2</span> Preliminaries</h2>
<ul>
<li>Install these packages in <strong><em>R</em></strong>: <a href="https://cran.r-project.org/web/packages/mosaic/mosaic">{mosiac}</a>, <a href="https://cran.r-project.org/web/packages/radiant/radiant.pdf">{radiant}</a>, <a href="https://cran.r-project.org/web/packages/sciplot/sciplot.pdf">{sciplot}</a>, and <a href="https://cran.r-project.org/web/packages/infer/infer.pdf">{infer}</a></li>
<li>Load {tidyverse}</li>
</ul>
</section>
<section id="important-terms" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="important-terms"><span class="header-section-number">12.3</span> Important Terms</h2>
<ul>
<li><strong>Population</strong> - <strong>all</strong> of the elements from a set of data (e.g., all of the gorillas in the world) = <strong><em>N</em></strong></li>
<li><strong>Sample</strong> - one or more observations drawn from a population by some kind of sampling process (e.g., the set of gorillas living in Rwanda, the set of gorilla skeletons found in a museum) = <strong><em>n</em></strong></li>
</ul>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> We often assume that a sampling process is <em>random</em>, but there are lots of ways in which sampling might be biased, thus the samples we work with <em>may not</em> be (and often <em>are not</em>) random samples!</p>
</blockquote>
<ul>
<li><strong>Parameter</strong> - a measurable characteristic of a population that summarizes data (e.g., the mean value of the femur length of all gorillas)</li>
</ul>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Population means for a given variable, <strong>x</strong>, are often indicated as <span class="math inline">\(\mu_x\)</span></p>
</blockquote>
<ul>
<li><strong>Statistic</strong> - a measurable characteristic about a sample that summarizes data (e.g., the mean femur length of gorilla femurs found at the American Museum of Natural History)</li>
</ul>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Sample means for a given variable, <strong>x</strong>, are often indicated as <span class="math inline">\(\bar{x}\)</span></p>
</blockquote>
<p>When we use statistical methods or attempt statistical inference - whether using a <em>null hypothesis significance testing</em> (<em>NHST</em>) framework or using <em>Bayesian</em> approaches - we are basically trying to estimate and draw conclusions about population-level parameters and processes and their distributions based on observations or measurements we take from a <em>sample</em>. Sometimes, we are simply trying evaluate whether it is reasonable to assume that our sample is drawn from a population with particular characteristics. Other times, we may be trying to understand what variables explain variation we see in a response measure of interest or be trying to evaluate which among a set of alternative models best predicts a given response.</p>
<p>Regardless, we should always keep in mind that the process of trying to draw conclusions about a population based on a sample can be complicated by the fact that…</p>
<ul>
<li>our sample may be biased, non-random, or non-representative in some way</li>
<li>there may be unknown or unobserved variables that impact how the sample is related to the population</li>
<li>the assumptions we make about the population that our sample is drawn from might not be correct</li>
</ul>
</section>
<section id="describing-sets-of-observations" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="describing-sets-of-observations"><span class="header-section-number">12.4</span> Describing Sets of Observations</h2>
<p>It is important for us to be able to describe the general characteristics of the distribution of a set of observations or measurements about a <strong>population</strong> or a <strong>sample</strong>, and we often do this by calculating some <em>measure(s) of central tendency</em> and some <em>measure(s) of spread</em> around that statistic. The “five-number summary” that we have talked about previously is doing basically just this.</p>
<section id="measures-of-central-tendency" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="measures-of-central-tendency">Measures of Central Tendency</h3>
<ul>
<li><strong>Median</strong> - the middle value in a rank ordered series of values</li>
<li><strong>Mean</strong> - the sum of measured values divided by <span class="math inline">\(n\)</span>, a.k.a., the <em>average</em> or the <em>arithimetic mean</em></li>
<li><strong>Mode</strong> - the most common measurement of values observed</li>
<li><strong>Harmonic mean</strong> - the reciprocal of the average of the reciprocals of a set of values</li>
</ul>
<p>The measures above are relevant to summarizing observations about processes that are additive.</p>
<ul>
<li><strong>Geometric mean</strong> - a measure of central tendency for processes that are exponential (e.g., some phases of population growth in natural populations) or multiplicative (e.g., increases in area or volume that accompany increases in linear dimension) in nature, rather than additive = the <span class="math inline">\(n^{th}\)</span> root of the product of the values, taken across a set of <span class="math inline">\(n\)</span> values; for the mathematically inclined, it also equals the <em>antilog</em> of the averaged <em>log</em> values</li>
</ul>
</section>
<section id="challenge" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge">CHALLENGE</h3>
<ul>
<li>Given a vector, <code>x &lt;- c(1,2,3,4,5,6,7,8,9,10,25,50,100,200,1000)</code>, write your own function to determine the <em>geometric mean</em> of the values in a vector. Remember the general form for functions is: <code>&lt;function name&gt; &lt;- function(&lt;arguments&gt;) {&lt;code&gt;}</code></li>
</ul>
<blockquote class="blockquote">
<p><strong>HINT:</strong> Taking the <span class="math inline">\(n^{th}\)</span> root of a number is equivalent to raising the number to the power of <span class="math inline">\(\frac{1}{n}\)</span></p>
</blockquote>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">1000</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>geometric_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prod</span>(x)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geometric_mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 13.50559</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>geometric_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(x)))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geometric_mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 13.50559</code></pre>
</details>
</div>
</div>
<p>What happens if you have <code>NA</code>s or zeros or negative numbers in your vector?</p>
<blockquote class="blockquote">
<p><strong>HINT:</strong> Including an <code>na.rm=TRUE</code> argument and the function <code>na.omit()</code> in your function code to ignore data points with <na> values may help you write more generic functions!</na></p>
</blockquote>
</section>
<section id="measures-of-spread" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="measures-of-spread">Measures of Spread</h3>
<p>In addition to measures of central tendency, measures of spread or variability in the distribution of variables of interest are some of the most important summary statistics to calculate. The <em>total range</em> (min to max) is one measure of spread, as is the <em>interquartile</em> range (25th to 75th quartile), which as we have seen are both part of the “five-number summary”.</p>
<p>We more commonly characterize spread, however, in terms of some measure of the <em>deviation of a set of values from the mean of those values</em>. One such measure is the <strong>sum of squares</strong>…</p>
<ul>
<li><strong><em>Sum of Squares</em></strong> = the sum of the squared deviations of a set of values from the mean of that set</li>
</ul>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Why do we use the sum of the <strong>squared</strong> deviations of values from the mean rather than just the sum of deviations? Because the latter would simply be ZERO!</p>
</blockquote>
</section>
<section id="challenge-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-1">CHALLENGE</h3>
<ul>
<li>Write a function to calculate the <strong>sum of squares</strong> for a vector.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sum_of_squares <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_of_squares</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 917183.3</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is equivalent to...</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>sum_of_squares <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">length</span>(x) <span class="sc">*</span> <span class="fu">mean</span>(x)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_of_squares</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 917183.3</code></pre>
</details>
</div>
</div>
<p>A shortcut to calculate the <strong>sum of squares</strong> for a vector, <strong>x</strong>, that does not actually require calculating <code>mean(x)</code> is the <code>(sum of the squared values in the dataset) minus the (square of the summed values) / n</code>, or…</p>
<p><span class="math display">\[\sum\limits_{i=1}^{k}(x^2) - \frac{(\sum\limits_{i=1}^{k} x)^2}{n}\]</span></p>
<p>Thus, another formula for the <strong>sum of squares</strong> is the following:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sum_of_squares <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> (<span class="fu">sum</span>(x))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_of_squares</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 917183.3</code></pre>
</div>
</div>
<p>Note that the <strong>sum of squares</strong> always increases with sample size… you can see this by adding more data points to your vector. Thus, to be able to compare across data sets of different size, we are often more interested in the <em>average</em> deviation of values from the mean rather than the straight sum of squares, i.e., a <strong>mean squared deviation</strong>.</p>
<p>This is the definition of the variability or <strong>variance</strong> in a dataset. If we are simply interested in describing the mean squared deviation in a <em>population</em>, where we have a value or measurement for every case (e.g., the femur length of all of the gorillas in a museum <em>population</em>), we could then just divide the <strong>sum of squares</strong> by the number of cases.</p>
<ul>
<li><strong><em>Population Variance</em></strong> (<span class="math inline">\(\sigma^2\)</span>) = <span class="math inline">\(\frac{SS}{N}\)</span></li>
</ul>
<p>In <strong><em>R</em></strong> parlance, we can write this as:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pop_var <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">length</span>(x))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pop_var</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 61145.56</code></pre>
</div>
</div>
<p>If, however, we have not measured all of the individual cases in population - i.e., if we are, instead, dealing with a <em>sample</em> from the population and are trying to use that sample to say something about the population from which it is drawn (e.g., to say something about gorilla femur lengths in general based on those that appear in a museum <em>sample</em>) - then we need to use a slightly different formula to get an unbiased estimate of the population variance. Such an estimate for a population parameter, based on data from a sample, is calculated as:</p>
<ul>
<li><strong><em>Sample Variance</em></strong> (an <em>estimator</em> of the population variance) = <span class="math inline">\(\frac{SS}{n-1}\)</span></li>
</ul>
<p>In this formula, <span class="math inline">\(n - 1\)</span> is the number of <em>degrees of freedom</em> implied by the sample. The <em>degrees of freedom</em> is the number of values used to calculate a sample statistic that are “free to vary”. For example, we used <em>n</em> observations to calculate the mean of our sample, which implies <span class="math inline">\(n - 1\)</span> degrees of freedom (i.e., if we know the mean and <span class="math inline">\(n - 1\)</span> values, then we also know the last value… it is <em>not</em> “free to vary”). We then use that statistic about our sample (i.e., the sample mean) as an estimate of the population mean, which is then used to derive an estimate of the population variance based on the sample variance.</p>
</section>
<section id="challenge-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-2">CHALLENGE</h3>
<ul>
<li>Write a function to calculate the <strong>variance</strong> for a vector of values representing a <em>sample</em> of measurements. Remember this means dividing the sample sum of squares by <span class="math inline">\(n-1\)</span>.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sample_var <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">length</span>(x) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_var</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 65513.1</code></pre>
</details>
</div>
</div>
<p>Compare the results of your function to the built-in <strong><em>R</em></strong> function, <code>var()</code>, which calculates sample variance.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 65513.1</code></pre>
</details>
</div>
</div>
</section>
<section id="questions-to-explore" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="questions-to-explore">Questions to Explore</h3>
<ul>
<li>For a random variable, how is variance related to sample size?</li>
</ul>
<p>We will explore this, and at the same time practice a bit about <strong>loops</strong> in <strong><em>R</em></strong> programming, via <strong>simulation</strong>, where we repeatedly draw samples of random variables from a specific distribution. As an example, we will we draw from a normal distribution with a mean of 10 and a standard deviation of 2.</p>
<p>To visualize this distribution, we can use the <code>plotDist()</code> function from the {mosaic} package…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"norm"</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="12-module_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># `plotDist()` comes from the {mosaic} package and makes it easy to plot a</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the following code block, we first set up a plot window to hold the results of our simulations and plot a line for the known population variance (i.e., the square of <span class="math inline">\(\sigma\)</span>, the standard deviation). We then use nested <code>for</code> loops to iterate the process of drawing samples of a specific size, <span class="math inline">\(n\)</span>, from the specified distribution. We do this for samples of size <span class="math inline">\(n\)</span> = 5, 10, 15… up to 100, and we draw out 50 replicates of each sample size. Recall from <a href="11-module.html"><strong>Module 11</strong></a> that the structure for <code>for</code> loops is:</p>
<pre><code>for (&lt;index&gt; in &lt;range&gt;){
  &lt;code to execute&gt;
}</code></pre>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up plot window</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">"Sample Size"</span>, <span class="at">ylab =</span> <span class="st">"Variance"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add the population variance (= square of population standard deviation) to</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the plot</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># run simulations and add results to plot</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># samples of 5, 10, 15...</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">5</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>)) {</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set up a variable, reps, to hold the set of variances calculated for each</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># replicate</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    reps <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"double"</span>, <span class="dv">50</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 50 replicates</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>) {</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">points</span>(n, <span class="fu">var</span>(x))</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        reps[[i]] <span class="ot">=</span> <span class="fu">var</span>(x)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># this is a common programming motif in R and is more memory and time</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># efficient than another common motif, `reps &lt;- c(reps, var(x))`</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(n, <span class="fu">mean</span>(reps), <span class="at">bg =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">23</span>, <span class="at">cex =</span> <span class="dv">2</span>)  <span class="co"># plots average</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="12-module_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>How does <em>sample variance</em> compare to <em>population variance</em>? What happens to the sample variances as sample size increases?</li>
</ul>
<p>Another measure of spread around a mean that we often see reported is the <strong>standard deviation</strong>. The standard deviation is simply the <em>square root of the variance</em> (<span class="math inline">\(\sqrt{\sigma^2} = \sigma\)</span>). The advantage of using the standard deviation as a statistic or parameter is that the units of standard deviation are the same as the units of our original measurement (rather than being units squared, which are our units for variance).</p>
<p>In <strong><em>R</em></strong> we can write…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>pop_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="fu">pop_var</span>(x))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pop_sd</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.99669</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sample_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="fu">sample_var</span>(x))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sd</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.997689</code></pre>
</div>
</div>
<p>The <code>sdpop()</code> function from the {radiant} package can be used to calculate the standard deviation for a completely sampled population.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(radiant)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sdpop</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.99669</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>radiant)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The built-in <strong><em>R</em></strong> function <code>sd()</code> can be used to calculate the standard deviation of a sample.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.997689</code></pre>
</div>
</div>
</section>
</section>
<section id="using-measures-of-spread" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="using-measures-of-spread"><span class="header-section-number">12.5</span> Using Measures of Spread</h2>
<section id="sampling-distributions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sampling-distributions">Sampling Distributions</h3>
<p>Since one of the goals of statistics is to estimate and make inferences about population-level parameters based on characteristics of a sample, it is important that we be able to judge and report just how reliable or unreliable our statistical estimates those population-level parameters are.</p>
<p>To explore how we do this, let’s start with a population where we KNOW every data point. We will use that first to describe our population empirically. We will then draw samples out of that population and see how well that the samples we draw can be used to describe the population.</p>
<p>Load the “IMDB-movies.csv” dataset from the <strong>ada-datasets</strong> repository on <strong><em>GitHub</em></strong> as a “tibble”, <strong>d</strong>. This dataset contains data on close to 29,000 movies scraped in early 2020 from the online <a href="https://www.imdb.com/interfaces/">Internet Movie Database</a>, including their year of title, director, year of production, running time, average viewer rating on a 10 point scale, and the number of votes that rating is based on. [Note that in collating this data, I excluded movies with fewer than 1000 votes.] Once we load the data, we will filter the dataset to keep only movies with a <code>startYear</code> from 1999 to 2019, which should leave us with 17,628 movies. We are going to use this dataset as our POPULATION.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/IMDB-movies.csv"</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">filter</span>(d, startYear <span class="sc">%in%</span> <span class="dv">1999</span><span class="sc">:</span><span class="dv">2019</span>)  <span class="co"># the %in% operator is VERY useful!</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 10
##   tconst    titleType primaryTitle startYear runtimeMinutes genres averageRating
##   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;
## 1 tt0035423 movie     Kate &amp; Leop…      2001            118 Comed…           6.4
## 2 tt0069049 movie     The Other S…      2018            122 Drama            6.8
## 3 tt0111068 movie     Sangharsh         1999            127 Actio…           6.8
## 4 tt0112444 movie     My Teacher'…      1999             89 Comed…           5.5
## 5 tt0113026 movie     The Fantast…      2000             86 Music…           5.6
## 6 tt0118589 movie     Glitter           2001            104 Drama…           2.2
## # ℹ 3 more variables: numVotes &lt;dbl&gt;, nconst &lt;chr&gt;, director &lt;chr&gt;</code></pre>
</div>
</div>
<p>First, we will do some exploratory data analysis on this dataset using, in part, some functions from the {mosaic} package. {mosaic} makes some kinds of quick exploratory data analysis very fast and easy to do (though we already know how to do lots of what we can do with {mosaic} in other ways)!</p>
<p>Functions in the {mosaic} package have a <code>data=</code> argument as well as a <code>~</code> argument that specifies which variable of interest from the <code>data=</code> argument the function is to be applied to.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(averageRating <span class="sc">~</span> startYear, <span class="at">data =</span> d, <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"Average Rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="12-module_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the `histogram()` function from {mosaic} plots neat 'augmented' histograms</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span>averageRating, <span class="at">data =</span> d, <span class="at">xlab =</span> <span class="st">"Average Rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="12-module_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the `favstats()` function from {mosiac} calculates a variant of the 5-number</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>(pop_stats <span class="ot">&lt;-</span> <span class="fu">favstats</span>(<span class="sc">~</span>averageRating, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  min  Q1 median  Q3 max     mean       sd     n missing
##    1 5.6    6.4 7.1 9.9 6.238972 1.160221 17628       0</code></pre>
</div>
</div>
<p>Now, let’s draw a single SAMPLE of 100 movies randomly from this population and visualize its average viewer rating. After setting the random number seed (analogous to setting what position we start at in a traditional table of random numbers), run the subsequent lines of code several times and look at how the results differ…</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> We use <code>set.seed()</code> here so that each time this function is run, it returns the same sequence of random numbers until the seed is reset.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(d, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># `sample_n()` from {dplyr} selects rows at random from a data frame it's</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># another SUPER useful function</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(s<span class="sc">$</span>startYear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## 1999 2000 2001 2002 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015 
##    2    4    2    2    4    3    1    5    6    4   10    7    4    6    6    7 
## 2016 2017 2018 2019 
##   10    7    8    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(averageRating <span class="sc">~</span> startYear, <span class="at">data =</span> s, <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"Average Rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="12-module_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span>averageRating, <span class="at">data =</span> s, <span class="at">xlab =</span> <span class="st">"Average Rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="12-module_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>(samp_stats <span class="ot">&lt;-</span> <span class="fu">favstats</span>(<span class="sc">~</span>averageRating, <span class="at">data =</span> s))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  min  Q1 median Q3 max  mean       sd   n missing
##  3.3 5.5   6.45  7 8.5 6.325 1.004673 100       0</code></pre>
</div>
</div>
<p>Note that each time we select a sample and calculate summary statistics, such as the mean and standard deviation of a sample, we get slightly different results. If we repeat this sampling process multiple times, we can use the results to generate a <strong>distribution</strong> for a particular summary statistic of interest, e.g., for the mean or the median. This process generates what is called a <strong>sampling distribution</strong> for the statistic.</p>
<p>The code below allows us to generate a sampling distribution virtually. The <code>do() *</code> construction from {mosaic}, in combination with one of the {mosaic} package’s aggregating functions (e.g., <code>mean()</code>, <code>median()</code>, etc.), can be used to repeat sampling from the population a user-specified number of times, calculate a summary statistic, and then bundle the results into a vector all in the same line. [Of course, we could also write a loop to do the same thing… and there are other ways we could do this as well (see examples below).]</p>
<p>This process of <em>simulating</em> samples drawn from a population and then generating statistics on the basis of each of our virtual samples is a very powerful tool that we will apply over and over again as we talk about statistical inference. This process is the basis for bootstrapping confidence intervals (see <a href="14-module.html"><strong>Module 14</strong></a>) and for conducting randomization/permutation tests (see <a href="16-module.html"><strong>Module 16</strong></a>.</p>
<section id="using-the-mosaic-package" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="using-the-mosaic-package">Using the {mosaic} Package</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using `do(reps) *` from {mosaic} to generate a sampling distribution</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>samp_dist_mean <span class="ot">&lt;-</span> <span class="fu">do</span>(reps) <span class="sc">*</span> <span class="fu">mean</span>(<span class="sc">~</span>averageRating, <span class="at">data =</span> <span class="fu">sample_n</span>(d, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generates a sampling distribution</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>mean_plot <span class="ot">&lt;-</span> <span class="fu">histogram</span>(<span class="sc">~</span>mean, <span class="at">data =</span> samp_dist_mean, <span class="at">xlab =</span> <span class="st">"Sampling Distribution for the</span><span class="sc">\n</span><span class="st">Mean of Average Rating"</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>samp_dist_median <span class="ot">&lt;-</span> <span class="fu">do</span>(reps) <span class="sc">*</span> <span class="fu">median</span>(<span class="sc">~</span>averageRating, <span class="at">data =</span> <span class="fu">sample_n</span>(d, <span class="at">size =</span> n,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># generates a sampling distribution</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>median_plot <span class="ot">&lt;-</span> <span class="fu">histogram</span>(<span class="sc">~</span>median, <span class="at">data =</span> samp_dist_median, <span class="at">xlab =</span> <span class="st">"Sampling Distribution for the</span><span class="sc">\n</span><span class="st">Median of Average Rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="using-the-purrr-package" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="using-the-purrr-package">Using the {purrr} Package</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using `rerun()` from {purrr} to generate a sampling distribution</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>samp_dist_mean_alt1 <span class="ot">&lt;-</span> <span class="fu">rerun</span>(reps, <span class="fu">mean</span>(<span class="sc">~</span>averageRating, <span class="at">data =</span> <span class="fu">sample_n</span>(d, <span class="at">size =</span> n,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">FALSE</span>))) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## Warning: `rerun()` was deprecated in purrr 1.0.0.
## ℹ Please use `map()` instead.
##   # Previously
##   rerun(1000, mean(~averageRating, data = sample_n(d, size = n, replace =
##   FALSE)))
## 
##   # Now
##   map(1:1000, ~ mean(~averageRating, data = sample_n(d, size = n, replace =
##   FALSE)))</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>mean_plot_alt1 <span class="ot">&lt;-</span> <span class="fu">histogram</span>(samp_dist_mean_alt1, <span class="at">xlab =</span> <span class="st">"Sampling Distribution for the</span><span class="sc">\n</span><span class="st">Mean of Average Rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="using-the-infer-package" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="using-the-infer-package">Using the {infer} Package</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using `rep_sample_n()` from {infer} to generate a sampling distribution</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## 
## Attaching package: 'infer'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>## The following object is masked from 'package:radiant.data':
## 
##     visualize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>## The following objects are masked from 'package:mosaic':
## 
##     prop_test, t_test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>samp_dist_mean_alt2 <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep_sample_n</span>(<span class="at">size =</span> n, <span class="at">reps =</span> reps, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(replicate) <span class="sc">|&gt;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(averageRating)) <span class="sc">|&gt;</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(mean)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>infer)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>mean_plot_alt2 <span class="ot">&lt;-</span> <span class="fu">histogram</span>(samp_dist_mean_alt2, <span class="at">xlab =</span> <span class="st">"Sampling Distribution for the</span><span class="sc">\n</span><span class="st">Mean of Average Rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(mean_plot, median_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="12-module_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><strong>IMPORTANT NOTE:</strong> The histograms we plot in the code above are for <strong>sampling distributions</strong> of the statistics in question. They do not represent the distribution of values in any particular sample! This is SUPER IMPORTANT to recognize and keep in mind.</p>
</blockquote>
<p>The <strong>mean of the sampling distribution</strong> (i.e., the mean of <span class="math inline">\(\bar{x}\)</span>) for a particular statistic should be a really good <strong>point estimate</strong> of the population value for that statistic (i.e., <span class="math inline">\(\mu\)</span>). Compare the following to confirm this:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="sc">~</span>mean, <span class="at">data =</span> samp_dist_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 6.239391</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the estimated population mean calculated as the mean of the sampling</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution of sample means</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>pop_stats<span class="sc">$</span>mean  <span class="co"># true population mean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 6.238972</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="sc">~</span>median, <span class="at">data =</span> samp_dist_median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 6.38125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the estimated population median calculated as the mean of the</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sampling distribution of sample medians</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>pop_stats<span class="sc">$</span>median  <span class="co"># true population median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 6.4</code></pre>
</div>
</div>
</section>
</section>
<section id="standard-errors" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="standard-errors">Standard Errors</h3>
<p>So, just how reliable or unreliable are these estimates of a population parameter based on the mean of the sampling distribution for a statistic of interest? That is, how far off is a statistic that we calculate based on a sampling distribution likely to be from the true POPULATION value of the parameter of interest?</p>
<p>One way to quantify the uncertainty is by calculating the variability of the summary statistic of interest across replicate samples drawn from the population. For example, we could calculate the <em>variance of the sampling distribution</em>. More commonly, because variance is expressed in <em>units squared</em>, we take the square root of this variance to calculate the <em>standard deviation of the sampling distribution</em> and thus express our uncertainly in <em>units</em> of the original measurement. Formally, this value is referred to as the <strong>standard error</strong> (<strong>SE</strong>) of measurement for any given summary statistic of interest. [Typically, that statistic is the <em>mean</em>, and we thus are calculating the <em>standard error of the mean</em>.]</p>
<p>The <strong>SE</strong> is, in effect, the <em>average deviation</em> between statistic values calculated from different and incomplete sets of samples drawn from a population and the average statistic value calculated across that set of samples (which should converge on the true population value for that statistic). The SE of the mean is thus a measure of <em>how dispersed sample means (</em><span class="math inline">\(\bar{x}\)</span>) are expected to be around the estimated population mean (<span class="math inline">\(\mu\)</span>) (i.e., how far off from the true population mean an estimate based on a sample of size <span class="math inline">\(n\)</span> is likely to be). Similarly, the SE of the median would be a measure of how dispersed sample medians are expected to be, on average, around the estimated population median, and so forth.</p>
<section id="estimating-a-se-from-a-sampling-distribution" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="estimating-a-se-from-a-sampling-distribution">Estimating a SE from a Sampling Distribution</h4>
<p>To estimate the SE from a sampling distribution, we simply take the standard standard deviation of the set of values comprising that distribution. Above, we used the <code>do() * &lt;function&gt;</code> construction to generate sampling distributions for the mean and median of average viewer ratings in the “movies.csv” dataset, so all we need to do is pull out the standard deviation of those distributions to estimate the standard error.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>se_mean <span class="ot">&lt;-</span> <span class="fu">favstats</span>(<span class="sc">~</span>mean, <span class="at">data =</span> samp_dist_mean)<span class="sc">$</span>sd</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or, se_mean &lt;- sd(samp_dist_mean$mean)</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>(<span class="fu">paste0</span>(<span class="st">"Estimated population mean = "</span>, <span class="fu">round</span>(<span class="fu">favstats</span>(<span class="sc">~</span>mean, <span class="at">data =</span> samp_dist_mean)<span class="sc">$</span>mean,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>), <span class="st">" ± "</span>, <span class="fu">round</span>(se_mean, <span class="dv">3</span>), <span class="st">" SE based on "</span>, reps, <span class="st">" samples of size "</span>, n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] "Estimated population mean = 6.239 ± 0.121 SE based on 1000 samples of size 100"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>se_median <span class="ot">&lt;-</span> <span class="fu">favstats</span>(<span class="sc">~</span>median, <span class="at">data =</span> samp_dist_median)<span class="sc">$</span>sd</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or, se_median &lt;- sd(samp_dist_median$median)</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">paste0</span>(<span class="st">"Estimated population median = "</span>, <span class="fu">round</span>(<span class="fu">favstats</span>(<span class="sc">~</span>median, <span class="at">data =</span> samp_dist_median)<span class="sc">$</span>mean,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>), <span class="st">" ± "</span>, <span class="fu">round</span>(se_median, <span class="dv">3</span>), <span class="st">" SE based on "</span>, reps, <span class="st">" samples of size "</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] "Estimated population median = 6.381 ± 0.134 SE based on 1000 samples of size 100"</code></pre>
</div>
</div>
<p>As we might expect for any measure of uncertainty or error, the <strong>SE</strong> [1] increases with the variability in a sample (i.e., estimates based on high-variability samples should be more uncertain) and [2] decreases with the size of the sample (i.e., estimates based on larger samples should be less uncertain). The <strong>SE</strong> thus reflects a ratio of variance to sample size.</p>
</section>
</section>
<section id="questions-to-explore-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="questions-to-explore-1">Questions to Explore</h3>
<ul>
<li>How does changing the <strong>size of our samples</strong> (<strong>n</strong>) impact the <strong>mean</strong> and <strong>SE</strong> of our estimate of the population parameter?</li>
<li>How does changing the <strong>number of replicate samples</strong> (<strong>reps</strong>) impact the <strong>mean</strong> and <strong>SE</strong> of our estimate of the population parameter?</li>
</ul>
<p>We can explore these two questions with the following code… note that we just take one set of 2000 replicates and then resample from that randomly to explore the impact of different, smaller numbers of replicates:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">n =</span> <span class="fu">numeric</span>(), <span class="at">mean =</span> <span class="fu">numeric</span>(), <span class="at">.index =</span> <span class="fu">numeric</span>())</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">20</span>, <span class="at">to =</span> <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">20</span>)) {</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    samp_dist <span class="ot">&lt;-</span> {</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">do</span>(reps) <span class="sc">*</span> <span class="fu">sample_n</span>(d, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    } <span class="sc">|&gt;</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(.index) <span class="sc">|&gt;</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(averageRating)) <span class="sc">|&gt;</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">n =</span> n)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(s, samp_dist)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">n =</span> <span class="fu">numeric</span>(), <span class="at">reps =</span> <span class="fu">numeric</span>(), <span class="at">samp_dist_mean =</span> <span class="fu">numeric</span>(), <span class="at">samp_dist_se =</span> <span class="fu">numeric</span>())</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (reps <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">250</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>)) {</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    subsample <span class="ot">&lt;-</span> s <span class="sc">|&gt;</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(n) <span class="sc">|&gt;</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sample_n</span>(reps, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">samp_dist_mean =</span> <span class="fu">mean</span>(mean), <span class="at">samp_dist_se =</span> <span class="fu">sd</span>(mean)) <span class="sc">|&gt;</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">reps =</span> reps)</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>    output <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(output, subsample)</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> output, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> samp_dist_mean)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span>reps) <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Sample Size"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Mean"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">6</span>, <span class="fl">6.5</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> output, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> samp_dist_se)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span>reps) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Sample Size"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"SE"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> output, <span class="fu">aes</span>(<span class="at">x =</span> n)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> samp_dist_mean <span class="sc">+</span> samp_dist_se),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> samp_dist_mean)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> samp_dist_mean <span class="sc">-</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    samp_dist_se), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span>reps) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Sample Size"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Mean ± SE"</span>) <span class="sc">+</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fl">5.8</span>, <span class="fl">6.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p2, p3, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="12-module_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that as the number of replicates increases, our estimates of both the mean and SE become less variable, while as the sample size increases, our SE decreases (and our estimate of the mean thus becomes less uncertain), regardless of number of replicates.</p>
<section id="calculating-ses-from-the-population-variance" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="calculating-ses-from-the-population-variance">Calculating SEs from the Population Variance</h4>
<p>Note that above, we estimated the <strong>SE</strong> by taking the standard deviation of a sampling distribution, where we derived that distribution by taking multiple samples from a perfectly known population. However, if we know the actual population variance (<span class="math inline">\(\sigma^2\)</span>) or population standard deviation (<span class="math inline">\(\sigma\)</span>), which we do in this case, we can actually calculate the expected <strong>SE</strong> for samples of a given size <em>directly</em>, without basing that on an empirical sampling distribution that we have derived from repeated sampling. This is because, mathematically, the variance of a fully realized sampling distribution (i.e., of taking all possible samples of size <span class="math inline">\(n\)</span> from a population) is equal to the variance of the population divided by the sample size. The square root of the variance of the sampling distribution is the standard deviation, i.e., the standard error.</p>
<p><span class="math display">\[SE = \sqrt{\frac{\sigma^2}{n}} = \frac{\sigma}{\sqrt{n}}\]</span></p>
<p>where <span class="math inline">\(\sigma^2\)</span> is the population variance (and <span class="math inline">\(\sigma\)</span> is thus the population standard deviation) and <span class="math inline">\(n\)</span> is the sample size.</p>
<p>We can compare the SEs for different sample sizes estimated above from our empirical sampling distributions with the SEs calculated directly from the population variance using the code below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select estimated SEs for different sample sizes with 1000 reps from our</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># output tibble</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>sampling_output <span class="ot">&lt;-</span> <span class="fu">filter</span>(output, reps <span class="sc">==</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(n, samp_dist_se)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a tibble of SEs based on the known population variance</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>pop_output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">n =</span> <span class="fu">numeric</span>(), <span class="at">pop_se =</span> <span class="fu">numeric</span>())</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">10</span>)) {</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    pop_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">pop_var</span>(d<span class="sc">$</span>averageRating)<span class="sc">/</span>n)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    pop_output <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pop_output, <span class="fu">c</span>(<span class="at">n =</span> n, <span class="at">pop_se =</span> pop_se))</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>(compare <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(sampling_output, pop_output, <span class="at">by =</span> <span class="st">"n"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 10 × 3
##        n samp_dist_se pop_se
##    &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;
##  1    20       0.257  0.259 
##  2    40       0.183  0.183 
##  3    60       0.150  0.150 
##  4    80       0.129  0.130 
##  5   100       0.114  0.116 
##  6   120       0.102  0.106 
##  7   140       0.0981 0.0981
##  8   160       0.0871 0.0917
##  9   180       0.0859 0.0865
## 10   200       0.0775 0.0820</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the sample_dist_se and pop_se columns should be very close in value!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimating-ses-from-a-single-sample" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="estimating-ses-from-a-single-sample">Estimating SEs from a Single Sample</h4>
<p>Of course, in practice we often do not know the true population variance or standard deviation, nor do we have the opportunity to generate a sampling distribution empirically and then use this to estimate the <strong>SE</strong>. Instead, we collect typically just collect a single sample from a population about which we know very little.</p>
<p>In these cases, we use some statistic about our single sample as a <strong>point estimate</strong> for the parameter value in our population (e.g., <span class="math inline">\(\bar{x}\)</span> for <span class="math inline">\(\mu\)</span>), and we use the variance or standard deviation and size of that single sample to estimate the <strong>SE</strong> around that point estimate for our statistic of interest: i.e., <strong>square root of (sample variance / sample size)</strong> or <strong>sample standard deviation / (square root of sample size)</strong></p>
<p><span class="math display">\[SE = \sqrt{\frac{s^2}{n}} = \frac{s}{\sqrt{n}}\]</span></p>
<p>where <span class="math inline">\(s^2\)</span> is the sample variance and <span class="math inline">\(s\)</span> is the sample standard deviation.</p>
</section>
</section>
<section id="challenge-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-3">CHALLENGE</h3>
<ul>
<li>Write your own function to calculate the <strong>standard error of the mean</strong> for a vector of values representing a single sample of observations from a population. You can use either your own function for the sample variance that you created above or the built-in <code>var()</code> function. There are, of course, several ways you could do this. Then, use your new function with <code>summarize()</code> and <code>sample_n()</code> to extract a single sample of size “n=100” from <strong>d</strong> and calculate an estimate of the population SE for that sample size.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>my_se1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="fu">sample_var</span>(x)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>my_se2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>my_se3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x))</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>new_sample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(d, <span class="at">size =</span> n)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(new_sample, <span class="at">se1 =</span> <span class="fu">my_se1</span>(averageRating), <span class="at">se2 =</span> <span class="fu">my_se2</span>(averageRating), <span class="at">se3 =</span> <span class="fu">my_se3</span>(averageRating))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## # A tibble: 1 × 3
##     se1   se2   se3
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 0.118 0.118 0.118</code></pre>
</details>
</div>
</div>
<p>The package {sciplot} includes the function, <code>se()</code>, for calculating standard errors (as do others).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sciplot)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(new_sample, <span class="at">se4 =</span> sciplot<span class="sc">::</span><span class="fu">se</span>(averageRating))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 1 × 1
##     se4
##   &lt;dbl&gt;
## 1 0.118</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>sciplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="concept-review" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="concept-review">Concept Review</h2>
<ul>
<li><p><span class="math inline">\(\mu, \bar{x}\)</span> = population mean, sample mean</p>
<ul>
<li><span class="math inline">\(\bar{x}\)</span> is an estimator for <span class="math inline">\(\mu\)</span></li>
</ul></li>
<li><p><span class="math inline">\(\sigma^2, s^2\)</span> = population variance, sample variance</p></li>
<li><p><span class="math inline">\(\sigma, s\)</span> = population standard deviation, sample standard deviation</p>
<ul>
<li><span class="math inline">\(s\)</span> is an estimator for <span class="math inline">\(\sigma\)</span></li>
</ul></li>
<li><p>Sample variance and standard deviation: <code>var()</code>, <code>sd()</code></p>
<ul>
<li>These are measures of the variation/spread in a <strong>sample</strong></li>
</ul></li>
<li><p>Sampling distributions and standard errors</p>
<ul>
<li><p>Mean of the sampling distribution of <span class="math inline">\(\bar{x}\)</span> is an estimate of <span class="math inline">\(\mu\)</span></p></li>
<li><p>Standard deviation of the sampling distribution of <span class="math inline">\(\bar{x}\)</span> = <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span> = standard error</p>
<ul>
<li>This is a measure of the variation/spread in a <strong>sample statistic</strong></li>
</ul></li>
<li><p>Standard errors: <code>sciplot::se()</code></p></li>
</ul></li>
<li><p>Using the <code>sample_n()</code> function from {dplyr} and <code>do() * &lt;function&gt;</code> construction from {mosaic} to generate sampling distributions</p></li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./11-module.html" class="pagination-link  aria-label=" &lt;span="" and="" flow="" control&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Functions and Flow Control</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./13-module.html" class="pagination-link" aria-label="<span class='chapter-number'>13</span>&nbsp; <span class='chapter-title'>Probability and Distributions</span>">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb78" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Central Tendency and Spread {#module-12}</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objectives</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The objective of this module is to review some key terms and ideas that form the foundation of statistics and statistical inference. In particular, this module considers ways for describing distributions of data, particularly measures of *central tendency* and *spread* (i.e., variation) in our observations of a variable, which play an important role in both descriptive statistics and in various approaches to statistical hypothesis testing.</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminaries</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Install these packages in ***R***: <span class="co">[</span><span class="ot">{mosiac}</span><span class="co">](https://cran.r-project.org/web/packages/mosaic/mosaic)</span>, <span class="co">[</span><span class="ot">{radiant}</span><span class="co">](https://cran.r-project.org/web/packages/radiant/radiant.pdf)</span>, <span class="co">[</span><span class="ot">{sciplot}</span><span class="co">](https://cran.r-project.org/web/packages/sciplot/sciplot.pdf)</span>, and <span class="co">[</span><span class="ot">{infer}</span><span class="co">](https://cran.r-project.org/web/packages/infer/infer.pdf)</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load {tidyverse}</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important Terms</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Population** - **all** of the elements from a set of data (e.g., all of the gorillas in the world) = ***N***</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Sample** - one or more observations drawn from a population by some kind of sampling process (e.g., the set of gorillas living in Rwanda, the set of gorilla skeletons found in a museum) = ***n***</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** We often assume that a sampling process is *random*, but there are lots of ways in which sampling might be biased, thus the samples we work with *may not* be (and often *are not*) random samples!</span></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Parameter** - a measurable characteristic of a population that summarizes data (e.g., the mean value of the femur length of all gorillas)</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Population means for a given variable, **x**, are often indicated as $\mu_x$</span></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Statistic** - a measurable characteristic about a sample that summarizes data (e.g., the mean femur length of gorilla femurs found at the American Museum of Natural History)</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Sample means for a given variable, **x**, are often indicated as $\bar{x}$</span></span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>When we use statistical methods or attempt statistical inference - whether using a *null hypothesis significance testing* (*NHST*) framework or using *Bayesian* approaches - we are basically trying to estimate and draw conclusions about population-level parameters and processes and their distributions based on observations or measurements we take from a *sample*. Sometimes, we are simply trying evaluate whether it is reasonable to assume that our sample is drawn from a population with particular characteristics. Other times, we may be trying to understand what variables explain variation we see in a response measure of interest or be trying to evaluate which among a set of alternative models best predicts a given response.</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>Regardless, we should always keep in mind that the process of trying to draw conclusions about a population based on a sample can be complicated by the fact that...</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>our sample may be biased, non-random, or non-representative in some way</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>there may be unknown or unobserved variables that impact how the sample is related to the population</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the assumptions we make about the population that our sample is drawn from might not be correct</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## Describing Sets of Observations</span></span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>It is important for us to be able to describe the general characteristics of the distribution of a set of observations or measurements about a **population** or a **sample**, and we often do this by calculating some *measure(s) of central tendency* and some *measure(s) of spread* around that statistic. The "five-number summary" that we have talked about previously is doing basically just this.</span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a><span class="fu">### Measures of Central Tendency {.unnumbered}</span></span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Median** - the middle value in a rank ordered series of values</span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Mean** - the sum of measured values divided by $n$, a.k.a., the *average* or the *arithimetic mean*</span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Mode** - the most common measurement of values observed</span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Harmonic mean** - the reciprocal of the average of the reciprocals of a set of values</span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>The measures above are relevant to summarizing observations about processes that are additive.</span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Geometric mean** - a measure of central tendency for processes that are exponential (e.g., some phases of population growth in natural populations) or multiplicative (e.g., increases in area or volume that accompany increases in linear dimension) in nature, rather than additive = the $n^{th}$ root of the product of the values, taken across a set of $n$ values; for the mathematically inclined, it also equals the *antilog* of the averaged *log* values</span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-58"><a href="#cb78-58" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb78-59"><a href="#cb78-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-60"><a href="#cb78-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Given a vector, <span class="in">`x &lt;- c(1,2,3,4,5,6,7,8,9,10,25,50,100,200,1000)`</span>, write your own function to determine the *geometric mean* of the values in a vector. Remember the general form for functions is: <span class="in">`&lt;function name&gt; &lt;- function(&lt;arguments&gt;) {&lt;code&gt;}`</span></span>
<span id="cb78-61"><a href="#cb78-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-62"><a href="#cb78-62" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **HINT:** Taking the $n^{th}$ root of a number is equivalent to raising the number to the power of $\frac{1}{n}$</span></span>
<span id="cb78-63"><a href="#cb78-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-66"><a href="#cb78-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-67"><a href="#cb78-67" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb78-68"><a href="#cb78-68" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb78-69"><a href="#cb78-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb78-70"><a href="#cb78-70" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">1000</span>)</span>
<span id="cb78-71"><a href="#cb78-71" aria-hidden="true" tabindex="-1"></a>geometric_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">prod</span>(x)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(x))}</span>
<span id="cb78-72"><a href="#cb78-72" aria-hidden="true" tabindex="-1"></a><span class="fu">geometric_mean</span>(x)</span>
<span id="cb78-73"><a href="#cb78-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-74"><a href="#cb78-74" aria-hidden="true" tabindex="-1"></a>geometric_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(x)))}</span>
<span id="cb78-75"><a href="#cb78-75" aria-hidden="true" tabindex="-1"></a><span class="fu">geometric_mean</span>(x)</span>
<span id="cb78-76"><a href="#cb78-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-77"><a href="#cb78-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-78"><a href="#cb78-78" aria-hidden="true" tabindex="-1"></a>What happens if you have <span class="in">`NA`</span>s or zeros or negative numbers in your vector?</span>
<span id="cb78-79"><a href="#cb78-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-80"><a href="#cb78-80" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **HINT:** Including an </span><span class="in">`na.rm=TRUE`</span><span class="at"> argument and the function </span><span class="in">`na.omit()`</span><span class="at"> in your function code to ignore data points with </span>&lt;NA&gt;<span class="at"> values may help you write more generic functions!</span></span>
<span id="cb78-81"><a href="#cb78-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-82"><a href="#cb78-82" aria-hidden="true" tabindex="-1"></a><span class="fu">### Measures of Spread {.unnumbered}</span></span>
<span id="cb78-83"><a href="#cb78-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-84"><a href="#cb78-84" aria-hidden="true" tabindex="-1"></a>In addition to measures of central tendency, measures of spread or variability in the distribution of variables of interest are some of the most important summary statistics to calculate. The *total range* (min to max) is one measure of spread, as is the *interquartile* range (25th to 75th quartile), which as we have seen are both part of the "five-number summary".</span>
<span id="cb78-85"><a href="#cb78-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-86"><a href="#cb78-86" aria-hidden="true" tabindex="-1"></a>We more commonly characterize spread, however, in terms of some measure of the *deviation of a set of values from the mean of those values*. One such measure is the **sum of squares**...</span>
<span id="cb78-87"><a href="#cb78-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-88"><a href="#cb78-88" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>***Sum of Squares*** = the sum of the squared deviations of a set of values from the mean of that set</span>
<span id="cb78-89"><a href="#cb78-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-90"><a href="#cb78-90" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Why do we use the sum of the **squared** deviations of values from the mean rather than just the sum of deviations? Because the latter would simply be ZERO!</span></span>
<span id="cb78-91"><a href="#cb78-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-92"><a href="#cb78-92" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb78-93"><a href="#cb78-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-94"><a href="#cb78-94" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Write a function to calculate the **sum of squares** for a vector.</span>
<span id="cb78-95"><a href="#cb78-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-98"><a href="#cb78-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-99"><a href="#cb78-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb78-100"><a href="#cb78-100" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb78-101"><a href="#cb78-101" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb78-102"><a href="#cb78-102" aria-hidden="true" tabindex="-1"></a>sum_of_squares <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">sum</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)}</span>
<span id="cb78-103"><a href="#cb78-103" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_of_squares</span>(x)</span>
<span id="cb78-104"><a href="#cb78-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-105"><a href="#cb78-105" aria-hidden="true" tabindex="-1"></a><span class="co">#This is equivalent to...</span></span>
<span id="cb78-106"><a href="#cb78-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-107"><a href="#cb78-107" aria-hidden="true" tabindex="-1"></a>sum_of_squares <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">length</span>(x)<span class="sc">*</span><span class="fu">mean</span>(x)<span class="sc">^</span><span class="dv">2</span>}</span>
<span id="cb78-108"><a href="#cb78-108" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_of_squares</span>(x)</span>
<span id="cb78-109"><a href="#cb78-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-110"><a href="#cb78-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-111"><a href="#cb78-111" aria-hidden="true" tabindex="-1"></a>A shortcut to calculate the **sum of squares** for a vector, **x**, that does not actually require calculating <span class="in">`mean(x)`</span> is the <span class="in">`(sum of the squared values in the dataset) minus the (square of the summed values) / n`</span>, or...</span>
<span id="cb78-112"><a href="#cb78-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-113"><a href="#cb78-113" aria-hidden="true" tabindex="-1"></a>$$\sum\limits_{i=1}^{k}(x^2) - \frac{(\sum\limits_{i=1}^{k} x)^2}{n}$$</span>
<span id="cb78-114"><a href="#cb78-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-115"><a href="#cb78-115" aria-hidden="true" tabindex="-1"></a>Thus, another formula for the **sum of squares** is the following:</span>
<span id="cb78-116"><a href="#cb78-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-119"><a href="#cb78-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-120"><a href="#cb78-120" aria-hidden="true" tabindex="-1"></a>sum_of_squares <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> (<span class="fu">sum</span>(x))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">length</span>(x)}</span>
<span id="cb78-121"><a href="#cb78-121" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_of_squares</span>(x)</span>
<span id="cb78-122"><a href="#cb78-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-123"><a href="#cb78-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-124"><a href="#cb78-124" aria-hidden="true" tabindex="-1"></a>Note that the **sum of squares** always increases with sample size... you can see this by adding more data points to your vector. Thus, to be able to compare across data sets of different size, we are often more interested in the *average* deviation of values from the mean rather than the straight sum of squares, i.e., a **mean squared deviation**.</span>
<span id="cb78-125"><a href="#cb78-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-126"><a href="#cb78-126" aria-hidden="true" tabindex="-1"></a>This is the definition of the variability or **variance** in a dataset. If we are simply interested in describing the mean squared deviation in a *population*, where we have a value or measurement for every case (e.g., the femur length of all of the gorillas in a museum *population*), we could then just divide the **sum of squares** by the number of cases.</span>
<span id="cb78-127"><a href="#cb78-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-128"><a href="#cb78-128" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>***Population Variance*** ($\sigma^2$) = $\frac{SS}{N}$</span>
<span id="cb78-129"><a href="#cb78-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-130"><a href="#cb78-130" aria-hidden="true" tabindex="-1"></a>In ***R*** parlance, we can write this as:</span>
<span id="cb78-131"><a href="#cb78-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-134"><a href="#cb78-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-135"><a href="#cb78-135" aria-hidden="true" tabindex="-1"></a>pop_var <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">sum</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">length</span>(x))}</span>
<span id="cb78-136"><a href="#cb78-136" aria-hidden="true" tabindex="-1"></a><span class="fu">pop_var</span>(x)</span>
<span id="cb78-137"><a href="#cb78-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-138"><a href="#cb78-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-139"><a href="#cb78-139" aria-hidden="true" tabindex="-1"></a>If, however, we have not measured all of the individual cases in population - i.e., if we are, instead, dealing with a *sample* from the population and are trying to use that sample to say something about the population from which it is drawn (e.g., to say something about gorilla femur lengths in general based on those that appear in a museum *sample*) - then we need to use a slightly different formula to get an unbiased estimate of the population variance. Such an estimate for a population parameter, based on data from a sample, is calculated as:</span>
<span id="cb78-140"><a href="#cb78-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-141"><a href="#cb78-141" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>***Sample Variance*** (an *estimator* of the population variance) = $\frac{SS}{n-1}$</span>
<span id="cb78-142"><a href="#cb78-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-143"><a href="#cb78-143" aria-hidden="true" tabindex="-1"></a>In this formula, $n - 1$ is the number of *degrees of freedom* implied by the sample. The *degrees of freedom* is the number of values used to calculate a sample statistic that are "free to vary". For example, we used *n* observations to calculate the mean of our sample, which implies $n - 1$ degrees of freedom (i.e., if we know the mean and $n - 1$ values, then we also know the last value... it is *not* "free to vary"). We then use that statistic about our sample (i.e., the sample mean) as an estimate of the population mean, which is then used to derive an estimate of the population variance based on the sample variance.</span>
<span id="cb78-144"><a href="#cb78-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-145"><a href="#cb78-145" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb78-146"><a href="#cb78-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-147"><a href="#cb78-147" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Write a function to calculate the **variance** for a vector of values representing a *sample* of measurements. Remember this means dividing the sample sum of squares by $n-1$.</span>
<span id="cb78-148"><a href="#cb78-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-151"><a href="#cb78-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-152"><a href="#cb78-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb78-153"><a href="#cb78-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb78-154"><a href="#cb78-154" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb78-155"><a href="#cb78-155" aria-hidden="true" tabindex="-1"></a>sample_var <span class="ot">&lt;-</span> <span class="cf">function</span> (x){<span class="fu">sum</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)}</span>
<span id="cb78-156"><a href="#cb78-156" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_var</span>(x)</span>
<span id="cb78-157"><a href="#cb78-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-158"><a href="#cb78-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-159"><a href="#cb78-159" aria-hidden="true" tabindex="-1"></a>Compare the results of your function to the built-in ***R*** function, <span class="in">`var()`</span>, which calculates sample variance.</span>
<span id="cb78-160"><a href="#cb78-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-163"><a href="#cb78-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-164"><a href="#cb78-164" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb78-165"><a href="#cb78-165" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb78-166"><a href="#cb78-166" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb78-167"><a href="#cb78-167" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x)</span>
<span id="cb78-168"><a href="#cb78-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-169"><a href="#cb78-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-170"><a href="#cb78-170" aria-hidden="true" tabindex="-1"></a><span class="fu">### Questions to Explore {.unnumbered}</span></span>
<span id="cb78-171"><a href="#cb78-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-172"><a href="#cb78-172" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For a random variable, how is variance related to sample size?</span>
<span id="cb78-173"><a href="#cb78-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-174"><a href="#cb78-174" aria-hidden="true" tabindex="-1"></a>We will explore this, and at the same time practice a bit about **loops** in ***R*** programming, via **simulation**, where we repeatedly draw samples of random variables from a specific distribution. As an example, we will we draw from a normal distribution with a mean of 10 and a standard deviation of 2.</span>
<span id="cb78-175"><a href="#cb78-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-176"><a href="#cb78-176" aria-hidden="true" tabindex="-1"></a>To visualize this distribution, we can use the <span class="in">`plotDist()`</span> function from the {mosaic} package...</span>
<span id="cb78-177"><a href="#cb78-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-180"><a href="#cb78-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-181"><a href="#cb78-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-182"><a href="#cb78-182" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb78-183"><a href="#cb78-183" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb78-184"><a href="#cb78-184" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb78-185"><a href="#cb78-185" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb78-186"><a href="#cb78-186" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"norm"</span>, <span class="at">mean=</span>mu, <span class="at">sd=</span>sigma, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"Frequency"</span>)</span>
<span id="cb78-187"><a href="#cb78-187" aria-hidden="true" tabindex="-1"></a><span class="co"># `plotDist()` comes from the {mosaic} package and makes it easy to plot a distribution</span></span>
<span id="cb78-188"><a href="#cb78-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-189"><a href="#cb78-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-190"><a href="#cb78-190" aria-hidden="true" tabindex="-1"></a>In the following code block, we first set up a plot window to hold the results of our simulations and plot a line for the known population variance (i.e., the square of $\sigma$, the standard deviation). We then use nested <span class="in">`for`</span> loops to iterate the process of drawing samples of a specific size, $n$, from the specified distribution. We do this for samples of size $n$ = 5, 10, 15... up to 100, and we draw out 50 replicates of each sample size. Recall from <span class="co">[</span><span class="ot">**Module 11**</span><span class="co">](#module-11)</span> that the structure for <span class="in">`for`</span> loops is:</span>
<span id="cb78-191"><a href="#cb78-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-192"><a href="#cb78-192" aria-hidden="true" tabindex="-1"></a><span class="in">    for (&lt;index&gt; in &lt;range&gt;){</span></span>
<span id="cb78-193"><a href="#cb78-193" aria-hidden="true" tabindex="-1"></a><span class="in">      &lt;code to execute&gt;</span></span>
<span id="cb78-194"><a href="#cb78-194" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb78-195"><a href="#cb78-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-198"><a href="#cb78-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-199"><a href="#cb78-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb78-200"><a href="#cb78-200" aria-hidden="true" tabindex="-1"></a><span class="co"># set up plot window</span></span>
<span id="cb78-201"><a href="#cb78-201" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb78-202"><a href="#cb78-202" aria-hidden="true" tabindex="-1"></a>     <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>),</span>
<span id="cb78-203"><a href="#cb78-203" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb78-204"><a href="#cb78-204" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Sample Size"</span>,</span>
<span id="cb78-205"><a href="#cb78-205" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Variance"</span>)</span>
<span id="cb78-206"><a href="#cb78-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-207"><a href="#cb78-207" aria-hidden="true" tabindex="-1"></a><span class="co"># add the population variance (= square of population standard deviation) to the plot</span></span>
<span id="cb78-208"><a href="#cb78-208" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(</span>
<span id="cb78-209"><a href="#cb78-209" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> <span class="dv">4</span>,</span>
<span id="cb78-210"><a href="#cb78-210" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb78-211"><a href="#cb78-211" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb78-212"><a href="#cb78-212" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="dv">2</span></span>
<span id="cb78-213"><a href="#cb78-213" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-214"><a href="#cb78-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-215"><a href="#cb78-215" aria-hidden="true" tabindex="-1"></a><span class="co"># run simulations and add results to plot</span></span>
<span id="cb78-216"><a href="#cb78-216" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb78-217"><a href="#cb78-217" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb78-218"><a href="#cb78-218" aria-hidden="true" tabindex="-1"></a><span class="co"># samples of 5, 10, 15...</span></span>
<span id="cb78-219"><a href="#cb78-219" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">5</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>)) {</span>
<span id="cb78-220"><a href="#cb78-220" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set up a variable, reps, to hold the set of variances calculated for each replicate</span></span>
<span id="cb78-221"><a href="#cb78-221" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"double"</span>, <span class="dv">50</span>)</span>
<span id="cb78-222"><a href="#cb78-222" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 50 replicates</span></span>
<span id="cb78-223"><a href="#cb78-223" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>) {</span>
<span id="cb78-224"><a href="#cb78-224" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb78-225"><a href="#cb78-225" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(n, <span class="fu">var</span>(x))</span>
<span id="cb78-226"><a href="#cb78-226" aria-hidden="true" tabindex="-1"></a>    reps[[i]] <span class="ot">=</span> <span class="fu">var</span>(x)</span>
<span id="cb78-227"><a href="#cb78-227" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this is a common programming motif in R and is more memory and time efficient than another common motif, `reps &lt;- c(reps, var(x))`</span></span>
<span id="cb78-228"><a href="#cb78-228" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-229"><a href="#cb78-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(n,</span>
<span id="cb78-230"><a href="#cb78-230" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mean</span>(reps),</span>
<span id="cb78-231"><a href="#cb78-231" aria-hidden="true" tabindex="-1"></a>         <span class="at">bg =</span> <span class="st">"red"</span>,</span>
<span id="cb78-232"><a href="#cb78-232" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch =</span> <span class="dv">23</span>,</span>
<span id="cb78-233"><a href="#cb78-233" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="dv">2</span>) <span class="co"># plots average</span></span>
<span id="cb78-234"><a href="#cb78-234" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-235"><a href="#cb78-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-236"><a href="#cb78-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-237"><a href="#cb78-237" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How does *sample variance* compare to *population variance*? What happens to the sample variances as sample size increases?</span>
<span id="cb78-238"><a href="#cb78-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-239"><a href="#cb78-239" aria-hidden="true" tabindex="-1"></a>Another measure of spread around a mean that we often see reported is the **standard deviation**. The standard deviation is simply the *square root of the variance* ($\sqrt{\sigma^2} = \sigma$). The advantage of using the standard deviation as a statistic or parameter is that the units of standard deviation are the same as the units of our original measurement (rather than being units squared, which are our units for variance).</span>
<span id="cb78-240"><a href="#cb78-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-241"><a href="#cb78-241" aria-hidden="true" tabindex="-1"></a>In ***R*** we can write...</span>
<span id="cb78-242"><a href="#cb78-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-245"><a href="#cb78-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-246"><a href="#cb78-246" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb78-247"><a href="#cb78-247" aria-hidden="true" tabindex="-1"></a>pop_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">sqrt</span>(<span class="fu">pop_var</span>(x))}</span>
<span id="cb78-248"><a href="#cb78-248" aria-hidden="true" tabindex="-1"></a><span class="fu">pop_sd</span>(x)</span>
<span id="cb78-249"><a href="#cb78-249" aria-hidden="true" tabindex="-1"></a>sample_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">sqrt</span>(<span class="fu">sample_var</span>(x))}</span>
<span id="cb78-250"><a href="#cb78-250" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sd</span>(x)</span>
<span id="cb78-251"><a href="#cb78-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-252"><a href="#cb78-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-253"><a href="#cb78-253" aria-hidden="true" tabindex="-1"></a>The <span class="in">`sdpop()`</span> function from the {radiant} package can be used to calculate the standard deviation for a completely sampled population.</span>
<span id="cb78-254"><a href="#cb78-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-257"><a href="#cb78-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-258"><a href="#cb78-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-259"><a href="#cb78-259" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(radiant)</span>
<span id="cb78-260"><a href="#cb78-260" aria-hidden="true" tabindex="-1"></a><span class="fu">sdpop</span>(x)</span>
<span id="cb78-261"><a href="#cb78-261" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>radiant)</span>
<span id="cb78-262"><a href="#cb78-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-263"><a href="#cb78-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-264"><a href="#cb78-264" aria-hidden="true" tabindex="-1"></a>The built-in ***R*** function <span class="in">`sd()`</span> can be used to calculate the standard deviation of a sample.</span>
<span id="cb78-265"><a href="#cb78-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-268"><a href="#cb78-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-269"><a href="#cb78-269" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span>
<span id="cb78-270"><a href="#cb78-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-271"><a href="#cb78-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-272"><a href="#cb78-272" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using Measures of Spread</span></span>
<span id="cb78-273"><a href="#cb78-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-274"><a href="#cb78-274" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sampling Distributions {.unnumbered}</span></span>
<span id="cb78-275"><a href="#cb78-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-276"><a href="#cb78-276" aria-hidden="true" tabindex="-1"></a>Since one of the goals of statistics is to estimate and make inferences about population-level parameters based on characteristics of a sample, it is important that we be able to judge and report just how reliable or unreliable our statistical estimates those population-level parameters are.</span>
<span id="cb78-277"><a href="#cb78-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-278"><a href="#cb78-278" aria-hidden="true" tabindex="-1"></a>To explore how we do this, let's start with a population where we KNOW every data point. We will use that first to describe our population empirically. We will then draw samples out of that population and see how well that the samples we draw can be used to describe the population.</span>
<span id="cb78-279"><a href="#cb78-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-280"><a href="#cb78-280" aria-hidden="true" tabindex="-1"></a>Load the "IMDB-movies.csv" dataset from the **ada-datasets** repository on ***GitHub*** as a "tibble", **d**. This dataset contains data on close to 29,000 movies scraped in early 2020 from the online <span class="co">[</span><span class="ot">Internet Movie Database</span><span class="co">](https://www.imdb.com/interfaces/)</span>, including their year of title, director, year of production, running time, average viewer rating on a 10 point scale, and the number of votes that rating is based on. <span class="co">[</span><span class="ot">Note that in collating this data, I excluded movies with fewer than 1000 votes.</span><span class="co">]</span> Once we load the data, we will filter the dataset to keep only movies with a <span class="in">`startYear`</span> from 1999 to 2019, which should leave us with 17,628 movies. We are going to use this dataset as our POPULATION.</span>
<span id="cb78-281"><a href="#cb78-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-284"><a href="#cb78-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-285"><a href="#cb78-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-286"><a href="#cb78-286" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/IMDB-movies.csv"</span></span>
<span id="cb78-287"><a href="#cb78-287" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-288"><a href="#cb78-288" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">filter</span>(d, startYear <span class="sc">%in%</span> <span class="dv">1999</span><span class="sc">:</span><span class="dv">2019</span>) <span class="co"># the %in% operator is VERY useful!</span></span>
<span id="cb78-289"><a href="#cb78-289" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb78-290"><a href="#cb78-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-291"><a href="#cb78-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-292"><a href="#cb78-292" aria-hidden="true" tabindex="-1"></a>First, we will do some exploratory data analysis on this dataset using, in part, some functions from the {mosaic} package. {mosaic} makes some kinds of quick exploratory data analysis very fast and easy to do (though we already know how to do lots of what we can do with {mosaic} in other ways)!</span>
<span id="cb78-293"><a href="#cb78-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-294"><a href="#cb78-294" aria-hidden="true" tabindex="-1"></a>Functions in the {mosaic} package have a <span class="in">`data=`</span> argument as well as a <span class="in">`~`</span> argument that specifies which variable of interest from the <span class="in">`data=`</span> argument the function is to be applied to.</span>
<span id="cb78-295"><a href="#cb78-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-298"><a href="#cb78-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-299"><a href="#cb78-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-300"><a href="#cb78-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb78-301"><a href="#cb78-301" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(averageRating <span class="sc">~</span> startYear, <span class="at">data=</span>d, <span class="at">xlab=</span><span class="st">"Year"</span>, <span class="at">ylab=</span><span class="st">"Average Rating"</span>)</span>
<span id="cb78-302"><a href="#cb78-302" aria-hidden="true" tabindex="-1"></a><span class="co"># the `histogram()` function from {mosaic} plots neat "augmented" histograms</span></span>
<span id="cb78-303"><a href="#cb78-303" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span> averageRating, <span class="at">data=</span>d, <span class="at">xlab=</span><span class="st">"Average Rating"</span>)</span>
<span id="cb78-304"><a href="#cb78-304" aria-hidden="true" tabindex="-1"></a><span class="co"># the `favstats()` function from {mosiac} calculates a variant of the 5-number summary</span></span>
<span id="cb78-305"><a href="#cb78-305" aria-hidden="true" tabindex="-1"></a>(pop_stats <span class="ot">&lt;-</span> <span class="fu">favstats</span>(<span class="sc">~</span> averageRating, <span class="at">data =</span> d))</span>
<span id="cb78-306"><a href="#cb78-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-307"><a href="#cb78-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-308"><a href="#cb78-308" aria-hidden="true" tabindex="-1"></a>Now, let's draw a single SAMPLE of 100 movies randomly from this population and visualize its average viewer rating. After setting the random number seed (analogous to setting what position we start at in a traditional table of random numbers), run the subsequent lines of code several times and look at how the results differ...</span>
<span id="cb78-309"><a href="#cb78-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-310"><a href="#cb78-310" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** We use </span><span class="in">`set.seed()`</span><span class="at"> here so that each time this function is run, it returns the same sequence of random numbers until the seed is reset.</span></span>
<span id="cb78-311"><a href="#cb78-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-314"><a href="#cb78-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-315"><a href="#cb78-315" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb78-316"><a href="#cb78-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-317"><a href="#cb78-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-320"><a href="#cb78-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-321"><a href="#cb78-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-322"><a href="#cb78-322" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb78-323"><a href="#cb78-323" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb78-324"><a href="#cb78-324" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(d, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb78-325"><a href="#cb78-325" aria-hidden="true" tabindex="-1"></a><span class="co"># `sample_n()` from {dplyr} selects rows at random from a data frame</span></span>
<span id="cb78-326"><a href="#cb78-326" aria-hidden="true" tabindex="-1"></a><span class="co"># it's another SUPER useful function</span></span>
<span id="cb78-327"><a href="#cb78-327" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(s<span class="sc">$</span>startYear)</span>
<span id="cb78-328"><a href="#cb78-328" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(averageRating <span class="sc">~</span> startYear, <span class="at">data=</span>s, <span class="at">xlab=</span><span class="st">"Year"</span>, <span class="at">ylab=</span><span class="st">"Average Rating"</span>)</span>
<span id="cb78-329"><a href="#cb78-329" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span> averageRating, <span class="at">data=</span>s, <span class="at">xlab=</span><span class="st">"Average Rating"</span>)</span>
<span id="cb78-330"><a href="#cb78-330" aria-hidden="true" tabindex="-1"></a>(samp_stats <span class="ot">&lt;-</span> <span class="fu">favstats</span>(<span class="sc">~</span> averageRating, <span class="at">data =</span> s))</span>
<span id="cb78-331"><a href="#cb78-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-332"><a href="#cb78-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-333"><a href="#cb78-333" aria-hidden="true" tabindex="-1"></a>Note that each time we select a sample and calculate summary statistics, such as the mean and standard deviation of a sample, we get slightly different results. If we repeat this sampling process multiple times, we can use the results to generate a **distribution** for a particular summary statistic of interest, e.g., for the mean or the median. This process generates what is called a **sampling distribution** for the statistic.</span>
<span id="cb78-334"><a href="#cb78-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-335"><a href="#cb78-335" aria-hidden="true" tabindex="-1"></a>The code below allows us to generate a sampling distribution virtually. The <span class="in">`do() *`</span> construction from {mosaic}, in combination with one of the {mosaic} package's aggregating functions (e.g., <span class="in">`mean()`</span>, <span class="in">`median()`</span>, etc.), can be used to repeat sampling from the population a user-specified number of times, calculate a summary statistic, and then bundle the results into a vector all in the same line. <span class="co">[</span><span class="ot">Of course, we could also write a loop to do the same thing... and there are other ways we could do this as well (see examples below).</span><span class="co">]</span></span>
<span id="cb78-336"><a href="#cb78-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-337"><a href="#cb78-337" aria-hidden="true" tabindex="-1"></a>This process of *simulating* samples drawn from a population and then generating statistics on the basis of each of our virtual samples is a very powerful tool that we will apply over and over again as we talk about statistical inference. This process is the basis for bootstrapping confidence intervals (see [**Module 14**](#module-14)) and for conducting randomization/permutation tests (see [**Module 16**](#module-16).</span>
<span id="cb78-338"><a href="#cb78-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-339"><a href="#cb78-339" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Using the {mosaic} Package {.unnumbered}</span></span>
<span id="cb78-340"><a href="#cb78-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-343"><a href="#cb78-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-344"><a href="#cb78-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-345"><a href="#cb78-345" aria-hidden="true" tabindex="-1"></a><span class="co"># using `do(reps) *` from {mosaic} to generate a sampling distribution</span></span>
<span id="cb78-346"><a href="#cb78-346" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb78-347"><a href="#cb78-347" aria-hidden="true" tabindex="-1"></a>samp_dist_mean <span class="ot">&lt;-</span></span>
<span id="cb78-348"><a href="#cb78-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(reps) <span class="sc">*</span> <span class="fu">mean</span>(<span class="sc">~</span> averageRating, <span class="at">data=</span><span class="fu">sample_n</span>(d, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb78-349"><a href="#cb78-349" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generates a sampling distribution</span></span>
<span id="cb78-350"><a href="#cb78-350" aria-hidden="true" tabindex="-1"></a>mean_plot <span class="ot">&lt;-</span></span>
<span id="cb78-351"><a href="#cb78-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">histogram</span>( <span class="sc">~</span> mean, <span class="at">data =</span> samp_dist_mean,</span>
<span id="cb78-352"><a href="#cb78-352" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"Sampling Distribution for the</span><span class="sc">\n</span><span class="st">Mean of Average Rating"</span>)</span>
<span id="cb78-353"><a href="#cb78-353" aria-hidden="true" tabindex="-1"></a>samp_dist_median <span class="ot">&lt;-</span></span>
<span id="cb78-354"><a href="#cb78-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(reps) <span class="sc">*</span> <span class="fu">median</span>( <span class="sc">~</span> averageRating, <span class="at">data =</span> <span class="fu">sample_n</span>(d, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>))</span>
<span id="cb78-355"><a href="#cb78-355" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generates a sampling distribution</span></span>
<span id="cb78-356"><a href="#cb78-356" aria-hidden="true" tabindex="-1"></a>median_plot <span class="ot">&lt;-</span></span>
<span id="cb78-357"><a href="#cb78-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">histogram</span>(<span class="sc">~</span> median, <span class="at">data=</span>samp_dist_median,</span>
<span id="cb78-358"><a href="#cb78-358" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"Sampling Distribution for the</span><span class="sc">\n</span><span class="st">Median of Average Rating"</span>)</span>
<span id="cb78-359"><a href="#cb78-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-360"><a href="#cb78-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-361"><a href="#cb78-361" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Using the {purrr} Package {.unnumbered}</span></span>
<span id="cb78-364"><a href="#cb78-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-365"><a href="#cb78-365" aria-hidden="true" tabindex="-1"></a><span class="co"># using `rerun()` from {purrr} to generate a sampling distribution</span></span>
<span id="cb78-366"><a href="#cb78-366" aria-hidden="true" tabindex="-1"></a>samp_dist_mean_alt1 <span class="ot">&lt;-</span></span>
<span id="cb78-367"><a href="#cb78-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rerun</span>(reps, <span class="fu">mean</span>(<span class="sc">~</span> averageRating,</span>
<span id="cb78-368"><a href="#cb78-368" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span><span class="fu">sample_n</span>(d, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>))) <span class="sc">|&gt;</span></span>
<span id="cb78-369"><a href="#cb78-369" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>()</span>
<span id="cb78-370"><a href="#cb78-370" aria-hidden="true" tabindex="-1"></a>mean_plot_alt1 <span class="ot">&lt;-</span></span>
<span id="cb78-371"><a href="#cb78-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">histogram</span>(samp_dist_mean_alt1,</span>
<span id="cb78-372"><a href="#cb78-372" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Sampling Distribution for the</span><span class="sc">\n</span><span class="st">Mean of Average Rating"</span>)</span>
<span id="cb78-373"><a href="#cb78-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-374"><a href="#cb78-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-375"><a href="#cb78-375" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Using the {infer} Package {.unnumbered}</span></span>
<span id="cb78-376"><a href="#cb78-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-379"><a href="#cb78-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-380"><a href="#cb78-380" aria-hidden="true" tabindex="-1"></a><span class="co"># using `rep_sample_n()` from {infer} to generate a sampling distribution</span></span>
<span id="cb78-381"><a href="#cb78-381" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb78-382"><a href="#cb78-382" aria-hidden="true" tabindex="-1"></a>samp_dist_mean_alt2 <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb78-383"><a href="#cb78-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep_sample_n</span>(<span class="at">size =</span> n, <span class="at">reps =</span> reps, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-384"><a href="#cb78-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(replicate) <span class="sc">|&gt;</span></span>
<span id="cb78-385"><a href="#cb78-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(averageRating)) <span class="sc">|&gt;</span></span>
<span id="cb78-386"><a href="#cb78-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(mean)</span>
<span id="cb78-387"><a href="#cb78-387" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>infer)</span>
<span id="cb78-388"><a href="#cb78-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-389"><a href="#cb78-389" aria-hidden="true" tabindex="-1"></a>mean_plot_alt2 <span class="ot">&lt;-</span></span>
<span id="cb78-390"><a href="#cb78-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">histogram</span>(samp_dist_mean_alt2,</span>
<span id="cb78-391"><a href="#cb78-391" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Sampling Distribution for the</span><span class="sc">\n</span><span class="st">Mean of Average Rating"</span>)</span>
<span id="cb78-392"><a href="#cb78-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-393"><a href="#cb78-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-396"><a href="#cb78-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-397"><a href="#cb78-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-398"><a href="#cb78-398" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb78-399"><a href="#cb78-399" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb78-400"><a href="#cb78-400" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(mean_plot, median_plot, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb78-401"><a href="#cb78-401" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>cowplot)</span>
<span id="cb78-402"><a href="#cb78-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-403"><a href="#cb78-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-404"><a href="#cb78-404" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **IMPORTANT NOTE:** The histograms we plot in the code above are for **sampling distributions** of the statistics in question. They do not represent the distribution of values in any particular sample! This is SUPER IMPORTANT to recognize and keep in mind.</span></span>
<span id="cb78-405"><a href="#cb78-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-406"><a href="#cb78-406" aria-hidden="true" tabindex="-1"></a>The **mean of the sampling distribution** (i.e., the mean of $\bar{x}$) for a particular statistic should be a really good **point estimate** of the population value for that statistic (i.e., $\mu$). Compare the following to confirm this:</span>
<span id="cb78-407"><a href="#cb78-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-410"><a href="#cb78-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-411"><a href="#cb78-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-412"><a href="#cb78-412" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="sc">~</span> mean, <span class="at">data=</span>samp_dist_mean)</span>
<span id="cb78-413"><a href="#cb78-413" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the estimated population mean calculated as the</span></span>
<span id="cb78-414"><a href="#cb78-414" aria-hidden="true" tabindex="-1"></a><span class="co"># mean of the sampling distribution of sample means</span></span>
<span id="cb78-415"><a href="#cb78-415" aria-hidden="true" tabindex="-1"></a>pop_stats<span class="sc">$</span>mean <span class="co"># true population mean</span></span>
<span id="cb78-416"><a href="#cb78-416" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="sc">~</span> median, <span class="at">data=</span>samp_dist_median)</span>
<span id="cb78-417"><a href="#cb78-417" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the estimated population median calculated as the</span></span>
<span id="cb78-418"><a href="#cb78-418" aria-hidden="true" tabindex="-1"></a><span class="co"># mean of the sampling distribution of sample medians</span></span>
<span id="cb78-419"><a href="#cb78-419" aria-hidden="true" tabindex="-1"></a>pop_stats<span class="sc">$</span>median <span class="co"># true population median</span></span>
<span id="cb78-420"><a href="#cb78-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-421"><a href="#cb78-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-422"><a href="#cb78-422" aria-hidden="true" tabindex="-1"></a><span class="fu">### Standard Errors {.unnumbered}</span></span>
<span id="cb78-423"><a href="#cb78-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-424"><a href="#cb78-424" aria-hidden="true" tabindex="-1"></a>So, just how reliable or unreliable are these estimates of a population parameter based on the mean of the sampling distribution for a statistic of interest? That is, how far off is a statistic that we calculate based on a sampling distribution likely to be from the true POPULATION value of the parameter of interest?</span>
<span id="cb78-425"><a href="#cb78-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-426"><a href="#cb78-426" aria-hidden="true" tabindex="-1"></a>One way to quantify the uncertainty is by calculating the variability of the summary statistic of interest across replicate samples drawn from the population. For example, we could calculate the *variance of the sampling distribution*. More commonly, because variance is expressed in *units squared*, we take the square root of this variance to calculate the *standard deviation of the sampling distribution* and thus express our uncertainly in *units* of the original measurement. Formally, this value is referred to as the **standard error** (**SE**) of measurement for any given summary statistic of interest. [Typically, that statistic is the *mean*, and we thus are calculating the *standard error of the mean*.]</span>
<span id="cb78-427"><a href="#cb78-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-428"><a href="#cb78-428" aria-hidden="true" tabindex="-1"></a>The **SE** is, in effect, the *average deviation* between statistic values calculated from different and incomplete sets of samples drawn from a population and the average statistic value calculated across that set of samples (which should converge on the true population value for that statistic). The SE of the mean is thus a measure of *how dispersed sample means (*$\bar{x}$) are expected to be around the estimated population mean ($\mu$) (i.e., how far off from the true population mean an estimate based on a sample of size $n$ is likely to be). Similarly, the SE of the median would be a measure of how dispersed sample medians are expected to be, on average, around the estimated population median, and so forth.</span>
<span id="cb78-429"><a href="#cb78-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-430"><a href="#cb78-430" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Estimating a SE from a Sampling Distribution {.unnumbered}</span></span>
<span id="cb78-431"><a href="#cb78-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-432"><a href="#cb78-432" aria-hidden="true" tabindex="-1"></a>To estimate the SE from a sampling distribution, we simply take the standard standard deviation of the set of values comprising that distribution. Above, we used the <span class="in">`do() * &lt;function&gt;`</span> construction to generate sampling distributions for the mean and median of average viewer ratings in the "movies.csv" dataset, so all we need to do is pull out the standard deviation of those distributions to estimate the standard error.</span>
<span id="cb78-433"><a href="#cb78-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-436"><a href="#cb78-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-437"><a href="#cb78-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-438"><a href="#cb78-438" aria-hidden="true" tabindex="-1"></a>se_mean <span class="ot">&lt;-</span> <span class="fu">favstats</span>(<span class="sc">~</span> mean, <span class="at">data=</span>samp_dist_mean)<span class="sc">$</span>sd</span>
<span id="cb78-439"><a href="#cb78-439" aria-hidden="true" tabindex="-1"></a><span class="co"># or, se_mean &lt;- sd(samp_dist_mean$mean)</span></span>
<span id="cb78-440"><a href="#cb78-440" aria-hidden="true" tabindex="-1"></a>(<span class="fu">paste0</span>( <span class="st">"Estimated population mean = "</span>,</span>
<span id="cb78-441"><a href="#cb78-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">favstats</span>(<span class="sc">~</span> mean, <span class="at">data=</span>samp_dist_mean)<span class="sc">$</span>mean,<span class="dv">3</span>),</span>
<span id="cb78-442"><a href="#cb78-442" aria-hidden="true" tabindex="-1"></a>  <span class="st">" ± "</span>, <span class="fu">round</span>(se_mean,<span class="dv">3</span>),</span>
<span id="cb78-443"><a href="#cb78-443" aria-hidden="true" tabindex="-1"></a>  <span class="st">" SE based on "</span>, reps, <span class="st">" samples of size "</span>, n))</span>
<span id="cb78-444"><a href="#cb78-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-445"><a href="#cb78-445" aria-hidden="true" tabindex="-1"></a>se_median <span class="ot">&lt;-</span> <span class="fu">favstats</span>(<span class="sc">~</span> median, <span class="at">data=</span>samp_dist_median)<span class="sc">$</span>sd</span>
<span id="cb78-446"><a href="#cb78-446" aria-hidden="true" tabindex="-1"></a><span class="co"># or, se_median &lt;- sd(samp_dist_median$median)</span></span>
<span id="cb78-447"><a href="#cb78-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-448"><a href="#cb78-448" aria-hidden="true" tabindex="-1"></a>(<span class="fu">paste0</span>( <span class="st">"Estimated population median = "</span>,</span>
<span id="cb78-449"><a href="#cb78-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">favstats</span>(<span class="sc">~</span> median, <span class="at">data=</span>samp_dist_median)<span class="sc">$</span>mean, <span class="dv">3</span>),</span>
<span id="cb78-450"><a href="#cb78-450" aria-hidden="true" tabindex="-1"></a>  <span class="st">" ± "</span>, <span class="fu">round</span>(se_median,<span class="dv">3</span>),</span>
<span id="cb78-451"><a href="#cb78-451" aria-hidden="true" tabindex="-1"></a>  <span class="st">" SE based on "</span>, reps, <span class="st">" samples of size "</span>, n))</span>
<span id="cb78-452"><a href="#cb78-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-453"><a href="#cb78-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-454"><a href="#cb78-454" aria-hidden="true" tabindex="-1"></a>As we might expect for any measure of uncertainty or error, the **SE** [1] increases with the variability in a sample (i.e., estimates based on high-variability samples should be more uncertain) and [2] decreases with the size of the sample (i.e., estimates based on larger samples should be less uncertain). The **SE** thus reflects a ratio of variance to sample size.</span>
<span id="cb78-455"><a href="#cb78-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-456"><a href="#cb78-456" aria-hidden="true" tabindex="-1"></a><span class="fu">### Questions to Explore {.unnumbered}</span></span>
<span id="cb78-457"><a href="#cb78-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-458"><a href="#cb78-458" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How does changing the **size of our samples** (**n**) impact the **mean** and **SE** of our estimate of the population parameter?</span>
<span id="cb78-459"><a href="#cb78-459" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How does changing the **number of replicate samples** (**reps**) impact the **mean** and **SE** of our estimate of the population parameter?</span>
<span id="cb78-460"><a href="#cb78-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-461"><a href="#cb78-461" aria-hidden="true" tabindex="-1"></a>We can explore these two questions with the following code... note that we just take one set of 2000 replicates and then resample from that randomly to explore the impact of different, smaller numbers of replicates:</span>
<span id="cb78-462"><a href="#cb78-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-465"><a href="#cb78-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-466"><a href="#cb78-466" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-467"><a href="#cb78-467" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb78-468"><a href="#cb78-468" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"n"</span><span class="ot">=</span><span class="fu">numeric</span>(),</span>
<span id="cb78-469"><a href="#cb78-469" aria-hidden="true" tabindex="-1"></a>  <span class="st">"mean"</span><span class="ot">=</span><span class="fu">numeric</span>(),</span>
<span id="cb78-470"><a href="#cb78-470" aria-hidden="true" tabindex="-1"></a>  <span class="st">".index"</span><span class="ot">=</span><span class="fu">numeric</span>())</span>
<span id="cb78-471"><a href="#cb78-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-472"><a href="#cb78-472" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">20</span>, <span class="at">to=</span><span class="dv">200</span>, <span class="at">by=</span><span class="dv">20</span>)){</span>
<span id="cb78-473"><a href="#cb78-473" aria-hidden="true" tabindex="-1"></a>  samp_dist <span class="ot">&lt;-</span> {<span class="fu">do</span>(reps) <span class="sc">*</span> <span class="fu">sample_n</span>(d, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>)} <span class="sc">|&gt;</span></span>
<span id="cb78-474"><a href="#cb78-474" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(.index) <span class="sc">|&gt;</span></span>
<span id="cb78-475"><a href="#cb78-475" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(averageRating)) <span class="sc">|&gt;</span></span>
<span id="cb78-476"><a href="#cb78-476" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">n=</span>n)</span>
<span id="cb78-477"><a href="#cb78-477" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(s,</span>
<span id="cb78-478"><a href="#cb78-478" aria-hidden="true" tabindex="-1"></a>       samp_dist)</span>
<span id="cb78-479"><a href="#cb78-479" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-480"><a href="#cb78-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-481"><a href="#cb78-481" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"n"</span><span class="ot">=</span><span class="fu">numeric</span>(),</span>
<span id="cb78-482"><a href="#cb78-482" aria-hidden="true" tabindex="-1"></a>  <span class="st">"reps"</span><span class="ot">=</span><span class="fu">numeric</span>(),</span>
<span id="cb78-483"><a href="#cb78-483" aria-hidden="true" tabindex="-1"></a>  <span class="st">"samp_dist_mean"</span><span class="ot">=</span><span class="fu">numeric</span>(),</span>
<span id="cb78-484"><a href="#cb78-484" aria-hidden="true" tabindex="-1"></a>  <span class="st">"samp_dist_se"</span><span class="ot">=</span><span class="fu">numeric</span>())</span>
<span id="cb78-485"><a href="#cb78-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-486"><a href="#cb78-486" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (reps <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">250</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">2000</span>)){</span>
<span id="cb78-487"><a href="#cb78-487" aria-hidden="true" tabindex="-1"></a>  subsample <span class="ot">&lt;-</span> s <span class="sc">|&gt;</span> </span>
<span id="cb78-488"><a href="#cb78-488" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(n) <span class="sc">|&gt;</span></span>
<span id="cb78-489"><a href="#cb78-489" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample_n</span>(reps, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-490"><a href="#cb78-490" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">samp_dist_mean=</span><span class="fu">mean</span>(mean),</span>
<span id="cb78-491"><a href="#cb78-491" aria-hidden="true" tabindex="-1"></a>      <span class="at">samp_dist_se=</span><span class="fu">sd</span>(mean)) <span class="sc">|&gt;</span></span>
<span id="cb78-492"><a href="#cb78-492" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">reps=</span>reps)</span>
<span id="cb78-493"><a href="#cb78-493" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(output,</span>
<span id="cb78-494"><a href="#cb78-494" aria-hidden="true" tabindex="-1"></a>    subsample)</span>
<span id="cb78-495"><a href="#cb78-495" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-496"><a href="#cb78-496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-497"><a href="#cb78-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-500"><a href="#cb78-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-501"><a href="#cb78-501" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>output, <span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>samp_dist_mean)) <span class="sc">+</span></span>
<span id="cb78-502"><a href="#cb78-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb78-503"><a href="#cb78-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> reps) <span class="sc">+</span></span>
<span id="cb78-504"><a href="#cb78-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Sample Size"</span>) <span class="sc">+</span></span>
<span id="cb78-505"><a href="#cb78-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean"</span>) <span class="sc">+</span></span>
<span id="cb78-506"><a href="#cb78-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">6.0</span>, <span class="fl">6.5</span>)</span>
<span id="cb78-507"><a href="#cb78-507" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>output, <span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>samp_dist_se)) <span class="sc">+</span></span>
<span id="cb78-508"><a href="#cb78-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb78-509"><a href="#cb78-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> reps) <span class="sc">+</span></span>
<span id="cb78-510"><a href="#cb78-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Sample Size"</span>) <span class="sc">+</span></span>
<span id="cb78-511"><a href="#cb78-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"SE"</span>) <span class="sc">+</span></span>
<span id="cb78-512"><a href="#cb78-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb78-513"><a href="#cb78-513" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> output, <span class="fu">aes</span>(<span class="at">x =</span> n)) <span class="sc">+</span></span>
<span id="cb78-514"><a href="#cb78-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> samp_dist_mean <span class="sc">+</span> samp_dist_se), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb78-515"><a href="#cb78-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> samp_dist_mean)) <span class="sc">+</span></span>
<span id="cb78-516"><a href="#cb78-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> samp_dist_mean <span class="sc">-</span> samp_dist_se), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb78-517"><a href="#cb78-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>( <span class="sc">~</span> reps) <span class="sc">+</span></span>
<span id="cb78-518"><a href="#cb78-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Sample Size"</span>) <span class="sc">+</span></span>
<span id="cb78-519"><a href="#cb78-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean ± SE"</span>) <span class="sc">+</span></span>
<span id="cb78-520"><a href="#cb78-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">5.8</span>, <span class="fl">6.7</span>)</span>
<span id="cb78-521"><a href="#cb78-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-522"><a href="#cb78-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-525"><a href="#cb78-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-526"><a href="#cb78-526" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-527"><a href="#cb78-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb78-528"><a href="#cb78-528" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb78-529"><a href="#cb78-529" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p2, p3, <span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb78-530"><a href="#cb78-530" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>cowplot)</span>
<span id="cb78-531"><a href="#cb78-531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-532"><a href="#cb78-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-533"><a href="#cb78-533" aria-hidden="true" tabindex="-1"></a>Notice that as the number of replicates increases, our estimates of both the mean and SE become less variable, while as the sample size increases, our SE decreases (and our estimate of the mean thus becomes less uncertain), regardless of number of replicates.</span>
<span id="cb78-534"><a href="#cb78-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-535"><a href="#cb78-535" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Calculating SEs from the Population Variance {.unnumbered}</span></span>
<span id="cb78-536"><a href="#cb78-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-537"><a href="#cb78-537" aria-hidden="true" tabindex="-1"></a>Note that above, we estimated the **SE** by taking the standard deviation of a sampling distribution, where we derived that distribution by taking multiple samples from a perfectly known population. However, if we know the actual population variance ($\sigma^2$) or population standard deviation ($\sigma$), which we do in this case, we can actually calculate the expected **SE** for samples of a given size *directly*, without basing that on an empirical sampling distribution that we have derived from repeated sampling. This is because, mathematically, the variance of a fully realized sampling distribution (i.e., of taking all possible samples of size $n$ from a population) is equal to the variance of the population divided by the sample size. The square root of the variance of the sampling distribution is the standard deviation, i.e., the standard error.</span>
<span id="cb78-538"><a href="#cb78-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-539"><a href="#cb78-539" aria-hidden="true" tabindex="-1"></a>$$SE = \sqrt{\frac{\sigma^2}{n}} = \frac{\sigma}{\sqrt{n}}$$</span>
<span id="cb78-540"><a href="#cb78-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-541"><a href="#cb78-541" aria-hidden="true" tabindex="-1"></a>where $\sigma^2$ is the population variance (and $\sigma$ is thus the population standard deviation) and $n$ is the sample size.</span>
<span id="cb78-542"><a href="#cb78-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-543"><a href="#cb78-543" aria-hidden="true" tabindex="-1"></a>We can compare the SEs for different sample sizes estimated above from our empirical sampling distributions with the SEs calculated directly from the population variance using the code below.</span>
<span id="cb78-544"><a href="#cb78-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-547"><a href="#cb78-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-548"><a href="#cb78-548" aria-hidden="true" tabindex="-1"></a><span class="co"># select estimated SEs for different sample sizes with 1000 reps from our output tibble</span></span>
<span id="cb78-549"><a href="#cb78-549" aria-hidden="true" tabindex="-1"></a>sampling_output <span class="ot">&lt;-</span> <span class="fu">filter</span>(output, reps <span class="sc">==</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-550"><a href="#cb78-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(n, samp_dist_se)</span>
<span id="cb78-551"><a href="#cb78-551" aria-hidden="true" tabindex="-1"></a><span class="co"># create a tibble of SEs based on the known population variance</span></span>
<span id="cb78-552"><a href="#cb78-552" aria-hidden="true" tabindex="-1"></a>pop_output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"n"</span> <span class="ot">=</span> <span class="fu">numeric</span>(), <span class="st">"pop_se"</span> <span class="ot">=</span> <span class="fu">numeric</span>())</span>
<span id="cb78-553"><a href="#cb78-553" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">10</span>)) {</span>
<span id="cb78-554"><a href="#cb78-554" aria-hidden="true" tabindex="-1"></a>  pop_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">pop_var</span>(d<span class="sc">$</span>averageRating) <span class="sc">/</span> n)</span>
<span id="cb78-555"><a href="#cb78-555" aria-hidden="true" tabindex="-1"></a>  pop_output <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pop_output, <span class="fu">c</span>(<span class="at">n =</span> n, <span class="at">pop_se =</span> pop_se))</span>
<span id="cb78-556"><a href="#cb78-556" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-557"><a href="#cb78-557" aria-hidden="true" tabindex="-1"></a>(compare <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(sampling_output, pop_output, <span class="at">by =</span> <span class="st">"n"</span>))</span>
<span id="cb78-558"><a href="#cb78-558" aria-hidden="true" tabindex="-1"></a><span class="co"># the sample_dist_se and pop_se columns should be very close in value!</span></span>
<span id="cb78-559"><a href="#cb78-559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-560"><a href="#cb78-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-561"><a href="#cb78-561" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Estimating SEs from a Single Sample {.unnumbered}</span></span>
<span id="cb78-562"><a href="#cb78-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-563"><a href="#cb78-563" aria-hidden="true" tabindex="-1"></a>Of course, in practice we often do not know the true population variance or standard deviation, nor do we have the opportunity to generate a sampling distribution empirically and then use this to estimate the **SE**. Instead, we collect typically just collect a single sample from a population about which we know very little.</span>
<span id="cb78-564"><a href="#cb78-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-565"><a href="#cb78-565" aria-hidden="true" tabindex="-1"></a>In these cases, we use some statistic about our single sample as a **point estimate** for the parameter value in our population (e.g., $\bar{x}$ for $\mu$), and we use the variance or standard deviation and size of that single sample to estimate the **SE** around that point estimate for our statistic of interest: i.e., **square root of (sample variance / sample size)** or **sample standard deviation / (square root of sample size)**</span>
<span id="cb78-566"><a href="#cb78-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-567"><a href="#cb78-567" aria-hidden="true" tabindex="-1"></a>$$SE = \sqrt{\frac{s^2}{n}} = \frac{s}{\sqrt{n}}$$</span>
<span id="cb78-568"><a href="#cb78-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-569"><a href="#cb78-569" aria-hidden="true" tabindex="-1"></a>where $s^2$ is the sample variance and $s$ is the sample standard deviation.</span>
<span id="cb78-570"><a href="#cb78-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-571"><a href="#cb78-571" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb78-572"><a href="#cb78-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-573"><a href="#cb78-573" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Write your own function to calculate the **standard error of the mean** for a vector of values representing a single sample of observations from a population. You can use either your own function for the sample variance that you created above or the built-in `var()` function. There are, of course, several ways you could do this. Then, use your new function with `summarize()` and `sample_n()` to extract a single sample of size "n=100" from **d** and calculate an estimate of the population SE for that sample size.</span>
<span id="cb78-574"><a href="#cb78-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-577"><a href="#cb78-577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-578"><a href="#cb78-578" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb78-579"><a href="#cb78-579" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb78-580"><a href="#cb78-580" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb78-581"><a href="#cb78-581" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb78-582"><a href="#cb78-582" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb78-583"><a href="#cb78-583" aria-hidden="true" tabindex="-1"></a>my_se1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">sqrt</span>(<span class="fu">sample_var</span>(x) <span class="sc">/</span> <span class="fu">length</span>(x))}</span>
<span id="cb78-584"><a href="#cb78-584" aria-hidden="true" tabindex="-1"></a>my_se2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">sqrt</span>(<span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">length</span>(x))}</span>
<span id="cb78-585"><a href="#cb78-585" aria-hidden="true" tabindex="-1"></a>my_se3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(x))}</span>
<span id="cb78-586"><a href="#cb78-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-587"><a href="#cb78-587" aria-hidden="true" tabindex="-1"></a>new_sample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(d, <span class="at">size =</span> n)</span>
<span id="cb78-588"><a href="#cb78-588" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(</span>
<span id="cb78-589"><a href="#cb78-589" aria-hidden="true" tabindex="-1"></a>  new_sample,</span>
<span id="cb78-590"><a href="#cb78-590" aria-hidden="true" tabindex="-1"></a>  <span class="at">se1 =</span> <span class="fu">my_se1</span>(averageRating),</span>
<span id="cb78-591"><a href="#cb78-591" aria-hidden="true" tabindex="-1"></a>  <span class="at">se2 =</span> <span class="fu">my_se2</span>(averageRating),</span>
<span id="cb78-592"><a href="#cb78-592" aria-hidden="true" tabindex="-1"></a>  <span class="at">se3 =</span> <span class="fu">my_se3</span>(averageRating)</span>
<span id="cb78-593"><a href="#cb78-593" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-594"><a href="#cb78-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-595"><a href="#cb78-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-596"><a href="#cb78-596" aria-hidden="true" tabindex="-1"></a>The package {sciplot} includes the function, <span class="in">`se()`</span>, for calculating standard errors (as do others).</span>
<span id="cb78-597"><a href="#cb78-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-600"><a href="#cb78-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-601"><a href="#cb78-601" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb78-602"><a href="#cb78-602" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sciplot)</span>
<span id="cb78-603"><a href="#cb78-603" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(new_sample,</span>
<span id="cb78-604"><a href="#cb78-604" aria-hidden="true" tabindex="-1"></a>  <span class="at">se4 =</span> sciplot<span class="sc">::</span><span class="fu">se</span>(averageRating)</span>
<span id="cb78-605"><a href="#cb78-605" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-606"><a href="#cb78-606" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>sciplot)</span>
<span id="cb78-607"><a href="#cb78-607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-608"><a href="#cb78-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-611"><a href="#cb78-611" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-612"><a href="#cb78-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb78-613"><a href="#cb78-613" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>mosaic)</span>
<span id="cb78-614"><a href="#cb78-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-615"><a href="#cb78-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-616"><a href="#cb78-616" aria-hidden="true" tabindex="-1"></a>&lt;hr&gt;</span>
<span id="cb78-617"><a href="#cb78-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-618"><a href="#cb78-618" aria-hidden="true" tabindex="-1"></a><span class="fu">## Concept Review {.unnumbered}</span></span>
<span id="cb78-619"><a href="#cb78-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-620"><a href="#cb78-620" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mu, \bar{x}$ = population mean, sample mean</span>
<span id="cb78-621"><a href="#cb78-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-622"><a href="#cb78-622" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$\bar{x}$ is an estimator for $\mu$</span>
<span id="cb78-623"><a href="#cb78-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-624"><a href="#cb78-624" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\sigma^2, s^2$ = population variance, sample variance</span>
<span id="cb78-625"><a href="#cb78-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-626"><a href="#cb78-626" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\sigma, s$ = population standard deviation, sample standard deviation</span>
<span id="cb78-627"><a href="#cb78-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-628"><a href="#cb78-628" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$s$ is an estimator for $\sigma$</span>
<span id="cb78-629"><a href="#cb78-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-630"><a href="#cb78-630" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sample variance and standard deviation: <span class="in">`var()`</span>, <span class="in">`sd()`</span></span>
<span id="cb78-631"><a href="#cb78-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-632"><a href="#cb78-632" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>These are measures of the variation/spread in a **sample**</span>
<span id="cb78-633"><a href="#cb78-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-634"><a href="#cb78-634" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sampling distributions and standard errors</span>
<span id="cb78-635"><a href="#cb78-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-636"><a href="#cb78-636" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Mean of the sampling distribution of $\bar{x}$ is an estimate of $\mu$</span>
<span id="cb78-637"><a href="#cb78-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-638"><a href="#cb78-638" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Standard deviation of the sampling distribution of $\bar{x}$ = $\frac{\sigma}{\sqrt{n}}$ = standard error</span>
<span id="cb78-639"><a href="#cb78-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-640"><a href="#cb78-640" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>This is a measure of the variation/spread in a **sample statistic**</span>
<span id="cb78-641"><a href="#cb78-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-642"><a href="#cb78-642" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Standard errors: <span class="in">`sciplot::se()`</span></span>
<span id="cb78-643"><a href="#cb78-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-644"><a href="#cb78-644" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Using the <span class="in">`sample_n()`</span> function from {dplyr} and <span class="in">`do() * &lt;function&gt;`</span> construction from {mosaic} to generate sampling distributions</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>