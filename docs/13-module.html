<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applied Data Analysis - 13&nbsp; Probability and Distributions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./14-module.html" rel="next">
<link href="./12-module.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./13-module.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-logistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Logistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course-schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-typography-and-formatting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Typography and Formatting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-programming-style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming Style Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>RStudio</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extending the Functionality of <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamentals of the <strong><em>R</em></strong> Language</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basics of Version Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Additional Data Structures in <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting Data into <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Functions and Flow Control</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part II - Statistics and Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Descriptive Statisics and Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-module.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Using Permutation Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Elements of Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression and ANCOVA</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 07</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 08</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-analysis-replication-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis Replication</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Packages Used</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives"><span class="header-section-number">13.1</span> Objectives</a></li>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link" data-scroll-target="#preliminaries"><span class="header-section-number">13.2</span> Preliminaries</a></li>
  <li><a href="#probability" id="toc-probability" class="nav-link" data-scroll-target="#probability"><span class="header-section-number">13.3</span> Probability</a>
  <ul class="collapse">
  <li><a href="#challenge" id="toc-challenge" class="nav-link" data-scroll-target="#challenge">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#rules-of-probability" id="toc-rules-of-probability" class="nav-link" data-scroll-target="#rules-of-probability"><span class="header-section-number">13.4</span> Rules of Probability</a>
  <ul class="collapse">
  <li><a href="#challenge-1" id="toc-challenge-1" class="nav-link" data-scroll-target="#challenge-1">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#random-variables" id="toc-random-variables" class="nav-link" data-scroll-target="#random-variables"><span class="header-section-number">13.5</span> Random Variables</a>
  <ul class="collapse">
  <li><a href="#probability-mass-functions" id="toc-probability-mass-functions" class="nav-link" data-scroll-target="#probability-mass-functions">Probability Mass Functions</a></li>
  <li><a href="#probability-density-functions" id="toc-probability-density-functions" class="nav-link" data-scroll-target="#probability-density-functions">Probability Density Functions</a></li>
  <li><a href="#cumulative-distribution-functions" id="toc-cumulative-distribution-functions" class="nav-link" data-scroll-target="#cumulative-distribution-functions">Cumulative Distribution Functions</a></li>
  <li><a href="#expected-mean-and-variance" id="toc-expected-mean-and-variance" class="nav-link" data-scroll-target="#expected-mean-and-variance">Expected Mean and Variance</a></li>
  </ul></li>
  <li><a href="#useful-probability-distributions" id="toc-useful-probability-distributions" class="nav-link" data-scroll-target="#useful-probability-distributions"><span class="header-section-number">13.6</span> Useful Probability Distributions</a>
  <ul class="collapse">
  <li><a href="#probability-mass-functions-1" id="toc-probability-mass-functions-1" class="nav-link" data-scroll-target="#probability-mass-functions-1">Probability Mass Functions</a></li>
  <li><a href="#challenge-2" id="toc-challenge-2" class="nav-link" data-scroll-target="#challenge-2">CHALLENGE</a></li>
  <li><a href="#challenge-3" id="toc-challenge-3" class="nav-link" data-scroll-target="#challenge-3">CHALLENGE</a></li>
  <li><a href="#probability-density-functions-1" id="toc-probability-density-functions-1" class="nav-link" data-scroll-target="#probability-density-functions-1">Probability Density Functions</a></li>
  <li><a href="#challenge-4" id="toc-challenge-4" class="nav-link" data-scroll-target="#challenge-4">CHALLENGE</a></li>
  <li><a href="#challenge-5" id="toc-challenge-5" class="nav-link" data-scroll-target="#challenge-5">CHALLENGE</a></li>
  <li><a href="#challenge-6" id="toc-challenge-6" class="nav-link" data-scroll-target="#challenge-6">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#sampling-distributions-redux" id="toc-sampling-distributions-redux" class="nav-link" data-scroll-target="#sampling-distributions-redux"><span class="header-section-number">13.7</span> Sampling Distributions Redux</a>
  <ul class="collapse">
  <li><a href="#challenge-7" id="toc-challenge-7" class="nav-link" data-scroll-target="#challenge-7">CHALLENGE</a></li>
  <li><a href="#challenge-8" id="toc-challenge-8" class="nav-link" data-scroll-target="#challenge-8">CHALLENGE</a></li>
  <li><a href="#challenge-9" id="toc-challenge-9" class="nav-link" data-scroll-target="#challenge-9">CHALLENGE</a></li>
  <li><a href="#challenge-10" id="toc-challenge-10" class="nav-link" data-scroll-target="#challenge-10">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#concept-review" id="toc-concept-review" class="nav-link" data-scroll-target="#concept-review">Concept Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./13-module.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="module-13" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="objectives" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="objectives"><span class="header-section-number">13.1</span> Objectives</h2>
<blockquote class="blockquote">
<p>The objective of this module is to gently begin our discussion of <em>statistical inference</em> and <em>statistical modeling</em>. Doing so requires that we first cover some basics of probability and statistical distributions.</p>
</blockquote>
</section>
<section id="preliminaries" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="preliminaries"><span class="header-section-number">13.2</span> Preliminaries</h2>
<ul>
<li>Install and load this package in <strong><em>R</em></strong>: <a href="https://cran.r-project.org/web/packages/manipulate/manipulate.pdf">{manipulate}</a></li>
<li>Load {tidyverse}, {mosaic}, and {cowplot}</li>
</ul>
</section>
<section id="probability" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="probability"><span class="header-section-number">13.3</span> Probability</h2>
<p>The term <strong>probability</strong> is applied to <em>population-level</em> variables to describe the magnitude of chance associated with particular observations or events. Probabilities summarize the relative frequencies of different possible outcomes and are properties of <em>distributions</em> of variables. Every variable has a distribution that can be described empirically and visualized, as we have done in some of our previous modules. And, sometimes, these empirical distributions are nicely approximated by particular theoretical distributions with well-known mathematical properties, a fact which forms the basis for traditional frequentist (or classical) statistical inference.</p>
<p>Probabilities for events or collections of events necessarily vary between zero and one. Outcomes or combinations of outcomes that are impossible have <span class="math inline">\(Pr = 0\)</span>, those that are certain have <span class="math inline">\(Pr = 1\)</span>.</p>
<blockquote class="blockquote">
<p><strong>EXAMPLE:</strong> If we roll a (fair, unbiased) die, there are 6 possible outcomes, and each has a probability of occurring of 1 in 6. We can estimate these probabilities using data on the outcome of lots of observations of independent die rolls. This is referred to as a <em>frequentist</em> or <em>classical</em> way of thinking about the probability of these different outcomes… the relative frequency with which a particular event occurs over numerous identical, independent, objective trials.</p>
</blockquote>
<p>We will use the {manipulate} package and the <code>sample()</code> function to explore the effects of sample size on estimates of the probability of different outcomes of the a process of rolling a (fair, unbiased) die. The {manipulate} package allows us to create an interactive plot that lets us dynamically change something about the values being plotted. We will set up a simulation where the probability of each possible outcome of the process of rolling a die one time (“1”, “2”,…, “6”) is 1 in 6, but our estimate of the probability of each possible outcome will change with sample size. In the code below, we use the powerful <code>sample()</code> function, which takes several arguments - a set of elements to sample from (<code>x=</code>), the number of elements to draw (<code>size=</code>), and whether or not to draw with replacement (<code>replace=</code>). After typing in and running the code below, play with the slider to change the number of die rolls being simulated.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>outcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(<span class="fu">histogram</span>(<span class="fu">sample</span>(<span class="at">x =</span> outcomes, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>), <span class="at">type =</span> <span class="st">"density"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Histogram of Outcomes of "</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    n, <span class="st">" Die Rolls"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">xlab =</span> <span class="st">"Roll"</span>, <span class="at">ylab =</span> <span class="st">"Probability"</span>), <span class="at">n =</span> <span class="fu">slider</span>(<span class="dv">0</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10000</span>, <span class="at">initial =</span> <span class="dv">100</span>, <span class="at">step =</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="challenge" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge">CHALLENGE</h3>
<p>Write your own function, <code>roll()</code>, to simulate rolling a die where you pass the number of rolls as an argument (<code>nrolls=</code>) with a default value of 1. Then, use your function to simulate rolling two dice a total 1000 times and take the sum of the rolls. Plot a histogram of those results. What happens if you roll each die 100 times? 10,000 times?</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>roll <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nrolls =</span> <span class="dv">1</span>) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, nrolls, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>}  <span class="co"># function with default of 1 roll</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>nrolls <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>two_dice <span class="ot">&lt;-</span> <span class="fu">roll</span>(nrolls) <span class="sc">+</span> <span class="fu">roll</span>(nrolls)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(two_dice, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">1.5</span><span class="sc">:</span><span class="fl">12.5</span>), <span class="at">type =</span> <span class="st">"density"</span>, <span class="at">main =</span> <span class="st">"Rolling Two Dice"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"Sum of Rolls"</span>, <span class="at">ylab =</span> <span class="st">"Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="rules-of-probability" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="rules-of-probability"><span class="header-section-number">13.4</span> Rules of Probability</h2>
<p>The following are a set of standard rule of probability that are worth reviewing:</p>
<ol type="1">
<li><span class="math inline">\(Pr (+)\)</span> = Probability that <em>something</em> occurs = 1</li>
<li><span class="math inline">\(Pr (\emptyset)\)</span> = Probability that <em>nothing</em> occurs = 0</li>
<li><span class="math inline">\(Pr (A)\)</span> = Probability that a <em>particular event</em>, <span class="math inline">\(A\)</span>, occurs</li>
</ol>
<p><span class="math display">\[0 \leq Pr (A) \leq 1\]</span></p>
<ol start="4" type="1">
<li><span class="math inline">\(Pr (A \cup B)\)</span> = Probability that a particular event <span class="math inline">\(A\)</span> <em>or</em> a particular event <span class="math inline">\(B\)</span> occurs = <strong>UNION</strong></li>
</ol>
<p><span class="math display">\[Pr (A \cup B) = Pr (A) + Pr (B) - Pr (A \cap B)\]</span></p>
<blockquote class="blockquote">
<p>If events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are <em>mutually exclusive</em>, then this simplifies to… <span class="math display">\[Pr (A) + Pr (B)\]</span></p>
</blockquote>
<ol start="5" type="1">
<li><span class="math inline">\(Pr (A \cap B)\)</span> = Probability that both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> occur simultaneously = <strong>INTERSECTION</strong></li>
</ol>
<p><span class="math display">\[Pr (A \cap B) = Pr (A \vert B) \times Pr (B) = Pr (B \vert A) \times Pr (A)\]</span></p>
<blockquote class="blockquote">
<p>The pipe operator ( <span class="math inline">\(\vert\)</span> ) can be read as “given” and indicates <em>conditional probability</em> (see below)</p>
<p>If <span class="math inline">\(Pr (A \cap B) = 0\)</span>, then we say the events are <em>mutually exclusive</em> (e.g., you cannot have a die roll be 1 <em>and</em> 2)</p>
<p>If the two events are <em>independent</em> (i.e., if the probability of one does not depend on the probability of the other), then <span class="math inline">\(Pr (A \cap B)\)</span> simplifies to… <span class="math display">\[Pr (A) \times Pr (B)\]</span></p>
</blockquote>
<ol start="6" type="1">
<li><p>Probability of the <strong>COMPLEMENT</strong> of <span class="math inline">\(A\)</span> (i.e., <strong>not</strong> <span class="math inline">\(A\)</span>) = <span class="math inline">\(Pr (Ā) = 1 - Pr (A)\)</span></p></li>
<li><p><strong>CONDITIONAL PROBABILITY</strong> is the probability of an event occuring after taking into account the occurrence of another event, i.e., one event is <em>conditioned</em> on the occurrence of a different event. For example, the probability of a die coming up as a “1” given that we know the die came up as an odd number (“1”, “3”, or “5”) is a conditional probability.</p></li>
</ol>
<p><span class="math display">\[Pr (A \vert B) = Pr (A \cap B) \div Pr (B)\]</span></p>
<blockquote class="blockquote">
<p>If event <span class="math inline">\(A\)</span> and event <span class="math inline">\(B\)</span> are <em>independent</em>, then <span class="math display">\[Pr (A \vert B) = [Pr (A) \times Pr (B) ] \div Pr (B) = Pr (A)\]</span></p>
<p>If event <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are <em>not independent</em>, then <span class="math display">\[Pr (A \vert B) ≠ Pr (A)\]</span></p>
</blockquote>
<section id="challenge-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-1">CHALLENGE</h3>
<p>You have a deck of 52 cards… Ace to 10 plus 3 face cards in each suit. You draw a card at random.</p>
<ul>
<li>What is the probability that you draw a <em>face card</em>?</li>
</ul>
<blockquote class="blockquote">
<p><span class="math inline">\(Pr (face\ card)\)</span></p>
<ul>
<li>12 of 52 cards = 0.2307692</li>
</ul>
</blockquote>
<ul>
<li>What is the probability that you draw a <em>King</em>?</li>
</ul>
<blockquote class="blockquote">
<p><span class="math inline">\(Pr(King)\)</span></p>
<ul>
<li>3 of 52 cards = 0.05769231</li>
</ul>
</blockquote>
<ul>
<li>What is the probability that you draw a <em>spade</em>?</li>
</ul>
<blockquote class="blockquote">
<p><span class="math inline">\(Pr(spade)\)</span></p>
<ul>
<li>13 of 52 cards = 0.25</li>
</ul>
</blockquote>
<ul>
<li>What is the probability that you draw a <em>spade</em> given that you draw a <em>face card</em>? (CONDITIONAL, INDEPENDENT EVENTS)</li>
</ul>
<blockquote class="blockquote">
<p>Intuitively…</p>
<ul>
<li>3 of 12 cards = 0.25</li>
</ul>
<p>Formally…</p>
<p><span class="math inline">\(Pr(spade \vert face\ card) = Pr(spade) \times Pr(face\ card) \div Pr(face\ card)\)</span></p>
<ul>
<li>(13 of 52) <span class="math inline">\(\times\)</span> (12 of 52) <span class="math inline">\(\div\)</span> (12 of 52) = 0.25</li>
</ul>
</blockquote>
<ul>
<li>What is the probability that you draw a <em>King</em> given that you draw a <em>face card</em>? (CONDITIONAL, NOT INDEPENDENT EVENTS)</li>
</ul>
<blockquote class="blockquote">
<p>Intuitively…</p>
<ul>
<li>4 of 12 cards = 0.3333333</li>
</ul>
<p>Formally…</p>
<p><span class="math inline">\(Pr(King \vert face\ card) = Pr(King \cap face\ card) \div Pr(face\ card) =\)</span></p>
<p><span class="math inline">\(Pr(face\ card \vert King) \times Pr(King) \div Pr(face\ card)\)</span></p>
<ul>
<li>1 <span class="math inline">\(\times\)</span> (4 of 52) <span class="math inline">\(\div\)</span> (12 of 52) = 0.3333333</li>
</ul>
</blockquote>
<ul>
<li>What is the probability that you draw a card that is both from a <em>red</em> suit (hearts or diamonds) and a <em>face card</em>? (INTERSECTION, INDEPENDENT EVENTS)</li>
</ul>
<blockquote class="blockquote">
<p>Intuitively…</p>
<ul>
<li>6 of 52 cards = 0.1153846</li>
</ul>
<p>Formally…</p>
<p><span class="math inline">\(Pr (red \cap face\ card) = Pr (red \vert face\ card) \times Pr (face\ card) =\)</span></p>
<p><span class="math inline">\([Pr(red) \times Pr(face\ card)] \div Pr(face\ card) \times Pr(face\ card)\)</span></p>
<p>where…</p>
<p><span class="math inline">\(Pr (red)\)</span></p>
<ul>
<li>26 of 52 cards = 0.5</li>
</ul>
<p><span class="math inline">\(Pr (face\ card)\)</span></p>
<ul>
<li>12 of 52 cards = 0.2307692</li>
</ul>
<p>so…</p>
<ul>
<li>[(26 of 52) <span class="math inline">\(\times\)</span> (12 of 52)] <span class="math inline">\(\div\)</span> (12 of 52) <span class="math inline">\(\times\)</span> (12 of 52) = 0.1153846</li>
</ul>
</blockquote>
<ul>
<li>What is the probability that you draw a card that is either a <em>club</em> or <em>not a face card</em>? (UNION, NOT INDEPENDENT EVENTS)</li>
</ul>
<blockquote class="blockquote">
<p>Intuitively…</p>
<ul>
<li>(13 club cards <span class="math inline">\(+\)</span> 40 not face cards <span class="math inline">\(-\)</span> 10 club cards that are not face cards) of 52 cards = 43 of 52 cards = 0.8269231</li>
</ul>
<p>Formally…</p>
<p><span class="math inline">\(Pr (club \cup not\ a\ face\ card) =\)</span></p>
<p><span class="math inline">\(Pr (club) + Pr (not\ a\ face\ card) - Pr (club \cap not\ a\ face\ card) =\)</span></p>
<p><span class="math inline">\(Pr (club) + Pr (not\ a\ face\ card) - Pr (club \vert not\ a\ face\ card) \times Pr (not\ a\ face\ card)\)</span></p>
<p>where…</p>
<p><span class="math inline">\(Pr (club)\)</span></p>
<ul>
<li>13 of 52 cards = 0.25</li>
</ul>
<p><span class="math inline">\(Pr (not\ a\ face\ card)\)</span></p>
<ul>
<li>40 of 52 cards = 0.7692308</li>
</ul>
<p><span class="math inline">\(Pr (club \vert not\ a\ face\ card)\)</span></p>
<ul>
<li>10 of 40 = 0.25</li>
</ul>
<p>so…</p>
<ul>
<li>(13 of 52) <span class="math inline">\(+\)</span> (40 of 52) <span class="math inline">\(-\)</span> [(10 of 40) <span class="math inline">\(\times\)</span> (40 of 52)] = 0.8269231</li>
</ul>
</blockquote>
</section>
</section>
<section id="random-variables" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="random-variables"><span class="header-section-number">13.5</span> Random Variables</h2>
<p>A <strong>random variable</strong> is a variable whose outcomes are assumed to arise by chance or according to some random or stochastic process. The chances of observing a <em>specific outcome</em>, or an outcome value <em>within a specific interval</em>, has associated with it a <strong>probability</strong>.</p>
<p>Random variables come in two varieties:</p>
<ul>
<li><strong>Discrete Random Variables</strong> are random variables that can assume only a countable number of discrete possibilities (e.g., counts of outcomes in a particular category, e.g., rolls of a die). We can assign a probability to each possible outcome.</li>
<li><strong>Continuous Random Variables</strong> are random variables that can assume any real number value within a given range (e.g., measurements of body weight, number of offspring, linear dimensions, etc.). We cannot assign a specific probability to each possible outcome value as the set of possible outcomes is (theoretically) infinite, but we can assign probabilites to intervals of outcome values.</li>
</ul>
<p>With these basics in mind, we can define a few more terms:</p>
<p>A <em>probability function</em> is a mathematical function that describes the chance associated with a random variable either having particular outcomes (for discrete variables) or falling within a given range of outcome values (for continuous variables). Familiar statistical distributions (e.g., the normal distribution, the beta distribution, the Poisson distribution) are all examples of probability functions.</p>
<p>We can distinguish two types of probability functions, associated with these different kinds of random variables.</p>
<section id="probability-mass-functions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="probability-mass-functions">Probability Mass Functions</h3>
<p><em>Probability Mass Functions (PMFs)</em> are associated with <strong>discrete random variables</strong>. These functions describe the probability that a random variable takes a particular discrete <strong>value</strong>.</p>
<p>To be a valid <em>PMF</em>, a function <span class="math inline">\(f(x)\)</span> must satisfy the following conditions:</p>
<ol type="1">
<li>There are <span class="math inline">\(k\)</span> distinct outcomes <span class="math inline">\(x_1, x_2, ... ,x_k\)</span></li>
<li><span class="math inline">\(0 \leq Pr (X=x_i) \leq 1\)</span> for all <span class="math inline">\(x_i\)</span></li>
<li><span class="math inline">\(\sum\limits_{i=1}^{k} Pr (X=x_i) = 1\)</span></li>
</ol>
<section id="example-flipping-a-fair-coin" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-flipping-a-fair-coin"><strong>EXAMPLE:</strong> Flipping a Fair Coin</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>outcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"heads"</span>, <span class="st">"tails"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(prob, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>), <span class="at">names.arg =</span> outcomes, <span class="at">space =</span> <span class="fl">0.1</span>, <span class="at">xlab =</span> <span class="st">"outcome"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Pr(X = outcome)"</span>, <span class="at">main =</span> <span class="st">"Probability Mass Function"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cumprob <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cumoutcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"heads"</span>, <span class="st">"heads + tails"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(cumprob, <span class="at">names.arg =</span> cumoutcomes, <span class="at">space =</span> <span class="fl">0.1</span>, <span class="at">xlab =</span> <span class="st">"outcome"</span>, <span class="at">ylab =</span> <span class="st">"Cumulative Pr(X)"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Cumulative Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-rolling-a-fair-die" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-rolling-a-fair-die"><strong>EXAMPLE:</strong> Rolling a Fair Die</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>outcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(prob, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">names.arg =</span> outcomes, <span class="at">space =</span> <span class="fl">0.1</span>, <span class="at">xlab =</span> <span class="st">"outcome"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Pr(X = outcome)"</span>, <span class="at">main =</span> <span class="st">"Probability Mass Function"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cumprob <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>cumoutcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"1 to 2"</span>, <span class="st">"1 to 3"</span>, <span class="st">"1 to 4"</span>, <span class="st">"1 to 5"</span>, <span class="st">"1 to 6"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(cumprob, <span class="at">names.arg =</span> cumoutcomes, <span class="at">space =</span> <span class="fl">0.1</span>, <span class="at">xlab =</span> <span class="st">"outcome"</span>, <span class="at">ylab =</span> <span class="st">"Cumulative Pr(X)"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Cumulative Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="probability-density-functions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="probability-density-functions">Probability Density Functions</h3>
<p><em>Probability Density Functions (PDFs)</em> are associated with <strong>continuous random variables</strong>. These functions describe the probability that a random variable falls <strong>within a given range of outcome values</strong>. The probability associated with that range equals the area under the <em>density function</em> for that range.</p>
<p>To be a valid <em>PDF</em>, a function <span class="math inline">\(f(x)\)</span> must satisfy the following:</p>
<ol type="1">
<li><span class="math inline">\(f(x)\geq 0\)</span> for all <span class="math inline">\(-\infty \leq x \leq +\infty\)</span>. That is, the function <span class="math inline">\(f(x)\)</span> is non-negative everywhere.</li>
<li><span class="math inline">\(\int_\limits{-\infty}^{+\infty} f(x) dx = 1\)</span>. That is, the total area under the function <span class="math inline">\(f(x)\)</span> = 1</li>
</ol>
<section id="example-exploring-the-beta-distribution" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-exploring-the-beta-distribution">Example: Exploring the <strong>Beta Distribution</strong></h4>
<p>The <strong>Beta Distribution</strong> refers to a family of continuous probability distributions defined over the interval [0, 1] and parameterized by two positive shape coefficients, denoted by <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, that appear as exponents of the random variable <span class="math inline">\(x\)</span> and control the shape of the distribution. The beta distribution function is…</p>
<p><span class="math display">\[f(x) = x^{\alpha-1}(1-x)^{\beta-1}\]</span></p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> There is nothing special about the <strong>Beta Distribution</strong> for this example, we are just using it to show how probabilities are equivalent to areas under a function.</p>
</blockquote>
<p>We can explore the beta distribution using the {manipulate} package by entering the code below. With the domain of <span class="math inline">\(x\)</span> restricted to [0, 1], and with <span class="math inline">\(\alpha\)</span> initially set to 2 and <span class="math inline">\(\beta\)</span> initially set to 1, we see the PDF for the beta distribution is triangular. Try playing with different values for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. The <code>dbeta()</code> function provides the value of the function at the specified values of <strong>x</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(<span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> alpha, <span class="at">shape2 =</span> beta), <span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"f(x)"</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Exploring the Beta Distribution"</span>, <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Cumulative Probability = "</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(<span class="fu">pbeta</span>(x, alpha, beta), <span class="dv">2</span>))) <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    x), <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> alpha, <span class="at">shape2 =</span> beta), <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">geom =</span> <span class="st">"area"</span>), <span class="at">alpha =</span> <span class="fu">slider</span>(<span class="dv">0</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>, <span class="at">initial =</span> <span class="dv">2</span>, <span class="at">step =</span> <span class="fl">0.1</span>), <span class="at">beta =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">initial =</span> <span class="dv">1</span>, <span class="at">step =</span> <span class="fl">0.1</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">initial =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="fl">0.01</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is this a <em>PDF</em>? Why or why not? Yes… it satisfies both criteria for a <em>PDF</em>.</p>
<ol type="1">
<li><span class="math inline">\(f(x) \geq 0\)</span> for all <span class="math inline">\(-\infty \leq x \leq +\infty\)</span></li>
<li>The total area under <span class="math inline">\(f(x)\)</span> = 1</li>
</ol>
<p>We can show this interactively by playing with the slider for <span class="math inline">\(x\)</span> and looking at the shaded area, which represents the <strong>cumulative probability</strong> integrated across <span class="math inline">\(f(x)\)</span> from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(x\)</span>.</p>
</section>
</section>
<section id="cumulative-distribution-functions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="cumulative-distribution-functions">Cumulative Distribution Functions</h3>
<p>The <strong>cumulative distribution function</strong>, or <strong>CDF</strong>, of a random variable is defined as the probability of observing a random variable <span class="math inline">\(X\)</span> taking the value of <span class="math inline">\(x\)</span> or less, i.e., <span class="math inline">\(F(x) = Pr (X \leq x)\)</span>.</p>
<p>This definition actually applies regardless of whether <span class="math inline">\(X\)</span> is discrete or continuous. Note here we are using the notation <span class="math inline">\(F(x)\)</span> for the cumulative distribution function rather than <span class="math inline">\(f(x)\)</span>, which we use for the probability density or mass function. For a continuous variable, the <em>PDF</em> is simply the first derivative of the <em>CDF</em>, i.e., <span class="math inline">\(f(x) = dF(x)\)</span>.</p>
<p>The built in <strong><em>R</em></strong> “probability” function for the <strong>Beta Distribution</strong>, <code>pbeta()</code>, gives us this cumulative probability directly, if we specify the values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. E.g., for <span class="math inline">\(\alpha\)</span> = 2 and <span class="math inline">\(\beta\)</span> = 1…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span>(<span class="fl">0.75</span>, <span class="dv">2</span>, <span class="dv">1</span>)  <span class="co"># cumulative probability for x ≤ 0.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.5625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">1</span>)  <span class="co"># cumulative probability for x ≤ 0.50</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.25</code></pre>
</div>
</div>
<p>In general, we find the cumulative probability for a continuous random variable by calculating the area under the probability density function of interest from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(x\)</span>. This is what is is being returned from <code>pbeta()</code>.</p>
<blockquote class="blockquote">
<p>The other related <strong><em>R</em></strong> functions for the <strong>Beta Distribution</strong>, i.e., <code>rbeta()</code>, <code>dbeta()</code>, and <code>qbeta()</code>, are also useful. <code>rbeta()</code> draws random observations from a specfied beta distribution. <code>dbeta()</code> gives the point estimate of the beta density function at the value of the argument <span class="math inline">\(x\)</span>, and <code>qbeta()</code> is essentially the converse of <code>pbeta()</code>, i.e., it tells you the value of <span class="math inline">\(x\)</span> that is associated with a particular cumulative probability, or <strong>quantile</strong>, of the cumulative distribution function.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbeta</span>(<span class="fl">0.75</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fl">0.5625</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.75</code></pre>
</div>
</div>
<p>We can also define the <strong>survival function</strong> for a random variable <span class="math inline">\(X\)</span> as:</p>
<p><span class="math display">\[S(x) = Pr (X \gt x) = 1 - Pr (X \leq x) = 1 - F(x)\]</span></p>
<p><em>PMFs</em> and <em>PDFs</em> for many other standard or well studied distributions have comparable <code>r</code>, <code>d</code>, <code>p</code>, and <code>q</code> functions to those for the <strong>Beta Distribution</strong>.</p>
<p><strong>TL/DR:</strong> <strong><em>R</em></strong> has four built-in functions that can be applied to a variety of standard and well understood statistical distributions:</p>
<ul>
<li><code>r</code> - the <em>random generation</em> function, which draws a random variable from the given distribution.</li>
<li><code>d</code> - the <em>density</em> function, PMF or PDF, which describes the distribution of values for the function across the range of <span class="math inline">\(x\)</span> values: <span class="math inline">\(f(x)\)</span>.</li>
<li><code>p</code> - the <em>cumulative distribution</em> function, CDF, which gives the cumulative probability for all values from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(x\)</span> for a given distribution: <span class="math inline">\(F(x)\)</span> = <em>Pr</em> <span class="math inline">\((X\)</span> <span class="math inline">\(\leq\)</span> <span class="math inline">\(x)\)</span>.</li>
<li><code>q</code> - the <em>quantile</em> function, which is the converse of <code>p</code>: the value of <span class="math inline">\(x\)</span> at which the CDF has the value <span class="math inline">\(q\)</span>, i.e., <span class="math inline">\(F(x_q) = q\)</span>.</li>
</ul>
<p>Note the relationship between the <code>p</code> and <code>q</code> functions:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span>(<span class="fl">0.7</span>, <span class="dv">2</span>, <span class="dv">1</span>)  <span class="co"># yields 0.49 - x values ≤ 0.7 comprise 49% of the CDF</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.49</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fl">0.49</span>, <span class="dv">2</span>, <span class="dv">1</span>)  <span class="co"># yields 0.7 - 49% of the CDF falls in the range x ≤ 0.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.7</code></pre>
</div>
</div>
</section>
<section id="expected-mean-and-variance" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="expected-mean-and-variance">Expected Mean and Variance</h3>
<p>The mean value (or <em>expectation</em>) of a discrete random variable with a given <em>probability mass function</em> is equivalent to a “long-term average”, i.e., what you would expect the average value of the variable to be if you sampled from the PMF many, many times. This expectation can be expressed generally as follows:</p>
<p><span class="math display">\[\mu_X = Expectation\ for\ X = \sum x_i \times Pr (X=x_i)\ for\ all\ x\ from\ x_i\ to\ x_k\]</span></p>
<p>Likewise, the expected variance of a discrete random variable, <span class="math inline">\(X\)</span>, across a large sample from the PMF is:</p>
<p><span class="math display">\[\sigma_X^2 = Variance\ of\ X = \sum (x_i - \mu_X)^2 \times Pr (X=x_i)\ for\ all\ x\ from\ x_i\ to\ x_k\]</span></p>
<p>Applying these formulae to die rolls, we could calculate the <em>expectation</em> for <span class="math inline">\(X\)</span> for a large set of die rolls as follows…</p>
<p><span class="math display">\[(1 \times 1/6) + (2 \times 1/6)\  +\ ...\ +\ (6 \times 1/6) = 3.5\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 3.5</code></pre>
</div>
</div>
<p>And the expected variance would be…</p>
<p><span class="math display">\[[(1 - 3.5)^2 \times (1/6)]\ +\  [(2 - 3.5)^2 \times (1/6)]\ +\ ...\ +\ [(6 - 3.5)^2 \times (1/6)] = 2.916667\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)))<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>var</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 2.916667</code></pre>
</div>
</div>
<p>Likewise, we can calculate the expectation and variance for a continuous random variable, <span class="math inline">\(X\)</span>, with a given <em>probability density function</em> generally as follows:</p>
<p><span class="math display">\[\mu_X = Expectation\ for\ X = \int\limits_{-\infty}^{+\infty} x f(x) dx\]</span></p>
<p><span class="math display">\[\sigma_X^2 = Variance\ of\ X = \int\limits_{-\infty}^{+\infty} (x - \mu_X)^2 f(x) dx\]</span></p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> To demonstrate these numerically would require a bit of calculus, i.e., <em>integration</em>, which we will not go through here.</p>
</blockquote>
</section>
</section>
<section id="useful-probability-distributions" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="useful-probability-distributions"><span class="header-section-number">13.6</span> Useful Probability Distributions</h2>
<section id="probability-mass-functions-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="probability-mass-functions-1">Probability Mass Functions</h3>
<section id="the-bernoulli-distribution" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-bernoulli-distribution">The Bernoulli Distribution</h4>
<p>The <strong>Bernoulli Distribution</strong> is the probability distribution of a <em>binary</em> random variable, i.e., a variable that has only two possible outcomes, such as success or failure, heads or tails, true or false. If <span class="math inline">\(p\)</span> is the probability of one outcome, then <span class="math inline">\(1-p\)</span> has to be the probabilty of the alternative. For flipping a fair coin, for example, <span class="math inline">\(p\)</span> = 0.5 and <span class="math inline">\(1-p\)</span> also = 0.5.</p>
<p>For the <strong>Bernoulli Distribution</strong>, the probability mass function is:</p>
<p><span class="math display">\[f(x) = p^x(1-p)^{1-x}\]</span></p>
<p>where x = {0 or 1}</p>
<p>For this distribution, the expectation and variance across a large set of trials would be: <span class="math inline">\(\mu_X = p\)</span> and <span class="math inline">\(\sigma_X^2 = p(1-p)\)</span></p>
</section>
</section>
<section id="challenge-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-2">CHALLENGE</h3>
<p>Using the Bernoulli distribution, calculate the expectation for drawing a <em>spade</em> from a deck of cards? What is the variance in this expectation across a large number of draws?</p>
<p><span class="math display">\[Pr (spade) = (13/52)^1 \times (39/52)^0 = 0.25\]</span></p>
<p><span class="math display">\[Var (spade) = (13/52) \times (1-13/52) = (0.25) \times (0.75) = 0.1875\]</span></p>
<p>In code, we can simulate this…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fl">1e+05</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>card <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>, reps, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>spade <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(card <span class="sc">&lt;=</span> <span class="dv">13</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>(exp_spade <span class="ot">&lt;-</span> <span class="fu">sum</span>(spade)<span class="sc">/</span>reps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.25141</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(exp_var_spade <span class="ot">&lt;-</span> <span class="fu">var</span>(spade))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.1882049</code></pre>
</div>
</div>
<section id="the-binomial-distribution" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-binomial-distribution">The Binomial Distribution</h4>
<p>The Bernoulli distribution is a special case of the <strong>Binomial Distribution</strong>. The binomial distribution is typically used to model the probability of a number of “successes”, <em>k</em>, out of a set of “trials”, <em>n</em>, i.e., for <em>counts</em> of a particular outcome.</p>
<p>Again, the probability of <em>success</em> on each trial = <span class="math inline">\(p\)</span> and the probability of <em>not success</em> = <span class="math inline">\(1-p\)</span>.</p>
<p>For the <strong>Binomial Distribution</strong>, the probability mass function is:</p>
<p><span class="math display">\[f(x)=\binom{n}{k} p^k (1-p)^{n-k}\]</span></p>
<p>where <span class="math inline">\(x\)</span> = {0, 1, 2, … , n} and where</p>
<p><span class="math display">\[\binom{n}{k}=\frac{n!}{k!(n-k)!}\]</span></p>
<p>This is read as “<span class="math inline">\(n\)</span> choose <span class="math inline">\(k\)</span>”, i.e., the probability of <span class="math inline">\(k\)</span> successes out of <span class="math inline">\(n\)</span> trials. This is also called the “binomial coefficient”.</p>
<p>For this distribution, the expectation (i.e., expected number of successes out of <span class="math inline">\(k\)</span> trials) and the expected variance are as follows:</p>
<p><span class="math display">\[\mu_X = np\]</span> and</p>
<p><span class="math display">\[\sigma_X^2 = np(1-p)\]</span></p>
<p>Recall, <span class="math inline">\(\mu_X\)</span> = expected <em>number of successes</em> in <span class="math inline">\(n\)</span> trials. Where <span class="math inline">\(n\)</span> = 1, the binomial distribution simplifies to the Bernoulli distribution.</p>
</section>
</section>
<section id="challenge-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-3">CHALLENGE</h3>
<ul>
<li>What is the chance of getting a “1” on each of six consecutive rolls of a die? Recall that rolling a “1” = a success, while rolling something other than a “1” is not a success.</li>
<li>What about of getting exactly three “1”s (i.e., 3 successes).</li>
<li>What is the expected number of “1”s to occur in six consecutive rolls (i.e., what is the expected number of successes) and the variance around that expectation?</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">6</span>  <span class="co"># number of trials</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">6</span>  <span class="co"># exact number of successes</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>(all_ones <span class="ot">&lt;-</span> (<span class="fu">factorial</span>(n)<span class="sc">/</span>(<span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="fu">factorial</span>(n <span class="sc">-</span> k))) <span class="sc">*</span> (p<span class="sc">^</span>k) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p)<span class="sc">^</span>(n <span class="sc">-</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    k))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 2.143347e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># exact number of successes</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>(three_ones <span class="ot">&lt;-</span> (<span class="fu">factorial</span>(n)<span class="sc">/</span>(<span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="fu">factorial</span>(n <span class="sc">-</span> k))) <span class="sc">*</span> (p<span class="sc">^</span>k) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p)<span class="sc">^</span>(n <span class="sc">-</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    k))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.05358368</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected number of successes</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>(expected_ones <span class="ot">&lt;-</span> n <span class="sc">*</span> p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(expected_variance <span class="ot">&lt;-</span> n <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.8333333</code></pre>
</div>
</div>
<p>As for other distributions, <strong><em>R</em></strong> has a built in <code>d</code> (density) function, the <code>dbinom()</code> function, that you can use to solve for the probability of a given outcome directly, i.e., <em>Pr</em> <span class="math inline">\((X = x)\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> k, <span class="at">size =</span> n, <span class="at">prob =</span> p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.05358368</code></pre>
</div>
</div>
<p>We can also use the built in function <code>pbinom()</code> to return the value of the <strong>cumulative distribution function</strong> for the binomial distribution, i.e., the probability of observing <em>up to and including</em> a given number of successes in <span class="math inline">\(n\)</span> trials.</p>
<p>So, for example, the chances of observing exactly 0, 1, 2, 3, … 6 rolls of “1” on 6 rolls of a die are…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>probset <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># x is number of successes, size is number of trials</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(probset, <span class="at">names.arg =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">space =</span> <span class="dv">0</span>, <span class="at">xlab =</span> <span class="st">"outcome = # of 'ones' seen in 6 rolls"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Pr(X = outcome)"</span>, <span class="at">main =</span> <span class="st">"Probability Mass Function"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>cumprob <span class="ot">=</span> <span class="fu">cumsum</span>(probset)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(cumprob, <span class="at">names.arg =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">space =</span> <span class="fl">0.1</span>, <span class="at">xlab =</span> <span class="st">"outcome"</span>, <span class="at">ylab =</span> <span class="st">"Cumulative Pr(X)"</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Cumulative Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(probset)  <span class="co"># equals 1, as it should</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1</code></pre>
</div>
</div>
<p>The chance of observing exactly 3 rolls of “1” is…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.05358368</code></pre>
</div>
</div>
<p>And the chance of observing up to and including 3 rolls of “1” in 6 rolls is…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.991298</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note the name of the argument is `q=` not `x=`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>… which can also be calculated by summing the relevant individual outcome probabilities…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this sums the probabilities of 0, 1, 2, and 3 successes</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.991298</code></pre>
</div>
</div>
<p>The probability of observing <strong>more than</strong> 3 rolls of “1” is given as…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.008701989</code></pre>
</div>
</div>
<p>or, alternatively…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.008701989</code></pre>
</div>
</div>
<p>The probability of observing three <strong>or more</strong> rolls of “1” is…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.06228567</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note here that the `q=` argument is '2'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or, alternatively…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.06228567</code></pre>
</div>
</div>
<p>Above, we were using the theoretical binomial distribution to answer our questions about expectations… Let’s do this same process by simulation!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate num_rolls rolls reps times</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fl">1e+06</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>num_rolls <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set up vectors to hold simulation results</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>all_ones <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"logical"</span>, <span class="at">length =</span> reps)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>three_ones <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"logical"</span>, <span class="at">length =</span> reps)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>count_ones <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"logical"</span>, <span class="at">length =</span> reps)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps) {</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    rolls <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">size =</span> num_rolls, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    all_ones[[i]] <span class="ot">&lt;-</span> <span class="fu">all</span>(rolls <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(rolls <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>        three_ones[[i]] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        three_ones[[i]] <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    count_ones[[i]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(rolls <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="co"># all 'ones' in 6 rolls</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(all_ones)<span class="sc">/</span>reps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 1.9e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># three 'ones' in 6 rolls</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(three_ones)<span class="sc">/</span>reps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.053309</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected # 'ones' in 6 rolls</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(count_ones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.999897</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variance in expected # 'ones' across rolls</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((count_ones <span class="sc">-</span> <span class="fu">mean</span>(count_ones))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">length</span>(count_ones))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.831043</code></pre>
</div>
</div>
<section id="the-poisson-distribution" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-poisson-distribution">The Poisson Distribution</h4>
<p>The <strong>Poisson Distribution</strong> is often used to model open ended counts of independently occuring events, for example the number of cars that pass a traffic intersection over a given interval of time or the number of times a monkey scratches itself during a given observation interval. The <em>probability mass function</em> for the Poisson distribution is described by a single parameter, <span class="math inline">\(\lambda\)</span>, where <span class="math inline">\(\lambda\)</span> can be interpreted as the mean number of occurrences of the event in the given interval.</p>
<p>The probability mass function for the <strong>Poisson Distribution</strong> is:</p>
<p><span class="math display">\[f(x)=\frac{\lambda^x\exp(-\lambda)}{x!}\]</span></p>
<p>where <span class="math inline">\(x\)</span> = {0, 1, 2, …}</p>
<p>For this distribution, <span class="math inline">\(\mu_X = \lambda\)</span> and <span class="math inline">\(\sigma_X^2 = \lambda\)</span></p>
<p>Note that for the Poisson Distribution the mean and the variance are the same!</p>
<p>Let’s use <strong><em>R</em></strong> and the {moasic} package to look at the probability mass functions for different values of <span class="math inline">\(\lambda\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plotDist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> l, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Poisson Distribution</span><span class="sc">\n</span><span class="st">with lambda="</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    l), <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"Pr(X=x)"</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plotDist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> l, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Poisson Distribution</span><span class="sc">\n</span><span class="st">with lambda="</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    l), <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"Pr(X=x)"</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plotDist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> l, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Poisson Distribution</span><span class="sc">\n</span><span class="st">with lambda="</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    l), <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"Pr(X=x)"</span>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p2, p3, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As we did for other distributions, we can also use the built in <code>p</code> function for the Poisson distribution, <code>ppois()</code>, to return the value of the <strong>cumulative distribution function</strong>, i.e., the probability of observing up to and including a specific number of events in the given interval.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plotDist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> l, <span class="at">kind =</span> <span class="st">"cdf"</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Cumulative Probability</span><span class="sc">\n</span><span class="st">with lambda="</span>,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    l), <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"Pr(X≤x)"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plotDist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> l, <span class="at">kind =</span> <span class="st">"cdf"</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Cumulative Probability</span><span class="sc">\n</span><span class="st">with lambda="</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    l), <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"Pr(X≤x)"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plotDist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> l, <span class="at">kind =</span> <span class="st">"cdf"</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Cumulative Probability</span><span class="sc">\n</span><span class="st">with lambda="</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    l), <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"Pr(X≤x)"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p2, p3, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="probability-density-functions-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="probability-density-functions-1">Probability Density Functions</h3>
<section id="the-uniform-distribution" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-uniform-distribution">The Uniform Distribution</h4>
<p>The <strong>Uniform Distribution</strong> is the simplest probability density function describing a continuous random variable. The probability is uniform and does not fluctuate across the range of <span class="math inline">\(x\)</span> values in a given interval.</p>
<p>The probability density function for the <strong>Uniform Distribution</strong> is:</p>
<p><span class="math display">\[f(x)=\frac{1}{b-a}\]</span></p>
<p>where <span class="math inline">\(a \leq x \leq b\)</span> and the function is 0 for <span class="math inline">\(x &lt; a\)</span> and <span class="math inline">\(x &gt; b\)</span></p>
<p>What would you predict the expectation (mean) should be for a uniform distribution? Not surprisingly, for this distribution:</p>
<p><span class="math display">\[\mu_x = \frac{a+b}{2}\]</span></p>
<p>and</p>
<p><span class="math display">\[\sigma_x^2 = \frac{(b-a)^2}{12}\]</span></p>
<p>Let’s plot a uniform distribution across a given range, from <span class="math inline">\(a\)</span> = 4 to <span class="math inline">\(b\)</span> = 8…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> a <span class="sc">-</span> <span class="dv">1</span>, <span class="at">to =</span> b <span class="sc">+</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">dunif</span>(x, <span class="at">min =</span> a, <span class="at">max =</span> b)  <span class="co"># dunif() evaluates the density at each x</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, fx, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(fx) <span class="sc">+</span> <span class="fl">0.1</span>), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"f(x)"</span>, <span class="at">main =</span> <span class="st">"Probability Density Function"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note that for the uniform distribution, the <em>cumulative density function</em> increases linearly over the given interval.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># punif() is the cumulative probability density up to a given x</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">punif</span>(<span class="at">q =</span> x, <span class="at">min =</span> a, <span class="at">max =</span> b), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.1</span>), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Pr(X ≤ x)"</span>, <span class="at">main =</span> <span class="st">"Cumulative Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="challenge-4" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-4">CHALLENGE</h3>
<p>Simulate a sample of 10,000 random numbers from a uniform distribution in the interval between <span class="math inline">\(a\)</span> = 6 and <span class="math inline">\(b\)</span> = 8. Calculate the mean and variance of this simulated sample and compare it to the expectation for these parameters.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>nums <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">min =</span> a, <span class="at">max =</span> b)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(nums))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 7.009949</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>(v <span class="ot">&lt;-</span> <span class="fu">var</span>(nums))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 0.3382361</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>(expected_mean <span class="ot">&lt;-</span> (a <span class="sc">+</span> b)<span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 7</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>(expected_variance <span class="ot">&lt;-</span> ((b <span class="sc">-</span> a)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 0.3333333</code></pre>
</details>
</div>
</div>
<section id="the-normal-distribution" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-normal-distribution">The Normal Distribution</h4>
<p>The <strong>Normal</strong> or <strong>Gaussian Distribution</strong> is perhaps the most familiar and most commonly applied probability density functions for modeling continuous random variables. Why is the normal distribution so important? Well, many traits are normally distributed, and the additive combination of many random factors is also commonly normally distributed. Even more importantly, as we will see in <a href="14-module.html"><strong>Module 14</strong></a>, the sampling distribution for many summary statistics (e.g., sample means) tends to be normally distributed when sample size is sufficiently large, and this fact is central to statistical inference.</p>
<p>For the normal distribution, two parameters, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, are used to describe the shape of the distribution.</p>
<p>The code below allows us to visualize and play around with a normal distribution. First, try maniupulating <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(<span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(mu <span class="sc">-</span> <span class="dv">6</span> <span class="sc">*</span> sigma, mu <span class="sc">+</span> <span class="dv">6</span> <span class="sc">*</span> sigma)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu, <span class="at">sd =</span> sigma), <span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"f(x)"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Exploring the Normal Distribution"</span>, <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Probability ± "</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    n_sigma, <span class="st">" SD around Mean = "</span>, <span class="fu">round</span>(<span class="fu">pnorm</span>(mu <span class="sc">+</span> n_sigma <span class="sc">*</span> sigma, mu, sigma) <span class="sc">-</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pnorm</span>(mu <span class="sc">-</span> n_sigma <span class="sc">*</span> sigma, mu, sigma), <span class="dv">4</span>))) <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(mu <span class="sc">-</span> n_sigma <span class="sc">*</span> sigma, mu <span class="sc">+</span> n_sigma <span class="sc">*</span> sigma), <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> sigma), <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span>),</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>, <span class="at">initial =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="dv">10</span>), <span class="at">sigma =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">initial =</span> <span class="dv">5</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">step =</span> <span class="dv">1</span>), <span class="at">n_sigma =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="at">initial =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="fl">0.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function, <code>dnorm()</code> gives the value of the normal probabilty density function at a given value of <span class="math inline">\(x\)</span>. <span class="math inline">\(x\)</span> can range from -<span class="math inline">\(\infty\)</span> to +<span class="math inline">\(\infty\)</span>. [Recall, it does not really make sense to talk about the “probability” associated with a given specific value of a continuous variable as this is a density not a mass function… but we can talk about the probability of <span class="math inline">\(x\)</span> falling within a given interval.]</p>
<p>The <code>pnorm()</code> function, as with the <code>p</code> function for other distributions, returns the cumulative probability of observing a value less than or equal to a given value of <span class="math inline">\(x\)</span>, i.e., <em>Pr</em> <span class="math inline">\((X\)</span> <span class="math inline">\(\leq\)</span> <span class="math inline">\(x)\)</span>. We can use the <code>pnorm()</code> function to calculate the probability of an observation drawn from the population falling within a particular, arbitrary interval.</p>
<p>For example, for a normally distributed population variable with <span class="math inline">\(\mu\)</span> = 6 and <span class="math inline">\(\sigma\)</span> = 2, the probability of a random observation falling between 7 and 8 is…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="dv">8</span>, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.1498823</code></pre>
</div>
</div>
<p>In the code above, this is what we are doing when we play interactively with <span class="math inline">\(n\_sigma\)</span>… we are using the difference between two <code>pnorm()</code> calculations to determine the probability of an observation falling within <span class="math inline">\(n\_sigma\)</span> standard deviations of the mean of a particular normal distribution.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Regardless of the specific values of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, about 95% of the normal distribution falls within 2 standard deviations of the mean, and about 68% of the distribution falls within 1 standard deviation. Check this out by playing with the <span class="math inline">\(n\_sigma\)</span> slider.</p>
</blockquote>
<div class="cell" data-layout-align="center" data-out_width="80%">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/normal_distribution.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="694"></p>
</figure>
</div>
</div>
</div>
<p>Another one of the family of normal distribution functions in <strong><em>R</em></strong> - the <code>qnorm()</code> or quantile function - will tell us the value of <span class="math inline">\(x\)</span> below which a given proportion of the cumulative probability function falls. For example, if we wanted to see the value of <span class="math inline">\(x\)</span> below which 2.5% of a normal distribution with mean of 5 and standard deviation of 6 falls, we could run the following:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.025</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">3</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] -0.879892</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lower.tail = TRUE by default...if we used lower.tail = FALSE this would give</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># us the value of x for the upper.tail of the distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="challenge-5" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-5">CHALLENGE</h3>
<ul>
<li>Create a vector, <strong>v</strong>, containing <strong>n</strong> random numbers selected from a normal distribution with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>. Use 1000 for <strong>n</strong>, 3.5 for <span class="math inline">\(\mu\)</span>, and 4 for <span class="math inline">\(\sigma\)</span>.</li>
</ul>
<blockquote class="blockquote">
<p><strong>HINT:</strong> Such a function exists! <code>rnorm()</code>. We also call <code>set.seed()</code> before <code>rnorm()</code> so that each time this function is run, it returns the same sequence of random numbers until the seed is reset.</p>
</blockquote>
<ul>
<li>Calculate the mean, variance, and standard deviation for your sample of random numbers.</li>
<li>Plot a histogram of your random numbers.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 3.453407</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 17.13681</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 4.139663</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(v, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Random Draws from a Normal Distribution</span><span class="sc">\n</span><span class="st">with Mean = "</span>,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    mu, <span class="st">" and SD = "</span>, sigma), <span class="at">type =</span> <span class="st">"density"</span>, <span class="at">center =</span> mu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can easily plot the density and cumulative probability functions for this normal distribution using the <code>plotDist()</code> function from the {mosaic} package:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="fu">plotDist</span>(<span class="st">"norm"</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Density"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="fu">plotDist</span>(<span class="st">"norm"</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">kind =</span> <span class="st">"cdf"</span>, <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Cumulative Probability"</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(pdf, cdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="q-q-plots" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="q-q-plots">Q-Q Plots</h4>
<p>A quantile-quantile or <strong>Q-Q</strong> plot can be used to look at whether a set of data seem to follow a normal distribution. A Q–Q plot is a general graphical method for comparing two probability distributions. To examine a set of data for normality graphically, you plot the <strong>quantiles for your actual data</strong> (as the y values) versus <strong>theoretical quantiles</strong> (as the x values) pulled from a normal distribution. If the two distributions being compared are similar, the points in the plot should lie approximately on the line y = x.</p>
<p>If we do this for the random variables we just generated, this <strong>should</strong> be apparent since we have simulated our initial vector of data from a normal distribution.</p>
<p>To quickly do a Q-Q plot, call the two <strong><em>R</em></strong> functions <code>qqnorm()</code> and <code>qqline()</code> using the vector of data you want to examine as an argument.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(v, <span class="at">main =</span> <span class="st">"QQ Plot - Random Normal Variable"</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(v, <span class="at">col =</span> <span class="st">"gray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is the same as doing the following:</p>
<ul>
<li>Step 1: Generate a sequence of probability points in the interval from 0 to 1 equivalent in length to vector <strong>v</strong>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="fu">length</span>(v))</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the `ppoints()` function generates evenly distributed points between 0 and 1</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.0005 0.0015 0.0025 0.0035 0.0045 0.0055</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.9945 0.9955 0.9965 0.9975 0.9985 0.9995</code></pre>
</div>
</div>
<ul>
<li>Step 2: Calculate the theoretical quantiles for this set of probabilities based on the distribution you want to compare to (in this case, the normal distribution):</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>theoretical_q <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(p)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># generates quantiles for each p based on a normal distribution (in this case,</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the standard normal)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Step 3: Calculate the quantiles for your set of observed data for the same number of points:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>observed_q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(v, <span class="fu">ppoints</span>(v))  <span class="co"># finds quantiles in our actual data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Step 4: Plot these quantiles against one another:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theoretical_q, observed_q, <span class="at">main =</span> <span class="st">"QQ Plot - Random Normal Variable"</span>, <span class="at">xlab =</span> <span class="st">"Theoretical Quantiles"</span>,</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Sample Quantiles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="challenge-6" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-6">CHALLENGE</h3>
<p>What happens if you simulate fewer observations in your vectors? Try with <strong>n = 100</strong>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(v, <span class="at">main =</span> <span class="st">"QQ Plot - Random Normal Variable"</span>)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(v, <span class="at">col =</span> <span class="st">"gray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with fewer simulated points, line isn't quite as good a fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>What happens if you simulate observations from a <em>different</em> distribution?</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, <span class="at">shape1 =</span> <span class="fl">1.3</span>, <span class="at">shape2 =</span> <span class="dv">2</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(v, <span class="at">main =</span> <span class="st">"QQ Plot - Random Beta Variable"</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(v, <span class="at">col =</span> <span class="st">"gray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with a different distribution, Q-Q plot isn't linear!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="the-standard-normal-distribution" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-standard-normal-distribution">The “Standard Normal” Distribution</h4>
<p>Any normal distribution with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span> can be converted into what is called the <strong>standard normal</strong> distribution, where the mean is 0 and the standard deviation is 1. This is done by subtracting the mean from all observations and dividing these differences by the standard deviation. The resultant values are referred to a <em>Z</em> scores, and they reflect the number of standard deviations an observation is from the mean.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate from a normal distribution with mean 5 and SD 8</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>x_plot <span class="ot">&lt;-</span> <span class="fu">histogram</span>(x, <span class="at">center =</span> mu, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Mean = "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(x), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">SD = "</span>,</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">sd</span>(x), <span class="dv">3</span>)))</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co"># standardize the scores</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>z_plot <span class="ot">&lt;-</span> <span class="fu">histogram</span>(z, <span class="at">center =</span> <span class="dv">0</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Mean = "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(z), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">SD = "</span>,</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">sd</span>(z), <span class="dv">3</span>)))</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(x_plot, z_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="sampling-distributions-redux" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="sampling-distributions-redux"><span class="header-section-number">13.7</span> Sampling Distributions Redux</h2>
<p>It is important to recognize that, above, we were dealing with probability distributions of discrete and continuous random variables as they relate to <em>populations</em>. But, as we have talked about before, we almost never measure entire populations… instead, we measure <em>samples</em> from populations and we characterize our samples using various <em>statistics</em>. The theoretical probability distributions described above (and others) are <em>models</em> for how we connect observed sample data to populations, taking into account various assumptions, and this is what allows us to do many types of inferential statistics. The most fundamental assumption is that the observations we make are <em>independent</em> from one another and are <em>identically distributed</em>, an assumption often abbreviated as <strong>iid</strong>. Obvious cases of violation of this assumption are rife in the scientific literature, and we should always be cautious about making this assumption!</p>
<p>However, the important thing for us to know is that we can get <em>unbiased estimates</em> of population level parameters based on sample statistics.</p>
<p><img src="img/pvz-zombie1.png" align="right" width="100px"></p>
<section id="challenge-7" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-7">CHALLENGE</h3>
<p>Let’s imagine a population of 1 million zombies whose age at zombification is characterized by a normal distribution with a mean of 25 years and a standard deviation of 5 years.</p>
<p>Create a variable <strong>x</strong> that describes this population and calculate the mean and standard deviation of the age at zombification.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e+06</span>, <span class="dv">25</span>, <span class="dv">5</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(x, <span class="at">type =</span> <span class="st">"density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>(mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(x))  <span class="co"># population mean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 25.00023</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>(sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">length</span>(x)))  <span class="co"># population SD</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 5.000924</code></pre>
</details>
</div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> We <strong>do not</strong> use the <code>sd()</code> function as this would divide by <code>length(x)-1</code>. Check that out using <code>sd(x)</code></p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 5.000926</code></pre>
</div>
</div>
<p>Now, suppose we now <strong>sample</strong> from the zombie population by trapping sets of zombies and determining the mean age at zombification in each set. We sample <em>without replacement</em> from the original population for each set…</p>
</section>
<section id="challenge-8" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-8">CHALLENGE</h3>
<p>Create a loop to sample the zombie population 5000 times with samples of size 10 and store these results in a list, <strong>s</strong>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5000</span>  <span class="co"># number of samples</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># size of each sample</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="co"># create a dummy variable to hold each sample</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dummy variable needs to be a list, not a vector, since each element will hold</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co"># a vector of numbers</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    s[[i]] <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(s, <span class="dv">1</span>)  <span class="co"># an example of one sample of 10 ages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [[1]]
##  [1] 32.48970 25.31725 25.52090 33.68150 22.90267 14.67928 26.26720 23.67120
##  [9] 17.89460 31.55967</code></pre>
</details>
</div>
</div>
<p>For each of these samples, we can then calculate a mean age, which is a statistic describing each sample. <strong>That statistic itself is a random variable with a mean and distribution!</strong> As we saw in <a href="12-module.html"><strong>Module 12</strong></a>, this is known as a <em>sampling distribution</em>.</p>
</section>
<section id="challenge-9" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-9">CHALLENGE</h3>
<p>Create a loop to calculate the mean of each of your 5000 samples and store the result in a vector, <strong>m</strong>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> k)  <span class="co"># create a dummy variable to hold the mean of each sample</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co"># here the dummy variable can be a vector and we can preallocate its length</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    m[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(s[[i]])</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 25.39840 22.48537 26.99638 26.14543 24.84191 25.72639</code></pre>
</details>
</div>
</div>
<p>So, how does the sampling distribution of mean ages compare to the population distribution of ages? The mean of the two is pretty close to the same! The sampling distribution mean, which is an average of the set of sample averages, is an unbiased estimator for the population mean.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(m)  <span class="co"># this is the mean of our set of sample means</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 25.0161</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e., the mean of the sampling distribution is almost equal to...</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>mu  <span class="co"># the true population mean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 25.00023</code></pre>
</div>
</div>
<p>Again, what we have just calculated is the <em>mean of the sampling distribution</em>, which is simply the average of the means of each sample we have made. This value should be really close to the population mean, and the sampling distribution - the distribution of sample means - should be about normally distributed around the true population mean.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(m), <span class="fu">aes</span>(<span class="at">x =</span> m)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="cf">function</span>(x) (<span class="fu">max</span>(m) <span class="sc">-</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">min</span>(m))<span class="sc">/</span><span class="dv">20</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Sampling Distribution"</span>), <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Means of "</span>,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>    k, <span class="st">" samples of size "</span>, n)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Sample Mean"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mu,</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> mu, <span class="at">y =</span> k <span class="sc">*</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.06</span>, <span class="at">label =</span> <span class="st">"True Population Mean</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(m), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">mean</span>(m) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> k <span class="sc">*</span> <span class="fl">0.06</span>, <span class="at">label =</span> <span class="st">"Mean of Sample Means</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now, let’s take a closer look at our samples of zombies that we extracted from the population of zombies…</p>
</section>
<section id="challenge-10" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-10">CHALLENGE</h3>
<p>Calculate a vector of standard error estimates based on the 5000 samples of zombies you have drawn from your population and then plot a histogram of the distribution of these standard errors. That is, for each sample, estimate the standard error of the sample (<span class="math inline">\(\frac{s}{\sqrt{n}}\)</span>). How does the mean of this set of standard errors compare to the standard error estimated from the population variance? How does it compare to the standard error calculated from the standard deviation of the sampling distribution?</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>sample_sd <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> k)  <span class="co"># create a dummy variable to hold the SD of each sample</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    sample_sd[[i]] <span class="ot">&lt;-</span> <span class="fu">sd</span>(s[[i]])  <span class="co"># a vector of SDs for each sample</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>sample_se <span class="ot">&lt;-</span> sample_sd<span class="sc">/</span><span class="fu">sqrt</span>(n)  <span class="co"># a vector of SEs estimated from each sample</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>pop_se <span class="ot">&lt;-</span> sigma<span class="sc">/</span>(<span class="fu">sqrt</span>(n))  <span class="co"># a single value estimated from the population SD</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>sampling_dist_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(m)  <span class="co"># a single value calculated from our sampling distibution SD</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(sample_se), <span class="fu">aes</span>(<span class="at">x =</span> sample_se)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="cf">function</span>(x) (<span class="fu">max</span>(sample_se) <span class="sc">-</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">min</span>(sample_se))<span class="sc">/</span><span class="dv">20</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Distribution of SEs estimated from</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    k, <span class="st">" samples of size "</span>, n)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Estimated SE"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(sample_se),</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">mean</span>(sample_se),</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> k <span class="sc">*</span> <span class="fl">0.075</span>, <span class="at">label =</span> <span class="st">"Mean Estimated SE</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> pop_se, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> pop_se, <span class="at">y =</span> k <span class="sc">*</span> <span class="fl">0.075</span>, <span class="at">label =</span> <span class="st">"</span><span class="sc">\n\n</span><span class="st">SE calculated from known population</span><span class="sc">\n</span><span class="st">standard deviation"</span>,</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sampling_dist_se,</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> sampling_dist_se,</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> k <span class="sc">*</span> <span class="fl">0.075</span>, <span class="at">label =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">SE estimated as SD of sampling distribution"</span>, <span class="at">color =</span> <span class="st">"green"</span>,</span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13-module_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sample_se)  <span class="co"># which is almost equal to...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 1.532473</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>pop_se  <span class="co"># which is almost equal to...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 1.581431</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>sampling_dist_se</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 1.604008</code></pre>
</details>
</div>
</div>
<p>Thus, the <em>standard error</em> calculated from an individual sample can be used as an <em>estimator</em> for the <strong>standard deviation of the sampling distribution</strong>. This is useful, since it means that, if our sample is large enough, we do not have to repeatedly sample from the population to get an estimate of the sampling distribution - we can instead estimate it directly using our data!</p>
<p>Note that as our sample size increases, the <em>standard error</em> calculated from the population variance should decrease, as should the standard deviation in the sampling distribution, i.e., in estimates of the population mean drawn from successive samples. This should be apparent intuitively… as each sample drawn from a population gets larger, the estimate of the mean value of those samples should vary less and less and thus have lower “error”.</p>
<p>Despite their similarities, the standard error of the mean estimated for a given sample and the standard deviation of that sample tell us different things. The <em>standard error</em> is an estimate of how far a given sample mean is likely to be from the population mean - it is a measure of uncertainty. The <em>standard deviation</em> of a sample is a measure of the degree to which individual values within a sample differ from the mean for that sample.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># | include: false</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>cowplot)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>manipulate)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>mosaic)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="concept-review" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="concept-review">Concept Review</h2>
<ul>
<li><p>Useful <strong><em>R</em></strong> functions for distributions: <code>r</code> (random value generation), <code>d</code> (point density), <code>p</code> (cumulative probability distribution), <code>q</code> (quantile)</p></li>
<li><p>Useful distributions:</p>
<ul>
<li>PMFs for discrete random variables - Bernoulli, Binomial, Poisson</li>
<li>PDFs for continuous random variables - Beta, Uniform, Normal and Standard Normal</li>
</ul></li>
<li><p>Standard error of the mean for a sample of size <span class="math inline">\(n\)</span>:</p>
<ul>
<li>(<strong>population standard deviation</strong>, or <span class="math inline">\(\sigma\)</span>) <span class="math inline">\(\div\)</span> <span class="math inline">\(\sqrt{n}\)</span></li>
<li>≈ <strong>standard deviation of the sampling distribution</strong> for a large set of samples of size <span class="math inline">\(n\)</span></li>
<li>≈ (<strong>standard deviation of a single sample of size</strong> <span class="math inline">\(n\)</span>, or <span class="math inline">\(s\)</span>) <span class="math inline">\(\div\)</span> <span class="math inline">\(\sqrt{n}\)</span></li>
</ul></li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./12-module.html" class="pagination-link  aria-label=" &lt;span="" statisics="" and="" sampling&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Descriptive Statisics and Sampling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./14-module.html" class="pagination-link" aria-label="<span class='chapter-number'>14</span>&nbsp; <span class='chapter-title'>Confidence Intervals</span>">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb130" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Probability and Distributions {#module-13}</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objectives</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The objective of this module is to gently begin our discussion of *statistical inference* and *statistical modeling*. Doing so requires that we first cover some basics of probability and statistical distributions.</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminaries</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Install and load this package in ***R***: <span class="co">[</span><span class="ot">{manipulate}</span><span class="co">](https://cran.r-project.org/web/packages/manipulate/manipulate.pdf)</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load {tidyverse}, {mosaic}, and {cowplot}</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manipulate)</span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Probability</span></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>The term **probability** is applied to *population-level* variables to describe the magnitude of chance associated with particular observations or events. Probabilities summarize the relative frequencies of different possible outcomes and are properties of *distributions* of variables. Every variable has a distribution that can be described empirically and visualized, as we have done in some of our previous modules. And, sometimes, these empirical distributions are nicely approximated by particular theoretical distributions with well-known mathematical properties, a fact which forms the basis for traditional frequentist (or classical) statistical inference.</span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>Probabilities for events or collections of events necessarily vary between zero and one. Outcomes or combinations of outcomes that are impossible have $Pr = 0$, those that are certain have $Pr = 1$.</span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **EXAMPLE:** If we roll a (fair, unbiased) die, there are 6 possible outcomes, and each has a probability of occurring of 1 in 6. We can estimate these probabilities using data on the outcome of lots of observations of independent die rolls. This is referred to as a *frequentist* or *classical* way of thinking about the probability of these different outcomes... the relative frequency with which a particular event occurs over numerous identical, independent, objective trials.</span></span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a>We will use the {manipulate} package and the <span class="in">`sample()`</span> function to explore the effects of sample size on estimates of the probability of different outcomes of the a process of rolling a (fair, unbiased) die. The {manipulate} package allows us to create an interactive plot that lets us dynamically change something about the values being plotted. We will set up a simulation where the probability of each possible outcome of the process of rolling a die one time ("1", "2",..., "6") is 1 in 6, but our estimate of the probability of each possible outcome will change with sample size. In the code below, we use the powerful <span class="in">`sample()`</span> function, which takes several arguments - a set of elements to sample from (<span class="in">`x=`</span>), the number of elements to draw (<span class="in">`size=`</span>), and whether or not to draw with replacement (<span class="in">`replace=`</span>). After typing in and running the code below, play with the slider to change the number of die rolls being simulated.</span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a>outcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(</span>
<span id="cb130-39"><a href="#cb130-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">histogram</span>(<span class="fu">sample</span>(<span class="at">x =</span> outcomes, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb130-40"><a href="#cb130-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">3.5</span>,<span class="fl">4.5</span>,<span class="fl">5.5</span>,<span class="fl">6.5</span>),</span>
<span id="cb130-41"><a href="#cb130-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"density"</span>,</span>
<span id="cb130-42"><a href="#cb130-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Histogram of Outcomes of "</span>, n, <span class="st">" Die Rolls"</span>, <span class="at">sep=</span><span class="st">""</span>),</span>
<span id="cb130-43"><a href="#cb130-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Roll"</span>,</span>
<span id="cb130-44"><a href="#cb130-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Probability"</span>),</span>
<span id="cb130-45"><a href="#cb130-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">n=</span><span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">10000</span>, <span class="at">initial=</span><span class="dv">100</span>, <span class="at">step=</span><span class="dv">100</span>)</span>
<span id="cb130-46"><a href="#cb130-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-47"><a href="#cb130-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-48"><a href="#cb130-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-49"><a href="#cb130-49" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb130-50"><a href="#cb130-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-51"><a href="#cb130-51" aria-hidden="true" tabindex="-1"></a>Write your own function, <span class="in">`roll()`</span>, to simulate rolling a die where you pass the number of rolls as an argument (<span class="in">`nrolls=`</span>) with a default value of 1. Then, use your function to simulate rolling two dice a total 1000 times and take the sum of the rolls. Plot a histogram of those results. What happens if you roll each die 100 times? 10,000 times?</span>
<span id="cb130-52"><a href="#cb130-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-55"><a href="#cb130-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-56"><a href="#cb130-56" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-57"><a href="#cb130-57" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb130-58"><a href="#cb130-58" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb130-59"><a href="#cb130-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb130-60"><a href="#cb130-60" aria-hidden="true" tabindex="-1"></a>roll <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nrolls=</span><span class="dv">1</span>) {<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, nrolls, <span class="at">replace =</span> <span class="cn">TRUE</span>)} <span class="co"># function with default of 1 roll</span></span>
<span id="cb130-61"><a href="#cb130-61" aria-hidden="true" tabindex="-1"></a>nrolls <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb130-62"><a href="#cb130-62" aria-hidden="true" tabindex="-1"></a>two_dice <span class="ot">&lt;-</span> <span class="fu">roll</span>(nrolls) <span class="sc">+</span> <span class="fu">roll</span>(nrolls)</span>
<span id="cb130-63"><a href="#cb130-63" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(two_dice,</span>
<span id="cb130-64"><a href="#cb130-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks=</span><span class="fu">c</span>(<span class="fl">1.5</span><span class="sc">:</span><span class="fl">12.5</span>),</span>
<span id="cb130-65"><a href="#cb130-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"density"</span>,</span>
<span id="cb130-66"><a href="#cb130-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Rolling Two Dice"</span>,</span>
<span id="cb130-67"><a href="#cb130-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Sum of Rolls"</span>,</span>
<span id="cb130-68"><a href="#cb130-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Probability"</span>)</span>
<span id="cb130-69"><a href="#cb130-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-70"><a href="#cb130-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-71"><a href="#cb130-71" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rules of Probability</span></span>
<span id="cb130-72"><a href="#cb130-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-73"><a href="#cb130-73" aria-hidden="true" tabindex="-1"></a>The following are a set of standard rule of probability that are worth reviewing:</span>
<span id="cb130-74"><a href="#cb130-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-75"><a href="#cb130-75" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>$Pr (+)$ = Probability that *something* occurs = 1</span>
<span id="cb130-76"><a href="#cb130-76" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>$Pr (\emptyset)$ = Probability that *nothing* occurs = 0</span>
<span id="cb130-77"><a href="#cb130-77" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>$Pr (A)$ = Probability that a *particular event*, $A$, occurs</span>
<span id="cb130-78"><a href="#cb130-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-79"><a href="#cb130-79" aria-hidden="true" tabindex="-1"></a>$$0 \leq Pr (A) \leq 1$$</span>
<span id="cb130-80"><a href="#cb130-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-81"><a href="#cb130-81" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>$Pr (A \cup B)$ = Probability that a particular event $A$ *or* a particular event $B$ occurs = **UNION**</span>
<span id="cb130-82"><a href="#cb130-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-83"><a href="#cb130-83" aria-hidden="true" tabindex="-1"></a>$$Pr (A \cup B) = Pr (A) + Pr (B) - Pr (A \cap B)$$</span>
<span id="cb130-84"><a href="#cb130-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-85"><a href="#cb130-85" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; If events $A$ and $B$ are *mutually exclusive*, then this simplifies to... $$Pr (A) + Pr (B)$$</span></span>
<span id="cb130-86"><a href="#cb130-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-87"><a href="#cb130-87" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>$Pr (A \cap B)$ = Probability that both $A$ and $B$ occur simultaneously = **INTERSECTION**</span>
<span id="cb130-88"><a href="#cb130-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-89"><a href="#cb130-89" aria-hidden="true" tabindex="-1"></a>$$Pr (A \cap B) = Pr (A \vert B) \times Pr (B) = Pr (B \vert A) \times Pr (A)$$</span>
<span id="cb130-90"><a href="#cb130-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-91"><a href="#cb130-91" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The pipe operator ( $\vert$ ) can be read as "given" and indicates *conditional probability* (see below)</span></span>
<span id="cb130-92"><a href="#cb130-92" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-93"><a href="#cb130-93" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; If $Pr (A \cap B) = 0$, then we say the events are *mutually exclusive* (e.g., you cannot have a die roll be 1 *and* 2)</span></span>
<span id="cb130-94"><a href="#cb130-94" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-95"><a href="#cb130-95" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; If the two events are *independent* (i.e., if the probability of one does not depend on the probability of the other), then $Pr (A \cap B)$ simplifies to... $$Pr (A) \times Pr (B)$$</span></span>
<span id="cb130-96"><a href="#cb130-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-97"><a href="#cb130-97" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Probability of the **COMPLEMENT** of $A$ (i.e., **not** $A$) = $Pr (Ā) = 1 - Pr (A)$</span>
<span id="cb130-98"><a href="#cb130-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-99"><a href="#cb130-99" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>**CONDITIONAL PROBABILITY** is the probability of an event occuring after taking into account the occurrence of another event, i.e., one event is *conditioned* on the occurrence of a different event. For example, the probability of a die coming up as a "1" given that we know the die came up as an odd number ("1", "3", or "5") is a conditional probability.</span>
<span id="cb130-100"><a href="#cb130-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-101"><a href="#cb130-101" aria-hidden="true" tabindex="-1"></a>$$Pr (A \vert B) = Pr (A \cap B) \div Pr (B)$$</span>
<span id="cb130-102"><a href="#cb130-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-103"><a href="#cb130-103" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; If event $A$ and event $B$ are *independent*, then $$Pr (A \vert B) = </span><span class="co">[</span><span class="ot">Pr (A) \times Pr (B) </span><span class="co">]</span><span class="at"> \div Pr (B) = Pr (A)$$</span></span>
<span id="cb130-104"><a href="#cb130-104" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-105"><a href="#cb130-105" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; If event $A$ and $B$ are *not independent*, then $$Pr (A \vert B) ≠ Pr (A)$$</span></span>
<span id="cb130-106"><a href="#cb130-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-107"><a href="#cb130-107" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb130-108"><a href="#cb130-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-109"><a href="#cb130-109" aria-hidden="true" tabindex="-1"></a>You have a deck of 52 cards... Ace to 10 plus 3 face cards in each suit. You draw a card at random.</span>
<span id="cb130-110"><a href="#cb130-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-111"><a href="#cb130-111" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the probability that you draw a *face card*?</span>
<span id="cb130-112"><a href="#cb130-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-113"><a href="#cb130-113" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr (face\ card)$</span></span>
<span id="cb130-114"><a href="#cb130-114" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-115"><a href="#cb130-115" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 12 of 52 cards = 0.2307692</span></span>
<span id="cb130-116"><a href="#cb130-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-117"><a href="#cb130-117" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the probability that you draw a *King*?</span>
<span id="cb130-118"><a href="#cb130-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-119"><a href="#cb130-119" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr(King)$</span></span>
<span id="cb130-120"><a href="#cb130-120" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-121"><a href="#cb130-121" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 3 of 52 cards = 0.05769231</span></span>
<span id="cb130-122"><a href="#cb130-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-123"><a href="#cb130-123" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the probability that you draw a *spade*?</span>
<span id="cb130-124"><a href="#cb130-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-125"><a href="#cb130-125" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr(spade)$</span></span>
<span id="cb130-126"><a href="#cb130-126" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-127"><a href="#cb130-127" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 13 of 52 cards = 0.25</span></span>
<span id="cb130-128"><a href="#cb130-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-129"><a href="#cb130-129" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the probability that you draw a *spade* given that you draw a *face card*? (CONDITIONAL, INDEPENDENT EVENTS)</span>
<span id="cb130-130"><a href="#cb130-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-131"><a href="#cb130-131" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Intuitively...</span></span>
<span id="cb130-132"><a href="#cb130-132" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-133"><a href="#cb130-133" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 3 of 12 cards = 0.25</span></span>
<span id="cb130-134"><a href="#cb130-134" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-135"><a href="#cb130-135" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Formally...</span></span>
<span id="cb130-136"><a href="#cb130-136" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-137"><a href="#cb130-137" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr(spade \vert face\ card) = Pr(spade) \times Pr(face\ card) \div Pr(face\ card)$</span></span>
<span id="cb130-138"><a href="#cb130-138" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-139"><a href="#cb130-139" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - (13 of 52) $\times$ (12 of 52) $\div$ (12 of 52) = 0.25</span></span>
<span id="cb130-140"><a href="#cb130-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-141"><a href="#cb130-141" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the probability that you draw a *King* given that you draw a *face card*? (CONDITIONAL, NOT INDEPENDENT EVENTS)</span>
<span id="cb130-142"><a href="#cb130-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-143"><a href="#cb130-143" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Intuitively...</span></span>
<span id="cb130-144"><a href="#cb130-144" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-145"><a href="#cb130-145" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 4 of 12 cards = 0.3333333</span></span>
<span id="cb130-146"><a href="#cb130-146" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-147"><a href="#cb130-147" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Formally...</span></span>
<span id="cb130-148"><a href="#cb130-148" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-149"><a href="#cb130-149" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr(King \vert face\ card) = Pr(King \cap face\ card) \div Pr(face\ card) =$</span></span>
<span id="cb130-150"><a href="#cb130-150" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-151"><a href="#cb130-151" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr(face\ card \vert King) \times Pr(King) \div Pr(face\ card)$</span></span>
<span id="cb130-152"><a href="#cb130-152" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-153"><a href="#cb130-153" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 1 $\times$ (4 of 52) $\div$ (12 of 52) = 0.3333333</span></span>
<span id="cb130-154"><a href="#cb130-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-155"><a href="#cb130-155" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the probability that you draw a card that is both from a *red* suit (hearts or diamonds) and a *face card*? (INTERSECTION, INDEPENDENT EVENTS)</span>
<span id="cb130-156"><a href="#cb130-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-157"><a href="#cb130-157" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Intuitively...</span></span>
<span id="cb130-158"><a href="#cb130-158" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-159"><a href="#cb130-159" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 6 of 52 cards = 0.1153846</span></span>
<span id="cb130-160"><a href="#cb130-160" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-161"><a href="#cb130-161" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Formally...</span></span>
<span id="cb130-162"><a href="#cb130-162" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-163"><a href="#cb130-163" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr (red \cap face\ card) = Pr (red \vert face\ card) \times Pr (face\ card) =$</span></span>
<span id="cb130-164"><a href="#cb130-164" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-165"><a href="#cb130-165" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $</span><span class="co">[</span><span class="ot">Pr(red) \times Pr(face\ card)</span><span class="co">]</span><span class="at"> \div Pr(face\ card) \times Pr(face\ card)$</span></span>
<span id="cb130-166"><a href="#cb130-166" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-167"><a href="#cb130-167" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; where...</span></span>
<span id="cb130-168"><a href="#cb130-168" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-169"><a href="#cb130-169" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr (red)$</span></span>
<span id="cb130-170"><a href="#cb130-170" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-171"><a href="#cb130-171" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 26 of 52 cards = 0.5</span></span>
<span id="cb130-172"><a href="#cb130-172" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-173"><a href="#cb130-173" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr (face\ card)$</span></span>
<span id="cb130-174"><a href="#cb130-174" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-175"><a href="#cb130-175" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 12 of 52 cards = 0.2307692</span></span>
<span id="cb130-176"><a href="#cb130-176" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-177"><a href="#cb130-177" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; so...</span></span>
<span id="cb130-178"><a href="#cb130-178" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-179"><a href="#cb130-179" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - </span><span class="co">[</span><span class="ot">(26 of 52) $\times$ (12 of 52)</span><span class="co">]</span><span class="at"> $\div$ (12 of 52) $\times$ (12 of 52) = 0.1153846</span></span>
<span id="cb130-180"><a href="#cb130-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-181"><a href="#cb130-181" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the probability that you draw a card that is either a *club* or *not a face card*? (UNION, NOT INDEPENDENT EVENTS)</span>
<span id="cb130-182"><a href="#cb130-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-183"><a href="#cb130-183" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Intuitively...</span></span>
<span id="cb130-184"><a href="#cb130-184" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-185"><a href="#cb130-185" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - (13 club cards $+$ 40 not face cards $-$ 10 club cards that are not face cards) of 52 cards = 43 of 52 cards = 0.8269231</span></span>
<span id="cb130-186"><a href="#cb130-186" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-187"><a href="#cb130-187" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Formally...</span></span>
<span id="cb130-188"><a href="#cb130-188" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-189"><a href="#cb130-189" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr (club \cup not\ a\ face\ card) =$</span></span>
<span id="cb130-190"><a href="#cb130-190" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-191"><a href="#cb130-191" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr (club) + Pr (not\ a\ face\ card) - Pr (club \cap not\ a\ face\ card) =$</span></span>
<span id="cb130-192"><a href="#cb130-192" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-193"><a href="#cb130-193" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr (club) + Pr (not\ a\ face\ card) - Pr (club \vert not\ a\ face\ card) \times Pr (not\ a\ face\ card)$</span></span>
<span id="cb130-194"><a href="#cb130-194" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-195"><a href="#cb130-195" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; where...</span></span>
<span id="cb130-196"><a href="#cb130-196" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-197"><a href="#cb130-197" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr (club)$</span></span>
<span id="cb130-198"><a href="#cb130-198" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-199"><a href="#cb130-199" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 13 of 52 cards = 0.25</span></span>
<span id="cb130-200"><a href="#cb130-200" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-201"><a href="#cb130-201" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr (not\ a\ face\ card)$</span></span>
<span id="cb130-202"><a href="#cb130-202" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-203"><a href="#cb130-203" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 40 of 52 cards = 0.7692308</span></span>
<span id="cb130-204"><a href="#cb130-204" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-205"><a href="#cb130-205" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr (club \vert not\ a\ face\ card)$</span></span>
<span id="cb130-206"><a href="#cb130-206" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-207"><a href="#cb130-207" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - 10 of 40 = 0.25</span></span>
<span id="cb130-208"><a href="#cb130-208" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-209"><a href="#cb130-209" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; so...</span></span>
<span id="cb130-210"><a href="#cb130-210" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb130-211"><a href="#cb130-211" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - (13 of 52) $+$ (40 of 52) $-$ </span><span class="co">[</span><span class="ot">(10 of 40) $\times$ (40 of 52)</span><span class="co">]</span><span class="at"> = 0.8269231</span></span>
<span id="cb130-212"><a href="#cb130-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-213"><a href="#cb130-213" aria-hidden="true" tabindex="-1"></a><span class="fu">## Random Variables</span></span>
<span id="cb130-214"><a href="#cb130-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-215"><a href="#cb130-215" aria-hidden="true" tabindex="-1"></a>A **random variable** is a variable whose outcomes are assumed to arise by chance or according to some random or stochastic process. The chances of observing a *specific outcome*, or an outcome value *within a specific interval*, has associated with it a **probability**.</span>
<span id="cb130-216"><a href="#cb130-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-217"><a href="#cb130-217" aria-hidden="true" tabindex="-1"></a>Random variables come in two varieties:</span>
<span id="cb130-218"><a href="#cb130-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-219"><a href="#cb130-219" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Discrete Random Variables** are random variables that can assume only a countable number of discrete possibilities (e.g., counts of outcomes in a particular category, e.g., rolls of a die). We can assign a probability to each possible outcome.</span>
<span id="cb130-220"><a href="#cb130-220" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Continuous Random Variables** are random variables that can assume any real number value within a given range (e.g., measurements of body weight, number of offspring, linear dimensions, etc.). We cannot assign a specific probability to each possible outcome value as the set of possible outcomes is (theoretically) infinite, but we can assign probabilites to intervals of outcome values.</span>
<span id="cb130-221"><a href="#cb130-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-222"><a href="#cb130-222" aria-hidden="true" tabindex="-1"></a>With these basics in mind, we can define a few more terms:</span>
<span id="cb130-223"><a href="#cb130-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-224"><a href="#cb130-224" aria-hidden="true" tabindex="-1"></a>A *probability function* is a mathematical function that describes the chance associated with a random variable either having particular outcomes (for discrete variables) or falling within a given range of outcome values (for continuous variables). Familiar statistical distributions (e.g., the normal distribution, the beta distribution, the Poisson distribution) are all examples of probability functions.</span>
<span id="cb130-225"><a href="#cb130-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-226"><a href="#cb130-226" aria-hidden="true" tabindex="-1"></a>We can distinguish two types of probability functions, associated with these different kinds of random variables.</span>
<span id="cb130-227"><a href="#cb130-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-228"><a href="#cb130-228" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probability Mass Functions {.unnumbered}</span></span>
<span id="cb130-229"><a href="#cb130-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-230"><a href="#cb130-230" aria-hidden="true" tabindex="-1"></a>*Probability Mass Functions (PMFs)* are associated with **discrete random variables**. These functions describe the probability that a random variable takes a particular discrete **value**.</span>
<span id="cb130-231"><a href="#cb130-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-232"><a href="#cb130-232" aria-hidden="true" tabindex="-1"></a>To be a valid *PMF*, a function $f(x)$ must satisfy the following conditions:</span>
<span id="cb130-233"><a href="#cb130-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-234"><a href="#cb130-234" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>There are $k$ distinct outcomes $x_1, x_2, ... ,x_k$</span>
<span id="cb130-235"><a href="#cb130-235" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>$0 \leq Pr (X=x_i) \leq 1$ for all $x_i$</span>
<span id="cb130-236"><a href="#cb130-236" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>$\sum\limits_{i=1}^{k} Pr (X=x_i) = 1$</span>
<span id="cb130-237"><a href="#cb130-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-238"><a href="#cb130-238" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **EXAMPLE:** Flipping a Fair Coin {.unnumbered}</span></span>
<span id="cb130-239"><a href="#cb130-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-242"><a href="#cb130-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-243"><a href="#cb130-243" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-244"><a href="#cb130-244" aria-hidden="true" tabindex="-1"></a>outcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"heads"</span>, <span class="st">"tails"</span>)</span>
<span id="cb130-245"><a href="#cb130-245" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb130-246"><a href="#cb130-246" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb130-247"><a href="#cb130-247" aria-hidden="true" tabindex="-1"></a>  prob,</span>
<span id="cb130-248"><a href="#cb130-248" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>),</span>
<span id="cb130-249"><a href="#cb130-249" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.arg =</span> outcomes,</span>
<span id="cb130-250"><a href="#cb130-250" aria-hidden="true" tabindex="-1"></a>  <span class="at">space =</span> <span class="fl">0.1</span>,</span>
<span id="cb130-251"><a href="#cb130-251" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"outcome"</span>,</span>
<span id="cb130-252"><a href="#cb130-252" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Pr(X = outcome)"</span>,</span>
<span id="cb130-253"><a href="#cb130-253" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Probability Mass Function"</span></span>
<span id="cb130-254"><a href="#cb130-254" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-255"><a href="#cb130-255" aria-hidden="true" tabindex="-1"></a>cumprob <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb130-256"><a href="#cb130-256" aria-hidden="true" tabindex="-1"></a>cumoutcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"heads"</span>, <span class="st">"heads + tails"</span>)</span>
<span id="cb130-257"><a href="#cb130-257" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb130-258"><a href="#cb130-258" aria-hidden="true" tabindex="-1"></a>  cumprob,</span>
<span id="cb130-259"><a href="#cb130-259" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.arg =</span> cumoutcomes,</span>
<span id="cb130-260"><a href="#cb130-260" aria-hidden="true" tabindex="-1"></a>  <span class="at">space =</span> <span class="fl">0.1</span>,</span>
<span id="cb130-261"><a href="#cb130-261" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"outcome"</span>,</span>
<span id="cb130-262"><a href="#cb130-262" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Cumulative Pr(X)"</span>,</span>
<span id="cb130-263"><a href="#cb130-263" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb130-264"><a href="#cb130-264" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-265"><a href="#cb130-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-266"><a href="#cb130-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-267"><a href="#cb130-267" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **EXAMPLE:** Rolling a Fair Die {.unnumbered}</span></span>
<span id="cb130-268"><a href="#cb130-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-271"><a href="#cb130-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-272"><a href="#cb130-272" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-273"><a href="#cb130-273" aria-hidden="true" tabindex="-1"></a>outcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb130-274"><a href="#cb130-274" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>)</span>
<span id="cb130-275"><a href="#cb130-275" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb130-276"><a href="#cb130-276" aria-hidden="true" tabindex="-1"></a>  prob,</span>
<span id="cb130-277"><a href="#cb130-277" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb130-278"><a href="#cb130-278" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.arg =</span> outcomes,</span>
<span id="cb130-279"><a href="#cb130-279" aria-hidden="true" tabindex="-1"></a>  <span class="at">space =</span> <span class="fl">0.1</span>,</span>
<span id="cb130-280"><a href="#cb130-280" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"outcome"</span>,</span>
<span id="cb130-281"><a href="#cb130-281" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Pr(X = outcome)"</span>,</span>
<span id="cb130-282"><a href="#cb130-282" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Probability Mass Function"</span></span>
<span id="cb130-283"><a href="#cb130-283" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-284"><a href="#cb130-284" aria-hidden="true" tabindex="-1"></a>cumprob <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb130-285"><a href="#cb130-285" aria-hidden="true" tabindex="-1"></a>cumoutcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"1 to 2"</span>, <span class="st">"1 to 3"</span>, <span class="st">"1 to 4"</span>, <span class="st">"1 to 5"</span>, <span class="st">"1 to 6"</span>)</span>
<span id="cb130-286"><a href="#cb130-286" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb130-287"><a href="#cb130-287" aria-hidden="true" tabindex="-1"></a>  cumprob,</span>
<span id="cb130-288"><a href="#cb130-288" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.arg =</span> cumoutcomes,</span>
<span id="cb130-289"><a href="#cb130-289" aria-hidden="true" tabindex="-1"></a>  <span class="at">space =</span> <span class="fl">0.1</span>,</span>
<span id="cb130-290"><a href="#cb130-290" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"outcome"</span>,</span>
<span id="cb130-291"><a href="#cb130-291" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Cumulative Pr(X)"</span>,</span>
<span id="cb130-292"><a href="#cb130-292" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb130-293"><a href="#cb130-293" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-294"><a href="#cb130-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-295"><a href="#cb130-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-296"><a href="#cb130-296" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probability Density Functions {.unnumbered}</span></span>
<span id="cb130-297"><a href="#cb130-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-298"><a href="#cb130-298" aria-hidden="true" tabindex="-1"></a>*Probability Density Functions (PDFs)* are associated with **continuous random variables**. These functions describe the probability that a random variable falls **within a given range of outcome values**. The probability associated with that range equals the area under the *density function* for that range.</span>
<span id="cb130-299"><a href="#cb130-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-300"><a href="#cb130-300" aria-hidden="true" tabindex="-1"></a>To be a valid *PDF*, a function $f(x)$ must satisfy the following:</span>
<span id="cb130-301"><a href="#cb130-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-302"><a href="#cb130-302" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>$f(x)\geq 0$ for all $-\infty \leq x \leq +\infty$. That is, the function $f(x)$ is non-negative everywhere.</span>
<span id="cb130-303"><a href="#cb130-303" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>$\int_\limits{-\infty}^{+\infty} f(x) dx = 1$. That is, the total area under the function $f(x)$ = 1</span>
<span id="cb130-304"><a href="#cb130-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-305"><a href="#cb130-305" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example: Exploring the **Beta Distribution** {.unnumbered}</span></span>
<span id="cb130-306"><a href="#cb130-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-307"><a href="#cb130-307" aria-hidden="true" tabindex="-1"></a>The **Beta Distribution** refers to a family of continuous probability distributions defined over the interval <span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span> and parameterized by two positive shape coefficients, denoted by $\alpha$ and $\beta$, that appear as exponents of the random variable $x$ and control the shape of the distribution. The beta distribution function is...</span>
<span id="cb130-308"><a href="#cb130-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-309"><a href="#cb130-309" aria-hidden="true" tabindex="-1"></a>$$f(x) = x^{\alpha-1}(1-x)^{\beta-1}$$</span>
<span id="cb130-310"><a href="#cb130-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-311"><a href="#cb130-311" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** There is nothing special about the **Beta Distribution** for this example, we are just using it to show how probabilities are equivalent to areas under a function.</span></span>
<span id="cb130-312"><a href="#cb130-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-313"><a href="#cb130-313" aria-hidden="true" tabindex="-1"></a>We can explore the beta distribution using the {manipulate} package by entering the code below. With the domain of $x$ restricted to <span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>, and with $\alpha$ initially set to 2 and $\beta$ initially set to 1, we see the PDF for the beta distribution is triangular. Try playing with different values for $\alpha$ and $\beta$. The <span class="in">`dbeta()`</span> function provides the value of the function at the specified values of **x**.</span>
<span id="cb130-314"><a href="#cb130-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-317"><a href="#cb130-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-318"><a href="#cb130-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb130-319"><a href="#cb130-319" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(</span>
<span id="cb130-320"><a href="#cb130-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">stat_function</span>(</span>
<span id="cb130-321"><a href="#cb130-321" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> dbeta,</span>
<span id="cb130-322"><a href="#cb130-322" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> alpha, <span class="at">shape2 =</span> beta),</span>
<span id="cb130-323"><a href="#cb130-323" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">1000</span></span>
<span id="cb130-324"><a href="#cb130-324" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"f(x)"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb130-325"><a href="#cb130-325" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Exploring the Beta Distribution"</span>,</span>
<span id="cb130-326"><a href="#cb130-326" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Cumulative Probability = "</span>, <span class="fu">round</span>(<span class="fu">pbeta</span>(x, alpha, beta), <span class="dv">2</span>))</span>
<span id="cb130-327"><a href="#cb130-327" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">stat_function</span>(</span>
<span id="cb130-328"><a href="#cb130-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> dbeta,</span>
<span id="cb130-329"><a href="#cb130-329" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, x),</span>
<span id="cb130-330"><a href="#cb130-330" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> alpha, <span class="at">shape2 =</span> beta),</span>
<span id="cb130-331"><a href="#cb130-331" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">1000</span>,</span>
<span id="cb130-332"><a href="#cb130-332" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"area"</span></span>
<span id="cb130-333"><a href="#cb130-333" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb130-334"><a href="#cb130-334" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">initial =</span> <span class="dv">2</span>, <span class="at">step =</span> <span class="fl">0.1</span>),</span>
<span id="cb130-335"><a href="#cb130-335" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">initial =</span> <span class="dv">1</span>, <span class="at">step =</span> <span class="fl">0.1</span>),</span>
<span id="cb130-336"><a href="#cb130-336" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">initial =</span> <span class="fl">0.0</span>, <span class="at">step =</span> <span class="fl">0.01</span>)</span>
<span id="cb130-337"><a href="#cb130-337" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-338"><a href="#cb130-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-339"><a href="#cb130-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-340"><a href="#cb130-340" aria-hidden="true" tabindex="-1"></a>Is this a *PDF*? Why or why not? Yes... it satisfies both criteria for a *PDF*.</span>
<span id="cb130-341"><a href="#cb130-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-342"><a href="#cb130-342" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>$f(x) \geq 0$ for all $-\infty \leq x \leq +\infty$</span>
<span id="cb130-343"><a href="#cb130-343" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The total area under $f(x)$ = 1</span>
<span id="cb130-344"><a href="#cb130-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-345"><a href="#cb130-345" aria-hidden="true" tabindex="-1"></a>We can show this interactively by playing with the slider for $x$ and looking at the shaded area, which represents the **cumulative probability** integrated across $f(x)$ from $-\infty$ to $x$.</span>
<span id="cb130-346"><a href="#cb130-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-347"><a href="#cb130-347" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cumulative Distribution Functions {.unnumbered}</span></span>
<span id="cb130-348"><a href="#cb130-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-349"><a href="#cb130-349" aria-hidden="true" tabindex="-1"></a>The **cumulative distribution function**, or **CDF**, of a random variable is defined as the probability of observing a random variable $X$ taking the value of $x$ or less, i.e., $F(x) = Pr (X \leq x)$.</span>
<span id="cb130-350"><a href="#cb130-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-351"><a href="#cb130-351" aria-hidden="true" tabindex="-1"></a>This definition actually applies regardless of whether $X$ is discrete or continuous. Note here we are using the notation $F(x)$ for the cumulative distribution function rather than $f(x)$, which we use for the probability density or mass function. For a continuous variable, the *PDF* is simply the first derivative of the *CDF*, i.e., $f(x) = dF(x)$.</span>
<span id="cb130-352"><a href="#cb130-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-353"><a href="#cb130-353" aria-hidden="true" tabindex="-1"></a>The built in ***R*** "probability" function for the **Beta Distribution**, <span class="in">`pbeta()`</span>, gives us this cumulative probability directly, if we specify the values of $\alpha$ and $\beta$. E.g., for $\alpha$ = 2 and $\beta$ = 1...</span>
<span id="cb130-354"><a href="#cb130-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-357"><a href="#cb130-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-358"><a href="#cb130-358" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span>(<span class="fl">0.75</span>, <span class="dv">2</span>, <span class="dv">1</span>) <span class="co"># cumulative probability for x ≤ 0.75</span></span>
<span id="cb130-359"><a href="#cb130-359" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">1</span>) <span class="co"># cumulative probability for x ≤ 0.50</span></span>
<span id="cb130-360"><a href="#cb130-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-361"><a href="#cb130-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-362"><a href="#cb130-362" aria-hidden="true" tabindex="-1"></a>In general, we find the cumulative probability for a continuous random variable by calculating the area under the probability density function of interest from $-\infty$ to $x$. This is what is is being returned from <span class="in">`pbeta()`</span>.</span>
<span id="cb130-363"><a href="#cb130-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-364"><a href="#cb130-364" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The other related ***R*** functions for the **Beta Distribution**, i.e., `rbeta()`, `dbeta()`, and `qbeta()`, are also useful. `rbeta()` draws random observations from a specfied beta distribution. `dbeta()` gives the point estimate of the beta density function at the value of the argument $x$, and `qbeta()` is essentially the converse of `pbeta()`, i.e., it tells you the value of $x$ that is associated with a particular cumulative probability, or **quantile**, of the cumulative distribution function.</span></span>
<span id="cb130-365"><a href="#cb130-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-368"><a href="#cb130-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-369"><a href="#cb130-369" aria-hidden="true" tabindex="-1"></a><span class="fu">dbeta</span>(<span class="fl">0.75</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb130-370"><a href="#cb130-370" aria-hidden="true" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fl">0.5625</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb130-371"><a href="#cb130-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-372"><a href="#cb130-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-373"><a href="#cb130-373" aria-hidden="true" tabindex="-1"></a>We can also define the **survival function** for a random variable $X$ as:</span>
<span id="cb130-374"><a href="#cb130-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-375"><a href="#cb130-375" aria-hidden="true" tabindex="-1"></a>$$S(x) = Pr (X \gt x) = 1 - Pr (X \leq x) = 1 - F(x)$$</span>
<span id="cb130-376"><a href="#cb130-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-377"><a href="#cb130-377" aria-hidden="true" tabindex="-1"></a>*PMFs* and *PDFs* for many other standard or well studied distributions have comparable `r`, `d`, `p`, and `q` functions to those for the **Beta Distribution**.</span>
<span id="cb130-378"><a href="#cb130-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-379"><a href="#cb130-379" aria-hidden="true" tabindex="-1"></a>**TL/DR:** ***R*** has four built-in functions that can be applied to a variety of standard and well understood statistical distributions:</span>
<span id="cb130-380"><a href="#cb130-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-381"><a href="#cb130-381" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`r`</span> - the *random generation* function, which draws a random variable from the given distribution.</span>
<span id="cb130-382"><a href="#cb130-382" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`d`</span> - the *density* function, PMF or PDF, which describes the distribution of values for the function across the range of $x$ values: $f(x)$.</span>
<span id="cb130-383"><a href="#cb130-383" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`p`</span> - the *cumulative distribution* function, CDF, which gives the cumulative probability for all values from $-\infty$ to $x$ for a given distribution: $F(x)$ = *Pr* $(X$ $\leq$ $x)$.</span>
<span id="cb130-384"><a href="#cb130-384" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`q`</span> - the *quantile* function, which is the converse of <span class="in">`p`</span>: the value of $x$ at which the CDF has the value $q$, i.e., $F(x_q) = q$.</span>
<span id="cb130-385"><a href="#cb130-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-386"><a href="#cb130-386" aria-hidden="true" tabindex="-1"></a>Note the relationship between the <span class="in">`p`</span> and <span class="in">`q`</span> functions:</span>
<span id="cb130-387"><a href="#cb130-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-390"><a href="#cb130-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-391"><a href="#cb130-391" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span> (<span class="fl">0.7</span>, <span class="dv">2</span>, <span class="dv">1</span>) <span class="co"># yields 0.49 - x values ≤ 0.7 comprise 49% of the CDF</span></span>
<span id="cb130-392"><a href="#cb130-392" aria-hidden="true" tabindex="-1"></a><span class="fu">qbeta</span> (<span class="fl">0.49</span>, <span class="dv">2</span>, <span class="dv">1</span>) <span class="co"># yields 0.7 - 49% of the CDF falls in the range x ≤ 0.7</span></span>
<span id="cb130-393"><a href="#cb130-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-394"><a href="#cb130-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-395"><a href="#cb130-395" aria-hidden="true" tabindex="-1"></a><span class="fu">### Expected Mean and Variance {.unnumbered}</span></span>
<span id="cb130-396"><a href="#cb130-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-397"><a href="#cb130-397" aria-hidden="true" tabindex="-1"></a>The mean value (or *expectation*) of a discrete random variable with a given *probability mass function* is equivalent to a "long-term average", i.e., what you would expect the average value of the variable to be if you sampled from the PMF many, many times. This expectation can be expressed generally as follows:</span>
<span id="cb130-398"><a href="#cb130-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-399"><a href="#cb130-399" aria-hidden="true" tabindex="-1"></a>$$\mu_X = Expectation\ for\ X = \sum x_i \times Pr (X=x_i)\ for\ all\ x\ from\ x_i\ to\ x_k$$</span>
<span id="cb130-400"><a href="#cb130-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-401"><a href="#cb130-401" aria-hidden="true" tabindex="-1"></a>Likewise, the expected variance of a discrete random variable, $X$, across a large sample from the PMF is:</span>
<span id="cb130-402"><a href="#cb130-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-403"><a href="#cb130-403" aria-hidden="true" tabindex="-1"></a>$$\sigma_X^2 = Variance\ of\ X = \sum (x_i - \mu_X)^2 \times Pr (X=x_i)\ for\ all\ x\ from\ x_i\ to\ x_k$$</span>
<span id="cb130-404"><a href="#cb130-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-405"><a href="#cb130-405" aria-hidden="true" tabindex="-1"></a>Applying these formulae to die rolls, we could calculate the *expectation* for $X$ for a large set of die rolls as follows...</span>
<span id="cb130-406"><a href="#cb130-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-407"><a href="#cb130-407" aria-hidden="true" tabindex="-1"></a>$$(1 \times 1/6) + (2 \times 1/6)\  +\ ...\ +\ (6 \times 1/6) = 3.5$$</span>
<span id="cb130-408"><a href="#cb130-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-411"><a href="#cb130-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-412"><a href="#cb130-412" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb130-413"><a href="#cb130-413" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb130-414"><a href="#cb130-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-415"><a href="#cb130-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-416"><a href="#cb130-416" aria-hidden="true" tabindex="-1"></a>And the expected variance would be...</span>
<span id="cb130-417"><a href="#cb130-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-418"><a href="#cb130-418" aria-hidden="true" tabindex="-1"></a>$$<span class="co">[</span><span class="ot">(1 - 3.5)^2 \times (1/6)</span><span class="co">]</span>\ +\  <span class="co">[</span><span class="ot">(2 - 3.5)^2 \times (1/6)</span><span class="co">]</span>\ +\ ...\ +\ <span class="co">[</span><span class="ot">(6 - 3.5)^2 \times (1/6)</span><span class="co">]</span> = 2.916667$$</span>
<span id="cb130-419"><a href="#cb130-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-422"><a href="#cb130-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-423"><a href="#cb130-423" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)<span class="sc">-</span><span class="fu">mean</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)))<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>))</span>
<span id="cb130-424"><a href="#cb130-424" aria-hidden="true" tabindex="-1"></a>var</span>
<span id="cb130-425"><a href="#cb130-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-426"><a href="#cb130-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-427"><a href="#cb130-427" aria-hidden="true" tabindex="-1"></a>Likewise, we can calculate the expectation and variance for a continuous random variable, $X$, with a given *probability density function* generally as follows:</span>
<span id="cb130-428"><a href="#cb130-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-429"><a href="#cb130-429" aria-hidden="true" tabindex="-1"></a>$$\mu_X = Expectation\ for\ X = \int\limits_{-\infty}^{+\infty} x f(x) dx$$</span>
<span id="cb130-430"><a href="#cb130-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-431"><a href="#cb130-431" aria-hidden="true" tabindex="-1"></a>$$\sigma_X^2 = Variance\ of\ X = \int\limits_{-\infty}^{+\infty} (x - \mu_X)^2 f(x) dx$$</span>
<span id="cb130-432"><a href="#cb130-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-433"><a href="#cb130-433" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** To demonstrate these numerically would require a bit of calculus, i.e., *integration*, which we will not go through here.</span></span>
<span id="cb130-434"><a href="#cb130-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-435"><a href="#cb130-435" aria-hidden="true" tabindex="-1"></a><span class="fu">## Useful Probability Distributions</span></span>
<span id="cb130-436"><a href="#cb130-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-437"><a href="#cb130-437" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probability Mass Functions {.unnumbered}</span></span>
<span id="cb130-438"><a href="#cb130-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-439"><a href="#cb130-439" aria-hidden="true" tabindex="-1"></a><span class="fu">#### The Bernoulli Distribution {.unnumbered}</span></span>
<span id="cb130-440"><a href="#cb130-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-441"><a href="#cb130-441" aria-hidden="true" tabindex="-1"></a>The **Bernoulli Distribution** is the probability distribution of a *binary* random variable, i.e., a variable that has only two possible outcomes, such as success or failure, heads or tails, true or false. If $p$ is the probability of one outcome, then $1-p$ has to be the probabilty of the alternative. For flipping a fair coin, for example, $p$ = 0.5 and $1-p$ also = 0.5.</span>
<span id="cb130-442"><a href="#cb130-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-443"><a href="#cb130-443" aria-hidden="true" tabindex="-1"></a>For the **Bernoulli Distribution**, the probability mass function is:</span>
<span id="cb130-444"><a href="#cb130-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-445"><a href="#cb130-445" aria-hidden="true" tabindex="-1"></a>$$f(x) = p^x(1-p)^{1-x}$$</span>
<span id="cb130-446"><a href="#cb130-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-447"><a href="#cb130-447" aria-hidden="true" tabindex="-1"></a>where x = {0 or 1}</span>
<span id="cb130-448"><a href="#cb130-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-449"><a href="#cb130-449" aria-hidden="true" tabindex="-1"></a>For this distribution, the expectation and variance across a large set of trials would be: $\mu_X = p$ and $\sigma_X^2 = p(1-p)$</span>
<span id="cb130-450"><a href="#cb130-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-451"><a href="#cb130-451" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb130-452"><a href="#cb130-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-453"><a href="#cb130-453" aria-hidden="true" tabindex="-1"></a>Using the Bernoulli distribution, calculate the expectation for drawing a *spade* from a deck of cards? What is the variance in this expectation across a large number of draws?</span>
<span id="cb130-454"><a href="#cb130-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-455"><a href="#cb130-455" aria-hidden="true" tabindex="-1"></a>$$Pr (spade) = (13/52)^1 \times (39/52)^0 = 0.25$$</span>
<span id="cb130-456"><a href="#cb130-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-457"><a href="#cb130-457" aria-hidden="true" tabindex="-1"></a>$$Var (spade) = (13/52) \times (1-13/52) = (0.25) \times (0.75) = 0.1875$$</span>
<span id="cb130-458"><a href="#cb130-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-459"><a href="#cb130-459" aria-hidden="true" tabindex="-1"></a>In code, we can simulate this...</span>
<span id="cb130-460"><a href="#cb130-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-463"><a href="#cb130-463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-464"><a href="#cb130-464" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb130-465"><a href="#cb130-465" aria-hidden="true" tabindex="-1"></a>card <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>, reps, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb130-466"><a href="#cb130-466" aria-hidden="true" tabindex="-1"></a>spade <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(card <span class="sc">&lt;=</span> <span class="dv">13</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb130-467"><a href="#cb130-467" aria-hidden="true" tabindex="-1"></a>(exp_spade <span class="ot">&lt;-</span> <span class="fu">sum</span>(spade)<span class="sc">/</span>reps)</span>
<span id="cb130-468"><a href="#cb130-468" aria-hidden="true" tabindex="-1"></a>(exp_var_spade <span class="ot">&lt;-</span> <span class="fu">var</span>(spade))</span>
<span id="cb130-469"><a href="#cb130-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-470"><a href="#cb130-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-471"><a href="#cb130-471" aria-hidden="true" tabindex="-1"></a><span class="fu">#### The Binomial Distribution {.unnumbered}</span></span>
<span id="cb130-472"><a href="#cb130-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-473"><a href="#cb130-473" aria-hidden="true" tabindex="-1"></a>The Bernoulli distribution is a special case of the **Binomial Distribution**. The binomial distribution is typically used to model the probability of a number of "successes", *k*, out of a set of "trials", *n*, i.e., for *counts* of a particular outcome.</span>
<span id="cb130-474"><a href="#cb130-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-475"><a href="#cb130-475" aria-hidden="true" tabindex="-1"></a>Again, the probability of *success* on each trial = $p$ and the probability of *not success* = $1-p$.</span>
<span id="cb130-476"><a href="#cb130-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-477"><a href="#cb130-477" aria-hidden="true" tabindex="-1"></a>For the **Binomial Distribution**, the probability mass function is:</span>
<span id="cb130-478"><a href="#cb130-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-479"><a href="#cb130-479" aria-hidden="true" tabindex="-1"></a>$$f(x)=\binom{n}{k} p^k (1-p)^{n-k}$$</span>
<span id="cb130-480"><a href="#cb130-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-481"><a href="#cb130-481" aria-hidden="true" tabindex="-1"></a>where $x$ = {0, 1, 2, ... , n} and where</span>
<span id="cb130-482"><a href="#cb130-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-483"><a href="#cb130-483" aria-hidden="true" tabindex="-1"></a>$$\binom{n}{k}=\frac{n!}{k!(n-k)!}$$</span>
<span id="cb130-484"><a href="#cb130-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-485"><a href="#cb130-485" aria-hidden="true" tabindex="-1"></a>This is read as "$n$ choose $k$", i.e., the probability of $k$ successes out of $n$ trials. This is also called the "binomial coefficient".</span>
<span id="cb130-486"><a href="#cb130-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-487"><a href="#cb130-487" aria-hidden="true" tabindex="-1"></a>For this distribution, the expectation (i.e., expected number of successes out of $k$ trials) and the expected variance are as follows:</span>
<span id="cb130-488"><a href="#cb130-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-489"><a href="#cb130-489" aria-hidden="true" tabindex="-1"></a>$$\mu_X = np$$ and</span>
<span id="cb130-490"><a href="#cb130-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-491"><a href="#cb130-491" aria-hidden="true" tabindex="-1"></a>$$\sigma_X^2 = np(1-p)$$</span>
<span id="cb130-492"><a href="#cb130-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-493"><a href="#cb130-493" aria-hidden="true" tabindex="-1"></a>Recall, $\mu_X$ = expected *number of successes* in $n$ trials. Where $n$ = 1, the binomial distribution simplifies to the Bernoulli distribution.</span>
<span id="cb130-494"><a href="#cb130-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-495"><a href="#cb130-495" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb130-496"><a href="#cb130-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-497"><a href="#cb130-497" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the chance of getting a "1" on each of six consecutive rolls of a die? Recall that rolling a "1" = a success, while rolling something other than a "1" is not a success.</span>
<span id="cb130-498"><a href="#cb130-498" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What about of getting exactly three "1"s (i.e., 3 successes).</span>
<span id="cb130-499"><a href="#cb130-499" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the expected number of "1"s to occur in six consecutive rolls (i.e., what is the expected number of successes) and the variance around that expectation?</span>
<span id="cb130-500"><a href="#cb130-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-503"><a href="#cb130-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-504"><a href="#cb130-504" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="co"># number of trials</span></span>
<span id="cb130-505"><a href="#cb130-505" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="co"># exact number of successes</span></span>
<span id="cb130-506"><a href="#cb130-506" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span></span>
<span id="cb130-507"><a href="#cb130-507" aria-hidden="true" tabindex="-1"></a>(all_ones <span class="ot">&lt;-</span> (<span class="fu">factorial</span>(n)<span class="sc">/</span>(<span class="fu">factorial</span>(k)<span class="sc">*</span><span class="fu">factorial</span>(n<span class="sc">-</span>k)))<span class="sc">*</span></span>
<span id="cb130-508"><a href="#cb130-508" aria-hidden="true" tabindex="-1"></a>    (p<span class="sc">^</span>k)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">^</span>(n<span class="sc">-</span>k))</span>
<span id="cb130-509"><a href="#cb130-509" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># exact number of successes</span></span>
<span id="cb130-510"><a href="#cb130-510" aria-hidden="true" tabindex="-1"></a>(three_ones <span class="ot">&lt;-</span> (<span class="fu">factorial</span>(n)<span class="sc">/</span>(<span class="fu">factorial</span>(k)<span class="sc">*</span><span class="fu">factorial</span>(n<span class="sc">-</span>k)))<span class="sc">*</span></span>
<span id="cb130-511"><a href="#cb130-511" aria-hidden="true" tabindex="-1"></a>    (p<span class="sc">^</span>k)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">^</span>(n<span class="sc">-</span>k))</span>
<span id="cb130-512"><a href="#cb130-512" aria-hidden="true" tabindex="-1"></a><span class="co"># expected number of successes</span></span>
<span id="cb130-513"><a href="#cb130-513" aria-hidden="true" tabindex="-1"></a>(expected_ones <span class="ot">&lt;-</span> n <span class="sc">*</span> p)</span>
<span id="cb130-514"><a href="#cb130-514" aria-hidden="true" tabindex="-1"></a>(expected_variance <span class="ot">&lt;-</span> n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb130-515"><a href="#cb130-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-516"><a href="#cb130-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-517"><a href="#cb130-517" aria-hidden="true" tabindex="-1"></a>As for other distributions, ***R*** has a built in <span class="in">`d`</span> (density) function, the <span class="in">`dbinom()`</span> function, that you can use to solve for the probability of a given outcome directly, i.e., *Pr* $(X = x)$.</span>
<span id="cb130-518"><a href="#cb130-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-521"><a href="#cb130-521" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-522"><a href="#cb130-522" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> k, <span class="at">size =</span> n, <span class="at">prob =</span> p)</span>
<span id="cb130-523"><a href="#cb130-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-524"><a href="#cb130-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-525"><a href="#cb130-525" aria-hidden="true" tabindex="-1"></a>We can also use the built in function <span class="in">`pbinom()`</span> to return the value of the **cumulative distribution function** for the binomial distribution, i.e., the probability of observing *up to and including* a given number of successes in $n$ trials.</span>
<span id="cb130-526"><a href="#cb130-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-527"><a href="#cb130-527" aria-hidden="true" tabindex="-1"></a>So, for example, the chances of observing exactly 0, 1, 2, 3, ... 6 rolls of "1" on 6 rolls of a die are...</span>
<span id="cb130-528"><a href="#cb130-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-531"><a href="#cb130-531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-532"><a href="#cb130-532" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-533"><a href="#cb130-533" aria-hidden="true" tabindex="-1"></a>probset <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>)</span>
<span id="cb130-534"><a href="#cb130-534" aria-hidden="true" tabindex="-1"></a><span class="co"># x is number of successes, size is number of trials</span></span>
<span id="cb130-535"><a href="#cb130-535" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb130-536"><a href="#cb130-536" aria-hidden="true" tabindex="-1"></a>  probset,</span>
<span id="cb130-537"><a href="#cb130-537" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.arg =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb130-538"><a href="#cb130-538" aria-hidden="true" tabindex="-1"></a>  <span class="at">space =</span> <span class="dv">0</span>,</span>
<span id="cb130-539"><a href="#cb130-539" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"outcome = # of 'ones' seen in 6 rolls"</span>,</span>
<span id="cb130-540"><a href="#cb130-540" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Pr(X = outcome)"</span>,</span>
<span id="cb130-541"><a href="#cb130-541" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Probability Mass Function"</span></span>
<span id="cb130-542"><a href="#cb130-542" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-543"><a href="#cb130-543" aria-hidden="true" tabindex="-1"></a>cumprob <span class="ot">=</span> <span class="fu">cumsum</span>(probset)</span>
<span id="cb130-544"><a href="#cb130-544" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb130-545"><a href="#cb130-545" aria-hidden="true" tabindex="-1"></a>  cumprob,</span>
<span id="cb130-546"><a href="#cb130-546" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.arg =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb130-547"><a href="#cb130-547" aria-hidden="true" tabindex="-1"></a>  <span class="at">space =</span> <span class="fl">0.1</span>,</span>
<span id="cb130-548"><a href="#cb130-548" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"outcome"</span>,</span>
<span id="cb130-549"><a href="#cb130-549" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Cumulative Pr(X)"</span>,</span>
<span id="cb130-550"><a href="#cb130-550" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb130-551"><a href="#cb130-551" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-552"><a href="#cb130-552" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(probset) <span class="co"># equals 1, as it should</span></span>
<span id="cb130-553"><a href="#cb130-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-554"><a href="#cb130-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-555"><a href="#cb130-555" aria-hidden="true" tabindex="-1"></a>The chance of observing exactly 3 rolls of "1" is...</span>
<span id="cb130-556"><a href="#cb130-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-559"><a href="#cb130-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-560"><a href="#cb130-560" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>)</span>
<span id="cb130-561"><a href="#cb130-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-562"><a href="#cb130-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-563"><a href="#cb130-563" aria-hidden="true" tabindex="-1"></a>And the chance of observing up to and including 3 rolls of "1" in 6 rolls is...</span>
<span id="cb130-564"><a href="#cb130-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-567"><a href="#cb130-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-568"><a href="#cb130-568" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>)</span>
<span id="cb130-569"><a href="#cb130-569" aria-hidden="true" tabindex="-1"></a><span class="co"># note the name of the argument is `q=` not `x=`</span></span>
<span id="cb130-570"><a href="#cb130-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-571"><a href="#cb130-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-572"><a href="#cb130-572" aria-hidden="true" tabindex="-1"></a>... which can also be calculated by summing the relevant individual outcome probabilities...</span>
<span id="cb130-573"><a href="#cb130-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-576"><a href="#cb130-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-577"><a href="#cb130-577" aria-hidden="true" tabindex="-1"></a> <span class="co"># this sums the probabilities of 0, 1, 2, and 3 successes</span></span>
<span id="cb130-578"><a href="#cb130-578" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>))</span>
<span id="cb130-579"><a href="#cb130-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-580"><a href="#cb130-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-581"><a href="#cb130-581" aria-hidden="true" tabindex="-1"></a>The probability of observing **more than** 3 rolls of "1" is given as...</span>
<span id="cb130-582"><a href="#cb130-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-585"><a href="#cb130-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-586"><a href="#cb130-586" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">prob=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb130-587"><a href="#cb130-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-588"><a href="#cb130-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-589"><a href="#cb130-589" aria-hidden="true" tabindex="-1"></a>or, alternatively...</span>
<span id="cb130-590"><a href="#cb130-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-593"><a href="#cb130-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-594"><a href="#cb130-594" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb130-595"><a href="#cb130-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-596"><a href="#cb130-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-597"><a href="#cb130-597" aria-hidden="true" tabindex="-1"></a>The probability of observing three **or more** rolls of "1" is...</span>
<span id="cb130-598"><a href="#cb130-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-601"><a href="#cb130-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-602"><a href="#cb130-602" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>)</span>
<span id="cb130-603"><a href="#cb130-603" aria-hidden="true" tabindex="-1"></a><span class="co"># note here that the `q=` argument is "2"</span></span>
<span id="cb130-604"><a href="#cb130-604" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-605"><a href="#cb130-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-606"><a href="#cb130-606" aria-hidden="true" tabindex="-1"></a>or, alternatively...</span>
<span id="cb130-607"><a href="#cb130-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-610"><a href="#cb130-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-611"><a href="#cb130-611" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">2</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">prob=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb130-612"><a href="#cb130-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-613"><a href="#cb130-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-614"><a href="#cb130-614" aria-hidden="true" tabindex="-1"></a>Above, we were using the theoretical binomial distribution to answer our questions about expectations... Let's do this same process by simulation!</span>
<span id="cb130-615"><a href="#cb130-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-618"><a href="#cb130-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-619"><a href="#cb130-619" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate num_rolls rolls reps times</span></span>
<span id="cb130-620"><a href="#cb130-620" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb130-621"><a href="#cb130-621" aria-hidden="true" tabindex="-1"></a>num_rolls <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb130-622"><a href="#cb130-622" aria-hidden="true" tabindex="-1"></a><span class="co"># set up vectors to hold simulation results</span></span>
<span id="cb130-623"><a href="#cb130-623" aria-hidden="true" tabindex="-1"></a>all_ones <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"logical"</span>, <span class="at">length =</span> reps)</span>
<span id="cb130-624"><a href="#cb130-624" aria-hidden="true" tabindex="-1"></a>three_ones <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"logical"</span>, <span class="at">length =</span> reps)</span>
<span id="cb130-625"><a href="#cb130-625" aria-hidden="true" tabindex="-1"></a>count_ones <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"logical"</span>, <span class="at">length =</span> reps)</span>
<span id="cb130-626"><a href="#cb130-626" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps){</span>
<span id="cb130-627"><a href="#cb130-627" aria-hidden="true" tabindex="-1"></a>  rolls <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="at">size =</span> num_rolls, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb130-628"><a href="#cb130-628" aria-hidden="true" tabindex="-1"></a>  all_ones[[i]] <span class="ot">&lt;-</span> <span class="fu">all</span>(rolls <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb130-629"><a href="#cb130-629" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(rolls <span class="sc">==</span> <span class="dv">1</span>)<span class="sc">==</span><span class="dv">3</span>) {</span>
<span id="cb130-630"><a href="#cb130-630" aria-hidden="true" tabindex="-1"></a>       three_ones[[i]] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb130-631"><a href="#cb130-631" aria-hidden="true" tabindex="-1"></a>     } <span class="cf">else</span> {</span>
<span id="cb130-632"><a href="#cb130-632" aria-hidden="true" tabindex="-1"></a>       three_ones[[i]] <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb130-633"><a href="#cb130-633" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb130-634"><a href="#cb130-634" aria-hidden="true" tabindex="-1"></a>  count_ones[[i]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(rolls <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb130-635"><a href="#cb130-635" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-636"><a href="#cb130-636" aria-hidden="true" tabindex="-1"></a><span class="co"># all "ones" in 6 rolls</span></span>
<span id="cb130-637"><a href="#cb130-637" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(all_ones) <span class="sc">/</span> reps</span>
<span id="cb130-638"><a href="#cb130-638" aria-hidden="true" tabindex="-1"></a><span class="co"># three "ones" in 6 rolls</span></span>
<span id="cb130-639"><a href="#cb130-639" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(three_ones) <span class="sc">/</span> reps </span>
<span id="cb130-640"><a href="#cb130-640" aria-hidden="true" tabindex="-1"></a><span class="co"># expected # "ones" in 6 rolls</span></span>
<span id="cb130-641"><a href="#cb130-641" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(count_ones)</span>
<span id="cb130-642"><a href="#cb130-642" aria-hidden="true" tabindex="-1"></a><span class="co"># variance in expected # "ones" across rolls</span></span>
<span id="cb130-643"><a href="#cb130-643" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((count_ones <span class="sc">-</span> <span class="fu">mean</span>(count_ones)) <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">length</span>(count_ones))</span>
<span id="cb130-644"><a href="#cb130-644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-645"><a href="#cb130-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-646"><a href="#cb130-646" aria-hidden="true" tabindex="-1"></a><span class="fu">#### The Poisson Distribution {.unnumbered}</span></span>
<span id="cb130-647"><a href="#cb130-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-648"><a href="#cb130-648" aria-hidden="true" tabindex="-1"></a>The **Poisson Distribution** is often used to model open ended counts of independently occuring events, for example the number of cars that pass a traffic intersection over a given interval of time or the number of times a monkey scratches itself during a given observation interval. The *probability mass function* for the Poisson distribution is described by a single parameter, $\lambda$, where $\lambda$ can be interpreted as the mean number of occurrences of the event in the given interval.</span>
<span id="cb130-649"><a href="#cb130-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-650"><a href="#cb130-650" aria-hidden="true" tabindex="-1"></a>The probability mass function for the **Poisson Distribution** is:</span>
<span id="cb130-651"><a href="#cb130-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-652"><a href="#cb130-652" aria-hidden="true" tabindex="-1"></a>$$f(x)=\frac{\lambda^x\exp(-\lambda)}{x!}$$</span>
<span id="cb130-653"><a href="#cb130-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-654"><a href="#cb130-654" aria-hidden="true" tabindex="-1"></a>where $x$ = {0, 1, 2, ...}</span>
<span id="cb130-655"><a href="#cb130-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-656"><a href="#cb130-656" aria-hidden="true" tabindex="-1"></a>For this distribution, $\mu_X = \lambda$ and $\sigma_X^2 = \lambda$</span>
<span id="cb130-657"><a href="#cb130-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-658"><a href="#cb130-658" aria-hidden="true" tabindex="-1"></a>Note that for the Poisson Distribution the mean and the variance are the same!</span>
<span id="cb130-659"><a href="#cb130-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-660"><a href="#cb130-660" aria-hidden="true" tabindex="-1"></a>Let's use ***R*** and the {moasic} package to look at the probability mass functions for different values of $\lambda$:</span>
<span id="cb130-661"><a href="#cb130-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-664"><a href="#cb130-664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-665"><a href="#cb130-665" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-666"><a href="#cb130-666" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb130-667"><a href="#cb130-667" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb130-668"><a href="#cb130-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotDist</span>(</span>
<span id="cb130-669"><a href="#cb130-669" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pois"</span>,</span>
<span id="cb130-670"><a href="#cb130-670" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda =</span> l,</span>
<span id="cb130-671"><a href="#cb130-671" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Poisson Distribution</span><span class="sc">\n</span><span class="st">with lambda="</span>, l),</span>
<span id="cb130-672"><a href="#cb130-672" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb130-673"><a href="#cb130-673" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Pr(X=x)"</span></span>
<span id="cb130-674"><a href="#cb130-674" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-675"><a href="#cb130-675" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb130-676"><a href="#cb130-676" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb130-677"><a href="#cb130-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotDist</span>(</span>
<span id="cb130-678"><a href="#cb130-678" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pois"</span>,</span>
<span id="cb130-679"><a href="#cb130-679" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda =</span> l,</span>
<span id="cb130-680"><a href="#cb130-680" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Poisson Distribution</span><span class="sc">\n</span><span class="st">with lambda="</span>, l),</span>
<span id="cb130-681"><a href="#cb130-681" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb130-682"><a href="#cb130-682" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Pr(X=x)"</span></span>
<span id="cb130-683"><a href="#cb130-683" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-684"><a href="#cb130-684" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb130-685"><a href="#cb130-685" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb130-686"><a href="#cb130-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotDist</span>(</span>
<span id="cb130-687"><a href="#cb130-687" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pois"</span>,</span>
<span id="cb130-688"><a href="#cb130-688" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda =</span> l,</span>
<span id="cb130-689"><a href="#cb130-689" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Poisson Distribution</span><span class="sc">\n</span><span class="st">with lambda="</span>, l),</span>
<span id="cb130-690"><a href="#cb130-690" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb130-691"><a href="#cb130-691" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Pr(X=x)"</span></span>
<span id="cb130-692"><a href="#cb130-692" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-693"><a href="#cb130-693" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p2, p3, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb130-694"><a href="#cb130-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-695"><a href="#cb130-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-696"><a href="#cb130-696" aria-hidden="true" tabindex="-1"></a>As we did for other distributions, we can also use the built in <span class="in">`p`</span> function for the Poisson distribution, <span class="in">`ppois()`</span>, to return the value of the **cumulative distribution function**, i.e., the probability of observing up to and including a specific number of events in the given interval.</span>
<span id="cb130-697"><a href="#cb130-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-700"><a href="#cb130-700" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-701"><a href="#cb130-701" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-702"><a href="#cb130-702" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb130-703"><a href="#cb130-703" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb130-704"><a href="#cb130-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotDist</span>(</span>
<span id="cb130-705"><a href="#cb130-705" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pois"</span>,</span>
<span id="cb130-706"><a href="#cb130-706" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda =</span> l,</span>
<span id="cb130-707"><a href="#cb130-707" aria-hidden="true" tabindex="-1"></a>    <span class="at">kind =</span> <span class="st">"cdf"</span>,</span>
<span id="cb130-708"><a href="#cb130-708" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Cumulative Probability</span><span class="sc">\n</span><span class="st">with lambda="</span>, l),</span>
<span id="cb130-709"><a href="#cb130-709" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb130-710"><a href="#cb130-710" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Pr(X≤x)"</span>,</span>
<span id="cb130-711"><a href="#cb130-711" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"l"</span></span>
<span id="cb130-712"><a href="#cb130-712" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-713"><a href="#cb130-713" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb130-714"><a href="#cb130-714" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb130-715"><a href="#cb130-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotDist</span>(</span>
<span id="cb130-716"><a href="#cb130-716" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pois"</span>,</span>
<span id="cb130-717"><a href="#cb130-717" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda =</span> l,</span>
<span id="cb130-718"><a href="#cb130-718" aria-hidden="true" tabindex="-1"></a>    <span class="at">kind =</span> <span class="st">"cdf"</span>,</span>
<span id="cb130-719"><a href="#cb130-719" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Cumulative Probability</span><span class="sc">\n</span><span class="st">with lambda="</span>, l),</span>
<span id="cb130-720"><a href="#cb130-720" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb130-721"><a href="#cb130-721" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Pr(X≤x)"</span>,</span>
<span id="cb130-722"><a href="#cb130-722" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"l"</span></span>
<span id="cb130-723"><a href="#cb130-723" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-724"><a href="#cb130-724" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb130-725"><a href="#cb130-725" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb130-726"><a href="#cb130-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotDist</span>(</span>
<span id="cb130-727"><a href="#cb130-727" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pois"</span>,</span>
<span id="cb130-728"><a href="#cb130-728" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda =</span> l,</span>
<span id="cb130-729"><a href="#cb130-729" aria-hidden="true" tabindex="-1"></a>    <span class="at">kind =</span> <span class="st">"cdf"</span>,</span>
<span id="cb130-730"><a href="#cb130-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Cumulative Probability</span><span class="sc">\n</span><span class="st">with lambda="</span>, l),</span>
<span id="cb130-731"><a href="#cb130-731" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb130-732"><a href="#cb130-732" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Pr(X≤x)"</span>,</span>
<span id="cb130-733"><a href="#cb130-733" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"l"</span></span>
<span id="cb130-734"><a href="#cb130-734" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-735"><a href="#cb130-735" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p2, p3, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb130-736"><a href="#cb130-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-737"><a href="#cb130-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-738"><a href="#cb130-738" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probability Density Functions {.unnumbered}</span></span>
<span id="cb130-739"><a href="#cb130-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-740"><a href="#cb130-740" aria-hidden="true" tabindex="-1"></a><span class="fu">#### The Uniform Distribution {.unnumbered}</span></span>
<span id="cb130-741"><a href="#cb130-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-742"><a href="#cb130-742" aria-hidden="true" tabindex="-1"></a>The **Uniform Distribution** is the simplest probability density function describing a continuous random variable. The probability is uniform and does not fluctuate across the range of $x$ values in a given interval.</span>
<span id="cb130-743"><a href="#cb130-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-744"><a href="#cb130-744" aria-hidden="true" tabindex="-1"></a>The probability density function for the **Uniform Distribution** is:</span>
<span id="cb130-745"><a href="#cb130-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-746"><a href="#cb130-746" aria-hidden="true" tabindex="-1"></a>$$f(x)=\frac{1}{b-a}$$</span>
<span id="cb130-747"><a href="#cb130-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-748"><a href="#cb130-748" aria-hidden="true" tabindex="-1"></a>where $a \leq x \leq b$ and the function is 0 for $x &lt; a$ and $x &gt; b$</span>
<span id="cb130-749"><a href="#cb130-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-750"><a href="#cb130-750" aria-hidden="true" tabindex="-1"></a>What would you predict the expectation (mean) should be for a uniform distribution? Not surprisingly, for this distribution:</span>
<span id="cb130-751"><a href="#cb130-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-752"><a href="#cb130-752" aria-hidden="true" tabindex="-1"></a>$$\mu_x = \frac{a+b}{2}$$</span>
<span id="cb130-753"><a href="#cb130-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-754"><a href="#cb130-754" aria-hidden="true" tabindex="-1"></a>and</span>
<span id="cb130-755"><a href="#cb130-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-756"><a href="#cb130-756" aria-hidden="true" tabindex="-1"></a>$$\sigma_x^2 = \frac{(b-a)^2}{12}$$</span>
<span id="cb130-757"><a href="#cb130-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-758"><a href="#cb130-758" aria-hidden="true" tabindex="-1"></a>Let's plot a uniform distribution across a given range, from $a$ = 4 to $b$ = 8...</span>
<span id="cb130-759"><a href="#cb130-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-762"><a href="#cb130-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-763"><a href="#cb130-763" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-764"><a href="#cb130-764" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb130-765"><a href="#cb130-765" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb130-766"><a href="#cb130-766" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span>a<span class="dv">-1</span>, <span class="at">to=</span>b<span class="sc">+</span><span class="dv">1</span>, <span class="at">by=</span><span class="fl">0.01</span>)   </span>
<span id="cb130-767"><a href="#cb130-767" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">dunif</span>(x,<span class="at">min=</span>a, <span class="at">max=</span>b) <span class="co"># dunif() evaluates the density at each x</span></span>
<span id="cb130-768"><a href="#cb130-768" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb130-769"><a href="#cb130-769" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb130-770"><a href="#cb130-770" aria-hidden="true" tabindex="-1"></a>  fx,</span>
<span id="cb130-771"><a href="#cb130-771" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(fx) <span class="sc">+</span> <span class="fl">0.1</span>),</span>
<span id="cb130-772"><a href="#cb130-772" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb130-773"><a href="#cb130-773" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb130-774"><a href="#cb130-774" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"f(x)"</span>,</span>
<span id="cb130-775"><a href="#cb130-775" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Probability Density Function"</span></span>
<span id="cb130-776"><a href="#cb130-776" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-777"><a href="#cb130-777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-778"><a href="#cb130-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-779"><a href="#cb130-779" aria-hidden="true" tabindex="-1"></a>Note that for the uniform distribution, the *cumulative density function* increases linearly over the given interval.</span>
<span id="cb130-780"><a href="#cb130-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-783"><a href="#cb130-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-784"><a href="#cb130-784" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-785"><a href="#cb130-785" aria-hidden="true" tabindex="-1"></a><span class="co"># punif() is the cumulative probability density up to a given x</span></span>
<span id="cb130-786"><a href="#cb130-786" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb130-787"><a href="#cb130-787" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb130-788"><a href="#cb130-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">punif</span>(<span class="at">q =</span> x, <span class="at">min =</span> a, <span class="at">max =</span> b),</span>
<span id="cb130-789"><a href="#cb130-789" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.1</span>),</span>
<span id="cb130-790"><a href="#cb130-790" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb130-791"><a href="#cb130-791" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb130-792"><a href="#cb130-792" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Pr(X ≤ x)"</span>,</span>
<span id="cb130-793"><a href="#cb130-793" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb130-794"><a href="#cb130-794" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-795"><a href="#cb130-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-796"><a href="#cb130-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-797"><a href="#cb130-797" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb130-798"><a href="#cb130-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-799"><a href="#cb130-799" aria-hidden="true" tabindex="-1"></a>Simulate a sample of 10,000 random numbers from a uniform distribution in the interval between $a$ = 6 and $b$ = 8. Calculate the mean and variance of this simulated sample and compare it to the expectation for these parameters.</span>
<span id="cb130-800"><a href="#cb130-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-803"><a href="#cb130-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-804"><a href="#cb130-804" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb130-805"><a href="#cb130-805" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb130-806"><a href="#cb130-806" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb130-807"><a href="#cb130-807" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb130-808"><a href="#cb130-808" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb130-809"><a href="#cb130-809" aria-hidden="true" tabindex="-1"></a>nums <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">min=</span>a, <span class="at">max=</span>b)</span>
<span id="cb130-810"><a href="#cb130-810" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(nums))</span>
<span id="cb130-811"><a href="#cb130-811" aria-hidden="true" tabindex="-1"></a>(v <span class="ot">&lt;-</span> <span class="fu">var</span>(nums))</span>
<span id="cb130-812"><a href="#cb130-812" aria-hidden="true" tabindex="-1"></a>(expected_mean <span class="ot">&lt;-</span> (a<span class="sc">+</span>b)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb130-813"><a href="#cb130-813" aria-hidden="true" tabindex="-1"></a>(expected_variance <span class="ot">&lt;-</span> ((b<span class="sc">-</span>a)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb130-814"><a href="#cb130-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-815"><a href="#cb130-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-816"><a href="#cb130-816" aria-hidden="true" tabindex="-1"></a><span class="fu">#### The Normal Distribution {.unnumbered}</span></span>
<span id="cb130-817"><a href="#cb130-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-818"><a href="#cb130-818" aria-hidden="true" tabindex="-1"></a>The **Normal** or **Gaussian Distribution** is perhaps the most familiar and most commonly applied probability density functions for modeling continuous random variables. Why is the normal distribution so important? Well, many traits are normally distributed, and the additive combination of many random factors is also commonly normally distributed. Even more importantly, as we will see in [**Module 14**](#module-14), the sampling distribution for many summary statistics (e.g., sample means) tends to be normally distributed when sample size is sufficiently large, and this fact is central to statistical inference.</span>
<span id="cb130-819"><a href="#cb130-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-820"><a href="#cb130-820" aria-hidden="true" tabindex="-1"></a>For the normal distribution, two parameters, $\mu$ and $\sigma$, are used to describe the shape of the distribution.</span>
<span id="cb130-821"><a href="#cb130-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-822"><a href="#cb130-822" aria-hidden="true" tabindex="-1"></a>The code below allows us to visualize and play around with a normal distribution. First, try maniupulating $\mu$ and $\sigma$.</span>
<span id="cb130-823"><a href="#cb130-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-826"><a href="#cb130-826" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-827"><a href="#cb130-827" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb130-828"><a href="#cb130-828" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(</span>
<span id="cb130-829"><a href="#cb130-829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(mu <span class="sc">-</span> <span class="dv">6</span> <span class="sc">*</span> sigma, mu <span class="sc">+</span> <span class="dv">6</span> <span class="sc">*</span> sigma)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb130-830"><a href="#cb130-830" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(</span>
<span id="cb130-831"><a href="#cb130-831" aria-hidden="true" tabindex="-1"></a>      <span class="at">fun =</span> dnorm,</span>
<span id="cb130-832"><a href="#cb130-832" aria-hidden="true" tabindex="-1"></a>      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu, <span class="at">sd =</span> sigma),</span>
<span id="cb130-833"><a href="#cb130-833" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="dv">1000</span></span>
<span id="cb130-834"><a href="#cb130-834" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb130-835"><a href="#cb130-835" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"f(x)"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb130-836"><a href="#cb130-836" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Exploring the Normal Distribution"</span>,</span>
<span id="cb130-837"><a href="#cb130-837" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb130-838"><a href="#cb130-838" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Probability ± "</span>, n_sigma, <span class="st">" SD around Mean = "</span>,</span>
<span id="cb130-839"><a href="#cb130-839" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(</span>
<span id="cb130-840"><a href="#cb130-840" aria-hidden="true" tabindex="-1"></a>          <span class="fu">pnorm</span>(mu <span class="sc">+</span> n_sigma <span class="sc">*</span> sigma, mu, sigma) <span class="sc">-</span></span>
<span id="cb130-841"><a href="#cb130-841" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pnorm</span>(mu <span class="sc">-</span> n_sigma <span class="sc">*</span> sigma, mu, sigma),</span>
<span id="cb130-842"><a href="#cb130-842" aria-hidden="true" tabindex="-1"></a>          <span class="dv">4</span></span>
<span id="cb130-843"><a href="#cb130-843" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb130-844"><a href="#cb130-844" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-845"><a href="#cb130-845" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-846"><a href="#cb130-846" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(</span>
<span id="cb130-847"><a href="#cb130-847" aria-hidden="true" tabindex="-1"></a>      <span class="at">fun =</span> dnorm,</span>
<span id="cb130-848"><a href="#cb130-848" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(mu <span class="sc">-</span> n_sigma <span class="sc">*</span> sigma, mu <span class="sc">+</span> n_sigma <span class="sc">*</span> sigma),</span>
<span id="cb130-849"><a href="#cb130-849" aria-hidden="true" tabindex="-1"></a>      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu, <span class="at">sd =</span> sigma),</span>
<span id="cb130-850"><a href="#cb130-850" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="dv">1000</span>,</span>
<span id="cb130-851"><a href="#cb130-851" aria-hidden="true" tabindex="-1"></a>      <span class="at">geom =</span> <span class="st">"area"</span>,</span>
<span id="cb130-852"><a href="#cb130-852" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"red"</span>,</span>
<span id="cb130-853"><a href="#cb130-853" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb130-854"><a href="#cb130-854" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb130-855"><a href="#cb130-855" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb130-856"><a href="#cb130-856" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fu">slider</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>, <span class="at">initial =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="dv">10</span>),</span>
<span id="cb130-857"><a href="#cb130-857" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">initial =</span> <span class="dv">5</span>, <span class="at">step =</span> <span class="dv">1</span>),</span>
<span id="cb130-858"><a href="#cb130-858" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_sigma =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="at">initial =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="fl">0.25</span>)</span>
<span id="cb130-859"><a href="#cb130-859" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-860"><a href="#cb130-860" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-861"><a href="#cb130-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-862"><a href="#cb130-862" aria-hidden="true" tabindex="-1"></a>The function, <span class="in">`dnorm()`</span> gives the value of the normal probabilty density function at a given value of $x$. $x$ can range from -$\infty$ to +$\infty$. <span class="co">[</span><span class="ot">Recall, it does not really make sense to talk about the "probability" associated with a given specific value of a continuous variable as this is a density not a mass function... but we can talk about the probability of $x$ falling within a given interval.</span><span class="co">]</span></span>
<span id="cb130-863"><a href="#cb130-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-864"><a href="#cb130-864" aria-hidden="true" tabindex="-1"></a>The <span class="in">`pnorm()`</span> function, as with the <span class="in">`p`</span> function for other distributions, returns the cumulative probability of observing a value less than or equal to a given value of $x$, i.e., *Pr* $(X$ $\leq$ $x)$. We can use the <span class="in">`pnorm()`</span> function to calculate the probability of an observation drawn from the population falling within a particular, arbitrary interval.</span>
<span id="cb130-865"><a href="#cb130-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-866"><a href="#cb130-866" aria-hidden="true" tabindex="-1"></a>For example, for a normally distributed population variable with $\mu$ = 6 and $\sigma$ = 2, the probability of a random observation falling between 7 and 8 is...</span>
<span id="cb130-867"><a href="#cb130-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-870"><a href="#cb130-870" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-871"><a href="#cb130-871" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="dv">8</span>,<span class="at">mean=</span><span class="dv">6</span>,<span class="at">sd=</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">7</span>,<span class="at">mean=</span><span class="dv">6</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb130-872"><a href="#cb130-872" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb130-873"><a href="#cb130-873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-874"><a href="#cb130-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-875"><a href="#cb130-875" aria-hidden="true" tabindex="-1"></a>In the code above, this is what we are doing when we play interactively with $n<span class="sc">\_</span>sigma$... we are using the difference between two <span class="in">`pnorm()`</span> calculations to determine the probability of an observation falling within $n<span class="sc">\_</span>sigma$ standard deviations of the mean of a particular normal distribution.</span>
<span id="cb130-876"><a href="#cb130-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-877"><a href="#cb130-877" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Regardless of the specific values of $\mu$ and $\sigma$, about 95% of the normal distribution falls within 2 standard deviations of the mean, and about 68% of the distribution falls within 1 standard deviation. Check this out by playing with the $n</span><span class="sc">\_</span><span class="at">sigma$ slider.</span></span>
<span id="cb130-878"><a href="#cb130-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-881"><a href="#cb130-881" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-882"><a href="#cb130-882" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb130-883"><a href="#cb130-883" aria-hidden="true" tabindex="-1"></a><span class="co">#| out_width: "80%"</span></span>
<span id="cb130-884"><a href="#cb130-884" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/normal_distribution.png"</span>)</span>
<span id="cb130-885"><a href="#cb130-885" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-886"><a href="#cb130-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-887"><a href="#cb130-887" aria-hidden="true" tabindex="-1"></a>Another one of the family of normal distribution functions in ***R*** - the <span class="in">`qnorm()`</span> or quantile function - will tell us the value of $x$ below which a given proportion of the cumulative probability function falls. For example, if we wanted to see the value of $x$ below which 2.5% of a normal distribution with mean of 5 and standard deviation of 6 falls, we could run the following:</span>
<span id="cb130-888"><a href="#cb130-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-891"><a href="#cb130-891" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-892"><a href="#cb130-892" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.025</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">3</span>, <span class="at">lower.tail=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-893"><a href="#cb130-893" aria-hidden="true" tabindex="-1"></a><span class="co"># lower.tail = TRUE by default...if we used lower.tail = FALSE</span></span>
<span id="cb130-894"><a href="#cb130-894" aria-hidden="true" tabindex="-1"></a><span class="co"># this would give us the value of x for the upper.tail of the distribution</span></span>
<span id="cb130-895"><a href="#cb130-895" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-896"><a href="#cb130-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-897"><a href="#cb130-897" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb130-898"><a href="#cb130-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-899"><a href="#cb130-899" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Create a vector, **v**, containing **n** random numbers selected from a normal distribution with mean $\mu$ and standard deviation $\sigma$. Use 1000 for **n**, 3.5 for $\mu$, and 4 for $\sigma$.</span>
<span id="cb130-900"><a href="#cb130-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-901"><a href="#cb130-901" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **HINT:** Such a function exists! </span><span class="in">`rnorm()`</span><span class="at">. We also call </span><span class="in">`set.seed()`</span><span class="at"> before </span><span class="in">`rnorm()`</span><span class="at"> so that each time this function is run, it returns the same sequence of random numbers until the seed is reset.</span></span>
<span id="cb130-902"><a href="#cb130-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-903"><a href="#cb130-903" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate the mean, variance, and standard deviation for your sample of random numbers.</span>
<span id="cb130-904"><a href="#cb130-904" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plot a histogram of your random numbers.</span>
<span id="cb130-905"><a href="#cb130-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-908"><a href="#cb130-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-909"><a href="#cb130-909" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-910"><a href="#cb130-910" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb130-911"><a href="#cb130-911" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb130-912"><a href="#cb130-912" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb130-913"><a href="#cb130-913" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb130-914"><a href="#cb130-914" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb130-915"><a href="#cb130-915" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb130-916"><a href="#cb130-916" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb130-917"><a href="#cb130-917" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb130-918"><a href="#cb130-918" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(v)</span>
<span id="cb130-919"><a href="#cb130-919" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(v)</span>
<span id="cb130-920"><a href="#cb130-920" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(v)</span>
<span id="cb130-921"><a href="#cb130-921" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(v,</span>
<span id="cb130-922"><a href="#cb130-922" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste0</span>(</span>
<span id="cb130-923"><a href="#cb130-923" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Random Draws from a Normal Distribution</span><span class="sc">\n</span><span class="st">with Mean = "</span>,</span>
<span id="cb130-924"><a href="#cb130-924" aria-hidden="true" tabindex="-1"></a>    mu,</span>
<span id="cb130-925"><a href="#cb130-925" aria-hidden="true" tabindex="-1"></a>    <span class="st">" and SD = "</span>,</span>
<span id="cb130-926"><a href="#cb130-926" aria-hidden="true" tabindex="-1"></a>    sigma</span>
<span id="cb130-927"><a href="#cb130-927" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb130-928"><a href="#cb130-928" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"density"</span>,</span>
<span id="cb130-929"><a href="#cb130-929" aria-hidden="true" tabindex="-1"></a>  <span class="at">center =</span> mu</span>
<span id="cb130-930"><a href="#cb130-930" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-931"><a href="#cb130-931" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-932"><a href="#cb130-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-933"><a href="#cb130-933" aria-hidden="true" tabindex="-1"></a>We can easily plot the density and cumulative probability functions for this normal distribution using the <span class="in">`plotDist()`</span> function from the {mosaic} package:</span>
<span id="cb130-934"><a href="#cb130-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-937"><a href="#cb130-937" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-938"><a href="#cb130-938" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-939"><a href="#cb130-939" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="fu">plotDist</span>(<span class="st">"norm"</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">xlab=</span><span class="st">"X"</span>, <span class="at">ylab=</span><span class="st">"Density"</span>)</span>
<span id="cb130-940"><a href="#cb130-940" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="fu">plotDist</span>(<span class="st">"norm"</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">kind=</span><span class="st">"cdf"</span>,</span>
<span id="cb130-941"><a href="#cb130-941" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">"X"</span>, <span class="at">ylab=</span> <span class="st">"Cumulative Probability"</span>)</span>
<span id="cb130-942"><a href="#cb130-942" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(pdf,cdf)</span>
<span id="cb130-943"><a href="#cb130-943" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-944"><a href="#cb130-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-945"><a href="#cb130-945" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Q-Q Plots {.unnumbered}</span></span>
<span id="cb130-946"><a href="#cb130-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-947"><a href="#cb130-947" aria-hidden="true" tabindex="-1"></a>A quantile-quantile or **Q-Q** plot can be used to look at whether a set of data seem to follow a normal distribution. A Q--Q plot is a general graphical method for comparing two probability distributions. To examine a set of data for normality graphically, you plot the **quantiles for your actual data** (as the y values) versus **theoretical quantiles** (as the x values) pulled from a normal distribution. If the two distributions being compared are similar, the points in the plot should lie approximately on the line y = x.</span>
<span id="cb130-948"><a href="#cb130-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-949"><a href="#cb130-949" aria-hidden="true" tabindex="-1"></a>If we do this for the random variables we just generated, this **should** be apparent since we have simulated our initial vector of data from a normal distribution.</span>
<span id="cb130-950"><a href="#cb130-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-951"><a href="#cb130-951" aria-hidden="true" tabindex="-1"></a>To quickly do a Q-Q plot, call the two ***R*** functions <span class="in">`qqnorm()`</span> and <span class="in">`qqline()`</span> using the vector of data you want to examine as an argument.</span>
<span id="cb130-952"><a href="#cb130-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-955"><a href="#cb130-955" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-956"><a href="#cb130-956" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-957"><a href="#cb130-957" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(v, <span class="at">main =</span> <span class="st">"QQ Plot - Random Normal Variable"</span>)</span>
<span id="cb130-958"><a href="#cb130-958" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(v, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb130-959"><a href="#cb130-959" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-960"><a href="#cb130-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-961"><a href="#cb130-961" aria-hidden="true" tabindex="-1"></a>This is the same as doing the following:</span>
<span id="cb130-962"><a href="#cb130-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-963"><a href="#cb130-963" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Step 1: Generate a sequence of probability points in the interval from 0 to 1 equivalent in length to vector **v**:</span>
<span id="cb130-964"><a href="#cb130-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-967"><a href="#cb130-967" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-968"><a href="#cb130-968" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="fu">length</span>(v))</span>
<span id="cb130-969"><a href="#cb130-969" aria-hidden="true" tabindex="-1"></a><span class="co"># the `ppoints()` function generates evenly distributed points</span></span>
<span id="cb130-970"><a href="#cb130-970" aria-hidden="true" tabindex="-1"></a><span class="co"># between 0 and 1</span></span>
<span id="cb130-971"><a href="#cb130-971" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(p)</span>
<span id="cb130-972"><a href="#cb130-972" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(p)</span>
<span id="cb130-973"><a href="#cb130-973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-974"><a href="#cb130-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-975"><a href="#cb130-975" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Step 2: Calculate the theoretical quantiles for this set of probabilities based on the distribution you want to compare to (in this case, the normal distribution):</span>
<span id="cb130-976"><a href="#cb130-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-979"><a href="#cb130-979" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-980"><a href="#cb130-980" aria-hidden="true" tabindex="-1"></a>theoretical_q <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(p)</span>
<span id="cb130-981"><a href="#cb130-981" aria-hidden="true" tabindex="-1"></a><span class="co"># generates quantiles for each p based on a normal distribution</span></span>
<span id="cb130-982"><a href="#cb130-982" aria-hidden="true" tabindex="-1"></a><span class="co"># (in this case, the standard normal)</span></span>
<span id="cb130-983"><a href="#cb130-983" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-984"><a href="#cb130-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-985"><a href="#cb130-985" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Step 3: Calculate the quantiles for your set of observed data for the same number of points:</span>
<span id="cb130-986"><a href="#cb130-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-989"><a href="#cb130-989" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-990"><a href="#cb130-990" aria-hidden="true" tabindex="-1"></a>observed_q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(v, <span class="fu">ppoints</span>(v)) <span class="co"># finds quantiles in our actual data</span></span>
<span id="cb130-991"><a href="#cb130-991" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-992"><a href="#cb130-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-993"><a href="#cb130-993" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Step 4: Plot these quantiles against one another:</span>
<span id="cb130-994"><a href="#cb130-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-997"><a href="#cb130-997" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-998"><a href="#cb130-998" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-999"><a href="#cb130-999" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb130-1000"><a href="#cb130-1000" aria-hidden="true" tabindex="-1"></a>  theoretical_q,</span>
<span id="cb130-1001"><a href="#cb130-1001" aria-hidden="true" tabindex="-1"></a>  observed_q,</span>
<span id="cb130-1002"><a href="#cb130-1002" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"QQ Plot - Random Normal Variable"</span>,</span>
<span id="cb130-1003"><a href="#cb130-1003" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Theoretical Quantiles"</span>,</span>
<span id="cb130-1004"><a href="#cb130-1004" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Sample Quantiles"</span></span>
<span id="cb130-1005"><a href="#cb130-1005" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-1006"><a href="#cb130-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1007"><a href="#cb130-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1008"><a href="#cb130-1008" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb130-1009"><a href="#cb130-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1010"><a href="#cb130-1010" aria-hidden="true" tabindex="-1"></a>What happens if you simulate fewer observations in your vectors? Try with **n = 100**.</span>
<span id="cb130-1011"><a href="#cb130-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1014"><a href="#cb130-1014" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1015"><a href="#cb130-1015" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-1016"><a href="#cb130-1016" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb130-1017"><a href="#cb130-1017" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb130-1018"><a href="#cb130-1018" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb130-1019"><a href="#cb130-1019" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb130-1020"><a href="#cb130-1020" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb130-1021"><a href="#cb130-1021" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb130-1022"><a href="#cb130-1022" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb130-1023"><a href="#cb130-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(v,<span class="at">main=</span><span class="st">"QQ Plot - Random Normal Variable"</span>)</span>
<span id="cb130-1024"><a href="#cb130-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(v,<span class="at">col=</span><span class="st">"gray"</span>)</span>
<span id="cb130-1025"><a href="#cb130-1025" aria-hidden="true" tabindex="-1"></a><span class="co"># with fewer simulated points, line isn't quite as good a fit</span></span>
<span id="cb130-1026"><a href="#cb130-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1027"><a href="#cb130-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1028"><a href="#cb130-1028" aria-hidden="true" tabindex="-1"></a>What happens if you simulate observations from a *different* distribution?</span>
<span id="cb130-1029"><a href="#cb130-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1032"><a href="#cb130-1032" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1033"><a href="#cb130-1033" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-1034"><a href="#cb130-1034" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb130-1035"><a href="#cb130-1035" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb130-1036"><a href="#cb130-1036" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb130-1037"><a href="#cb130-1037" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb130-1038"><a href="#cb130-1038" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, <span class="at">shape1 =</span> <span class="fl">1.3</span>, <span class="at">shape2 =</span> <span class="dv">2</span>)</span>
<span id="cb130-1039"><a href="#cb130-1039" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(v,<span class="at">main=</span><span class="st">"QQ Plot - Random Beta Variable"</span>)</span>
<span id="cb130-1040"><a href="#cb130-1040" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(v,<span class="at">col=</span><span class="st">"gray"</span>)</span>
<span id="cb130-1041"><a href="#cb130-1041" aria-hidden="true" tabindex="-1"></a><span class="co"># with a different distribution, Q-Q plot isn't linear!</span></span>
<span id="cb130-1042"><a href="#cb130-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1043"><a href="#cb130-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1044"><a href="#cb130-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">#### The "Standard Normal" Distribution {.unnumbered}</span></span>
<span id="cb130-1045"><a href="#cb130-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1046"><a href="#cb130-1046" aria-hidden="true" tabindex="-1"></a>Any normal distribution with mean $\mu$ and standard deviation $\sigma$ can be converted into what is called the **standard normal** distribution, where the mean is 0 and the standard deviation is 1. This is done by subtracting the mean from all observations and dividing these differences by the standard deviation. The resultant values are referred to a *Z* scores, and they reflect the number of standard deviations an observation is from the mean.</span>
<span id="cb130-1047"><a href="#cb130-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1050"><a href="#cb130-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1051"><a href="#cb130-1051" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-1052"><a href="#cb130-1052" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb130-1053"><a href="#cb130-1053" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb130-1054"><a href="#cb130-1054" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate from a normal distribution with mean 5 and SD 8</span></span>
<span id="cb130-1055"><a href="#cb130-1055" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb130-1056"><a href="#cb130-1056" aria-hidden="true" tabindex="-1"></a>x_plot <span class="ot">&lt;-</span> <span class="fu">histogram</span>(x,</span>
<span id="cb130-1057"><a href="#cb130-1057" aria-hidden="true" tabindex="-1"></a>  <span class="at">center =</span> mu,</span>
<span id="cb130-1058"><a href="#cb130-1058" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Mean = "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(x), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">SD = "</span>, <span class="fu">round</span>(<span class="fu">sd</span>(x), <span class="dv">3</span>)))</span>
<span id="cb130-1059"><a href="#cb130-1059" aria-hidden="true" tabindex="-1"></a><span class="co"># standardize the scores</span></span>
<span id="cb130-1060"><a href="#cb130-1060" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb130-1061"><a href="#cb130-1061" aria-hidden="true" tabindex="-1"></a>z_plot <span class="ot">&lt;-</span> <span class="fu">histogram</span>(z,</span>
<span id="cb130-1062"><a href="#cb130-1062" aria-hidden="true" tabindex="-1"></a>  <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb130-1063"><a href="#cb130-1063" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Mean = "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(z), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">SD = "</span>, <span class="fu">round</span>(<span class="fu">sd</span>(z), <span class="dv">3</span>)))</span>
<span id="cb130-1064"><a href="#cb130-1064" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(x_plot,z_plot)</span>
<span id="cb130-1065"><a href="#cb130-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1066"><a href="#cb130-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1067"><a href="#cb130-1067" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sampling Distributions Redux</span></span>
<span id="cb130-1068"><a href="#cb130-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1069"><a href="#cb130-1069" aria-hidden="true" tabindex="-1"></a>It is important to recognize that, above, we were dealing with probability distributions of discrete and continuous random variables as they relate to *populations*. But, as we have talked about before, we almost never measure entire populations... instead, we measure *samples* from populations and we characterize our samples using various *statistics*. The theoretical probability distributions described above (and others) are *models* for how we connect observed sample data to populations, taking into account various assumptions, and this is what allows us to do many types of inferential statistics. The most fundamental assumption is that the observations we make are *independent* from one another and are *identically distributed*, an assumption often abbreviated as **iid**. Obvious cases of violation of this assumption are rife in the scientific literature, and we should always be cautious about making this assumption!</span>
<span id="cb130-1070"><a href="#cb130-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1071"><a href="#cb130-1071" aria-hidden="true" tabindex="-1"></a>However, the important thing for us to know is that we can get *unbiased estimates* of population level parameters based on sample statistics.</span>
<span id="cb130-1072"><a href="#cb130-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1073"><a href="#cb130-1073" aria-hidden="true" tabindex="-1"></a>&lt;img src="img/pvz-zombie1.png" align="right" width="100px"/&gt;</span>
<span id="cb130-1074"><a href="#cb130-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1075"><a href="#cb130-1075" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb130-1076"><a href="#cb130-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1077"><a href="#cb130-1077" aria-hidden="true" tabindex="-1"></a>Let's imagine a population of 1 million zombies whose age at zombification is characterized by a normal distribution with a mean of 25 years and a standard deviation of 5 years.</span>
<span id="cb130-1078"><a href="#cb130-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1079"><a href="#cb130-1079" aria-hidden="true" tabindex="-1"></a>Create a variable **x** that describes this population and calculate the mean and standard deviation of the age at zombification.</span>
<span id="cb130-1080"><a href="#cb130-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1083"><a href="#cb130-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1084"><a href="#cb130-1084" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb130-1085"><a href="#cb130-1085" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb130-1086"><a href="#cb130-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb130-1087"><a href="#cb130-1087" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb130-1088"><a href="#cb130-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb130-1089"><a href="#cb130-1089" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000000</span>, <span class="dv">25</span>, <span class="dv">5</span>)</span>
<span id="cb130-1090"><a href="#cb130-1090" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(x, <span class="at">type=</span><span class="st">"density"</span>)</span>
<span id="cb130-1091"><a href="#cb130-1091" aria-hidden="true" tabindex="-1"></a>(mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)) <span class="co"># population mean</span></span>
<span id="cb130-1092"><a href="#cb130-1092" aria-hidden="true" tabindex="-1"></a>(sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">length</span>(x))) <span class="co"># population SD</span></span>
<span id="cb130-1093"><a href="#cb130-1093" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1094"><a href="#cb130-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1095"><a href="#cb130-1095" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** We **do not** use the </span><span class="in">`sd()`</span><span class="at"> function as this would divide by </span><span class="in">`length(x)-1`</span><span class="at">. Check that out using </span><span class="in">`sd(x)`</span></span>
<span id="cb130-1096"><a href="#cb130-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1099"><a href="#cb130-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1100"><a href="#cb130-1100" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span>
<span id="cb130-1101"><a href="#cb130-1101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1102"><a href="#cb130-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1103"><a href="#cb130-1103" aria-hidden="true" tabindex="-1"></a>Now, suppose we now **sample** from the zombie population by trapping sets of zombies and determining the mean age at zombification in each set. We sample *without replacement* from the original population for each set...</span>
<span id="cb130-1104"><a href="#cb130-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1105"><a href="#cb130-1105" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb130-1106"><a href="#cb130-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1107"><a href="#cb130-1107" aria-hidden="true" tabindex="-1"></a>Create a loop to sample the zombie population 5000 times with samples of size 10 and store these results in a list, **s**.</span>
<span id="cb130-1108"><a href="#cb130-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1111"><a href="#cb130-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1112"><a href="#cb130-1112" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb130-1113"><a href="#cb130-1113" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb130-1114"><a href="#cb130-1114" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb130-1115"><a href="#cb130-1115" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co"># number of samples</span></span>
<span id="cb130-1116"><a href="#cb130-1116" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># size of each sample</span></span>
<span id="cb130-1117"><a href="#cb130-1117" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="co"># create a dummy variable to hold each sample</span></span>
<span id="cb130-1118"><a href="#cb130-1118" aria-hidden="true" tabindex="-1"></a><span class="co"># dummy variable needs to be a list, not a vector, since each element</span></span>
<span id="cb130-1119"><a href="#cb130-1119" aria-hidden="true" tabindex="-1"></a><span class="co"># will hold a vector of numbers</span></span>
<span id="cb130-1120"><a href="#cb130-1120" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb130-1121"><a href="#cb130-1121" aria-hidden="true" tabindex="-1"></a>    s[[i]] <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,<span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb130-1122"><a href="#cb130-1122" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-1123"><a href="#cb130-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(s, <span class="dv">1</span>) <span class="co"># an example of one sample of 10 ages</span></span>
<span id="cb130-1124"><a href="#cb130-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1125"><a href="#cb130-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1126"><a href="#cb130-1126" aria-hidden="true" tabindex="-1"></a>For each of these samples, we can then calculate a mean age, which is a statistic describing each sample. **That statistic itself is a random variable with a mean and distribution!** As we saw in [**Module 12**](#module-12), this is known as a *sampling distribution*.</span>
<span id="cb130-1127"><a href="#cb130-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1128"><a href="#cb130-1128" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb130-1129"><a href="#cb130-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1130"><a href="#cb130-1130" aria-hidden="true" tabindex="-1"></a>Create a loop to calculate the mean of each of your 5000 samples and store the result in a vector, **m**.</span>
<span id="cb130-1131"><a href="#cb130-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1134"><a href="#cb130-1134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1135"><a href="#cb130-1135" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb130-1136"><a href="#cb130-1136" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb130-1137"><a href="#cb130-1137" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb130-1138"><a href="#cb130-1138" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span>k) <span class="co"># create a dummy variable to hold the mean of each sample</span></span>
<span id="cb130-1139"><a href="#cb130-1139" aria-hidden="true" tabindex="-1"></a><span class="co"># here the dummy variable can be a vector and we can preallocate its length</span></span>
<span id="cb130-1140"><a href="#cb130-1140" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb130-1141"><a href="#cb130-1141" aria-hidden="true" tabindex="-1"></a>  m[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(s[[i]])</span>
<span id="cb130-1142"><a href="#cb130-1142" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-1143"><a href="#cb130-1143" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m)</span>
<span id="cb130-1144"><a href="#cb130-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1145"><a href="#cb130-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1146"><a href="#cb130-1146" aria-hidden="true" tabindex="-1"></a>So, how does the sampling distribution of mean ages compare to the population distribution of ages? The mean of the two is pretty close to the same! The sampling distribution mean, which is an average of the set of sample averages, is an unbiased estimator for the population mean.</span>
<span id="cb130-1147"><a href="#cb130-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1150"><a href="#cb130-1150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1151"><a href="#cb130-1151" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(m) <span class="co"># this is the mean of our set of sample means</span></span>
<span id="cb130-1152"><a href="#cb130-1152" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e., the mean of the sampling distribution is almost equal to...</span></span>
<span id="cb130-1153"><a href="#cb130-1153" aria-hidden="true" tabindex="-1"></a>mu <span class="co"># the true population mean</span></span>
<span id="cb130-1154"><a href="#cb130-1154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1155"><a href="#cb130-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1156"><a href="#cb130-1156" aria-hidden="true" tabindex="-1"></a>Again, what we have just calculated is the *mean of the sampling distribution*, which is simply the average of the means of each sample we have made. This value should be really close to the population mean, and the sampling distribution - the distribution of sample means - should be about normally distributed around the true population mean.</span>
<span id="cb130-1157"><a href="#cb130-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1160"><a href="#cb130-1160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1161"><a href="#cb130-1161" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb130-1162"><a href="#cb130-1162" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(m), <span class="fu">aes</span>(<span class="at">x =</span> m)) <span class="sc">+</span></span>
<span id="cb130-1163"><a href="#cb130-1163" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="cf">function</span>(x) (<span class="fu">max</span>(m) <span class="sc">-</span> <span class="fu">min</span>(m)) <span class="sc">/</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb130-1164"><a href="#cb130-1164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb130-1165"><a href="#cb130-1165" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Sampling Distribution"</span>),</span>
<span id="cb130-1166"><a href="#cb130-1166" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Means of "</span>, k, <span class="st">" samples of size "</span>, n)</span>
<span id="cb130-1167"><a href="#cb130-1167" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb130-1168"><a href="#cb130-1168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Sample Mean"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb130-1169"><a href="#cb130-1169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(</span>
<span id="cb130-1170"><a href="#cb130-1170" aria-hidden="true" tabindex="-1"></a>      <span class="at">xintercept =</span> mu,</span>
<span id="cb130-1171"><a href="#cb130-1171" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb130-1172"><a href="#cb130-1172" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb130-1173"><a href="#cb130-1173" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb130-1174"><a href="#cb130-1174" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb130-1175"><a href="#cb130-1175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(</span>
<span id="cb130-1176"><a href="#cb130-1176" aria-hidden="true" tabindex="-1"></a>      <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb130-1177"><a href="#cb130-1177" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> mu,</span>
<span id="cb130-1178"><a href="#cb130-1178" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> k <span class="sc">*</span> <span class="fl">0.06</span>,</span>
<span id="cb130-1179"><a href="#cb130-1179" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"True Population Mean</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb130-1180"><a href="#cb130-1180" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb130-1181"><a href="#cb130-1181" aria-hidden="true" tabindex="-1"></a>      <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb130-1182"><a href="#cb130-1182" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">6</span></span>
<span id="cb130-1183"><a href="#cb130-1183" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb130-1184"><a href="#cb130-1184" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(</span>
<span id="cb130-1185"><a href="#cb130-1185" aria-hidden="true" tabindex="-1"></a>      <span class="at">xintercept =</span> <span class="fu">mean</span>(m),</span>
<span id="cb130-1186"><a href="#cb130-1186" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb130-1187"><a href="#cb130-1187" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb130-1188"><a href="#cb130-1188" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb130-1189"><a href="#cb130-1189" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb130-1190"><a href="#cb130-1190" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(</span>
<span id="cb130-1191"><a href="#cb130-1191" aria-hidden="true" tabindex="-1"></a>      <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb130-1192"><a href="#cb130-1192" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">mean</span>(m) <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb130-1193"><a href="#cb130-1193" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> k <span class="sc">*</span> <span class="fl">0.06</span>,</span>
<span id="cb130-1194"><a href="#cb130-1194" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Mean of Sample Means</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb130-1195"><a href="#cb130-1195" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb130-1196"><a href="#cb130-1196" aria-hidden="true" tabindex="-1"></a>      <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb130-1197"><a href="#cb130-1197" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">6</span></span>
<span id="cb130-1198"><a href="#cb130-1198" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-1199"><a href="#cb130-1199" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-1200"><a href="#cb130-1200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1201"><a href="#cb130-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1202"><a href="#cb130-1202" aria-hidden="true" tabindex="-1"></a>Now, let's take a closer look at our samples of zombies that we extracted from the population of zombies...</span>
<span id="cb130-1203"><a href="#cb130-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1204"><a href="#cb130-1204" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb130-1205"><a href="#cb130-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1206"><a href="#cb130-1206" aria-hidden="true" tabindex="-1"></a>Calculate a vector of standard error estimates based on the 5000 samples of zombies you have drawn from your population and then plot a histogram of the distribution of these standard errors. That is, for each sample, estimate the standard error of the sample ($\frac{s}{\sqrt{n}}$). How does the mean of this set of standard errors compare to the standard error estimated from the population variance? How does it compare to the standard error calculated from the standard deviation of the sampling distribution?</span>
<span id="cb130-1207"><a href="#cb130-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1210"><a href="#cb130-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1211"><a href="#cb130-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb130-1212"><a href="#cb130-1212" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb130-1213"><a href="#cb130-1213" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb130-1214"><a href="#cb130-1214" aria-hidden="true" tabindex="-1"></a>sample_sd <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span>k) <span class="co"># create a dummy variable to hold the SD of each sample</span></span>
<span id="cb130-1215"><a href="#cb130-1215" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb130-1216"><a href="#cb130-1216" aria-hidden="true" tabindex="-1"></a>    sample_sd[[i]] <span class="ot">&lt;-</span> <span class="fu">sd</span>(s[[i]]) <span class="co"># a vector of SDs for each sample</span></span>
<span id="cb130-1217"><a href="#cb130-1217" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-1218"><a href="#cb130-1218" aria-hidden="true" tabindex="-1"></a>sample_se <span class="ot">&lt;-</span> sample_sd<span class="sc">/</span><span class="fu">sqrt</span>(n) <span class="co"># a vector of SEs estimated from each sample</span></span>
<span id="cb130-1219"><a href="#cb130-1219" aria-hidden="true" tabindex="-1"></a>pop_se <span class="ot">&lt;-</span> sigma<span class="sc">/</span>(<span class="fu">sqrt</span>(n)) <span class="co"># a single value estimated from the population SD</span></span>
<span id="cb130-1220"><a href="#cb130-1220" aria-hidden="true" tabindex="-1"></a>sampling_dist_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(m) <span class="co"># a single value calculated from our sampling distibution SD</span></span>
<span id="cb130-1221"><a href="#cb130-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1222"><a href="#cb130-1222" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(sample_se), <span class="fu">aes</span>(<span class="at">x =</span> sample_se)) <span class="sc">+</span></span>
<span id="cb130-1223"><a href="#cb130-1223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span></span>
<span id="cb130-1224"><a href="#cb130-1224" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) (<span class="fu">max</span>(sample_se) <span class="sc">-</span> <span class="fu">min</span>(sample_se)) <span class="sc">/</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb130-1225"><a href="#cb130-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb130-1226"><a href="#cb130-1226" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Distribution of SEs estimated from</span><span class="sc">\n</span><span class="st">"</span>, k, <span class="st">" samples of size "</span>, n)</span>
<span id="cb130-1227"><a href="#cb130-1227" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-1228"><a href="#cb130-1228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Estimated SE"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb130-1229"><a href="#cb130-1229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb130-1230"><a href="#cb130-1230" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="fu">mean</span>(sample_se),</span>
<span id="cb130-1231"><a href="#cb130-1231" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb130-1232"><a href="#cb130-1232" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb130-1233"><a href="#cb130-1233" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb130-1234"><a href="#cb130-1234" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-1235"><a href="#cb130-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb130-1236"><a href="#cb130-1236" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb130-1237"><a href="#cb130-1237" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">mean</span>(sample_se),</span>
<span id="cb130-1238"><a href="#cb130-1238" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> k <span class="sc">*</span> <span class="fl">0.075</span>,</span>
<span id="cb130-1239"><a href="#cb130-1239" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Mean Estimated SE</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb130-1240"><a href="#cb130-1240" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb130-1241"><a href="#cb130-1241" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb130-1242"><a href="#cb130-1242" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb130-1243"><a href="#cb130-1243" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-1244"><a href="#cb130-1244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb130-1245"><a href="#cb130-1245" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> pop_se,</span>
<span id="cb130-1246"><a href="#cb130-1246" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb130-1247"><a href="#cb130-1247" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb130-1248"><a href="#cb130-1248" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb130-1249"><a href="#cb130-1249" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-1250"><a href="#cb130-1250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb130-1251"><a href="#cb130-1251" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb130-1252"><a href="#cb130-1252" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> pop_se,</span>
<span id="cb130-1253"><a href="#cb130-1253" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> k <span class="sc">*</span> <span class="fl">0.075</span>,</span>
<span id="cb130-1254"><a href="#cb130-1254" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"</span><span class="sc">\n\n</span><span class="st">SE calculated from known population</span><span class="sc">\n</span><span class="st">standard deviation"</span>,</span>
<span id="cb130-1255"><a href="#cb130-1255" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb130-1256"><a href="#cb130-1256" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">90</span> ,</span>
<span id="cb130-1257"><a href="#cb130-1257" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb130-1258"><a href="#cb130-1258" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-1259"><a href="#cb130-1259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb130-1260"><a href="#cb130-1260" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> sampling_dist_se,</span>
<span id="cb130-1261"><a href="#cb130-1261" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"green"</span>,</span>
<span id="cb130-1262"><a href="#cb130-1262" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb130-1263"><a href="#cb130-1263" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb130-1264"><a href="#cb130-1264" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-1265"><a href="#cb130-1265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb130-1266"><a href="#cb130-1266" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb130-1267"><a href="#cb130-1267" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> sampling_dist_se,</span>
<span id="cb130-1268"><a href="#cb130-1268" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> k <span class="sc">*</span> <span class="fl">0.075</span>,</span>
<span id="cb130-1269"><a href="#cb130-1269" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">SE estimated as SD of sampling distribution"</span>,</span>
<span id="cb130-1270"><a href="#cb130-1270" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"green"</span>,</span>
<span id="cb130-1271"><a href="#cb130-1271" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb130-1272"><a href="#cb130-1272" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb130-1273"><a href="#cb130-1273" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-1274"><a href="#cb130-1274" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-1275"><a href="#cb130-1275" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sample_se) <span class="co"># which is almost equal to...</span></span>
<span id="cb130-1276"><a href="#cb130-1276" aria-hidden="true" tabindex="-1"></a>pop_se <span class="co"># which is almost equal to...</span></span>
<span id="cb130-1277"><a href="#cb130-1277" aria-hidden="true" tabindex="-1"></a>sampling_dist_se</span>
<span id="cb130-1278"><a href="#cb130-1278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1279"><a href="#cb130-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1280"><a href="#cb130-1280" aria-hidden="true" tabindex="-1"></a>Thus, the *standard error* calculated from an individual sample can be used as an *estimator* for the **standard deviation of the sampling distribution**. This is useful, since it means that, if our sample is large enough, we do not have to repeatedly sample from the population to get an estimate of the sampling distribution - we can instead estimate it directly using our data!</span>
<span id="cb130-1281"><a href="#cb130-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1282"><a href="#cb130-1282" aria-hidden="true" tabindex="-1"></a>Note that as our sample size increases, the *standard error* calculated from the population variance should decrease, as should the standard deviation in the sampling distribution, i.e., in estimates of the population mean drawn from successive samples. This should be apparent intuitively... as each sample drawn from a population gets larger, the estimate of the mean value of those samples should vary less and less and thus have lower "error".</span>
<span id="cb130-1283"><a href="#cb130-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1284"><a href="#cb130-1284" aria-hidden="true" tabindex="-1"></a>Despite their similarities, the standard error of the mean estimated for a given sample and the standard deviation of that sample tell us different things. The *standard error* is an estimate of how far a given sample mean is likely to be from the population mean - it is a measure of uncertainty. The *standard deviation* of a sample is a measure of the degree to which individual values within a sample differ from the mean for that sample.</span>
<span id="cb130-1285"><a href="#cb130-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1288"><a href="#cb130-1288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1289"><a href="#cb130-1289" aria-hidden="true" tabindex="-1"></a><span class="co"># | include: false</span></span>
<span id="cb130-1290"><a href="#cb130-1290" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>cowplot)</span>
<span id="cb130-1291"><a href="#cb130-1291" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>manipulate)</span>
<span id="cb130-1292"><a href="#cb130-1292" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>mosaic)</span>
<span id="cb130-1293"><a href="#cb130-1293" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>tidyverse)</span>
<span id="cb130-1294"><a href="#cb130-1294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1295"><a href="#cb130-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1296"><a href="#cb130-1296" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb130-1297"><a href="#cb130-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1298"><a href="#cb130-1298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Concept Review {.unnumbered}</span></span>
<span id="cb130-1299"><a href="#cb130-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1300"><a href="#cb130-1300" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Useful ***R*** functions for distributions: <span class="in">`r`</span> (random value generation), <span class="in">`d`</span> (point density), <span class="in">`p`</span> (cumulative probability distribution), <span class="in">`q`</span> (quantile)</span>
<span id="cb130-1301"><a href="#cb130-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1302"><a href="#cb130-1302" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Useful distributions:</span>
<span id="cb130-1303"><a href="#cb130-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1304"><a href="#cb130-1304" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>PMFs for discrete random variables - Bernoulli, Binomial, Poisson</span>
<span id="cb130-1305"><a href="#cb130-1305" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>PDFs for continuous random variables - Beta, Uniform, Normal and Standard Normal</span>
<span id="cb130-1306"><a href="#cb130-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1307"><a href="#cb130-1307" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Standard error of the mean for a sample of size $n$:</span>
<span id="cb130-1308"><a href="#cb130-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1309"><a href="#cb130-1309" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(**population standard deviation**, or $\sigma$) $\div$ $\sqrt{n}$</span>
<span id="cb130-1310"><a href="#cb130-1310" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>≈ **standard deviation of the sampling distribution** for a large set of samples of size $n$</span>
<span id="cb130-1311"><a href="#cb130-1311" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>≈ (**standard deviation of a single sample of size** $n$, or $s$) $\div$ $\sqrt{n}$</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>