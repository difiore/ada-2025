<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applied Data Analysis - 22&nbsp; Model Selection in Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./23-module.html" rel="next">
<link href="./21-module.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./22-module.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Model Selection in Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-logistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Logistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course-schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-typography-and-formatting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Typography and Formatting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-programming-style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming Style Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>RStudio</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extending the Functionality of <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamentals of the <strong><em>R</em></strong> Language</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basics of Version Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Additional Data Structures in <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting Data into <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Functions and Flow Control</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part II - Statistics and Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Descriptive Statisics and Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability and Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Classical Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Using Permutation Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Error, Power, and Effect Size</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Linear Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Elements of Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression and ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-module.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Model Selection in Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Mixed Effects or Multilevel Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Part III - Miscellany</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-maximum_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Maximum Likelihood Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-geospatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Geospatial Data Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-r-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building Custom <strong><em>R</em></strong> Packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-python-from-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using <strong><em>Python</em></strong> from <strong><em>R</em></strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building Interactive Web Apps</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-04-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 04 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-05-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 05 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-06-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 06 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 07</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 08</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-08-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 08 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 09</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-09-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 09 Solution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 10</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-analysis-replication-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis Replication</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Packages Used</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">22.1</span> Overview</a></li>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link" data-scroll-target="#preliminaries"><span class="header-section-number">22.2</span> Preliminaries</a></li>
  <li><a href="#nested-comparisons-and-f-tests" id="toc-nested-comparisons-and-f-tests" class="nav-link" data-scroll-target="#nested-comparisons-and-f-tests"><span class="header-section-number">22.3</span> Nested Comparisons and F Tests</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">EXAMPLE:</a></li>
  </ul></li>
  <li><a href="#forward-selection" id="toc-forward-selection" class="nav-link" data-scroll-target="#forward-selection"><span class="header-section-number">22.4</span> Forward Selection</a></li>
  <li><a href="#backward-selection" id="toc-backward-selection" class="nav-link" data-scroll-target="#backward-selection"><span class="header-section-number">22.5</span> Backward Selection</a></li>
  <li><a href="#model-selection-using-aic" id="toc-model-selection-using-aic" class="nav-link" data-scroll-target="#model-selection-using-aic"><span class="header-section-number">22.6</span> Model Selection Using AIC</a>
  <ul class="collapse">
  <li><a href="#averaging-coefficients-across-sets-of-models" id="toc-averaging-coefficients-across-sets-of-models" class="nav-link" data-scroll-target="#averaging-coefficients-across-sets-of-models"><span class="header-section-number">22.6.1</span> Averaging Coefficients across Sets of Models</a></li>
  </ul></li>
  <li><a href="#concept-review" id="toc-concept-review" class="nav-link" data-scroll-target="#concept-review">Concept Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-module.html">Part II - Statistics and Inference</a></li><li class="breadcrumb-item"><a href="./22-module.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Model Selection in Regression</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="module-22" class="quarto-section-identifier"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Model Selection in Regression</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">22.1</span> Overview</h2>
<p>The purpose of a model selection process in a regression analysis is to sort through our explanatory variables in a systematic fashion in order to establish which are best able to describe the response. There are different possible algorithms to use for model selection, e.g., forward and backward selection, and different ways of comparing models to one another, which may result in different parameters being included in the final model. The are also several different package that we can use to combine results from several different models.</p>
</section>
<section id="preliminaries" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="preliminaries"><span class="header-section-number">22.2</span> Preliminaries</h2>
<ul>
<li>Install these packages in <strong><em>R</em></strong>: <a href="https://cran.r-project.org/web/packages/MASS/MASS.pdf">{MASS}</a>, <a href="https://cran.r-project.org/web/packages/AICcmodavg/AICcmodavg.pdf">{AICcmodavg}</a>, and <a href="https://cran.r-project.org/web/packages/MuMIn/MuMIn.pdf">{MuMIn}</a></li>
<li>Load {tidyverse}</li>
</ul>
</section>
<section id="nested-comparisons-and-f-tests" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="nested-comparisons-and-f-tests"><span class="header-section-number">22.3</span> Nested Comparisons and F Tests</h2>
<p>One way we can compare different models is to use F ratios and what are called <strong>partial F tests</strong>. This approach looks at two or more <em>nested</em> models - a larger, or more complex, model that contains explanatory variables that we are interested in and smaller, less complex, models that exclude one or more of those variables. Basically, we aim to compare the total variance in the response variable that is explained by the more complex model to that explained by a “reduced” model. If the more complex model explains a significantly greater proportion of the variation, then we conclude that predictor terms absent from the less complex model are important.</p>
<p>For example, if including an additional term with its associated <span class="math inline">\(\beta\)</span> coefficient results in significantly better fit to the observed data than we find for a model that lacks that particular terms, then this is evidence against the null hypothesis that the <span class="math inline">\(\beta\)</span> coefficient (slope) for that term equals zero.</p>
<section id="example" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example">EXAMPLE:</h3>
<p>Let’s go back to our zombie apocalypse survivors dataset and compare a few models. We need to calculate the following partial F statistic for a full versus reduced model:</p>
<p><span class="math display">\[F = \frac{(R^2_{full}-R^2_{reduced})(n-q-1)}{(1-R^2_{full})(q-p)}\]</span></p>
<p>where:</p>
<ul>
<li>The <span class="math inline">\(R^2\)</span> values are the coefficients of determination of the full model and the nested “reduced” model</li>
<li><span class="math inline">\(n\)</span> is the number of observations in the data set</li>
<li><span class="math inline">\(p\)</span> is the number of predictor terms in the nested (reduced) model</li>
<li><span class="math inline">\(q\)</span> is the number of predictor terms in the full model</li>
</ul>
<p>After we calculate this F statistic, we compare it to an <span class="math inline">\(F\)</span> distribution with “df1 = q-p” and “df2 = n-q” to derive a p value. The <code>lm()</code> function will do this for us automatically, but we can also do it by hand.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## Rows: 1000 Columns: 10
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (4): first_name, last_name, gender, major
## dbl (6): id, height, weight, zombies_killed, years_of_education, age
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>z<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(z<span class="sc">$</span>gender)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> age <span class="sc">*</span> gender)  <span class="co"># full model</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> age <span class="sc">+</span> gender)  <span class="co"># model without interaction</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> age)  <span class="co"># model with one predictor</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> <span class="dv">1</span>)  <span class="co"># intercept only model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once we have fitted the full and three nested models, we can carry out partial F tests to compare particular models using the <code>anova()</code> function, with the nested (reduced) and full model as arguments. The reduced model is included as the first argument and the full model is included as the second argument.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2, m1, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Analysis of Variance Table
## 
## Model 1: height ~ age + gender
## Model 2: height ~ age * gender
##   Res.Df    RSS Df Sum of Sq     F  Pr(&gt;F)  
## 1    997 6752.7                             
## 2    996 6708.6  1    44.138 6.553 0.01062 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compares the reduced model without interactions (m2) to the full model with</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># interactions (m1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also calculate the F statistic by hand and compare it to the <span class="math inline">\(F\)</span> distribution.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(f <span class="ot">&lt;-</span> ((<span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared <span class="sc">-</span> <span class="fu">summary</span>(m2)<span class="sc">$</span>r.squared) <span class="sc">*</span> (<span class="fu">nrow</span>(z) <span class="sc">-</span> <span class="dv">3</span> <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">/</span>((<span class="dv">1</span> <span class="sc">-</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared) <span class="sc">*</span> (<span class="dv">3</span> <span class="sc">-</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 6.552973</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(f, <span class="at">df1 =</span> <span class="dv">3</span> <span class="sc">-</span> <span class="dv">2</span>, <span class="at">df2 =</span> <span class="fu">nrow</span>(z) <span class="sc">-</span> <span class="dv">3</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0.01061738</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df1 = q-p, df2 = n-q</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m3, m2, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Analysis of Variance Table
## 
## Model 1: height ~ age
## Model 2: height ~ age + gender
##   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    998 10756.6                                  
## 2    997  6752.7  1    4003.9 591.15 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compares the age only model (m3) to the age + gender model (m2)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>(f <span class="ot">&lt;-</span> ((<span class="fu">summary</span>(m2)<span class="sc">$</span>r.squared <span class="sc">-</span> <span class="fu">summary</span>(m3)<span class="sc">$</span>r.squared) <span class="sc">*</span> (<span class="fu">nrow</span>(z) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">/</span>((<span class="dv">1</span> <span class="sc">-</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(m2)<span class="sc">$</span>r.squared) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 591.147</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(f, <span class="at">df1 =</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>, <span class="at">df2 =</span> <span class="fu">nrow</span>(z) <span class="sc">-</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df1 = q-p, df2 = n-q</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In these cases, each comparison shows that the more complex model indeed results in signficantly more explantory power than the reduced model.</p>
</section>
</section>
<section id="forward-selection" class="level2" data-number="22.4">
<h2 data-number="22.4" class="anchored" data-anchor-id="forward-selection"><span class="header-section-number">22.4</span> Forward Selection</h2>
<p>Forward selection starts with an intercept-only model and then tests which of the predictor variables best improves the goodness-of-fit. Then the model is updated by adding that term and tests which of the remaining predictors would further and best improve the fit. The process continues until there are not any other terms that could be added to improve the fit more. The <strong><em>R</em></strong> functions <code>add1()</code> and <code>update()</code>, respectively, perform the series of tests and update your fitted regression model. Setting the “test=” argument in <code>add1()</code> to “F” includes the partial F statistic value and its significance. The “.~.” part of the “scope=” argument means, basically, “what is already there”, while the remainder of the “scope=” argument is the list of additional variables you might add for the fullest possible model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ 1, data = z)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.4806  -2.9511  -0.1279   2.7530  12.8997 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  67.6301     0.1363   496.2   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.31 on 999 degrees of freedom</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">add1</span>(m0, <span class="at">scope =</span> . <span class="sc">~</span> . <span class="sc">+</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Single term additions
## 
## Model:
## height ~ 1
##                    Df Sum of Sq     RSS    AIC   F value  Pr(&gt;F)    
## &lt;none&gt;                          18558.6 2922.9                      
## age                 1    7802.0 10756.6 2379.5  723.8676 &lt; 2e-16 ***
## weight              1   12864.8  5693.8 1743.4 2254.9310 &lt; 2e-16 ***
## zombies_killed      1       5.7 18552.9 2924.6    0.3048 0.58100    
## years_of_education  1      81.6 18477.0 2920.5    4.4057 0.03607 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Looking at the output of <code>add1()</code>, we see that adding <strong>weight</strong>, <strong>age</strong>, or <strong>years_of_education</strong> all would add explanatory power to our model, but <strong>weight</strong> is associated with the highest new F statistic and the lowest new RSS, so we should update our model by adding it as a new predictor. We do this with the <code>update()</code> function, passing it the old model and a “formula=” argument of “.~.” (what is already there) “+ weight” (the new predictor).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">update</span>(m0, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">+</span> weight)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ weight, data = z)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.1519 -1.5206 -0.0535  1.5167  9.4439 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 39.565446   0.595815   66.41   &lt;2e-16 ***
## weight       0.195019   0.004107   47.49   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.389 on 998 degrees of freedom
## Multiple R-squared:  0.6932, Adjusted R-squared:  0.6929 
## F-statistic:  2255 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We then repeat this process until adding additional predictors no longer improves the explanatory power of the model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">add1</span>(m1, <span class="at">scope =</span> . <span class="sc">~</span> . <span class="sc">+</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Single term additions
## 
## Model:
## height ~ weight
##                    Df Sum of Sq    RSS     AIC   F value  Pr(&gt;F)    
## &lt;none&gt;                          5693.8 1743.38                      
## age                 1   3012.83 2681.0  992.17 1120.4147 &lt; 2e-16 ***
## zombies_killed      1      5.16 5688.6 1744.47    0.9052 0.34163    
## years_of_education  1     16.93 5676.9 1742.40    2.9728 0.08498 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">update</span>(m1, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">+</span> age)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ weight + age, data = z)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.2278 -1.1782 -0.0574  1.1566  5.4117 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 31.763388   0.470797   67.47   &lt;2e-16 ***
## weight       0.163107   0.002976   54.80   &lt;2e-16 ***
## age          0.618270   0.018471   33.47   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.64 on 997 degrees of freedom
## Multiple R-squared:  0.8555, Adjusted R-squared:  0.8553 
## F-statistic:  2952 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">add1</span>(m2, <span class="at">scope =</span> . <span class="sc">~</span> . <span class="sc">+</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Single term additions
## 
## Model:
## height ~ weight + age
##                    Df Sum of Sq    RSS    AIC F value Pr(&gt;F)
## &lt;none&gt;                          2681.0 992.17               
## zombies_killed      1   2.62551 2678.3 993.20  0.9764 0.3233
## years_of_education  1   0.77683 2680.2 993.89  0.2887 0.5912</code></pre>
</div>
</div>
<p>After we add <strong>weight</strong> and <strong>age</strong>, no other variable improves the fit of the model significantly, so the final, best model in this case is <strong>m2</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ weight + age, data = z)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.2278 -1.1782 -0.0574  1.1566  5.4117 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 31.763388   0.470797   67.47   &lt;2e-16 ***
## weight       0.163107   0.002976   54.80   &lt;2e-16 ***
## age          0.618270   0.018471   33.47   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.64 on 997 degrees of freedom
## Multiple R-squared:  0.8555, Adjusted R-squared:  0.8553 
## F-statistic:  2952 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="backward-selection" class="level2" data-number="22.5">
<h2 data-number="22.5" class="anchored" data-anchor-id="backward-selection"><span class="header-section-number">22.5</span> Backward Selection</h2>
<p>Opposite to forward selection, backward selection starts with the fullest model you want to consider and systematically drops terms that do not contribute to the explanatory value of the model. The <strong><em>R</em></strong> functions for this process are <code>drop1()</code> to inspect the partial F test results and <code>update()</code> to update the model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ age + weight + zombies_killed + years_of_education, 
##     data = z)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.1716 -1.1751 -0.0645  1.1263  5.4526 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        31.625711   0.486310  65.032   &lt;2e-16 ***
## age                 0.617436   0.018511  33.355   &lt;2e-16 ***
## weight              0.163197   0.002981  54.750   &lt;2e-16 ***
## zombies_killed      0.029777   0.029721   1.002    0.317    
## years_of_education  0.017476   0.031050   0.563    0.574    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.64 on 995 degrees of freedom
## Multiple R-squared:  0.8557, Adjusted R-squared:  0.8551 
## F-statistic:  1475 on 4 and 995 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(m0, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Single term deletions
## 
## Model:
## height ~ age + weight + zombies_killed + years_of_education
##                    Df Sum of Sq     RSS     AIC   F value Pr(&gt;F)    
## &lt;none&gt;                           2677.5  994.88                     
## age                 1    2993.7  5671.2 1743.40 1112.5240 &lt;2e-16 ***
## weight              1    8066.3 10743.7 2382.32 2997.5633 &lt;2e-16 ***
## zombies_killed      1       2.7  2680.2  993.89    1.0038 0.3166    
## years_of_education  1       0.9  2678.3  993.20    0.3168 0.5737    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Here, removing either <strong>weight</strong> or <strong>age</strong> would result in a significant loss of explanatory power for our model, while removing either <strong>zombies_killed</strong> or <strong>years_of_education</strong> would not. The latter variable is associated with the lowest F value and lowest increase in RSS, so we update our model by removing it. We then run the <code>drop1()</code> function on the new, updated model and remove the next variable whose loss does not significantly reduce the explanatory power of the model. We continue doing this until removing any additional predictors results in a significantly worse model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">update</span>(m0, . <span class="sc">~</span> . <span class="sc">-</span> years_of_education)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ age + weight + zombies_killed, data = z)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.1715 -1.1928 -0.0615  1.1435  5.4700 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    31.661862   0.481884  65.704   &lt;2e-16 ***
## age             0.618053   0.018472  33.458   &lt;2e-16 ***
## weight          0.163232   0.002979  54.793   &lt;2e-16 ***
## zombies_killed  0.029348   0.029701   0.988    0.323    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.64 on 996 degrees of freedom
## Multiple R-squared:  0.8557, Adjusted R-squared:  0.8552 
## F-statistic:  1968 on 3 and 996 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(m1, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Single term deletions
## 
## Model:
## height ~ age + weight + zombies_killed
##                Df Sum of Sq     RSS     AIC   F value Pr(&gt;F)    
## &lt;none&gt;                       2678.3  993.20                     
## age             1    3010.3  5688.6 1744.47 1119.4439 &lt;2e-16 ***
## weight          1    8073.4 10751.7 2381.07 3002.2762 &lt;2e-16 ***
## zombies_killed  1       2.6  2681.0  992.17    0.9764 0.3233    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">update</span>(m1, . <span class="sc">~</span> . <span class="sc">-</span> zombies_killed)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ age + weight, data = z)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.2278 -1.1782 -0.0574  1.1566  5.4117 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 31.763388   0.470797   67.47   &lt;2e-16 ***
## age          0.618270   0.018471   33.47   &lt;2e-16 ***
## weight       0.163107   0.002976   54.80   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.64 on 997 degrees of freedom
## Multiple R-squared:  0.8555, Adjusted R-squared:  0.8553 
## F-statistic:  2952 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(m2, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Single term deletions
## 
## Model:
## height ~ age + weight
##        Df Sum of Sq     RSS     AIC F value    Pr(&gt;F)    
## &lt;none&gt;               2681.0  992.17                      
## age     1    3012.8  5693.8 1743.38  1120.4 &lt; 2.2e-16 ***
## weight  1    8075.7 10756.6 2379.52  3003.2 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>At this point, all of the explanatory variables are still significant, so the final, best model in this case is also <strong>m2</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ age + weight, data = z)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.2278 -1.1782 -0.0574  1.1566  5.4117 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 31.763388   0.470797   67.47   &lt;2e-16 ***
## age          0.618270   0.018471   33.47   &lt;2e-16 ***
## weight       0.163107   0.002976   54.80   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.64 on 997 degrees of freedom
## Multiple R-squared:  0.8555, Adjusted R-squared:  0.8553 
## F-statistic:  2952 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="model-selection-using-aic" class="level2" data-number="22.6">
<h2 data-number="22.6" class="anchored" data-anchor-id="model-selection-using-aic"><span class="header-section-number">22.6</span> Model Selection Using AIC</h2>
<section id="stepwise-selection-using-mass" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="stepwise-selection-using-mass">Stepwise Selection using {MASS}</h4>
<p>There are two <strong><em>R</em></strong> functions that can act as further shortcuts for this process that use the <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion">Akaike Information Criterion (AIC)</a> rather than partial F tests to determine relative model fit. We will talk in more detail about how we get AIC in our upcoming modules on GLM and mixed modeling as well.</p>
<p>The AIC is typically calculated as <strong><em>-2(log-likelihood) + 2K</em></strong>, where <span class="math inline">\(K\)</span> is the number of model parameters (i.e., the number of <span class="math inline">\(\beta\)</span> coefficients we estimate, which equals the number of variables in the model, plus the intercept), and the log-likelihood is a measure of model fit (the higher, the better). [Keep in mind, though, that log-likelihood is a function of sample size, and larger samples will tend to have lower log-likelihoods regardless of fit!] We will not derive log-likelihoods by hand in class, but if you want to know more about how log-likelihood values are derived, you can check out <a href="https://newonlinecourses.science.psu.edu/stat504/node/27/">this helpful resource</a>.</p>
<p>As you might guess from how AIC is defined, the model with the <strong>lowest</strong> AIC is typically designated as the best fit for the data. Note that although AIC can be used to assess the relative fit of a model to a certain data set, it really does not say anything about the absolute fit or explanatory value of the model (e.g., like the <span class="math inline">\(R^2\)</span> value can). Keep in mind that the best fit model according to AIC, among the models you test against each other, may actually explain very little of the overall variation.</p>
<p>There are many functions within <strong>R</strong> that will perform stepwise model reduction automatically using AIC as a criterion. One of the most popular is called <code>stepAIC()</code>, which is a function in the {MASS} package. To use it, you must simply specify the most complex version of the model and choose whether you would like to assess the model using backwards or forwards (or both) methods of stepwise comparison.</p>
<p>Let’s try <code>stepAIC()</code> with our <strong>m0</strong> from above. In the call for the function, we can ask it to run forward, backward, or both directions.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## 
## Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     select</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># start with full model...</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>(s <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(m, <span class="at">scope =</span> . <span class="sc">~</span> ., <span class="at">direction =</span> <span class="st">"both"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Start:  AIC=994.88
## height ~ age + weight + zombies_killed + years_of_education
## 
##                      Df Sum of Sq     RSS     AIC
## - years_of_education  1       0.9  2678.3  993.20
## - zombies_killed      1       2.7  2680.2  993.89
## &lt;none&gt;                             2677.5  994.88
## - age                 1    2993.7  5671.2 1743.40
## - weight              1    8066.3 10743.7 2382.32
## 
## Step:  AIC=993.2
## height ~ age + weight + zombies_killed
## 
##                      Df Sum of Sq     RSS     AIC
## - zombies_killed      1       2.6  2681.0  992.17
## &lt;none&gt;                             2678.3  993.20
## + years_of_education  1       0.9  2677.5  994.88
## - age                 1    3010.3  5688.6 1744.47
## - weight              1    8073.4 10751.7 2381.07
## 
## Step:  AIC=992.17
## height ~ age + weight
## 
##                      Df Sum of Sq     RSS     AIC
## &lt;none&gt;                             2681.0  992.17
## + zombies_killed      1       2.6  2678.3  993.20
## + years_of_education  1       0.8  2680.2  993.89
## - age                 1    3012.8  5693.8 1743.38
## - weight              1    8075.7 10756.6 2379.52</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ age + weight, data = z)
## 
## Coefficients:
## (Intercept)          age       weight  
##     31.7634       0.6183       0.1631</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ age + weight, data = z)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.2278 -1.1782 -0.0574  1.1566  5.4117 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 31.763388   0.470797   67.47   &lt;2e-16 ***
## age          0.618270   0.018471   33.47   &lt;2e-16 ***
## weight       0.163107   0.002976   54.80   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.64 on 997 degrees of freedom
## Multiple R-squared:  0.8555, Adjusted R-squared:  0.8553 
## F-statistic:  2952 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ... or start with minimal model</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>(s <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(m, <span class="at">scope =</span> <span class="sc">~</span>. <span class="sc">+</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"both"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Start:  AIC=2922.93
## height ~ 1
## 
##                      Df Sum of Sq     RSS    AIC
## + weight              1   12864.8  5693.8 1743.4
## + age                 1    7802.0 10756.6 2379.5
## + years_of_education  1      81.6 18477.0 2920.5
## &lt;none&gt;                            18558.6 2922.9
## + zombies_killed      1       5.7 18552.9 2924.6
## 
## Step:  AIC=1743.38
## height ~ weight
## 
##                      Df Sum of Sq     RSS     AIC
## + age                 1    3012.8  2681.0  992.17
## + years_of_education  1      16.9  5676.9 1742.40
## &lt;none&gt;                             5693.8 1743.38
## + zombies_killed      1       5.2  5688.6 1744.47
## - weight              1   12864.8 18558.6 2922.93
## 
## Step:  AIC=992.17
## height ~ weight + age
## 
##                      Df Sum of Sq     RSS     AIC
## &lt;none&gt;                             2681.0  992.17
## + zombies_killed      1       2.6  2678.3  993.20
## + years_of_education  1       0.8  2680.2  993.89
## - age                 1    3012.8  5693.8 1743.38
## - weight              1    8075.7 10756.6 2379.52</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ weight + age, data = z)
## 
## Coefficients:
## (Intercept)       weight          age  
##     31.7634       0.1631       0.6183</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## lm(formula = height ~ weight + age, data = z)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.2278 -1.1782 -0.0574  1.1566  5.4117 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 31.763388   0.470797   67.47   &lt;2e-16 ***
## weight       0.163107   0.002976   54.80   &lt;2e-16 ***
## age          0.618270   0.018471   33.47   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.64 on 997 degrees of freedom
## Multiple R-squared:  0.8555, Adjusted R-squared:  0.8553 
## F-statistic:  2952 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the <code>stepAIC()</code> function, whether we start with the full model more with a null model, has converged (using AIC, in this case) on the same best model we found above through forward and backwards selection by hand - i.e., the model with just <strong>age</strong> and <strong>weight</strong> retained as predictor variables after our process of model selection.</p>
<p>Finally, there’s a very helpful model selection package called {AICcmodavg}. You may have noticed the extra “c” in AICc… this is a “corrected” version of AIC that can account for small sample sizes (helpful for most of us in anthropology and biology). It is derived from AIC using the following equation (which you do not need to know!):</p>
<p><span class="math display">\[AIC_c = AIC + \frac{2K^2 + 2K}{n-K-1}\]</span></p>
<p>where <span class="math inline">\(n\)</span> is sample size and <span class="math inline">\(K\)</span> is the number of parameters in the model. This is, essentially, a version of AIC with greater penalties for models with more parameters. Since the values for AICc and AIC converge as sample size increases, it has been argued that AICc should be the default model testing criterion rather than AIC.</p>
<p>What makes this wrapper especially useful is that the table output of the function very clearly compares AIC values for different models in a way often asked for in publications. Let’s take a look using our already-defined models.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(<span class="fu">list</span>(m0, m1, m2), <span class="fu">c</span>(<span class="st">"m0"</span>, <span class="st">"m1"</span>, <span class="st">"m2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Model selection based on AICc:
## 
##    K    AICc Delta_AICc AICcWt Cum.Wt       LL
## m2 4 3832.09       0.00   0.54   0.54 -1912.03
## m1 5 3833.13       1.04   0.32   0.86 -1911.54
## m0 6 3834.84       2.75   0.14   1.00 -1911.38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>AICcmodavg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We get a few types of output that allow us to directly compare the relative fit of each model: the number of parameters (<strong>k</strong>), the <strong>AICc</strong> scores, and a number of other helpful outputs. <strong>Delta AICc</strong> (or <span class="math inline">\(\Delta_i(AIC)=AIC_i-min(AIC)\)</span>) is simply a comparison showing how different each “least-best” model is from the best model in AICc score (i.e., the difference in their AICc scores). <strong>AICcWt</strong> shows us the “weight” of the model at each level (see <a href="https://www.rdocumentation.org/packages/qpcR/versions/1.4-0/topics/akaike.weights">here</a> for an explanation of what this means). In this case, the best model is the first on the list and is, like in all our other model selection methods, <strong>m2</strong>.</p>
</section>
<section id="automated-subset-selection-and-model-averaging-using-mumin" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="automated-subset-selection-and-model-averaging-using-mumin">Automated Subset Selection and Model Averaging using {MuMIn}</h4>
<p>An alternative approach to model selection using AIC is provided by using the function <code>dredge()</code> in the {MuMIn} package, which explores subsets of a given global model in an automated way. With <code>dredge()</code>, we first run a global model that includes all of the terms we want to consider and then we run <code>dredge()</code> to fit subsets of that model without having to specify explicitly which submodels we want to run. The <code>dredge()</code> function returns a “model selection” table with models ranked in order of increasing AICc (i.e., lowest, or “best”, first).</p>
<p>We start by defining a “global.model”…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education, <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Here, we need to change the “na.action” argument from the default of “na.omit” to “na.fail” to prevent <code>dredge()</code> from trying to fit submodels with different data sets than the global model if there are missing values.</p>
</blockquote>
<blockquote class="blockquote">
<p>Alternatively, we could set that option globally for our R session before running the global model by using <code>options(na.action = na.fail)</code> and then omitting the <code>na.action=</code> argument from our call to <code>lm()</code>.</p>
</blockquote>
<blockquote class="blockquote">
<p>We could also filter our dataset to only include rows where none of the variables of interest have missing data using, e.g., <code>drop_na()</code>.</p>
</blockquote>
<blockquote class="blockquote">
<p>The command <code>options()$na.action</code> shows the current “na.action” option.</p>
</blockquote>
<p>We then run <code>dredge()</code> to explore a set of submodels…</p>
<ul>
<li>the <code>m.lim=</code> argument is optional and sets lower and upper limits on the number of terms to include</li>
<li>the <code>beta=</code> argument specifies whether or not and how to standardize the beta coefficients; “none” is the default</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>mods <span class="ot">&lt;-</span> <span class="fu">dredge</span>(m, <span class="at">beta =</span> <span class="st">"none"</span>, <span class="at">m.lim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## Fixed term is "(Intercept)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mods)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] "model.selection" "data.frame"</code></pre>
</div>
</div>
<p>The <code>dredge()</code> function returns a “model.selection” object summarizing all of the models that were tested. The <code>get.models()</code> function can be used to return a list of these models.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>(mods.list <span class="ot">&lt;-</span> <span class="fu">get.models</span>(mods, <span class="at">subset =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## $`4`
## 
## Call:
## lm(formula = height ~ age + weight + 1, data = z, na.action = "na.fail")
## 
## Coefficients:
## (Intercept)          age       weight  
##     31.7634       0.6183       0.1631  
## 
## 
## $`12`
## 
## Call:
## lm(formula = height ~ age + weight + zombies_killed + 1, data = z, 
##     na.action = "na.fail")
## 
## Coefficients:
##    (Intercept)             age          weight  zombies_killed  
##       31.66186         0.61805         0.16323         0.02935  
## 
## 
## $`8`
## 
## Call:
## lm(formula = height ~ age + weight + years_of_education + 1, 
##     data = z, na.action = "na.fail")
## 
## Coefficients:
##        (Intercept)                 age              weight  years_of_education  
##           31.73031             0.61768             0.16307             0.01668  
## 
## 
## $`16`
## 
## Call:
## lm(formula = height ~ age + weight + years_of_education + zombies_killed + 
##     1, data = z, na.action = "na.fail")
## 
## Coefficients:
##        (Intercept)                 age              weight  years_of_education  
##           31.62571             0.61744             0.16320             0.01748  
##     zombies_killed  
##            0.02978  
## 
## 
## $`7`
## 
## Call:
## lm(formula = height ~ weight + years_of_education + 1, data = z, 
##     na.action = "na.fail")
## 
## Coefficients:
##        (Intercept)              weight  years_of_education  
##           39.37682             0.19471             0.07771  
## 
## 
## $`3`
## 
## Call:
## lm(formula = height ~ weight + 1, data = z, na.action = "na.fail")
## 
## Coefficients:
## (Intercept)       weight  
##      39.565        0.195  
## 
## 
## $`15`
## 
## Call:
## lm(formula = height ~ weight + years_of_education + zombies_killed + 
##     1, data = z, na.action = "na.fail")
## 
## Coefficients:
##        (Intercept)              weight  years_of_education      zombies_killed  
##           39.22119             0.19487             0.07883             0.04304  
## 
## 
## $`11`
## 
## Call:
## lm(formula = height ~ weight + zombies_killed + 1, data = z, 
##     na.action = "na.fail")
## 
## Coefficients:
##    (Intercept)          weight  zombies_killed  
##       39.41922         0.19518         0.04116  
## 
## 
## $`2`
## 
## Call:
## lm(formula = height ~ age + 1, data = z, na.action = "na.fail")
## 
## Coefficients:
## (Intercept)          age  
##     48.7357       0.9425  
## 
## 
## $`6`
## 
## Call:
## lm(formula = height ~ age + years_of_education + 1, data = z, 
##     na.action = "na.fail")
## 
## Coefficients:
##        (Intercept)                 age  years_of_education  
##           48.61525             0.94036             0.05458  
## 
## 
## $`10`
## 
## Call:
## lm(formula = height ~ age + zombies_killed + 1, data = z, na.action = "na.fail")
## 
## Coefficients:
##    (Intercept)             age  zombies_killed  
##       48.85642         0.94246        -0.04006  
## 
## 
## $`14`
## 
## Call:
## lm(formula = height ~ age + years_of_education + zombies_killed + 
##     1, data = z, na.action = "na.fail")
## 
## Coefficients:
##        (Intercept)                 age  years_of_education      zombies_killed  
##            48.7343              0.9404              0.0535             -0.0387  
## 
## 
## $`5`
## 
## Call:
## lm(formula = height ~ years_of_education + 1, data = z, na.action = "na.fail")
## 
## Coefficients:
##        (Intercept)  years_of_education  
##            67.1195              0.1704  
## 
## 
## $`13`
## 
## Call:
## lm(formula = height ~ years_of_education + zombies_killed + 1, 
##     data = z, na.action = "na.fail")
## 
## Coefficients:
##        (Intercept)  years_of_education      zombies_killed  
##           67.23863             0.16936            -0.03875  
## 
## 
## $`1`
## 
## Call:
## lm(formula = height ~ 1, data = z, na.action = "na.fail")
## 
## Coefficients:
## (Intercept)  
##       67.63  
## 
## 
## $`9`
## 
## Call:
## lm(formula = height ~ zombies_killed + 1, data = z, na.action = "na.fail")
## 
## Coefficients:
##    (Intercept)  zombies_killed  
##       67.75898        -0.04308  
## 
## 
## attr(,"rank")
## function (x) 
## do.call("rank", list(x))
## &lt;environment: 0x10d4f31a0&gt;
## attr(,"call")
## AICc(x)
## attr(,"class")
## [1] "function"     "rankFunction"
## attr(,"beta")
## [1] "none"</code></pre>
</div>
</div>
<p>Running the <code>coef()</code> function on the output of <code>dredge()</code> returns a table of coefficients from each model, where the rowname is the number of the corresponding model in the “model.selection” object.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mods)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##    (Intercept)       age    weight zombies_killed years_of_education
## 4     31.76339 0.6182699 0.1631067             NA                 NA
## 12    31.66186 0.6180530 0.1632323     0.02934761                 NA
## 8     31.73031 0.6176839 0.1630710             NA         0.01667747
## 16    31.62571 0.6174357 0.1631967     0.02977682         0.01747568
## 7     39.37682        NA 0.1947115             NA         0.07771446
## 3     39.56545        NA 0.1950187             NA                 NA
## 15    39.22119        NA 0.1948748     0.04304143         0.07883279
## 11    39.41922        NA 0.1951791     0.04115847                 NA
## 2     48.73566 0.9425086        NA             NA                 NA
## 6     48.61525 0.9403588        NA             NA         0.05457557
## 10    48.85642 0.9424641        NA    -0.04006155                 NA
## 14    48.73428 0.9403581        NA    -0.03870129         0.05350017
## 5     67.11947        NA        NA             NA         0.17043620
## 13    67.23863        NA        NA    -0.03874818         0.16935942
## 1     67.63010        NA        NA             NA                 NA
## 9     67.75898        NA        NA    -0.04307553                 NA</code></pre>
</div>
</div>
</section>
<section id="averaging-coefficients-across-sets-of-models" class="level3" data-number="22.6.1">
<h3 data-number="22.6.1" class="anchored" data-anchor-id="averaging-coefficients-across-sets-of-models"><span class="header-section-number">22.6.1</span> Averaging Coefficients across Sets of Models</h3>
<p>The code below averages beta coefficients for the set of models with <strong>Delta AICc</strong> &lt; 4. Here, we also need to set the argument <code>fit=TRUE</code> because <code>dredge()</code> does not actually store the model results. The <code>model.avg()</code> function returns a “summary.averaging” object.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>(mods.avg <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">model.avg</span>(mods, <span class="at">subset =</span> delta <span class="sc">&lt;</span> <span class="dv">4</span>, <span class="at">fit =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## model.avg(object = get.models(object = mods, subset = delta &lt; 
##     4))
## 
## Component model call: 
## lm(formula = height ~ &lt;4 unique rhs&gt;, data = z, na.action = na.fail)
## 
## Component models: 
##      df   logLik    AICc delta weight
## 12    4 -1912.03 3832.09  0.00   0.44
## 124   5 -1911.54 3833.13  1.04   0.26
## 123   5 -1911.88 3833.82  1.73   0.19
## 1234  6 -1911.38 3834.84  2.75   0.11
## 
## Term codes: 
##                age             weight years_of_education     zombies_killed 
##                  1                  2                  3                  4 
## 
## Model-averaged coefficients:  
## (full average) 
##                     Estimate Std. Error Adjusted SE z value Pr(&gt;|z|)    
## (Intercept)        31.715277   0.479075    0.479651  66.122   &lt;2e-16 ***
## age                 0.618011   0.018485    0.018508  33.392   &lt;2e-16 ***
## weight              0.163143   0.002979    0.002982  54.706   &lt;2e-16 ***
## zombies_killed      0.011014   0.023089    0.023106   0.477    0.634    
## years_of_education  0.005046   0.018619    0.018638   0.271    0.787    
##  
## (conditional average) 
##                     Estimate Std. Error Adjusted SE z value Pr(&gt;|z|)    
## (Intercept)        31.715277   0.479075    0.479651  66.122   &lt;2e-16 ***
## age                 0.618011   0.018485    0.018508  33.392   &lt;2e-16 ***
## weight              0.163143   0.002979    0.002982  54.706   &lt;2e-16 ***
## zombies_killed      0.029476   0.029707    0.029744   0.991    0.322    
## years_of_education  0.016977   0.031046    0.031084   0.546    0.585    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mods.avg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] "summary.averaging" "averaging"</code></pre>
</div>
</div>
<p>We can use the <code>confint()</code> function to confidence intervals for the averaged coefficient estimates across models…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mods.avg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##                          2.5 %      97.5 %
## (Intercept)        30.77517771 32.65537579
## age                 0.58173646  0.65428595
## weight              0.15729812  0.16898796
## zombies_killed     -0.02882057  0.08777229
## years_of_education -0.04394591  0.07790059</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>NOTE: The ‘subset’ (or ‘conditional’) average reported is only averaging over models where the term appears. The ‘full’ average reported assumes that a term is included in every model, but the estimate and standard error are set to zero in models where the term is not included.</p>
</blockquote>
<p>The code below averages beta coefficients for models in the 95% confidence set, i.e., for cumulative AIC weights up to 95%:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>(mods.avg <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">model.avg</span>(mods, <span class="at">subset =</span> <span class="fu">cumsum</span>(weight) <span class="sc">&lt;=</span> <span class="fl">0.95</span>, <span class="at">fit =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## 
## Call:
## model.avg(object = get.models(object = mods, subset = cumsum(weight) &lt;= 
##     0.95))
## 
## Component model call: 
## lm(formula = height ~ &lt;3 unique rhs&gt;, data = z, na.action = na.fail)
## 
## Component models: 
##     df   logLik    AICc delta weight
## 12   4 -1912.03 3832.09  0.00   0.50
## 124  5 -1911.54 3833.13  1.04   0.29
## 123  5 -1911.88 3833.82  1.73   0.21
## 
## Term codes: 
##                age             weight years_of_education     zombies_killed 
##                  1                  2                  3                  4 
## 
## Model-averaged coefficients:  
## (full average) 
##                     Estimate Std. Error Adjusted SE z value Pr(&gt;|z|)    
## (Intercept)        31.726534   0.476970    0.477545  66.437   &lt;2e-16 ***
## age                 0.618084   0.018481    0.018503  33.404   &lt;2e-16 ***
## weight              0.163136   0.002978    0.002982  54.711   &lt;2e-16 ***
## zombies_killed      0.008656   0.020959    0.020974   0.413    0.680    
## years_of_education  0.003484   0.015723    0.015739   0.221    0.825    
##  
## (conditional average) 
##                     Estimate Std. Error Adjusted SE z value Pr(&gt;|z|)    
## (Intercept)        31.726534   0.476970    0.477545  66.437   &lt;2e-16 ***
## age                 0.618084   0.018481    0.018503  33.404   &lt;2e-16 ***
## weight              0.163136   0.002978    0.002982  54.711   &lt;2e-16 ***
## zombies_killed      0.029348   0.029701    0.029737   0.987    0.324    
## years_of_education  0.016677   0.031040    0.031078   0.537    0.592    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mods.avg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##                          2.5 %      97.5 %
## (Intercept)        30.79056281 32.66250541
## age                 0.58181768  0.65434939
## weight              0.15729206  0.16898053
## zombies_killed     -0.02893582  0.08763103
## years_of_education -0.04423354  0.07758849</code></pre>
</div>
</div>
<p>With the {MuMIn} package loaded, we can use the <code>plot()</code> function to make a plot of averaged model coefficients, similar to <code>plot_summs()</code> from {jtools}.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mods.avg, <span class="at">full =</span> <span class="cn">TRUE</span>, <span class="at">intercept =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="22-module_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mods.avg, <span class="at">full =</span> <span class="cn">FALSE</span>, <span class="at">intercept =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="22-module_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>NOTE: Omitting the <code>intercept=</code> argument or setting it to <code>TRUE</code> will include the <span class="math inline">\(\beta0\)</span> coefficient. When <code>full=TRUE</code>, coefficient averaging is done over all models in the selected set (for models where a particular parameter does not appear, the corresponding coefficient and its variance are set to zero). When <code>full=FALSE</code>, coefficient averaging is done only over models in the selected set where the parameter appears.</p>
</blockquote>
<p>Note that, here again, the two key predictors of zombie apocalypse survivor’s <strong>height</strong> are <strong>age</strong> and <strong>weight</strong>, and the best models include both of these terms!</p>
<hr>
</section>
</section>
<section id="concept-review" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="concept-review">Concept Review</h2>
<ul>
<li>Model selection is an iterative process, done as part of a regression analysis, where we sort through our explanatory variables and alternative models involving those variables to discern which are best able to account for variation in the response variable</li>
<li>There are various criteria for evaluating alternative models, but all rely on comparing the “explanatory value” of more complex models versus less complex models</li>
<li>Forward selection evaluates whether adding a variable or interaction among variables to a less complex model increases the explanatory value of the model significantly</li>
<li>Backwards selection evaluates whether removing a variable or interaction among variables from a more complex model results in a significant loss of explanatory power</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./21-module.html" class="pagination-link  aria-label=" &lt;span="" regression="" and="" ancova&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression and ANCOVA</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./23-module.html" class="pagination-link" aria-label="<span class='chapter-number'>23</span>&nbsp; <span class='chapter-title'>Generalized Linear Models</span>">
        <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb84" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model Selection in Regression {#module-22}</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>The purpose of a model selection process in a regression analysis is to sort through our explanatory variables in a systematic fashion in order to establish which are best able to describe the response. There are different possible algorithms to use for model selection, e.g., forward and backward selection, and different ways of comparing models to one another, which may result in different parameters being included in the final model. The are also several different package that we can use to combine results from several different models.</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminaries</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Install these packages in ***R***: <span class="co">[</span><span class="ot">{MASS}</span><span class="co">](https://cran.r-project.org/web/packages/MASS/MASS.pdf)</span>, <span class="co">[</span><span class="ot">{AICcmodavg}</span><span class="co">](https://cran.r-project.org/web/packages/AICcmodavg/AICcmodavg.pdf)</span>, and <span class="co">[</span><span class="ot">{MuMIn}</span><span class="co">](https://cran.r-project.org/web/packages/MuMIn/MuMIn.pdf)</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load {tidyverse}</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Nested Comparisons and F Tests</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>One way we can compare different models is to use F ratios and what are called **partial F tests**. This approach looks at two or more *nested* models - a larger, or more complex, model that contains explanatory variables that we are interested in and smaller, less complex, models that exclude one or more of those variables. Basically, we aim to compare the total variance in the response variable that is explained by the more complex model to that explained by a "reduced" model. If the more complex model explains a significantly greater proportion of the variation, then we conclude that predictor terms absent from the less complex model are important.</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>For example, if including an additional term with its associated $\beta$ coefficient results in significantly better fit to the observed data than we find for a model that lacks that particular terms, then this is evidence against the null hypothesis that the $\beta$ coefficient (slope) for that term equals zero.</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="fu">### EXAMPLE: {.unnumbered}</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>Let's go back to our zombie apocalypse survivors dataset and compare a few models. We need to calculate the following partial F statistic for a full versus reduced model:</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>$$F = \frac{(R^2_{full}-R^2_{reduced})(n-q-1)}{(1-R^2_{full})(q-p)}$$</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The $R^2$ values are the coefficients of determination of the full model and the nested "reduced" model</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$n$ is the number of observations in the data set</span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$p$ is the number of predictor terms in the nested (reduced) model</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$q$ is the number of predictor terms in the full model</span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>After we calculate this F statistic, we compare it to an $F$ distribution with "df1 = q-p" and "df2 = n-q" to derive a p value. The <span class="in">`lm()`</span> function will do this for us automatically, but we can also do it by hand.</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span></span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a>z<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(z<span class="sc">$</span>gender)</span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> age <span class="sc">*</span> gender) <span class="co"># full model</span></span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> age <span class="sc">+</span> gender) <span class="co"># model without interaction</span></span>
<span id="cb84-48"><a href="#cb84-48" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> age) <span class="co"># model with one predictor</span></span>
<span id="cb84-49"><a href="#cb84-49" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> <span class="dv">1</span>) <span class="co"># intercept only model</span></span>
<span id="cb84-50"><a href="#cb84-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-51"><a href="#cb84-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-52"><a href="#cb84-52" aria-hidden="true" tabindex="-1"></a>Once we have fitted the full and three nested models, we can carry out partial F tests to compare particular models using the <span class="in">`anova()`</span> function, with the nested (reduced) and full model as arguments. The reduced model is included as the first argument and the full model is included as the second argument.</span>
<span id="cb84-53"><a href="#cb84-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-56"><a href="#cb84-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-57"><a href="#cb84-57" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2, m1, <span class="at">test =</span> <span class="st">"F"</span>)</span>
<span id="cb84-58"><a href="#cb84-58" aria-hidden="true" tabindex="-1"></a><span class="co"># compares the reduced model without interactions (m2) to the full model with interactions (m1)</span></span>
<span id="cb84-59"><a href="#cb84-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-60"><a href="#cb84-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-61"><a href="#cb84-61" aria-hidden="true" tabindex="-1"></a>We can also calculate the F statistic by hand and compare it to the $F$ distribution.</span>
<span id="cb84-62"><a href="#cb84-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-65"><a href="#cb84-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-66"><a href="#cb84-66" aria-hidden="true" tabindex="-1"></a>(f <span class="ot">&lt;-</span> ((<span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared <span class="sc">-</span> <span class="fu">summary</span>(m2)<span class="sc">$</span>r.squared) <span class="sc">*</span></span>
<span id="cb84-67"><a href="#cb84-67" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">nrow</span>(z) <span class="sc">-</span> <span class="dv">3</span> <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared) <span class="sc">*</span> (<span class="dv">3</span> <span class="sc">-</span> <span class="dv">2</span>)))</span>
<span id="cb84-68"><a href="#cb84-68" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(f, <span class="at">df1 =</span> <span class="dv">3</span> <span class="sc">-</span> <span class="dv">2</span>, <span class="at">df2 =</span> <span class="fu">nrow</span>(z) <span class="sc">-</span> <span class="dv">3</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb84-69"><a href="#cb84-69" aria-hidden="true" tabindex="-1"></a><span class="co"># df1 = q-p, df2 = n-q</span></span>
<span id="cb84-70"><a href="#cb84-70" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m3, m2, <span class="at">test =</span> <span class="st">"F"</span>)</span>
<span id="cb84-71"><a href="#cb84-71" aria-hidden="true" tabindex="-1"></a><span class="co"># compares the age only model (m3) to the age + gender model (m2)</span></span>
<span id="cb84-72"><a href="#cb84-72" aria-hidden="true" tabindex="-1"></a>(f <span class="ot">&lt;-</span> ((<span class="fu">summary</span>(m2)<span class="sc">$</span>r.squared <span class="sc">-</span> <span class="fu">summary</span>(m3)<span class="sc">$</span>r.squared) <span class="sc">*</span></span>
<span id="cb84-73"><a href="#cb84-73" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">nrow</span>(z) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">summary</span>(m2)<span class="sc">$</span>r.squared) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb84-74"><a href="#cb84-74" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(f, <span class="at">df1 =</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>, <span class="at">df2 =</span> <span class="fu">nrow</span>(z) <span class="sc">-</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb84-75"><a href="#cb84-75" aria-hidden="true" tabindex="-1"></a><span class="co"># df1 = q-p, df2 = n-q</span></span>
<span id="cb84-76"><a href="#cb84-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-77"><a href="#cb84-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-78"><a href="#cb84-78" aria-hidden="true" tabindex="-1"></a>In these cases, each comparison shows that the more complex model indeed results in signficantly more explantory power than the reduced model.</span>
<span id="cb84-79"><a href="#cb84-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-80"><a href="#cb84-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## Forward Selection</span></span>
<span id="cb84-81"><a href="#cb84-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-82"><a href="#cb84-82" aria-hidden="true" tabindex="-1"></a>Forward selection starts with an intercept-only model and then tests which of the predictor variables best improves the goodness-of-fit. Then the model is updated by adding that term and tests which of the remaining predictors would further and best improve the fit. The process continues until there are not any other terms that could be added to improve the fit more. The ***R*** functions <span class="in">`add1()`</span> and <span class="in">`update()`</span>, respectively, perform the series of tests and update your fitted regression model. Setting the "test=" argument in <span class="in">`add1()`</span> to "F" includes the partial F statistic value and its significance. The ".~." part of the "scope=" argument means, basically, "what is already there", while the remainder of the "scope=" argument is the list of additional variables you might add for the fullest possible model.</span>
<span id="cb84-83"><a href="#cb84-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-86"><a href="#cb84-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-87"><a href="#cb84-87" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb84-88"><a href="#cb84-88" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb84-89"><a href="#cb84-89" aria-hidden="true" tabindex="-1"></a><span class="fu">add1</span>(m0, <span class="at">scope =</span> .<span class="sc">~</span>. <span class="sc">+</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education, <span class="at">test =</span> <span class="st">"F"</span>)</span>
<span id="cb84-90"><a href="#cb84-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-91"><a href="#cb84-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-92"><a href="#cb84-92" aria-hidden="true" tabindex="-1"></a>Looking at the output of <span class="in">`add1()`</span>, we see that adding **weight**, **age**, or **years_of_education** all would add explanatory power to our model, but **weight** is associated with the highest new F statistic and the lowest new RSS, so we should update our model by adding it as a new predictor. We do this with the <span class="in">`update()`</span> function, passing it the old model and a "formula=" argument of ".~." (what is already there) "+ weight" (the new predictor).</span>
<span id="cb84-93"><a href="#cb84-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-96"><a href="#cb84-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-97"><a href="#cb84-97" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">update</span>(m0, <span class="at">formula =</span> .<span class="sc">~</span>. <span class="sc">+</span> weight)</span>
<span id="cb84-98"><a href="#cb84-98" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb84-99"><a href="#cb84-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-100"><a href="#cb84-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-101"><a href="#cb84-101" aria-hidden="true" tabindex="-1"></a>We then repeat this process until adding additional predictors no longer improves the explanatory power of the model.</span>
<span id="cb84-102"><a href="#cb84-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-105"><a href="#cb84-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-106"><a href="#cb84-106" aria-hidden="true" tabindex="-1"></a><span class="fu">add1</span>(m1, <span class="at">scope =</span> .<span class="sc">~</span>. <span class="sc">+</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education, <span class="at">test =</span> <span class="st">"F"</span>)</span>
<span id="cb84-107"><a href="#cb84-107" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">update</span>(m1, <span class="at">formula =</span> .<span class="sc">~</span>. <span class="sc">+</span> age)</span>
<span id="cb84-108"><a href="#cb84-108" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span>
<span id="cb84-109"><a href="#cb84-109" aria-hidden="true" tabindex="-1"></a><span class="fu">add1</span>(m2, <span class="at">scope =</span> .<span class="sc">~</span>. <span class="sc">+</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education, <span class="at">test =</span> <span class="st">"F"</span>)</span>
<span id="cb84-110"><a href="#cb84-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-111"><a href="#cb84-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-112"><a href="#cb84-112" aria-hidden="true" tabindex="-1"></a>After we add **weight** and **age**, no other variable improves the fit of the model significantly, so the final, best model in this case is **m2**.</span>
<span id="cb84-113"><a href="#cb84-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-116"><a href="#cb84-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-117"><a href="#cb84-117" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span>
<span id="cb84-118"><a href="#cb84-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-119"><a href="#cb84-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-120"><a href="#cb84-120" aria-hidden="true" tabindex="-1"></a><span class="fu">## Backward Selection</span></span>
<span id="cb84-121"><a href="#cb84-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-122"><a href="#cb84-122" aria-hidden="true" tabindex="-1"></a>Opposite to forward selection, backward selection starts with the fullest model you want to consider and systematically drops terms that do not contribute to the explanatory value of the model. The ***R*** functions for this process are <span class="in">`drop1()`</span> to inspect the partial F test results and <span class="in">`update()`</span> to update the model.</span>
<span id="cb84-123"><a href="#cb84-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-126"><a href="#cb84-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-127"><a href="#cb84-127" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span></span>
<span id="cb84-128"><a href="#cb84-128" aria-hidden="true" tabindex="-1"></a>  years_of_education)</span>
<span id="cb84-129"><a href="#cb84-129" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb84-130"><a href="#cb84-130" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(m0, <span class="at">test =</span> <span class="st">"F"</span>)</span>
<span id="cb84-131"><a href="#cb84-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-132"><a href="#cb84-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-133"><a href="#cb84-133" aria-hidden="true" tabindex="-1"></a>Here, removing either **weight** or **age** would result in a significant loss of explanatory power for our model, while removing either **zombies_killed** or **years_of_education** would not. The latter variable is associated with the lowest F value and lowest increase in RSS, so we update our model by removing it. We then run the <span class="in">`drop1()`</span> function on the new, updated model and remove the next variable whose loss does not significantly reduce the explanatory power of the model. We continue doing this until removing any additional predictors results in a significantly worse model.</span>
<span id="cb84-134"><a href="#cb84-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-137"><a href="#cb84-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-138"><a href="#cb84-138" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">update</span>(m0, .<span class="sc">~</span>. <span class="sc">-</span> years_of_education)</span>
<span id="cb84-139"><a href="#cb84-139" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb84-140"><a href="#cb84-140" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(m1, <span class="at">test =</span> <span class="st">"F"</span>)</span>
<span id="cb84-141"><a href="#cb84-141" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">update</span>(m1, .<span class="sc">~</span>. <span class="sc">-</span> zombies_killed)</span>
<span id="cb84-142"><a href="#cb84-142" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span>
<span id="cb84-143"><a href="#cb84-143" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(m2, <span class="at">test =</span> <span class="st">"F"</span>)</span>
<span id="cb84-144"><a href="#cb84-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-145"><a href="#cb84-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-146"><a href="#cb84-146" aria-hidden="true" tabindex="-1"></a>At this point, all of the explanatory variables are still significant, so the final, best model in this case is also **m2**.</span>
<span id="cb84-147"><a href="#cb84-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-150"><a href="#cb84-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-151"><a href="#cb84-151" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span>
<span id="cb84-152"><a href="#cb84-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-153"><a href="#cb84-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-154"><a href="#cb84-154" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model Selection Using AIC</span></span>
<span id="cb84-155"><a href="#cb84-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-156"><a href="#cb84-156" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Stepwise Selection using {MASS} {.unnumbered}</span></span>
<span id="cb84-157"><a href="#cb84-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-158"><a href="#cb84-158" aria-hidden="true" tabindex="-1"></a>There are two ***R*** functions that can act as further shortcuts for this process that use the <span class="co">[</span><span class="ot">Akaike Information Criterion (AIC)</span><span class="co">](https://en.wikipedia.org/wiki/Akaike_information_criterion)</span> rather than partial F tests to determine relative model fit. We will talk in more detail about how we get AIC in our upcoming modules on GLM and mixed modeling as well.</span>
<span id="cb84-159"><a href="#cb84-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-160"><a href="#cb84-160" aria-hidden="true" tabindex="-1"></a>The AIC is typically calculated as ***-2(log-likelihood) + 2K***, where $K$ is the number of model parameters (i.e., the number of $\beta$ coefficients we estimate, which equals the number of variables in the model, plus the intercept), and the log-likelihood is a measure of model fit (the higher, the better). <span class="co">[</span><span class="ot">Keep in mind, though, that log-likelihood is a function of sample size, and larger samples will tend to have lower log-likelihoods regardless of fit!</span><span class="co">]</span> We will not derive log-likelihoods by hand in class, but if you want to know more about how log-likelihood values are derived, you can check out <span class="co">[</span><span class="ot">this helpful resource</span><span class="co">](https://newonlinecourses.science.psu.edu/stat504/node/27/)</span>.</span>
<span id="cb84-161"><a href="#cb84-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-162"><a href="#cb84-162" aria-hidden="true" tabindex="-1"></a>As you might guess from how AIC is defined, the model with the **lowest** AIC is typically designated as the best fit for the data. Note that although AIC can be used to assess the relative fit of a model to a certain data set, it really does not say anything about the absolute fit or explanatory value of the model (e.g., like the $R^2$ value can). Keep in mind that the best fit model according to AIC, among the models you test against each other, may actually explain very little of the overall variation.</span>
<span id="cb84-163"><a href="#cb84-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-164"><a href="#cb84-164" aria-hidden="true" tabindex="-1"></a>There are many functions within **R** that will perform stepwise model reduction automatically using AIC as a criterion. One of the most popular is called <span class="in">`stepAIC()`</span>, which is a function in the {MASS} package. To use it, you must simply specify the most complex version of the model and choose whether you would like to assess the model using backwards or forwards (or both) methods of stepwise comparison.</span>
<span id="cb84-165"><a href="#cb84-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-166"><a href="#cb84-166" aria-hidden="true" tabindex="-1"></a>Let's try <span class="in">`stepAIC()`</span> with our **m0** from above. In the call for the function, we can ask it to run forward, backward, or both directions.</span>
<span id="cb84-167"><a href="#cb84-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-170"><a href="#cb84-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-171"><a href="#cb84-171" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb84-172"><a href="#cb84-172" aria-hidden="true" tabindex="-1"></a><span class="co"># start with full model...</span></span>
<span id="cb84-173"><a href="#cb84-173" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education)</span>
<span id="cb84-174"><a href="#cb84-174" aria-hidden="true" tabindex="-1"></a>(s <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(m, <span class="at">scope =</span> . <span class="sc">~</span> ., <span class="at">direction =</span> <span class="st">"both"</span>))</span>
<span id="cb84-175"><a href="#cb84-175" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(s)</span>
<span id="cb84-176"><a href="#cb84-176" aria-hidden="true" tabindex="-1"></a><span class="co"># ... or start with minimal model</span></span>
<span id="cb84-177"><a href="#cb84-177" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z, height <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb84-178"><a href="#cb84-178" aria-hidden="true" tabindex="-1"></a>(s <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(m, <span class="at">scope =</span> <span class="sc">~</span> . <span class="sc">+</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span></span>
<span id="cb84-179"><a href="#cb84-179" aria-hidden="true" tabindex="-1"></a>  years_of_education, <span class="at">direction =</span> <span class="st">"both"</span>))</span>
<span id="cb84-180"><a href="#cb84-180" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(s)</span>
<span id="cb84-181"><a href="#cb84-181" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>MASS)</span>
<span id="cb84-182"><a href="#cb84-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-183"><a href="#cb84-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-184"><a href="#cb84-184" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`stepAIC()`</span> function, whether we start with the full model more with a null model, has converged (using AIC, in this case) on the same best model we found above through forward and backwards selection by hand - i.e., the model with just **age** and **weight** retained as predictor variables after our process of model selection.</span>
<span id="cb84-185"><a href="#cb84-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-186"><a href="#cb84-186" aria-hidden="true" tabindex="-1"></a>Finally, there's a very helpful model selection package called {AICcmodavg}. You may have noticed the extra "c" in AICc... this is a "corrected" version of AIC that can account for small sample sizes (helpful for most of us in anthropology and biology). It is derived from AIC using the following equation (which you do not need to know!):</span>
<span id="cb84-187"><a href="#cb84-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-188"><a href="#cb84-188" aria-hidden="true" tabindex="-1"></a>$$AIC_c = AIC + \frac{2K^2 + 2K}{n-K-1}$$</span>
<span id="cb84-189"><a href="#cb84-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-190"><a href="#cb84-190" aria-hidden="true" tabindex="-1"></a>where $n$ is sample size and $K$ is the number of parameters in the model. This is, essentially, a version of AIC with greater penalties for models with more parameters. Since the values for AICc and AIC converge as sample size increases, it has been argued that AICc should be the default model testing criterion rather than AIC.</span>
<span id="cb84-191"><a href="#cb84-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-192"><a href="#cb84-192" aria-hidden="true" tabindex="-1"></a>What makes this wrapper especially useful is that the table output of the function very clearly compares AIC values for different models in a way often asked for in publications. Let's take a look using our already-defined models.</span>
<span id="cb84-193"><a href="#cb84-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-196"><a href="#cb84-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-197"><a href="#cb84-197" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb84-198"><a href="#cb84-198" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(<span class="fu">list</span>(m0, m1, m2), <span class="fu">c</span>(<span class="st">"m0"</span>, <span class="st">"m1"</span>, <span class="st">"m2"</span>))</span>
<span id="cb84-199"><a href="#cb84-199" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>AICcmodavg)</span>
<span id="cb84-200"><a href="#cb84-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-201"><a href="#cb84-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-202"><a href="#cb84-202" aria-hidden="true" tabindex="-1"></a>We get a few types of output that allow us to directly compare the relative fit of each model: the number of parameters (**k**), the **AICc** scores, and a number of other helpful outputs. **Delta AICc** (or $\Delta_i(AIC)=AIC_i-min(AIC)$) is simply a comparison showing how different each "least-best" model is from the best model in AICc score (i.e., the difference in their AICc scores). **AICcWt** shows us the "weight" of the model at each level (see [here](https://www.rdocumentation.org/packages/qpcR/versions/1.4-0/topics/akaike.weights) for an explanation of what this means). In this case, the best model is the first on the list and is, like in all our other model selection methods, **m2**.</span>
<span id="cb84-203"><a href="#cb84-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-204"><a href="#cb84-204" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Automated Subset Selection and Model Averaging using {MuMIn} {.unnumbered}</span></span>
<span id="cb84-205"><a href="#cb84-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-206"><a href="#cb84-206" aria-hidden="true" tabindex="-1"></a>An alternative approach to model selection using AIC is provided by using the function <span class="in">`dredge()`</span> in the {MuMIn} package, which explores subsets of a given global model in an automated way. With <span class="in">`dredge()`</span>, we first run a global model that includes all of the terms we want to consider and then we run <span class="in">`dredge()`</span> to fit subsets of that model without having to specify explicitly which submodels we want to run. The <span class="in">`dredge()`</span> function returns a "model selection" table with models ranked in order of increasing AICc (i.e., lowest, or "best", first).</span>
<span id="cb84-207"><a href="#cb84-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-208"><a href="#cb84-208" aria-hidden="true" tabindex="-1"></a>We start by defining a "global.model"...</span>
<span id="cb84-209"><a href="#cb84-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-212"><a href="#cb84-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-213"><a href="#cb84-213" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb84-214"><a href="#cb84-214" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> z,</span>
<span id="cb84-215"><a href="#cb84-215" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> zombies_killed <span class="sc">+</span> years_of_education,</span>
<span id="cb84-216"><a href="#cb84-216" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb84-217"><a href="#cb84-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-218"><a href="#cb84-218" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Here, we need to change the "na.action" argument from the default of "na.omit" to "na.fail" to prevent </span><span class="in">`dredge()`</span><span class="at"> from trying to fit submodels with different data sets than the global model if there are missing values.</span></span>
<span id="cb84-219"><a href="#cb84-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-220"><a href="#cb84-220" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Alternatively, we could set that option globally for our R session before running the global model by using </span><span class="in">`options(na.action = na.fail)`</span><span class="at"> and then omitting the </span><span class="in">`na.action=`</span><span class="at"> argument from our call to </span><span class="in">`lm()`</span><span class="at">.</span></span>
<span id="cb84-221"><a href="#cb84-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-222"><a href="#cb84-222" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; We could also filter our dataset to only include rows where none of the variables of interest have missing data using, e.g., </span><span class="in">`drop_na()`</span><span class="at">.</span></span>
<span id="cb84-223"><a href="#cb84-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-224"><a href="#cb84-224" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The command </span><span class="in">`options()$na.action`</span><span class="at"> shows the current "na.action" option.</span></span>
<span id="cb84-225"><a href="#cb84-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-226"><a href="#cb84-226" aria-hidden="true" tabindex="-1"></a>We then run <span class="in">`dredge()`</span> to explore a set of submodels...</span>
<span id="cb84-227"><a href="#cb84-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-228"><a href="#cb84-228" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>the <span class="in">`m.lim=`</span> argument is optional and sets lower and upper limits on the number of terms to include</span>
<span id="cb84-229"><a href="#cb84-229" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>the <span class="in">`beta=`</span> argument specifies whether or not and how to standardize the beta coefficients; "none" is the default</span>
<span id="cb84-230"><a href="#cb84-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-233"><a href="#cb84-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-234"><a href="#cb84-234" aria-hidden="true" tabindex="-1"></a>mods <span class="ot">&lt;-</span> <span class="fu">dredge</span>(m, <span class="at">beta =</span> <span class="st">"none"</span>, <span class="at">m.lim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb84-235"><a href="#cb84-235" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mods)</span>
<span id="cb84-236"><a href="#cb84-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-237"><a href="#cb84-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-238"><a href="#cb84-238" aria-hidden="true" tabindex="-1"></a>The <span class="in">`dredge()`</span> function returns a "model.selection" object summarizing all of the models that were tested. The <span class="in">`get.models()`</span> function can be used to return a list of these models.</span>
<span id="cb84-239"><a href="#cb84-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-242"><a href="#cb84-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-243"><a href="#cb84-243" aria-hidden="true" tabindex="-1"></a>(mods.list <span class="ot">&lt;-</span> <span class="fu">get.models</span>(mods, <span class="at">subset=</span><span class="cn">TRUE</span>))</span>
<span id="cb84-244"><a href="#cb84-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-245"><a href="#cb84-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-246"><a href="#cb84-246" aria-hidden="true" tabindex="-1"></a>Running the <span class="in">`coef()`</span> function on the output of <span class="in">`dredge()`</span> returns a table of coefficients from each model, where the rowname is the number of the corresponding model in the "model.selection" object.</span>
<span id="cb84-247"><a href="#cb84-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-250"><a href="#cb84-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-251"><a href="#cb84-251" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mods)</span>
<span id="cb84-252"><a href="#cb84-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-253"><a href="#cb84-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-254"><a href="#cb84-254" aria-hidden="true" tabindex="-1"></a><span class="fu">### Averaging Coefficients across Sets of Models</span></span>
<span id="cb84-255"><a href="#cb84-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-256"><a href="#cb84-256" aria-hidden="true" tabindex="-1"></a>The code below averages beta coefficients for the set of models with **Delta AICc** &lt; 4. Here, we also need to set the argument <span class="in">`fit=TRUE`</span> because <span class="in">`dredge()`</span> does not actually store the model results. The <span class="in">`model.avg()`</span> function returns a "summary.averaging" object.</span>
<span id="cb84-257"><a href="#cb84-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-260"><a href="#cb84-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-261"><a href="#cb84-261" aria-hidden="true" tabindex="-1"></a>(mods.avg <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">model.avg</span>(mods,</span>
<span id="cb84-262"><a href="#cb84-262" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> delta <span class="sc">&lt;</span> <span class="dv">4</span>, <span class="at">fit =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb84-263"><a href="#cb84-263" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mods.avg)</span>
<span id="cb84-264"><a href="#cb84-264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-265"><a href="#cb84-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-266"><a href="#cb84-266" aria-hidden="true" tabindex="-1"></a>We can use the <span class="in">`confint()`</span> function to confidence intervals for the averaged coefficient estimates across models...</span>
<span id="cb84-267"><a href="#cb84-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-270"><a href="#cb84-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-271"><a href="#cb84-271" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mods.avg)</span>
<span id="cb84-272"><a href="#cb84-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-273"><a href="#cb84-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-274"><a href="#cb84-274" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; NOTE: The ‘subset’ (or ‘conditional’) average reported is only averaging over models where the term appears. The ‘full’ average reported assumes that a term is included in every model, but the estimate and standard error are set to zero in models where the term is not included.</span></span>
<span id="cb84-275"><a href="#cb84-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-276"><a href="#cb84-276" aria-hidden="true" tabindex="-1"></a>The code below averages beta coefficients for models in the 95% confidence set, i.e., for cumulative AIC weights up to 95%:</span>
<span id="cb84-277"><a href="#cb84-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-280"><a href="#cb84-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-281"><a href="#cb84-281" aria-hidden="true" tabindex="-1"></a>(mods.avg <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">model.avg</span>(mods, <span class="at">subset =</span> <span class="fu">cumsum</span>(weight) <span class="sc">&lt;=</span> <span class="fl">0.95</span>, <span class="at">fit =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb84-282"><a href="#cb84-282" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mods.avg)</span>
<span id="cb84-283"><a href="#cb84-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-284"><a href="#cb84-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-285"><a href="#cb84-285" aria-hidden="true" tabindex="-1"></a>With the {MuMIn} package loaded, we can use the <span class="in">`plot()`</span> function to make a plot of averaged model coefficients, similar to <span class="in">`plot_summs()`</span> from {jtools}.</span>
<span id="cb84-286"><a href="#cb84-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-289"><a href="#cb84-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-290"><a href="#cb84-290" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mods.avg, <span class="at">full =</span> <span class="cn">TRUE</span>, <span class="at">intercept =</span> <span class="cn">FALSE</span>)</span>
<span id="cb84-291"><a href="#cb84-291" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mods.avg, <span class="at">full =</span> <span class="cn">FALSE</span>, <span class="at">intercept =</span> <span class="cn">FALSE</span>)</span>
<span id="cb84-292"><a href="#cb84-292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-293"><a href="#cb84-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-294"><a href="#cb84-294" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; NOTE: Omitting the </span><span class="in">`intercept=`</span><span class="at"> argument or setting it to </span><span class="in">`TRUE`</span><span class="at"> will include the $\beta0$ coefficient. When </span><span class="in">`full=TRUE`</span><span class="at">, coefficient averaging is done over all models in the selected set (for models where a particular parameter does not appear, the corresponding coefficient and its variance are set to zero). When </span><span class="in">`full=FALSE`</span><span class="at">, coefficient averaging is done only over models in the selected set where the parameter appears.</span></span>
<span id="cb84-295"><a href="#cb84-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-296"><a href="#cb84-296" aria-hidden="true" tabindex="-1"></a>Note that, here again, the two key predictors of zombie apocalypse survivor's **height** are **age** and **weight**, and the best models include both of these terms!</span>
<span id="cb84-297"><a href="#cb84-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-300"><a href="#cb84-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-301"><a href="#cb84-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb84-302"><a href="#cb84-302" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>MuMIn)</span>
<span id="cb84-303"><a href="#cb84-303" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>tidyverse)</span>
<span id="cb84-304"><a href="#cb84-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-305"><a href="#cb84-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-306"><a href="#cb84-306" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb84-307"><a href="#cb84-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-308"><a href="#cb84-308" aria-hidden="true" tabindex="-1"></a><span class="fu">## Concept Review {.unnumbered}</span></span>
<span id="cb84-309"><a href="#cb84-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-310"><a href="#cb84-310" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Model selection is an iterative process, done as part of a regression analysis, where we sort through our explanatory variables and alternative models involving those variables to discern which are best able to account for variation in the response variable</span>
<span id="cb84-311"><a href="#cb84-311" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are various criteria for evaluating alternative models, but all rely on comparing the "explanatory value" of more complex models versus less complex models</span>
<span id="cb84-312"><a href="#cb84-312" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Forward selection evaluates whether adding a variable or interaction among variables to a less complex model increases the explanatory value of the model significantly</span>
<span id="cb84-313"><a href="#cb84-313" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Backwards selection evaluates whether removing a variable or interaction among variables from a more complex model results in a significant loss of explanatory power</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>